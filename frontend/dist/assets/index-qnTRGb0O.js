var OC=Object.defineProperty;var hb=n=>{throw TypeError(n)};var FC=(n,e,t)=>e in n?OC(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var F=(n,e,t)=>FC(n,typeof e!="symbol"?e+"":e,t),zm=(n,e,t)=>e.has(n)||hb("Cannot "+t);var l=(n,e,t)=>(zm(n,e,"read from private field"),t?t.call(n):e.get(n)),x=(n,e,t)=>e.has(n)?hb("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),m=(n,e,t,s)=>(zm(n,e,"write to private field"),s?s.call(n,t):e.set(n,t),t),S=(n,e,t)=>(zm(n,e,"access private method"),t);var Jt=(n,e,t,s)=>({set _(i){m(n,e,i,t)},get _(){return l(n,e,s)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=t(i);fetch(i.href,r)}})();function j0(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var vS={exports:{}},im={},wS={exports:{}},ce={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _f=Symbol.for("react.element"),jC=Symbol.for("react.portal"),zC=Symbol.for("react.fragment"),$C=Symbol.for("react.strict_mode"),BC=Symbol.for("react.profiler"),HC=Symbol.for("react.provider"),UC=Symbol.for("react.context"),VC=Symbol.for("react.forward_ref"),GC=Symbol.for("react.suspense"),WC=Symbol.for("react.memo"),XC=Symbol.for("react.lazy"),fb=Symbol.iterator;function qC(n){return n===null||typeof n!="object"?null:(n=fb&&n[fb]||n["@@iterator"],typeof n=="function"?n:null)}var bS={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},xS=Object.assign,SS={};function bu(n,e,t){this.props=n,this.context=e,this.refs=SS,this.updater=t||bS}bu.prototype.isReactComponent={};bu.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};bu.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function AS(){}AS.prototype=bu.prototype;function z0(n,e,t){this.props=n,this.context=e,this.refs=SS,this.updater=t||bS}var $0=z0.prototype=new AS;$0.constructor=z0;xS($0,bu.prototype);$0.isPureReactComponent=!0;var pb=Array.isArray,ES=Object.prototype.hasOwnProperty,B0={current:null},_S={key:!0,ref:!0,__self:!0,__source:!0};function CS(n,e,t){var s,i={},r=null,o=null;if(e!=null)for(s in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(r=""+e.key),e)ES.call(e,s)&&!_S.hasOwnProperty(s)&&(i[s]=e[s]);var a=arguments.length-2;if(a===1)i.children=t;else if(1<a){for(var c=Array(a),u=0;u<a;u++)c[u]=arguments[u+2];i.children=c}if(n&&n.defaultProps)for(s in a=n.defaultProps,a)i[s]===void 0&&(i[s]=a[s]);return{$$typeof:_f,type:n,key:r,ref:o,props:i,_owner:B0.current}}function YC(n,e){return{$$typeof:_f,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function H0(n){return typeof n=="object"&&n!==null&&n.$$typeof===_f}function KC(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var gb=/\/+/g;function $m(n,e){return typeof n=="object"&&n!==null&&n.key!=null?KC(""+n.key):e.toString(36)}function pp(n,e,t,s,i){var r=typeof n;(r==="undefined"||r==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(r){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case _f:case jC:o=!0}}if(o)return o=n,i=i(o),n=s===""?"."+$m(o,0):s,pb(i)?(t="",n!=null&&(t=n.replace(gb,"$&/")+"/"),pp(i,e,t,"",function(u){return u})):i!=null&&(H0(i)&&(i=YC(i,t+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(gb,"$&/")+"/")+n)),e.push(i)),1;if(o=0,s=s===""?".":s+":",pb(n))for(var a=0;a<n.length;a++){r=n[a];var c=s+$m(r,a);o+=pp(r,e,t,c,i)}else if(c=qC(n),typeof c=="function")for(n=c.call(n),a=0;!(r=n.next()).done;)r=r.value,c=s+$m(r,a++),o+=pp(r,e,t,c,i);else if(r==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Vf(n,e,t){if(n==null)return n;var s=[],i=0;return pp(n,s,"","",function(r){return e.call(t,r,i++)}),s}function QC(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var dn={current:null},gp={transition:null},JC={ReactCurrentDispatcher:dn,ReactCurrentBatchConfig:gp,ReactCurrentOwner:B0};function kS(){throw Error("act(...) is not supported in production builds of React.")}ce.Children={map:Vf,forEach:function(n,e,t){Vf(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return Vf(n,function(){e++}),e},toArray:function(n){return Vf(n,function(e){return e})||[]},only:function(n){if(!H0(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};ce.Component=bu;ce.Fragment=zC;ce.Profiler=BC;ce.PureComponent=z0;ce.StrictMode=$C;ce.Suspense=GC;ce.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=JC;ce.act=kS;ce.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var s=xS({},n.props),i=n.key,r=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(r=e.ref,o=B0.current),e.key!==void 0&&(i=""+e.key),n.type&&n.type.defaultProps)var a=n.type.defaultProps;for(c in e)ES.call(e,c)&&!_S.hasOwnProperty(c)&&(s[c]=e[c]===void 0&&a!==void 0?a[c]:e[c])}var c=arguments.length-2;if(c===1)s.children=t;else if(1<c){a=Array(c);for(var u=0;u<c;u++)a[u]=arguments[u+2];s.children=a}return{$$typeof:_f,type:n.type,key:i,ref:r,props:s,_owner:o}};ce.createContext=function(n){return n={$$typeof:UC,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:HC,_context:n},n.Consumer=n};ce.createElement=CS;ce.createFactory=function(n){var e=CS.bind(null,n);return e.type=n,e};ce.createRef=function(){return{current:null}};ce.forwardRef=function(n){return{$$typeof:VC,render:n}};ce.isValidElement=H0;ce.lazy=function(n){return{$$typeof:XC,_payload:{_status:-1,_result:n},_init:QC}};ce.memo=function(n,e){return{$$typeof:WC,type:n,compare:e===void 0?null:e}};ce.startTransition=function(n){var e=gp.transition;gp.transition={};try{n()}finally{gp.transition=e}};ce.unstable_act=kS;ce.useCallback=function(n,e){return dn.current.useCallback(n,e)};ce.useContext=function(n){return dn.current.useContext(n)};ce.useDebugValue=function(){};ce.useDeferredValue=function(n){return dn.current.useDeferredValue(n)};ce.useEffect=function(n,e){return dn.current.useEffect(n,e)};ce.useId=function(){return dn.current.useId()};ce.useImperativeHandle=function(n,e,t){return dn.current.useImperativeHandle(n,e,t)};ce.useInsertionEffect=function(n,e){return dn.current.useInsertionEffect(n,e)};ce.useLayoutEffect=function(n,e){return dn.current.useLayoutEffect(n,e)};ce.useMemo=function(n,e){return dn.current.useMemo(n,e)};ce.useReducer=function(n,e,t){return dn.current.useReducer(n,e,t)};ce.useRef=function(n){return dn.current.useRef(n)};ce.useState=function(n){return dn.current.useState(n)};ce.useSyncExternalStore=function(n,e,t){return dn.current.useSyncExternalStore(n,e,t)};ce.useTransition=function(){return dn.current.useTransition()};ce.version="18.3.1";wS.exports=ce;var P=wS.exports;const an=j0(P);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ZC=P,ek=Symbol.for("react.element"),tk=Symbol.for("react.fragment"),nk=Object.prototype.hasOwnProperty,sk=ZC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ik={key:!0,ref:!0,__self:!0,__source:!0};function TS(n,e,t){var s,i={},r=null,o=null;t!==void 0&&(r=""+t),e.key!==void 0&&(r=""+e.key),e.ref!==void 0&&(o=e.ref);for(s in e)nk.call(e,s)&&!ik.hasOwnProperty(s)&&(i[s]=e[s]);if(n&&n.defaultProps)for(s in e=n.defaultProps,e)i[s]===void 0&&(i[s]=e[s]);return{$$typeof:ek,type:n,key:r,ref:o,props:i,_owner:sk.current}}im.Fragment=tk;im.jsx=TS;im.jsxs=TS;vS.exports=im;var _=vS.exports,_y={},PS={exports:{}},es={},RS={exports:{}},LS={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(I,V){var K=I.length;I.push(V);e:for(;0<K;){var re=K-1>>>1,J=I[re];if(0<i(J,V))I[re]=V,I[K]=J,K=re;else break e}}function t(I){return I.length===0?null:I[0]}function s(I){if(I.length===0)return null;var V=I[0],K=I.pop();if(K!==V){I[0]=K;e:for(var re=0,J=I.length,oe=J>>>1;re<oe;){var Re=2*(re+1)-1,Xe=I[Re],fe=Re+1,pe=I[fe];if(0>i(Xe,K))fe<J&&0>i(pe,Xe)?(I[re]=pe,I[fe]=K,re=fe):(I[re]=Xe,I[Re]=K,re=Re);else if(fe<J&&0>i(pe,K))I[re]=pe,I[fe]=K,re=fe;else break e}}return V}function i(I,V){var K=I.sortIndex-V.sortIndex;return K!==0?K:I.id-V.id}if(typeof performance=="object"&&typeof performance.now=="function"){var r=performance;n.unstable_now=function(){return r.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var c=[],u=[],d=1,h=null,f=3,p=!1,y=!1,g=!1,A=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(I){for(var V=t(u);V!==null;){if(V.callback===null)s(u);else if(V.startTime<=I)s(u),V.sortIndex=V.expirationTime,e(c,V);else break;V=t(u)}}function E(I){if(g=!1,b(I),!y)if(t(c)!==null)y=!0,j(C);else{var V=t(u);V!==null&&O(E,V.startTime-I)}}function C(I,V){y=!1,g&&(g=!1,v(R),R=-1),p=!0;var K=f;try{for(b(V),h=t(c);h!==null&&(!(h.expirationTime>V)||I&&!N());){var re=h.callback;if(typeof re=="function"){h.callback=null,f=h.priorityLevel;var J=re(h.expirationTime<=V);V=n.unstable_now(),typeof J=="function"?h.callback=J:h===t(c)&&s(c),b(V)}else s(c);h=t(c)}if(h!==null)var oe=!0;else{var Re=t(u);Re!==null&&O(E,Re.startTime-V),oe=!1}return oe}finally{h=null,f=K,p=!1}}var T=!1,k=null,R=-1,M=5,L=-1;function N(){return!(n.unstable_now()-L<M)}function B(){if(k!==null){var I=n.unstable_now();L=I;var V=!0;try{V=k(!0,I)}finally{V?H():(T=!1,k=null)}}else T=!1}var H;if(typeof w=="function")H=function(){w(B)};else if(typeof MessageChannel<"u"){var W=new MessageChannel,ee=W.port2;W.port1.onmessage=B,H=function(){ee.postMessage(null)}}else H=function(){A(B,0)};function j(I){k=I,T||(T=!0,H())}function O(I,V){R=A(function(){I(n.unstable_now())},V)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(I){I.callback=null},n.unstable_continueExecution=function(){y||p||(y=!0,j(C))},n.unstable_forceFrameRate=function(I){0>I||125<I?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<I?Math.floor(1e3/I):5},n.unstable_getCurrentPriorityLevel=function(){return f},n.unstable_getFirstCallbackNode=function(){return t(c)},n.unstable_next=function(I){switch(f){case 1:case 2:case 3:var V=3;break;default:V=f}var K=f;f=V;try{return I()}finally{f=K}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(I,V){switch(I){case 1:case 2:case 3:case 4:case 5:break;default:I=3}var K=f;f=I;try{return V()}finally{f=K}},n.unstable_scheduleCallback=function(I,V,K){var re=n.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?re+K:re):K=re,I){case 1:var J=-1;break;case 2:J=250;break;case 5:J=1073741823;break;case 4:J=1e4;break;default:J=5e3}return J=K+J,I={id:d++,callback:V,priorityLevel:I,startTime:K,expirationTime:J,sortIndex:-1},K>re?(I.sortIndex=K,e(u,I),t(c)===null&&I===t(u)&&(g?(v(R),R=-1):g=!0,O(E,K-re))):(I.sortIndex=J,e(c,I),y||p||(y=!0,j(C))),I},n.unstable_shouldYield=N,n.unstable_wrapCallback=function(I){var V=f;return function(){var K=f;f=V;try{return I.apply(this,arguments)}finally{f=K}}}})(LS);RS.exports=LS;var rk=RS.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ok=P,Zn=rk;function D(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var NS=new Set,Ed={};function ml(n,e){uu(n,e),uu(n+"Capture",e)}function uu(n,e){for(Ed[n]=e,n=0;n<e.length;n++)NS.add(e[n])}var br=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Cy=Object.prototype.hasOwnProperty,ak=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,mb={},yb={};function lk(n){return Cy.call(yb,n)?!0:Cy.call(mb,n)?!1:ak.test(n)?yb[n]=!0:(mb[n]=!0,!1)}function ck(n,e,t,s){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function uk(n,e,t,s){if(e===null||typeof e>"u"||ck(n,e,t,s))return!0;if(s)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function hn(n,e,t,s,i,r,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=i,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=r,this.removeEmptyString=o}var jt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){jt[n]=new hn(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];jt[e]=new hn(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){jt[n]=new hn(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){jt[n]=new hn(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){jt[n]=new hn(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){jt[n]=new hn(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){jt[n]=new hn(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){jt[n]=new hn(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){jt[n]=new hn(n,5,!1,n.toLowerCase(),null,!1,!1)});var U0=/[\-:]([a-z])/g;function V0(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(U0,V0);jt[e]=new hn(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(U0,V0);jt[e]=new hn(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(U0,V0);jt[e]=new hn(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){jt[n]=new hn(n,1,!1,n.toLowerCase(),null,!1,!1)});jt.xlinkHref=new hn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){jt[n]=new hn(n,1,!1,n.toLowerCase(),null,!0,!0)});function G0(n,e,t,s){var i=jt.hasOwnProperty(e)?jt[e]:null;(i!==null?i.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(uk(e,t,i,s)&&(t=null),s||i===null?lk(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):i.mustUseProperty?n[i.propertyName]=t===null?i.type===3?!1:"":t:(e=i.attributeName,s=i.attributeNamespace,t===null?n.removeAttribute(e):(i=i.type,t=i===3||i===4&&t===!0?"":""+t,s?n.setAttributeNS(s,e,t):n.setAttribute(e,t))))}var kr=ok.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Gf=Symbol.for("react.element"),Ll=Symbol.for("react.portal"),Nl=Symbol.for("react.fragment"),W0=Symbol.for("react.strict_mode"),ky=Symbol.for("react.profiler"),MS=Symbol.for("react.provider"),DS=Symbol.for("react.context"),X0=Symbol.for("react.forward_ref"),Ty=Symbol.for("react.suspense"),Py=Symbol.for("react.suspense_list"),q0=Symbol.for("react.memo"),Dr=Symbol.for("react.lazy"),IS=Symbol.for("react.offscreen"),vb=Symbol.iterator;function Pu(n){return n===null||typeof n!="object"?null:(n=vb&&n[vb]||n["@@iterator"],typeof n=="function"?n:null)}var We=Object.assign,Bm;function Hu(n){if(Bm===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);Bm=e&&e[1]||""}return`
`+Bm+n}var Hm=!1;function Um(n,e){if(!n||Hm)return"";Hm=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var s=u}Reflect.construct(n,[],e)}else{try{e.call()}catch(u){s=u}n.call(e.prototype)}else{try{throw Error()}catch(u){s=u}n()}}catch(u){if(u&&s&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),r=s.stack.split(`
`),o=i.length-1,a=r.length-1;1<=o&&0<=a&&i[o]!==r[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==r[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==r[a]){var c=`
`+i[o].replace(" at new "," at ");return n.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",n.displayName)),c}while(1<=o&&0<=a);break}}}finally{Hm=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?Hu(n):""}function dk(n){switch(n.tag){case 5:return Hu(n.type);case 16:return Hu("Lazy");case 13:return Hu("Suspense");case 19:return Hu("SuspenseList");case 0:case 2:case 15:return n=Um(n.type,!1),n;case 11:return n=Um(n.type.render,!1),n;case 1:return n=Um(n.type,!0),n;default:return""}}function Ry(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Nl:return"Fragment";case Ll:return"Portal";case ky:return"Profiler";case W0:return"StrictMode";case Ty:return"Suspense";case Py:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case DS:return(n.displayName||"Context")+".Consumer";case MS:return(n._context.displayName||"Context")+".Provider";case X0:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case q0:return e=n.displayName||null,e!==null?e:Ry(n.type)||"Memo";case Dr:e=n._payload,n=n._init;try{return Ry(n(e))}catch{}}return null}function hk(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ry(e);case 8:return e===W0?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Mo(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function OS(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function fk(n){var e=OS(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),s=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var i=t.get,r=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){s=""+o,r.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return s},setValue:function(o){s=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function Wf(n){n._valueTracker||(n._valueTracker=fk(n))}function FS(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),s="";return n&&(s=OS(n)?n.checked?"true":"false":n.value),n=s,n!==t?(e.setValue(n),!0):!1}function sg(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function Ly(n,e){var t=e.checked;return We({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function wb(n,e){var t=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;t=Mo(e.value!=null?e.value:t),n._wrapperState={initialChecked:s,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function jS(n,e){e=e.checked,e!=null&&G0(n,"checked",e,!1)}function Ny(n,e){jS(n,e);var t=Mo(e.value),s=e.type;if(t!=null)s==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(s==="submit"||s==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?My(n,e.type,t):e.hasOwnProperty("defaultValue")&&My(n,e.type,Mo(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function bb(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function My(n,e,t){(e!=="number"||sg(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var Uu=Array.isArray;function Xl(n,e,t,s){if(n=n.options,e){e={};for(var i=0;i<t.length;i++)e["$"+t[i]]=!0;for(t=0;t<n.length;t++)i=e.hasOwnProperty("$"+n[t].value),n[t].selected!==i&&(n[t].selected=i),i&&s&&(n[t].defaultSelected=!0)}else{for(t=""+Mo(t),e=null,i=0;i<n.length;i++){if(n[i].value===t){n[i].selected=!0,s&&(n[i].defaultSelected=!0);return}e!==null||n[i].disabled||(e=n[i])}e!==null&&(e.selected=!0)}}function Dy(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(D(91));return We({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function xb(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(D(92));if(Uu(t)){if(1<t.length)throw Error(D(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:Mo(t)}}function zS(n,e){var t=Mo(e.value),s=Mo(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),s!=null&&(n.defaultValue=""+s)}function Sb(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function $S(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Iy(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?$S(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Xf,BS=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,s,i){MSApp.execUnsafeLocalFunction(function(){return n(e,t,s,i)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(Xf=Xf||document.createElement("div"),Xf.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Xf.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function _d(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var dd={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pk=["Webkit","ms","Moz","O"];Object.keys(dd).forEach(function(n){pk.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),dd[e]=dd[n]})});function HS(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||dd.hasOwnProperty(n)&&dd[n]?(""+e).trim():e+"px"}function US(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var s=t.indexOf("--")===0,i=HS(t,e[t],s);t==="float"&&(t="cssFloat"),s?n.setProperty(t,i):n[t]=i}}var gk=We({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Oy(n,e){if(e){if(gk[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(D(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(D(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(D(61))}if(e.style!=null&&typeof e.style!="object")throw Error(D(62))}}function Fy(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var jy=null;function Y0(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var zy=null,ql=null,Yl=null;function Ab(n){if(n=Tf(n)){if(typeof zy!="function")throw Error(D(280));var e=n.stateNode;e&&(e=cm(e),zy(n.stateNode,n.type,e))}}function VS(n){ql?Yl?Yl.push(n):Yl=[n]:ql=n}function GS(){if(ql){var n=ql,e=Yl;if(Yl=ql=null,Ab(n),e)for(n=0;n<e.length;n++)Ab(e[n])}}function WS(n,e){return n(e)}function XS(){}var Vm=!1;function qS(n,e,t){if(Vm)return n(e,t);Vm=!0;try{return WS(n,e,t)}finally{Vm=!1,(ql!==null||Yl!==null)&&(XS(),GS())}}function Cd(n,e){var t=n.stateNode;if(t===null)return null;var s=cm(t);if(s===null)return null;t=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(n=n.type,s=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!s;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(D(231,e,typeof t));return t}var $y=!1;if(br)try{var Ru={};Object.defineProperty(Ru,"passive",{get:function(){$y=!0}}),window.addEventListener("test",Ru,Ru),window.removeEventListener("test",Ru,Ru)}catch{$y=!1}function mk(n,e,t,s,i,r,o,a,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(t,u)}catch(d){this.onError(d)}}var hd=!1,ig=null,rg=!1,By=null,yk={onError:function(n){hd=!0,ig=n}};function vk(n,e,t,s,i,r,o,a,c){hd=!1,ig=null,mk.apply(yk,arguments)}function wk(n,e,t,s,i,r,o,a,c){if(vk.apply(this,arguments),hd){if(hd){var u=ig;hd=!1,ig=null}else throw Error(D(198));rg||(rg=!0,By=u)}}function yl(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function YS(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function Eb(n){if(yl(n)!==n)throw Error(D(188))}function bk(n){var e=n.alternate;if(!e){if(e=yl(n),e===null)throw Error(D(188));return e!==n?null:n}for(var t=n,s=e;;){var i=t.return;if(i===null)break;var r=i.alternate;if(r===null){if(s=i.return,s!==null){t=s;continue}break}if(i.child===r.child){for(r=i.child;r;){if(r===t)return Eb(i),n;if(r===s)return Eb(i),e;r=r.sibling}throw Error(D(188))}if(t.return!==s.return)t=i,s=r;else{for(var o=!1,a=i.child;a;){if(a===t){o=!0,t=i,s=r;break}if(a===s){o=!0,s=i,t=r;break}a=a.sibling}if(!o){for(a=r.child;a;){if(a===t){o=!0,t=r,s=i;break}if(a===s){o=!0,s=r,t=i;break}a=a.sibling}if(!o)throw Error(D(189))}}if(t.alternate!==s)throw Error(D(190))}if(t.tag!==3)throw Error(D(188));return t.stateNode.current===t?n:e}function KS(n){return n=bk(n),n!==null?QS(n):null}function QS(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=QS(n);if(e!==null)return e;n=n.sibling}return null}var JS=Zn.unstable_scheduleCallback,_b=Zn.unstable_cancelCallback,xk=Zn.unstable_shouldYield,Sk=Zn.unstable_requestPaint,tt=Zn.unstable_now,Ak=Zn.unstable_getCurrentPriorityLevel,K0=Zn.unstable_ImmediatePriority,ZS=Zn.unstable_UserBlockingPriority,og=Zn.unstable_NormalPriority,Ek=Zn.unstable_LowPriority,eA=Zn.unstable_IdlePriority,rm=null,_i=null;function _k(n){if(_i&&typeof _i.onCommitFiberRoot=="function")try{_i.onCommitFiberRoot(rm,n,void 0,(n.current.flags&128)===128)}catch{}}var Gs=Math.clz32?Math.clz32:Tk,Ck=Math.log,kk=Math.LN2;function Tk(n){return n>>>=0,n===0?32:31-(Ck(n)/kk|0)|0}var qf=64,Yf=4194304;function Vu(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function ag(n,e){var t=n.pendingLanes;if(t===0)return 0;var s=0,i=n.suspendedLanes,r=n.pingedLanes,o=t&268435455;if(o!==0){var a=o&~i;a!==0?s=Vu(a):(r&=o,r!==0&&(s=Vu(r)))}else o=t&~i,o!==0?s=Vu(o):r!==0&&(s=Vu(r));if(s===0)return 0;if(e!==0&&e!==s&&!(e&i)&&(i=s&-s,r=e&-e,i>=r||i===16&&(r&4194240)!==0))return e;if(s&4&&(s|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=s;0<e;)t=31-Gs(e),i=1<<t,s|=n[t],e&=~i;return s}function Pk(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Rk(n,e){for(var t=n.suspendedLanes,s=n.pingedLanes,i=n.expirationTimes,r=n.pendingLanes;0<r;){var o=31-Gs(r),a=1<<o,c=i[o];c===-1?(!(a&t)||a&s)&&(i[o]=Pk(a,e)):c<=e&&(n.expiredLanes|=a),r&=~a}}function Hy(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function tA(){var n=qf;return qf<<=1,!(qf&4194240)&&(qf=64),n}function Gm(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function Cf(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-Gs(e),n[e]=t}function Lk(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var s=n.eventTimes;for(n=n.expirationTimes;0<t;){var i=31-Gs(t),r=1<<i;e[i]=0,s[i]=-1,n[i]=-1,t&=~r}}function Q0(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var s=31-Gs(t),i=1<<s;i&e|n[s]&e&&(n[s]|=e),t&=~i}}var Se=0;function nA(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var sA,J0,iA,rA,oA,Uy=!1,Kf=[],_o=null,Co=null,ko=null,kd=new Map,Td=new Map,Fr=[],Nk="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Cb(n,e){switch(n){case"focusin":case"focusout":_o=null;break;case"dragenter":case"dragleave":Co=null;break;case"mouseover":case"mouseout":ko=null;break;case"pointerover":case"pointerout":kd.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Td.delete(e.pointerId)}}function Lu(n,e,t,s,i,r){return n===null||n.nativeEvent!==r?(n={blockedOn:e,domEventName:t,eventSystemFlags:s,nativeEvent:r,targetContainers:[i]},e!==null&&(e=Tf(e),e!==null&&J0(e)),n):(n.eventSystemFlags|=s,e=n.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),n)}function Mk(n,e,t,s,i){switch(e){case"focusin":return _o=Lu(_o,n,e,t,s,i),!0;case"dragenter":return Co=Lu(Co,n,e,t,s,i),!0;case"mouseover":return ko=Lu(ko,n,e,t,s,i),!0;case"pointerover":var r=i.pointerId;return kd.set(r,Lu(kd.get(r)||null,n,e,t,s,i)),!0;case"gotpointercapture":return r=i.pointerId,Td.set(r,Lu(Td.get(r)||null,n,e,t,s,i)),!0}return!1}function aA(n){var e=Jo(n.target);if(e!==null){var t=yl(e);if(t!==null){if(e=t.tag,e===13){if(e=YS(t),e!==null){n.blockedOn=e,oA(n.priority,function(){iA(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function mp(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=Vy(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var s=new t.constructor(t.type,t);jy=s,t.target.dispatchEvent(s),jy=null}else return e=Tf(t),e!==null&&J0(e),n.blockedOn=t,!1;e.shift()}return!0}function kb(n,e,t){mp(n)&&t.delete(e)}function Dk(){Uy=!1,_o!==null&&mp(_o)&&(_o=null),Co!==null&&mp(Co)&&(Co=null),ko!==null&&mp(ko)&&(ko=null),kd.forEach(kb),Td.forEach(kb)}function Nu(n,e){n.blockedOn===e&&(n.blockedOn=null,Uy||(Uy=!0,Zn.unstable_scheduleCallback(Zn.unstable_NormalPriority,Dk)))}function Pd(n){function e(i){return Nu(i,n)}if(0<Kf.length){Nu(Kf[0],n);for(var t=1;t<Kf.length;t++){var s=Kf[t];s.blockedOn===n&&(s.blockedOn=null)}}for(_o!==null&&Nu(_o,n),Co!==null&&Nu(Co,n),ko!==null&&Nu(ko,n),kd.forEach(e),Td.forEach(e),t=0;t<Fr.length;t++)s=Fr[t],s.blockedOn===n&&(s.blockedOn=null);for(;0<Fr.length&&(t=Fr[0],t.blockedOn===null);)aA(t),t.blockedOn===null&&Fr.shift()}var Kl=kr.ReactCurrentBatchConfig,lg=!0;function Ik(n,e,t,s){var i=Se,r=Kl.transition;Kl.transition=null;try{Se=1,Z0(n,e,t,s)}finally{Se=i,Kl.transition=r}}function Ok(n,e,t,s){var i=Se,r=Kl.transition;Kl.transition=null;try{Se=4,Z0(n,e,t,s)}finally{Se=i,Kl.transition=r}}function Z0(n,e,t,s){if(lg){var i=Vy(n,e,t,s);if(i===null)ty(n,e,s,cg,t),Cb(n,s);else if(Mk(i,n,e,t,s))s.stopPropagation();else if(Cb(n,s),e&4&&-1<Nk.indexOf(n)){for(;i!==null;){var r=Tf(i);if(r!==null&&sA(r),r=Vy(n,e,t,s),r===null&&ty(n,e,s,cg,t),r===i)break;i=r}i!==null&&s.stopPropagation()}else ty(n,e,s,null,t)}}var cg=null;function Vy(n,e,t,s){if(cg=null,n=Y0(s),n=Jo(n),n!==null)if(e=yl(n),e===null)n=null;else if(t=e.tag,t===13){if(n=YS(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return cg=n,null}function lA(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ak()){case K0:return 1;case ZS:return 4;case og:case Ek:return 16;case eA:return 536870912;default:return 16}default:return 16}}var Ao=null,ew=null,yp=null;function cA(){if(yp)return yp;var n,e=ew,t=e.length,s,i="value"in Ao?Ao.value:Ao.textContent,r=i.length;for(n=0;n<t&&e[n]===i[n];n++);var o=t-n;for(s=1;s<=o&&e[t-s]===i[r-s];s++);return yp=i.slice(n,1<s?1-s:void 0)}function vp(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function Qf(){return!0}function Tb(){return!1}function ts(n){function e(t,s,i,r,o){this._reactName=t,this._targetInst=i,this.type=s,this.nativeEvent=r,this.target=o,this.currentTarget=null;for(var a in n)n.hasOwnProperty(a)&&(t=n[a],this[a]=t?t(r):r[a]);return this.isDefaultPrevented=(r.defaultPrevented!=null?r.defaultPrevented:r.returnValue===!1)?Qf:Tb,this.isPropagationStopped=Tb,this}return We(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Qf)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Qf)},persist:function(){},isPersistent:Qf}),e}var xu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},tw=ts(xu),kf=We({},xu,{view:0,detail:0}),Fk=ts(kf),Wm,Xm,Mu,om=We({},kf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:nw,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Mu&&(Mu&&n.type==="mousemove"?(Wm=n.screenX-Mu.screenX,Xm=n.screenY-Mu.screenY):Xm=Wm=0,Mu=n),Wm)},movementY:function(n){return"movementY"in n?n.movementY:Xm}}),Pb=ts(om),jk=We({},om,{dataTransfer:0}),zk=ts(jk),$k=We({},kf,{relatedTarget:0}),qm=ts($k),Bk=We({},xu,{animationName:0,elapsedTime:0,pseudoElement:0}),Hk=ts(Bk),Uk=We({},xu,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Vk=ts(Uk),Gk=We({},xu,{data:0}),Rb=ts(Gk),Wk={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Xk={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},qk={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Yk(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=qk[n])?!!e[n]:!1}function nw(){return Yk}var Kk=We({},kf,{key:function(n){if(n.key){var e=Wk[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=vp(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Xk[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:nw,charCode:function(n){return n.type==="keypress"?vp(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?vp(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Qk=ts(Kk),Jk=We({},om,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Lb=ts(Jk),Zk=We({},kf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:nw}),eT=ts(Zk),tT=We({},xu,{propertyName:0,elapsedTime:0,pseudoElement:0}),nT=ts(tT),sT=We({},om,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),iT=ts(sT),rT=[9,13,27,32],sw=br&&"CompositionEvent"in window,fd=null;br&&"documentMode"in document&&(fd=document.documentMode);var oT=br&&"TextEvent"in window&&!fd,uA=br&&(!sw||fd&&8<fd&&11>=fd),Nb=" ",Mb=!1;function dA(n,e){switch(n){case"keyup":return rT.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function hA(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Ml=!1;function aT(n,e){switch(n){case"compositionend":return hA(e);case"keypress":return e.which!==32?null:(Mb=!0,Nb);case"textInput":return n=e.data,n===Nb&&Mb?null:n;default:return null}}function lT(n,e){if(Ml)return n==="compositionend"||!sw&&dA(n,e)?(n=cA(),yp=ew=Ao=null,Ml=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return uA&&e.locale!=="ko"?null:e.data;default:return null}}var cT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Db(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!cT[n.type]:e==="textarea"}function fA(n,e,t,s){VS(s),e=ug(e,"onChange"),0<e.length&&(t=new tw("onChange","change",null,t,s),n.push({event:t,listeners:e}))}var pd=null,Rd=null;function uT(n){EA(n,0)}function am(n){var e=Ol(n);if(FS(e))return n}function dT(n,e){if(n==="change")return e}var pA=!1;if(br){var Ym;if(br){var Km="oninput"in document;if(!Km){var Ib=document.createElement("div");Ib.setAttribute("oninput","return;"),Km=typeof Ib.oninput=="function"}Ym=Km}else Ym=!1;pA=Ym&&(!document.documentMode||9<document.documentMode)}function Ob(){pd&&(pd.detachEvent("onpropertychange",gA),Rd=pd=null)}function gA(n){if(n.propertyName==="value"&&am(Rd)){var e=[];fA(e,Rd,n,Y0(n)),qS(uT,e)}}function hT(n,e,t){n==="focusin"?(Ob(),pd=e,Rd=t,pd.attachEvent("onpropertychange",gA)):n==="focusout"&&Ob()}function fT(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return am(Rd)}function pT(n,e){if(n==="click")return am(e)}function gT(n,e){if(n==="input"||n==="change")return am(e)}function mT(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var Xs=typeof Object.is=="function"?Object.is:mT;function Ld(n,e){if(Xs(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),s=Object.keys(e);if(t.length!==s.length)return!1;for(s=0;s<t.length;s++){var i=t[s];if(!Cy.call(e,i)||!Xs(n[i],e[i]))return!1}return!0}function Fb(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function jb(n,e){var t=Fb(n);n=0;for(var s;t;){if(t.nodeType===3){if(s=n+t.textContent.length,n<=e&&s>=e)return{node:t,offset:e-n};n=s}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=Fb(t)}}function mA(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?mA(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function yA(){for(var n=window,e=sg();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=sg(n.document)}return e}function iw(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function yT(n){var e=yA(),t=n.focusedElem,s=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&mA(t.ownerDocument.documentElement,t)){if(s!==null&&iw(t)){if(e=s.start,n=s.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var i=t.textContent.length,r=Math.min(s.start,i);s=s.end===void 0?r:Math.min(s.end,i),!n.extend&&r>s&&(i=s,s=r,r=i),i=jb(t,r);var o=jb(t,s);i&&o&&(n.rangeCount!==1||n.anchorNode!==i.node||n.anchorOffset!==i.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),n.removeAllRanges(),r>s?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var vT=br&&"documentMode"in document&&11>=document.documentMode,Dl=null,Gy=null,gd=null,Wy=!1;function zb(n,e,t){var s=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;Wy||Dl==null||Dl!==sg(s)||(s=Dl,"selectionStart"in s&&iw(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),gd&&Ld(gd,s)||(gd=s,s=ug(Gy,"onSelect"),0<s.length&&(e=new tw("onSelect","select",null,e,t),n.push({event:e,listeners:s}),e.target=Dl)))}function Jf(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var Il={animationend:Jf("Animation","AnimationEnd"),animationiteration:Jf("Animation","AnimationIteration"),animationstart:Jf("Animation","AnimationStart"),transitionend:Jf("Transition","TransitionEnd")},Qm={},vA={};br&&(vA=document.createElement("div").style,"AnimationEvent"in window||(delete Il.animationend.animation,delete Il.animationiteration.animation,delete Il.animationstart.animation),"TransitionEvent"in window||delete Il.transitionend.transition);function lm(n){if(Qm[n])return Qm[n];if(!Il[n])return n;var e=Il[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in vA)return Qm[n]=e[t];return n}var wA=lm("animationend"),bA=lm("animationiteration"),xA=lm("animationstart"),SA=lm("transitionend"),AA=new Map,$b="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Bo(n,e){AA.set(n,e),ml(e,[n])}for(var Jm=0;Jm<$b.length;Jm++){var Zm=$b[Jm],wT=Zm.toLowerCase(),bT=Zm[0].toUpperCase()+Zm.slice(1);Bo(wT,"on"+bT)}Bo(wA,"onAnimationEnd");Bo(bA,"onAnimationIteration");Bo(xA,"onAnimationStart");Bo("dblclick","onDoubleClick");Bo("focusin","onFocus");Bo("focusout","onBlur");Bo(SA,"onTransitionEnd");uu("onMouseEnter",["mouseout","mouseover"]);uu("onMouseLeave",["mouseout","mouseover"]);uu("onPointerEnter",["pointerout","pointerover"]);uu("onPointerLeave",["pointerout","pointerover"]);ml("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ml("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ml("onBeforeInput",["compositionend","keypress","textInput","paste"]);ml("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ml("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ml("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Gu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),xT=new Set("cancel close invalid load scroll toggle".split(" ").concat(Gu));function Bb(n,e,t){var s=n.type||"unknown-event";n.currentTarget=t,wk(s,e,void 0,n),n.currentTarget=null}function EA(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var s=n[t],i=s.event;s=s.listeners;e:{var r=void 0;if(e)for(var o=s.length-1;0<=o;o--){var a=s[o],c=a.instance,u=a.currentTarget;if(a=a.listener,c!==r&&i.isPropagationStopped())break e;Bb(i,a,u),r=c}else for(o=0;o<s.length;o++){if(a=s[o],c=a.instance,u=a.currentTarget,a=a.listener,c!==r&&i.isPropagationStopped())break e;Bb(i,a,u),r=c}}}if(rg)throw n=By,rg=!1,By=null,n}function De(n,e){var t=e[Qy];t===void 0&&(t=e[Qy]=new Set);var s=n+"__bubble";t.has(s)||(_A(e,n,2,!1),t.add(s))}function ey(n,e,t){var s=0;e&&(s|=4),_A(t,n,s,e)}var Zf="_reactListening"+Math.random().toString(36).slice(2);function Nd(n){if(!n[Zf]){n[Zf]=!0,NS.forEach(function(t){t!=="selectionchange"&&(xT.has(t)||ey(t,!1,n),ey(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[Zf]||(e[Zf]=!0,ey("selectionchange",!1,e))}}function _A(n,e,t,s){switch(lA(e)){case 1:var i=Ik;break;case 4:i=Ok;break;default:i=Z0}t=i.bind(null,e,t,n),i=void 0,!$y||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),s?i!==void 0?n.addEventListener(e,t,{capture:!0,passive:i}):n.addEventListener(e,t,!0):i!==void 0?n.addEventListener(e,t,{passive:i}):n.addEventListener(e,t,!1)}function ty(n,e,t,s,i){var r=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var o=s.tag;if(o===3||o===4){var a=s.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=s.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Jo(a),o===null)return;if(c=o.tag,c===5||c===6){s=r=o;continue e}a=a.parentNode}}s=s.return}qS(function(){var u=r,d=Y0(t),h=[];e:{var f=AA.get(n);if(f!==void 0){var p=tw,y=n;switch(n){case"keypress":if(vp(t)===0)break e;case"keydown":case"keyup":p=Qk;break;case"focusin":y="focus",p=qm;break;case"focusout":y="blur",p=qm;break;case"beforeblur":case"afterblur":p=qm;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=Pb;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=zk;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=eT;break;case wA:case bA:case xA:p=Hk;break;case SA:p=nT;break;case"scroll":p=Fk;break;case"wheel":p=iT;break;case"copy":case"cut":case"paste":p=Vk;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Lb}var g=(e&4)!==0,A=!g&&n==="scroll",v=g?f!==null?f+"Capture":null:f;g=[];for(var w=u,b;w!==null;){b=w;var E=b.stateNode;if(b.tag===5&&E!==null&&(b=E,v!==null&&(E=Cd(w,v),E!=null&&g.push(Md(w,E,b)))),A)break;w=w.return}0<g.length&&(f=new p(f,y,null,t,d),h.push({event:f,listeners:g}))}}if(!(e&7)){e:{if(f=n==="mouseover"||n==="pointerover",p=n==="mouseout"||n==="pointerout",f&&t!==jy&&(y=t.relatedTarget||t.fromElement)&&(Jo(y)||y[xr]))break e;if((p||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,p?(y=t.relatedTarget||t.toElement,p=u,y=y?Jo(y):null,y!==null&&(A=yl(y),y!==A||y.tag!==5&&y.tag!==6)&&(y=null)):(p=null,y=u),p!==y)){if(g=Pb,E="onMouseLeave",v="onMouseEnter",w="mouse",(n==="pointerout"||n==="pointerover")&&(g=Lb,E="onPointerLeave",v="onPointerEnter",w="pointer"),A=p==null?f:Ol(p),b=y==null?f:Ol(y),f=new g(E,w+"leave",p,t,d),f.target=A,f.relatedTarget=b,E=null,Jo(d)===u&&(g=new g(v,w+"enter",y,t,d),g.target=b,g.relatedTarget=A,E=g),A=E,p&&y)t:{for(g=p,v=y,w=0,b=g;b;b=Al(b))w++;for(b=0,E=v;E;E=Al(E))b++;for(;0<w-b;)g=Al(g),w--;for(;0<b-w;)v=Al(v),b--;for(;w--;){if(g===v||v!==null&&g===v.alternate)break t;g=Al(g),v=Al(v)}g=null}else g=null;p!==null&&Hb(h,f,p,g,!1),y!==null&&A!==null&&Hb(h,A,y,g,!0)}}e:{if(f=u?Ol(u):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var C=dT;else if(Db(f))if(pA)C=gT;else{C=fT;var T=hT}else(p=f.nodeName)&&p.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(C=pT);if(C&&(C=C(n,u))){fA(h,C,t,d);break e}T&&T(n,f,u),n==="focusout"&&(T=f._wrapperState)&&T.controlled&&f.type==="number"&&My(f,"number",f.value)}switch(T=u?Ol(u):window,n){case"focusin":(Db(T)||T.contentEditable==="true")&&(Dl=T,Gy=u,gd=null);break;case"focusout":gd=Gy=Dl=null;break;case"mousedown":Wy=!0;break;case"contextmenu":case"mouseup":case"dragend":Wy=!1,zb(h,t,d);break;case"selectionchange":if(vT)break;case"keydown":case"keyup":zb(h,t,d)}var k;if(sw)e:{switch(n){case"compositionstart":var R="onCompositionStart";break e;case"compositionend":R="onCompositionEnd";break e;case"compositionupdate":R="onCompositionUpdate";break e}R=void 0}else Ml?dA(n,t)&&(R="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(R="onCompositionStart");R&&(uA&&t.locale!=="ko"&&(Ml||R!=="onCompositionStart"?R==="onCompositionEnd"&&Ml&&(k=cA()):(Ao=d,ew="value"in Ao?Ao.value:Ao.textContent,Ml=!0)),T=ug(u,R),0<T.length&&(R=new Rb(R,n,null,t,d),h.push({event:R,listeners:T}),k?R.data=k:(k=hA(t),k!==null&&(R.data=k)))),(k=oT?aT(n,t):lT(n,t))&&(u=ug(u,"onBeforeInput"),0<u.length&&(d=new Rb("onBeforeInput","beforeinput",null,t,d),h.push({event:d,listeners:u}),d.data=k))}EA(h,e)})}function Md(n,e,t){return{instance:n,listener:e,currentTarget:t}}function ug(n,e){for(var t=e+"Capture",s=[];n!==null;){var i=n,r=i.stateNode;i.tag===5&&r!==null&&(i=r,r=Cd(n,t),r!=null&&s.unshift(Md(n,r,i)),r=Cd(n,e),r!=null&&s.push(Md(n,r,i))),n=n.return}return s}function Al(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function Hb(n,e,t,s,i){for(var r=e._reactName,o=[];t!==null&&t!==s;){var a=t,c=a.alternate,u=a.stateNode;if(c!==null&&c===s)break;a.tag===5&&u!==null&&(a=u,i?(c=Cd(t,r),c!=null&&o.unshift(Md(t,c,a))):i||(c=Cd(t,r),c!=null&&o.push(Md(t,c,a)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var ST=/\r\n?/g,AT=/\u0000|\uFFFD/g;function Ub(n){return(typeof n=="string"?n:""+n).replace(ST,`
`).replace(AT,"")}function ep(n,e,t){if(e=Ub(e),Ub(n)!==e&&t)throw Error(D(425))}function dg(){}var Xy=null,qy=null;function Yy(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Ky=typeof setTimeout=="function"?setTimeout:void 0,ET=typeof clearTimeout=="function"?clearTimeout:void 0,Vb=typeof Promise=="function"?Promise:void 0,_T=typeof queueMicrotask=="function"?queueMicrotask:typeof Vb<"u"?function(n){return Vb.resolve(null).then(n).catch(CT)}:Ky;function CT(n){setTimeout(function(){throw n})}function ny(n,e){var t=e,s=0;do{var i=t.nextSibling;if(n.removeChild(t),i&&i.nodeType===8)if(t=i.data,t==="/$"){if(s===0){n.removeChild(i),Pd(e);return}s--}else t!=="$"&&t!=="$?"&&t!=="$!"||s++;t=i}while(t);Pd(e)}function To(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function Gb(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var Su=Math.random().toString(36).slice(2),Si="__reactFiber$"+Su,Dd="__reactProps$"+Su,xr="__reactContainer$"+Su,Qy="__reactEvents$"+Su,kT="__reactListeners$"+Su,TT="__reactHandles$"+Su;function Jo(n){var e=n[Si];if(e)return e;for(var t=n.parentNode;t;){if(e=t[xr]||t[Si]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=Gb(n);n!==null;){if(t=n[Si])return t;n=Gb(n)}return e}n=t,t=n.parentNode}return null}function Tf(n){return n=n[Si]||n[xr],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function Ol(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(D(33))}function cm(n){return n[Dd]||null}var Jy=[],Fl=-1;function Ho(n){return{current:n}}function Oe(n){0>Fl||(n.current=Jy[Fl],Jy[Fl]=null,Fl--)}function Ne(n,e){Fl++,Jy[Fl]=n.current,n.current=e}var Do={},Qt=Ho(Do),xn=Ho(!1),cl=Do;function du(n,e){var t=n.type.contextTypes;if(!t)return Do;var s=n.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var i={},r;for(r in t)i[r]=e[r];return s&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=i),i}function Sn(n){return n=n.childContextTypes,n!=null}function hg(){Oe(xn),Oe(Qt)}function Wb(n,e,t){if(Qt.current!==Do)throw Error(D(168));Ne(Qt,e),Ne(xn,t)}function CA(n,e,t){var s=n.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return t;s=s.getChildContext();for(var i in s)if(!(i in e))throw Error(D(108,hk(n)||"Unknown",i));return We({},t,s)}function fg(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Do,cl=Qt.current,Ne(Qt,n),Ne(xn,xn.current),!0}function Xb(n,e,t){var s=n.stateNode;if(!s)throw Error(D(169));t?(n=CA(n,e,cl),s.__reactInternalMemoizedMergedChildContext=n,Oe(xn),Oe(Qt),Ne(Qt,n)):Oe(xn),Ne(xn,t)}var zi=null,um=!1,sy=!1;function kA(n){zi===null?zi=[n]:zi.push(n)}function PT(n){um=!0,kA(n)}function Uo(){if(!sy&&zi!==null){sy=!0;var n=0,e=Se;try{var t=zi;for(Se=1;n<t.length;n++){var s=t[n];do s=s(!0);while(s!==null)}zi=null,um=!1}catch(i){throw zi!==null&&(zi=zi.slice(n+1)),JS(K0,Uo),i}finally{Se=e,sy=!1}}return null}var jl=[],zl=0,pg=null,gg=0,fs=[],ps=0,ul=null,gr=1,mr="";function Go(n,e){jl[zl++]=gg,jl[zl++]=pg,pg=n,gg=e}function TA(n,e,t){fs[ps++]=gr,fs[ps++]=mr,fs[ps++]=ul,ul=n;var s=gr;n=mr;var i=32-Gs(s)-1;s&=~(1<<i),t+=1;var r=32-Gs(e)+i;if(30<r){var o=i-i%5;r=(s&(1<<o)-1).toString(32),s>>=o,i-=o,gr=1<<32-Gs(e)+i|t<<i|s,mr=r+n}else gr=1<<r|t<<i|s,mr=n}function rw(n){n.return!==null&&(Go(n,1),TA(n,1,0))}function ow(n){for(;n===pg;)pg=jl[--zl],jl[zl]=null,gg=jl[--zl],jl[zl]=null;for(;n===ul;)ul=fs[--ps],fs[ps]=null,mr=fs[--ps],fs[ps]=null,gr=fs[--ps],fs[ps]=null}var Qn=null,Kn=null,$e=!1,Us=null;function PA(n,e){var t=ys(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function qb(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,Qn=n,Kn=To(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,Qn=n,Kn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=ul!==null?{id:gr,overflow:mr}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=ys(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,Qn=n,Kn=null,!0):!1;default:return!1}}function Zy(n){return(n.mode&1)!==0&&(n.flags&128)===0}function ev(n){if($e){var e=Kn;if(e){var t=e;if(!qb(n,e)){if(Zy(n))throw Error(D(418));e=To(t.nextSibling);var s=Qn;e&&qb(n,e)?PA(s,t):(n.flags=n.flags&-4097|2,$e=!1,Qn=n)}}else{if(Zy(n))throw Error(D(418));n.flags=n.flags&-4097|2,$e=!1,Qn=n}}}function Yb(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Qn=n}function tp(n){if(n!==Qn)return!1;if(!$e)return Yb(n),$e=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!Yy(n.type,n.memoizedProps)),e&&(e=Kn)){if(Zy(n))throw RA(),Error(D(418));for(;e;)PA(n,e),e=To(e.nextSibling)}if(Yb(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(D(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){Kn=To(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}Kn=null}}else Kn=Qn?To(n.stateNode.nextSibling):null;return!0}function RA(){for(var n=Kn;n;)n=To(n.nextSibling)}function hu(){Kn=Qn=null,$e=!1}function aw(n){Us===null?Us=[n]:Us.push(n)}var RT=kr.ReactCurrentBatchConfig;function Du(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(D(309));var s=t.stateNode}if(!s)throw Error(D(147,n));var i=s,r=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===r?e.ref:(e=function(o){var a=i.refs;o===null?delete a[r]:a[r]=o},e._stringRef=r,e)}if(typeof n!="string")throw Error(D(284));if(!t._owner)throw Error(D(290,n))}return n}function np(n,e){throw n=Object.prototype.toString.call(e),Error(D(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function Kb(n){var e=n._init;return e(n._payload)}function LA(n){function e(v,w){if(n){var b=v.deletions;b===null?(v.deletions=[w],v.flags|=16):b.push(w)}}function t(v,w){if(!n)return null;for(;w!==null;)e(v,w),w=w.sibling;return null}function s(v,w){for(v=new Map;w!==null;)w.key!==null?v.set(w.key,w):v.set(w.index,w),w=w.sibling;return v}function i(v,w){return v=No(v,w),v.index=0,v.sibling=null,v}function r(v,w,b){return v.index=b,n?(b=v.alternate,b!==null?(b=b.index,b<w?(v.flags|=2,w):b):(v.flags|=2,w)):(v.flags|=1048576,w)}function o(v){return n&&v.alternate===null&&(v.flags|=2),v}function a(v,w,b,E){return w===null||w.tag!==6?(w=uy(b,v.mode,E),w.return=v,w):(w=i(w,b),w.return=v,w)}function c(v,w,b,E){var C=b.type;return C===Nl?d(v,w,b.props.children,E,b.key):w!==null&&(w.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Dr&&Kb(C)===w.type)?(E=i(w,b.props),E.ref=Du(v,w,b),E.return=v,E):(E=_p(b.type,b.key,b.props,null,v.mode,E),E.ref=Du(v,w,b),E.return=v,E)}function u(v,w,b,E){return w===null||w.tag!==4||w.stateNode.containerInfo!==b.containerInfo||w.stateNode.implementation!==b.implementation?(w=dy(b,v.mode,E),w.return=v,w):(w=i(w,b.children||[]),w.return=v,w)}function d(v,w,b,E,C){return w===null||w.tag!==7?(w=ll(b,v.mode,E,C),w.return=v,w):(w=i(w,b),w.return=v,w)}function h(v,w,b){if(typeof w=="string"&&w!==""||typeof w=="number")return w=uy(""+w,v.mode,b),w.return=v,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Gf:return b=_p(w.type,w.key,w.props,null,v.mode,b),b.ref=Du(v,null,w),b.return=v,b;case Ll:return w=dy(w,v.mode,b),w.return=v,w;case Dr:var E=w._init;return h(v,E(w._payload),b)}if(Uu(w)||Pu(w))return w=ll(w,v.mode,b,null),w.return=v,w;np(v,w)}return null}function f(v,w,b,E){var C=w!==null?w.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return C!==null?null:a(v,w,""+b,E);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Gf:return b.key===C?c(v,w,b,E):null;case Ll:return b.key===C?u(v,w,b,E):null;case Dr:return C=b._init,f(v,w,C(b._payload),E)}if(Uu(b)||Pu(b))return C!==null?null:d(v,w,b,E,null);np(v,b)}return null}function p(v,w,b,E,C){if(typeof E=="string"&&E!==""||typeof E=="number")return v=v.get(b)||null,a(w,v,""+E,C);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Gf:return v=v.get(E.key===null?b:E.key)||null,c(w,v,E,C);case Ll:return v=v.get(E.key===null?b:E.key)||null,u(w,v,E,C);case Dr:var T=E._init;return p(v,w,b,T(E._payload),C)}if(Uu(E)||Pu(E))return v=v.get(b)||null,d(w,v,E,C,null);np(w,E)}return null}function y(v,w,b,E){for(var C=null,T=null,k=w,R=w=0,M=null;k!==null&&R<b.length;R++){k.index>R?(M=k,k=null):M=k.sibling;var L=f(v,k,b[R],E);if(L===null){k===null&&(k=M);break}n&&k&&L.alternate===null&&e(v,k),w=r(L,w,R),T===null?C=L:T.sibling=L,T=L,k=M}if(R===b.length)return t(v,k),$e&&Go(v,R),C;if(k===null){for(;R<b.length;R++)k=h(v,b[R],E),k!==null&&(w=r(k,w,R),T===null?C=k:T.sibling=k,T=k);return $e&&Go(v,R),C}for(k=s(v,k);R<b.length;R++)M=p(k,v,R,b[R],E),M!==null&&(n&&M.alternate!==null&&k.delete(M.key===null?R:M.key),w=r(M,w,R),T===null?C=M:T.sibling=M,T=M);return n&&k.forEach(function(N){return e(v,N)}),$e&&Go(v,R),C}function g(v,w,b,E){var C=Pu(b);if(typeof C!="function")throw Error(D(150));if(b=C.call(b),b==null)throw Error(D(151));for(var T=C=null,k=w,R=w=0,M=null,L=b.next();k!==null&&!L.done;R++,L=b.next()){k.index>R?(M=k,k=null):M=k.sibling;var N=f(v,k,L.value,E);if(N===null){k===null&&(k=M);break}n&&k&&N.alternate===null&&e(v,k),w=r(N,w,R),T===null?C=N:T.sibling=N,T=N,k=M}if(L.done)return t(v,k),$e&&Go(v,R),C;if(k===null){for(;!L.done;R++,L=b.next())L=h(v,L.value,E),L!==null&&(w=r(L,w,R),T===null?C=L:T.sibling=L,T=L);return $e&&Go(v,R),C}for(k=s(v,k);!L.done;R++,L=b.next())L=p(k,v,R,L.value,E),L!==null&&(n&&L.alternate!==null&&k.delete(L.key===null?R:L.key),w=r(L,w,R),T===null?C=L:T.sibling=L,T=L);return n&&k.forEach(function(B){return e(v,B)}),$e&&Go(v,R),C}function A(v,w,b,E){if(typeof b=="object"&&b!==null&&b.type===Nl&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case Gf:e:{for(var C=b.key,T=w;T!==null;){if(T.key===C){if(C=b.type,C===Nl){if(T.tag===7){t(v,T.sibling),w=i(T,b.props.children),w.return=v,v=w;break e}}else if(T.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Dr&&Kb(C)===T.type){t(v,T.sibling),w=i(T,b.props),w.ref=Du(v,T,b),w.return=v,v=w;break e}t(v,T);break}else e(v,T);T=T.sibling}b.type===Nl?(w=ll(b.props.children,v.mode,E,b.key),w.return=v,v=w):(E=_p(b.type,b.key,b.props,null,v.mode,E),E.ref=Du(v,w,b),E.return=v,v=E)}return o(v);case Ll:e:{for(T=b.key;w!==null;){if(w.key===T)if(w.tag===4&&w.stateNode.containerInfo===b.containerInfo&&w.stateNode.implementation===b.implementation){t(v,w.sibling),w=i(w,b.children||[]),w.return=v,v=w;break e}else{t(v,w);break}else e(v,w);w=w.sibling}w=dy(b,v.mode,E),w.return=v,v=w}return o(v);case Dr:return T=b._init,A(v,w,T(b._payload),E)}if(Uu(b))return y(v,w,b,E);if(Pu(b))return g(v,w,b,E);np(v,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,w!==null&&w.tag===6?(t(v,w.sibling),w=i(w,b),w.return=v,v=w):(t(v,w),w=uy(b,v.mode,E),w.return=v,v=w),o(v)):t(v,w)}return A}var fu=LA(!0),NA=LA(!1),mg=Ho(null),yg=null,$l=null,lw=null;function cw(){lw=$l=yg=null}function uw(n){var e=mg.current;Oe(mg),n._currentValue=e}function tv(n,e,t){for(;n!==null;){var s=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),n===t)break;n=n.return}}function Ql(n,e){yg=n,lw=$l=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(bn=!0),n.firstContext=null)}function bs(n){var e=n._currentValue;if(lw!==n)if(n={context:n,memoizedValue:e,next:null},$l===null){if(yg===null)throw Error(D(308));$l=n,yg.dependencies={lanes:0,firstContext:n}}else $l=$l.next=n;return e}var Zo=null;function dw(n){Zo===null?Zo=[n]:Zo.push(n)}function MA(n,e,t,s){var i=e.interleaved;return i===null?(t.next=t,dw(e)):(t.next=i.next,i.next=t),e.interleaved=t,Sr(n,s)}function Sr(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var Ir=!1;function hw(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function DA(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function yr(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function Po(n,e,t){var s=n.updateQueue;if(s===null)return null;if(s=s.shared,me&2){var i=s.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),s.pending=e,Sr(n,t)}return i=s.interleaved,i===null?(e.next=e,dw(s)):(e.next=i.next,i.next=e),s.interleaved=e,Sr(n,t)}function wp(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var s=e.lanes;s&=n.pendingLanes,t|=s,e.lanes=t,Q0(n,t)}}function Qb(n,e){var t=n.updateQueue,s=n.alternate;if(s!==null&&(s=s.updateQueue,t===s)){var i=null,r=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};r===null?i=r=o:r=r.next=o,t=t.next}while(t!==null);r===null?i=r=e:r=r.next=e}else i=r=e;t={baseState:s.baseState,firstBaseUpdate:i,lastBaseUpdate:r,shared:s.shared,effects:s.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function vg(n,e,t,s){var i=n.updateQueue;Ir=!1;var r=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var c=a,u=c.next;c.next=null,o===null?r=u:o.next=u,o=c;var d=n.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=u:a.next=u,d.lastBaseUpdate=c))}if(r!==null){var h=i.baseState;o=0,d=u=c=null,a=r;do{var f=a.lane,p=a.eventTime;if((s&f)===f){d!==null&&(d=d.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var y=n,g=a;switch(f=e,p=t,g.tag){case 1:if(y=g.payload,typeof y=="function"){h=y.call(p,h,f);break e}h=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=g.payload,f=typeof y=="function"?y.call(p,h,f):y,f==null)break e;h=We({},h,f);break e;case 2:Ir=!0}}a.callback!==null&&a.lane!==0&&(n.flags|=64,f=i.effects,f===null?i.effects=[a]:f.push(a))}else p={eventTime:p,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(u=d=p,c=h):d=d.next=p,o|=f;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;f=a,a=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(!0);if(d===null&&(c=h),i.baseState=c,i.firstBaseUpdate=u,i.lastBaseUpdate=d,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else r===null&&(i.shared.lanes=0);hl|=o,n.lanes=o,n.memoizedState=h}}function Jb(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var s=n[e],i=s.callback;if(i!==null){if(s.callback=null,s=t,typeof i!="function")throw Error(D(191,i));i.call(s)}}}var Pf={},Ci=Ho(Pf),Id=Ho(Pf),Od=Ho(Pf);function ea(n){if(n===Pf)throw Error(D(174));return n}function fw(n,e){switch(Ne(Od,e),Ne(Id,n),Ne(Ci,Pf),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Iy(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=Iy(e,n)}Oe(Ci),Ne(Ci,e)}function pu(){Oe(Ci),Oe(Id),Oe(Od)}function IA(n){ea(Od.current);var e=ea(Ci.current),t=Iy(e,n.type);e!==t&&(Ne(Id,n),Ne(Ci,t))}function pw(n){Id.current===n&&(Oe(Ci),Oe(Id))}var Ve=Ho(0);function wg(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var iy=[];function gw(){for(var n=0;n<iy.length;n++)iy[n]._workInProgressVersionPrimary=null;iy.length=0}var bp=kr.ReactCurrentDispatcher,ry=kr.ReactCurrentBatchConfig,dl=0,Ge=null,dt=null,St=null,bg=!1,md=!1,Fd=0,LT=0;function $t(){throw Error(D(321))}function mw(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!Xs(n[t],e[t]))return!1;return!0}function yw(n,e,t,s,i,r){if(dl=r,Ge=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,bp.current=n===null||n.memoizedState===null?IT:OT,n=t(s,i),md){r=0;do{if(md=!1,Fd=0,25<=r)throw Error(D(301));r+=1,St=dt=null,e.updateQueue=null,bp.current=FT,n=t(s,i)}while(md)}if(bp.current=xg,e=dt!==null&&dt.next!==null,dl=0,St=dt=Ge=null,bg=!1,e)throw Error(D(300));return n}function vw(){var n=Fd!==0;return Fd=0,n}function ri(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return St===null?Ge.memoizedState=St=n:St=St.next=n,St}function xs(){if(dt===null){var n=Ge.alternate;n=n!==null?n.memoizedState:null}else n=dt.next;var e=St===null?Ge.memoizedState:St.next;if(e!==null)St=e,dt=n;else{if(n===null)throw Error(D(310));dt=n,n={memoizedState:dt.memoizedState,baseState:dt.baseState,baseQueue:dt.baseQueue,queue:dt.queue,next:null},St===null?Ge.memoizedState=St=n:St=St.next=n}return St}function jd(n,e){return typeof e=="function"?e(n):e}function oy(n){var e=xs(),t=e.queue;if(t===null)throw Error(D(311));t.lastRenderedReducer=n;var s=dt,i=s.baseQueue,r=t.pending;if(r!==null){if(i!==null){var o=i.next;i.next=r.next,r.next=o}s.baseQueue=i=r,t.pending=null}if(i!==null){r=i.next,s=s.baseState;var a=o=null,c=null,u=r;do{var d=u.lane;if((dl&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),s=u.hasEagerState?u.eagerState:n(s,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(a=c=h,o=s):c=c.next=h,Ge.lanes|=d,hl|=d}u=u.next}while(u!==null&&u!==r);c===null?o=s:c.next=a,Xs(s,e.memoizedState)||(bn=!0),e.memoizedState=s,e.baseState=o,e.baseQueue=c,t.lastRenderedState=s}if(n=t.interleaved,n!==null){i=n;do r=i.lane,Ge.lanes|=r,hl|=r,i=i.next;while(i!==n)}else i===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function ay(n){var e=xs(),t=e.queue;if(t===null)throw Error(D(311));t.lastRenderedReducer=n;var s=t.dispatch,i=t.pending,r=e.memoizedState;if(i!==null){t.pending=null;var o=i=i.next;do r=n(r,o.action),o=o.next;while(o!==i);Xs(r,e.memoizedState)||(bn=!0),e.memoizedState=r,e.baseQueue===null&&(e.baseState=r),t.lastRenderedState=r}return[r,s]}function OA(){}function FA(n,e){var t=Ge,s=xs(),i=e(),r=!Xs(s.memoizedState,i);if(r&&(s.memoizedState=i,bn=!0),s=s.queue,ww($A.bind(null,t,s,n),[n]),s.getSnapshot!==e||r||St!==null&&St.memoizedState.tag&1){if(t.flags|=2048,zd(9,zA.bind(null,t,s,i,e),void 0,null),Et===null)throw Error(D(349));dl&30||jA(t,e,i)}return i}function jA(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=Ge.updateQueue,e===null?(e={lastEffect:null,stores:null},Ge.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function zA(n,e,t,s){e.value=t,e.getSnapshot=s,BA(e)&&HA(n)}function $A(n,e,t){return t(function(){BA(e)&&HA(n)})}function BA(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!Xs(n,t)}catch{return!0}}function HA(n){var e=Sr(n,1);e!==null&&Ws(e,n,1,-1)}function Zb(n){var e=ri();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:jd,lastRenderedState:n},e.queue=n,n=n.dispatch=DT.bind(null,Ge,n),[e.memoizedState,n]}function zd(n,e,t,s){return n={tag:n,create:e,destroy:t,deps:s,next:null},e=Ge.updateQueue,e===null?(e={lastEffect:null,stores:null},Ge.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(s=t.next,t.next=n,n.next=s,e.lastEffect=n)),n}function UA(){return xs().memoizedState}function xp(n,e,t,s){var i=ri();Ge.flags|=n,i.memoizedState=zd(1|e,t,void 0,s===void 0?null:s)}function dm(n,e,t,s){var i=xs();s=s===void 0?null:s;var r=void 0;if(dt!==null){var o=dt.memoizedState;if(r=o.destroy,s!==null&&mw(s,o.deps)){i.memoizedState=zd(e,t,r,s);return}}Ge.flags|=n,i.memoizedState=zd(1|e,t,r,s)}function ex(n,e){return xp(8390656,8,n,e)}function ww(n,e){return dm(2048,8,n,e)}function VA(n,e){return dm(4,2,n,e)}function GA(n,e){return dm(4,4,n,e)}function WA(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function XA(n,e,t){return t=t!=null?t.concat([n]):null,dm(4,4,WA.bind(null,e,n),t)}function bw(){}function qA(n,e){var t=xs();e=e===void 0?null:e;var s=t.memoizedState;return s!==null&&e!==null&&mw(e,s[1])?s[0]:(t.memoizedState=[n,e],n)}function YA(n,e){var t=xs();e=e===void 0?null:e;var s=t.memoizedState;return s!==null&&e!==null&&mw(e,s[1])?s[0]:(n=n(),t.memoizedState=[n,e],n)}function KA(n,e,t){return dl&21?(Xs(t,e)||(t=tA(),Ge.lanes|=t,hl|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,bn=!0),n.memoizedState=t)}function NT(n,e){var t=Se;Se=t!==0&&4>t?t:4,n(!0);var s=ry.transition;ry.transition={};try{n(!1),e()}finally{Se=t,ry.transition=s}}function QA(){return xs().memoizedState}function MT(n,e,t){var s=Lo(n);if(t={lane:s,action:t,hasEagerState:!1,eagerState:null,next:null},JA(n))ZA(e,t);else if(t=MA(n,e,t,s),t!==null){var i=cn();Ws(t,n,s,i),e1(t,e,s)}}function DT(n,e,t){var s=Lo(n),i={lane:s,action:t,hasEagerState:!1,eagerState:null,next:null};if(JA(n))ZA(e,i);else{var r=n.alternate;if(n.lanes===0&&(r===null||r.lanes===0)&&(r=e.lastRenderedReducer,r!==null))try{var o=e.lastRenderedState,a=r(o,t);if(i.hasEagerState=!0,i.eagerState=a,Xs(a,o)){var c=e.interleaved;c===null?(i.next=i,dw(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}t=MA(n,e,i,s),t!==null&&(i=cn(),Ws(t,n,s,i),e1(t,e,s))}}function JA(n){var e=n.alternate;return n===Ge||e!==null&&e===Ge}function ZA(n,e){md=bg=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function e1(n,e,t){if(t&4194240){var s=e.lanes;s&=n.pendingLanes,t|=s,e.lanes=t,Q0(n,t)}}var xg={readContext:bs,useCallback:$t,useContext:$t,useEffect:$t,useImperativeHandle:$t,useInsertionEffect:$t,useLayoutEffect:$t,useMemo:$t,useReducer:$t,useRef:$t,useState:$t,useDebugValue:$t,useDeferredValue:$t,useTransition:$t,useMutableSource:$t,useSyncExternalStore:$t,useId:$t,unstable_isNewReconciler:!1},IT={readContext:bs,useCallback:function(n,e){return ri().memoizedState=[n,e===void 0?null:e],n},useContext:bs,useEffect:ex,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,xp(4194308,4,WA.bind(null,e,n),t)},useLayoutEffect:function(n,e){return xp(4194308,4,n,e)},useInsertionEffect:function(n,e){return xp(4,2,n,e)},useMemo:function(n,e){var t=ri();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var s=ri();return e=t!==void 0?t(e):e,s.memoizedState=s.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},s.queue=n,n=n.dispatch=MT.bind(null,Ge,n),[s.memoizedState,n]},useRef:function(n){var e=ri();return n={current:n},e.memoizedState=n},useState:Zb,useDebugValue:bw,useDeferredValue:function(n){return ri().memoizedState=n},useTransition:function(){var n=Zb(!1),e=n[0];return n=NT.bind(null,n[1]),ri().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var s=Ge,i=ri();if($e){if(t===void 0)throw Error(D(407));t=t()}else{if(t=e(),Et===null)throw Error(D(349));dl&30||jA(s,e,t)}i.memoizedState=t;var r={value:t,getSnapshot:e};return i.queue=r,ex($A.bind(null,s,r,n),[n]),s.flags|=2048,zd(9,zA.bind(null,s,r,t,e),void 0,null),t},useId:function(){var n=ri(),e=Et.identifierPrefix;if($e){var t=mr,s=gr;t=(s&~(1<<32-Gs(s)-1)).toString(32)+t,e=":"+e+"R"+t,t=Fd++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=LT++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},OT={readContext:bs,useCallback:qA,useContext:bs,useEffect:ww,useImperativeHandle:XA,useInsertionEffect:VA,useLayoutEffect:GA,useMemo:YA,useReducer:oy,useRef:UA,useState:function(){return oy(jd)},useDebugValue:bw,useDeferredValue:function(n){var e=xs();return KA(e,dt.memoizedState,n)},useTransition:function(){var n=oy(jd)[0],e=xs().memoizedState;return[n,e]},useMutableSource:OA,useSyncExternalStore:FA,useId:QA,unstable_isNewReconciler:!1},FT={readContext:bs,useCallback:qA,useContext:bs,useEffect:ww,useImperativeHandle:XA,useInsertionEffect:VA,useLayoutEffect:GA,useMemo:YA,useReducer:ay,useRef:UA,useState:function(){return ay(jd)},useDebugValue:bw,useDeferredValue:function(n){var e=xs();return dt===null?e.memoizedState=n:KA(e,dt.memoizedState,n)},useTransition:function(){var n=ay(jd)[0],e=xs().memoizedState;return[n,e]},useMutableSource:OA,useSyncExternalStore:FA,useId:QA,unstable_isNewReconciler:!1};function Ts(n,e){if(n&&n.defaultProps){e=We({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function nv(n,e,t,s){e=n.memoizedState,t=t(s,e),t=t==null?e:We({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var hm={isMounted:function(n){return(n=n._reactInternals)?yl(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var s=cn(),i=Lo(n),r=yr(s,i);r.payload=e,t!=null&&(r.callback=t),e=Po(n,r,i),e!==null&&(Ws(e,n,i,s),wp(e,n,i))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var s=cn(),i=Lo(n),r=yr(s,i);r.tag=1,r.payload=e,t!=null&&(r.callback=t),e=Po(n,r,i),e!==null&&(Ws(e,n,i,s),wp(e,n,i))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=cn(),s=Lo(n),i=yr(t,s);i.tag=2,e!=null&&(i.callback=e),e=Po(n,i,s),e!==null&&(Ws(e,n,s,t),wp(e,n,s))}};function tx(n,e,t,s,i,r,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(s,r,o):e.prototype&&e.prototype.isPureReactComponent?!Ld(t,s)||!Ld(i,r):!0}function t1(n,e,t){var s=!1,i=Do,r=e.contextType;return typeof r=="object"&&r!==null?r=bs(r):(i=Sn(e)?cl:Qt.current,s=e.contextTypes,r=(s=s!=null)?du(n,i):Do),e=new e(t,r),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=hm,n.stateNode=e,e._reactInternals=n,s&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=i,n.__reactInternalMemoizedMaskedChildContext=r),e}function nx(n,e,t,s){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,s),e.state!==n&&hm.enqueueReplaceState(e,e.state,null)}function sv(n,e,t,s){var i=n.stateNode;i.props=t,i.state=n.memoizedState,i.refs={},hw(n);var r=e.contextType;typeof r=="object"&&r!==null?i.context=bs(r):(r=Sn(e)?cl:Qt.current,i.context=du(n,r)),i.state=n.memoizedState,r=e.getDerivedStateFromProps,typeof r=="function"&&(nv(n,e,r,t),i.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&hm.enqueueReplaceState(i,i.state,null),vg(n,t,i,s),i.state=n.memoizedState),typeof i.componentDidMount=="function"&&(n.flags|=4194308)}function gu(n,e){try{var t="",s=e;do t+=dk(s),s=s.return;while(s);var i=t}catch(r){i=`
Error generating stack: `+r.message+`
`+r.stack}return{value:n,source:e,stack:i,digest:null}}function ly(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function iv(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var jT=typeof WeakMap=="function"?WeakMap:Map;function n1(n,e,t){t=yr(-1,t),t.tag=3,t.payload={element:null};var s=e.value;return t.callback=function(){Ag||(Ag=!0,pv=s),iv(n,e)},t}function s1(n,e,t){t=yr(-1,t),t.tag=3;var s=n.type.getDerivedStateFromError;if(typeof s=="function"){var i=e.value;t.payload=function(){return s(i)},t.callback=function(){iv(n,e)}}var r=n.stateNode;return r!==null&&typeof r.componentDidCatch=="function"&&(t.callback=function(){iv(n,e),typeof s!="function"&&(Ro===null?Ro=new Set([this]):Ro.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function sx(n,e,t){var s=n.pingCache;if(s===null){s=n.pingCache=new jT;var i=new Set;s.set(e,i)}else i=s.get(e),i===void 0&&(i=new Set,s.set(e,i));i.has(t)||(i.add(t),n=JT.bind(null,n,e,t),e.then(n,n))}function ix(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function rx(n,e,t,s,i){return n.mode&1?(n.flags|=65536,n.lanes=i,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=yr(-1,1),e.tag=2,Po(t,e,1))),t.lanes|=1),n)}var zT=kr.ReactCurrentOwner,bn=!1;function on(n,e,t,s){e.child=n===null?NA(e,null,t,s):fu(e,n.child,t,s)}function ox(n,e,t,s,i){t=t.render;var r=e.ref;return Ql(e,i),s=yw(n,e,t,s,r,i),t=vw(),n!==null&&!bn?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Ar(n,e,i)):($e&&t&&rw(e),e.flags|=1,on(n,e,s,i),e.child)}function ax(n,e,t,s,i){if(n===null){var r=t.type;return typeof r=="function"&&!Tw(r)&&r.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=r,i1(n,e,r,s,i)):(n=_p(t.type,null,s,e,e.mode,i),n.ref=e.ref,n.return=e,e.child=n)}if(r=n.child,!(n.lanes&i)){var o=r.memoizedProps;if(t=t.compare,t=t!==null?t:Ld,t(o,s)&&n.ref===e.ref)return Ar(n,e,i)}return e.flags|=1,n=No(r,s),n.ref=e.ref,n.return=e,e.child=n}function i1(n,e,t,s,i){if(n!==null){var r=n.memoizedProps;if(Ld(r,s)&&n.ref===e.ref)if(bn=!1,e.pendingProps=s=r,(n.lanes&i)!==0)n.flags&131072&&(bn=!0);else return e.lanes=n.lanes,Ar(n,e,i)}return rv(n,e,t,s,i)}function r1(n,e,t){var s=e.pendingProps,i=s.children,r=n!==null?n.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ne(Hl,Xn),Xn|=t;else{if(!(t&1073741824))return n=r!==null?r.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,Ne(Hl,Xn),Xn|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=r!==null?r.baseLanes:t,Ne(Hl,Xn),Xn|=s}else r!==null?(s=r.baseLanes|t,e.memoizedState=null):s=t,Ne(Hl,Xn),Xn|=s;return on(n,e,i,t),e.child}function o1(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function rv(n,e,t,s,i){var r=Sn(t)?cl:Qt.current;return r=du(e,r),Ql(e,i),t=yw(n,e,t,s,r,i),s=vw(),n!==null&&!bn?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Ar(n,e,i)):($e&&s&&rw(e),e.flags|=1,on(n,e,t,i),e.child)}function lx(n,e,t,s,i){if(Sn(t)){var r=!0;fg(e)}else r=!1;if(Ql(e,i),e.stateNode===null)Sp(n,e),t1(e,t,s),sv(e,t,s,i),s=!0;else if(n===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var c=o.context,u=t.contextType;typeof u=="object"&&u!==null?u=bs(u):(u=Sn(t)?cl:Qt.current,u=du(e,u));var d=t.getDerivedStateFromProps,h=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==s||c!==u)&&nx(e,o,s,u),Ir=!1;var f=e.memoizedState;o.state=f,vg(e,s,o,i),c=e.memoizedState,a!==s||f!==c||xn.current||Ir?(typeof d=="function"&&(nv(e,t,d,s),c=e.memoizedState),(a=Ir||tx(e,t,a,s,f,c,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=c),o.props=s,o.state=c,o.context=u,s=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{o=e.stateNode,DA(n,e),a=e.memoizedProps,u=e.type===e.elementType?a:Ts(e.type,a),o.props=u,h=e.pendingProps,f=o.context,c=t.contextType,typeof c=="object"&&c!==null?c=bs(c):(c=Sn(t)?cl:Qt.current,c=du(e,c));var p=t.getDerivedStateFromProps;(d=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||f!==c)&&nx(e,o,s,c),Ir=!1,f=e.memoizedState,o.state=f,vg(e,s,o,i);var y=e.memoizedState;a!==h||f!==y||xn.current||Ir?(typeof p=="function"&&(nv(e,t,p,s),y=e.memoizedState),(u=Ir||tx(e,t,u,s,f,y,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(s,y,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(s,y,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&f===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&f===n.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=y),o.props=s,o.state=y,o.context=c,s=u):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&f===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&f===n.memoizedState||(e.flags|=1024),s=!1)}return ov(n,e,t,s,r,i)}function ov(n,e,t,s,i,r){o1(n,e);var o=(e.flags&128)!==0;if(!s&&!o)return i&&Xb(e,t,!1),Ar(n,e,r);s=e.stateNode,zT.current=e;var a=o&&typeof t.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,n!==null&&o?(e.child=fu(e,n.child,null,r),e.child=fu(e,null,a,r)):on(n,e,a,r),e.memoizedState=s.state,i&&Xb(e,t,!0),e.child}function a1(n){var e=n.stateNode;e.pendingContext?Wb(n,e.pendingContext,e.pendingContext!==e.context):e.context&&Wb(n,e.context,!1),fw(n,e.containerInfo)}function cx(n,e,t,s,i){return hu(),aw(i),e.flags|=256,on(n,e,t,s),e.child}var av={dehydrated:null,treeContext:null,retryLane:0};function lv(n){return{baseLanes:n,cachePool:null,transitions:null}}function l1(n,e,t){var s=e.pendingProps,i=Ve.current,r=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=n!==null&&n.memoizedState===null?!1:(i&2)!==0),a?(r=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(i|=1),Ne(Ve,i&1),n===null)return ev(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=s.children,n=s.fallback,r?(s=e.mode,r=e.child,o={mode:"hidden",children:o},!(s&1)&&r!==null?(r.childLanes=0,r.pendingProps=o):r=gm(o,s,0,null),n=ll(n,s,t,null),r.return=e,n.return=e,r.sibling=n,e.child=r,e.child.memoizedState=lv(t),e.memoizedState=av,n):xw(e,o));if(i=n.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return $T(n,e,o,s,a,i,t);if(r){r=s.fallback,o=e.mode,i=n.child,a=i.sibling;var c={mode:"hidden",children:s.children};return!(o&1)&&e.child!==i?(s=e.child,s.childLanes=0,s.pendingProps=c,e.deletions=null):(s=No(i,c),s.subtreeFlags=i.subtreeFlags&14680064),a!==null?r=No(a,r):(r=ll(r,o,t,null),r.flags|=2),r.return=e,s.return=e,s.sibling=r,e.child=s,s=r,r=e.child,o=n.child.memoizedState,o=o===null?lv(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},r.memoizedState=o,r.childLanes=n.childLanes&~t,e.memoizedState=av,s}return r=n.child,n=r.sibling,s=No(r,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=t),s.return=e,s.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=s,e.memoizedState=null,s}function xw(n,e){return e=gm({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function sp(n,e,t,s){return s!==null&&aw(s),fu(e,n.child,null,t),n=xw(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function $T(n,e,t,s,i,r,o){if(t)return e.flags&256?(e.flags&=-257,s=ly(Error(D(422))),sp(n,e,o,s)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(r=s.fallback,i=e.mode,s=gm({mode:"visible",children:s.children},i,0,null),r=ll(r,i,o,null),r.flags|=2,s.return=e,r.return=e,s.sibling=r,e.child=s,e.mode&1&&fu(e,n.child,null,o),e.child.memoizedState=lv(o),e.memoizedState=av,r);if(!(e.mode&1))return sp(n,e,o,null);if(i.data==="$!"){if(s=i.nextSibling&&i.nextSibling.dataset,s)var a=s.dgst;return s=a,r=Error(D(419)),s=ly(r,s,void 0),sp(n,e,o,s)}if(a=(o&n.childLanes)!==0,bn||a){if(s=Et,s!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(s.suspendedLanes|o)?0:i,i!==0&&i!==r.retryLane&&(r.retryLane=i,Sr(n,i),Ws(s,n,i,-1))}return kw(),s=ly(Error(D(421))),sp(n,e,o,s)}return i.data==="$?"?(e.flags|=128,e.child=n.child,e=ZT.bind(null,n),i._reactRetry=e,null):(n=r.treeContext,Kn=To(i.nextSibling),Qn=e,$e=!0,Us=null,n!==null&&(fs[ps++]=gr,fs[ps++]=mr,fs[ps++]=ul,gr=n.id,mr=n.overflow,ul=e),e=xw(e,s.children),e.flags|=4096,e)}function ux(n,e,t){n.lanes|=e;var s=n.alternate;s!==null&&(s.lanes|=e),tv(n.return,e,t)}function cy(n,e,t,s,i){var r=n.memoizedState;r===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:t,tailMode:i}:(r.isBackwards=e,r.rendering=null,r.renderingStartTime=0,r.last=s,r.tail=t,r.tailMode=i)}function c1(n,e,t){var s=e.pendingProps,i=s.revealOrder,r=s.tail;if(on(n,e,s.children,t),s=Ve.current,s&2)s=s&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&ux(n,t,e);else if(n.tag===19)ux(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}s&=1}if(Ne(Ve,s),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(t=e.child,i=null;t!==null;)n=t.alternate,n!==null&&wg(n)===null&&(i=t),t=t.sibling;t=i,t===null?(i=e.child,e.child=null):(i=t.sibling,t.sibling=null),cy(e,!1,i,t,r);break;case"backwards":for(t=null,i=e.child,e.child=null;i!==null;){if(n=i.alternate,n!==null&&wg(n)===null){e.child=i;break}n=i.sibling,i.sibling=t,t=i,i=n}cy(e,!0,t,null,r);break;case"together":cy(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Sp(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Ar(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),hl|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(D(153));if(e.child!==null){for(n=e.child,t=No(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=No(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function BT(n,e,t){switch(e.tag){case 3:a1(e),hu();break;case 5:IA(e);break;case 1:Sn(e.type)&&fg(e);break;case 4:fw(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,i=e.memoizedProps.value;Ne(mg,s._currentValue),s._currentValue=i;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(Ne(Ve,Ve.current&1),e.flags|=128,null):t&e.child.childLanes?l1(n,e,t):(Ne(Ve,Ve.current&1),n=Ar(n,e,t),n!==null?n.sibling:null);Ne(Ve,Ve.current&1);break;case 19:if(s=(t&e.childLanes)!==0,n.flags&128){if(s)return c1(n,e,t);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ne(Ve,Ve.current),s)break;return null;case 22:case 23:return e.lanes=0,r1(n,e,t)}return Ar(n,e,t)}var u1,cv,d1,h1;u1=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};cv=function(){};d1=function(n,e,t,s){var i=n.memoizedProps;if(i!==s){n=e.stateNode,ea(Ci.current);var r=null;switch(t){case"input":i=Ly(n,i),s=Ly(n,s),r=[];break;case"select":i=We({},i,{value:void 0}),s=We({},s,{value:void 0}),r=[];break;case"textarea":i=Dy(n,i),s=Dy(n,s),r=[];break;default:typeof i.onClick!="function"&&typeof s.onClick=="function"&&(n.onclick=dg)}Oy(t,s);var o;t=null;for(u in i)if(!s.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(o in a)a.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Ed.hasOwnProperty(u)?r||(r=[]):(r=r||[]).push(u,null));for(u in s){var c=s[u];if(a=i!=null?i[u]:void 0,s.hasOwnProperty(u)&&c!==a&&(c!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in c)c.hasOwnProperty(o)&&a[o]!==c[o]&&(t||(t={}),t[o]=c[o])}else t||(r||(r=[]),r.push(u,t)),t=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(r=r||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(r=r||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Ed.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&De("scroll",n),r||a===c||(r=[])):(r=r||[]).push(u,c))}t&&(r=r||[]).push("style",t);var u=r;(e.updateQueue=u)&&(e.flags|=4)}};h1=function(n,e,t,s){t!==s&&(e.flags|=4)};function Iu(n,e){if(!$e)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var s=null;t!==null;)t.alternate!==null&&(s=t),t=t.sibling;s===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:s.sibling=null}}function Bt(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,s=0;if(e)for(var i=n.child;i!==null;)t|=i.lanes|i.childLanes,s|=i.subtreeFlags&14680064,s|=i.flags&14680064,i.return=n,i=i.sibling;else for(i=n.child;i!==null;)t|=i.lanes|i.childLanes,s|=i.subtreeFlags,s|=i.flags,i.return=n,i=i.sibling;return n.subtreeFlags|=s,n.childLanes=t,e}function HT(n,e,t){var s=e.pendingProps;switch(ow(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Bt(e),null;case 1:return Sn(e.type)&&hg(),Bt(e),null;case 3:return s=e.stateNode,pu(),Oe(xn),Oe(Qt),gw(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(n===null||n.child===null)&&(tp(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Us!==null&&(yv(Us),Us=null))),cv(n,e),Bt(e),null;case 5:pw(e);var i=ea(Od.current);if(t=e.type,n!==null&&e.stateNode!=null)d1(n,e,t,s,i),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(D(166));return Bt(e),null}if(n=ea(Ci.current),tp(e)){s=e.stateNode,t=e.type;var r=e.memoizedProps;switch(s[Si]=e,s[Dd]=r,n=(e.mode&1)!==0,t){case"dialog":De("cancel",s),De("close",s);break;case"iframe":case"object":case"embed":De("load",s);break;case"video":case"audio":for(i=0;i<Gu.length;i++)De(Gu[i],s);break;case"source":De("error",s);break;case"img":case"image":case"link":De("error",s),De("load",s);break;case"details":De("toggle",s);break;case"input":wb(s,r),De("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!r.multiple},De("invalid",s);break;case"textarea":xb(s,r),De("invalid",s)}Oy(t,r),i=null;for(var o in r)if(r.hasOwnProperty(o)){var a=r[o];o==="children"?typeof a=="string"?s.textContent!==a&&(r.suppressHydrationWarning!==!0&&ep(s.textContent,a,n),i=["children",a]):typeof a=="number"&&s.textContent!==""+a&&(r.suppressHydrationWarning!==!0&&ep(s.textContent,a,n),i=["children",""+a]):Ed.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&De("scroll",s)}switch(t){case"input":Wf(s),bb(s,r,!0);break;case"textarea":Wf(s),Sb(s);break;case"select":case"option":break;default:typeof r.onClick=="function"&&(s.onclick=dg)}s=i,e.updateQueue=s,s!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=$S(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof s.is=="string"?n=o.createElement(t,{is:s.is}):(n=o.createElement(t),t==="select"&&(o=n,s.multiple?o.multiple=!0:s.size&&(o.size=s.size))):n=o.createElementNS(n,t),n[Si]=e,n[Dd]=s,u1(n,e,!1,!1),e.stateNode=n;e:{switch(o=Fy(t,s),t){case"dialog":De("cancel",n),De("close",n),i=s;break;case"iframe":case"object":case"embed":De("load",n),i=s;break;case"video":case"audio":for(i=0;i<Gu.length;i++)De(Gu[i],n);i=s;break;case"source":De("error",n),i=s;break;case"img":case"image":case"link":De("error",n),De("load",n),i=s;break;case"details":De("toggle",n),i=s;break;case"input":wb(n,s),i=Ly(n,s),De("invalid",n);break;case"option":i=s;break;case"select":n._wrapperState={wasMultiple:!!s.multiple},i=We({},s,{value:void 0}),De("invalid",n);break;case"textarea":xb(n,s),i=Dy(n,s),De("invalid",n);break;default:i=s}Oy(t,i),a=i;for(r in a)if(a.hasOwnProperty(r)){var c=a[r];r==="style"?US(n,c):r==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&BS(n,c)):r==="children"?typeof c=="string"?(t!=="textarea"||c!=="")&&_d(n,c):typeof c=="number"&&_d(n,""+c):r!=="suppressContentEditableWarning"&&r!=="suppressHydrationWarning"&&r!=="autoFocus"&&(Ed.hasOwnProperty(r)?c!=null&&r==="onScroll"&&De("scroll",n):c!=null&&G0(n,r,c,o))}switch(t){case"input":Wf(n),bb(n,s,!1);break;case"textarea":Wf(n),Sb(n);break;case"option":s.value!=null&&n.setAttribute("value",""+Mo(s.value));break;case"select":n.multiple=!!s.multiple,r=s.value,r!=null?Xl(n,!!s.multiple,r,!1):s.defaultValue!=null&&Xl(n,!!s.multiple,s.defaultValue,!0);break;default:typeof i.onClick=="function"&&(n.onclick=dg)}switch(t){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Bt(e),null;case 6:if(n&&e.stateNode!=null)h1(n,e,n.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(D(166));if(t=ea(Od.current),ea(Ci.current),tp(e)){if(s=e.stateNode,t=e.memoizedProps,s[Si]=e,(r=s.nodeValue!==t)&&(n=Qn,n!==null))switch(n.tag){case 3:ep(s.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&ep(s.nodeValue,t,(n.mode&1)!==0)}r&&(e.flags|=4)}else s=(t.nodeType===9?t:t.ownerDocument).createTextNode(s),s[Si]=e,e.stateNode=s}return Bt(e),null;case 13:if(Oe(Ve),s=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if($e&&Kn!==null&&e.mode&1&&!(e.flags&128))RA(),hu(),e.flags|=98560,r=!1;else if(r=tp(e),s!==null&&s.dehydrated!==null){if(n===null){if(!r)throw Error(D(318));if(r=e.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(D(317));r[Si]=e}else hu(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Bt(e),r=!1}else Us!==null&&(yv(Us),Us=null),r=!0;if(!r)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(s=s!==null,s!==(n!==null&&n.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(n===null||Ve.current&1?ft===0&&(ft=3):kw())),e.updateQueue!==null&&(e.flags|=4),Bt(e),null);case 4:return pu(),cv(n,e),n===null&&Nd(e.stateNode.containerInfo),Bt(e),null;case 10:return uw(e.type._context),Bt(e),null;case 17:return Sn(e.type)&&hg(),Bt(e),null;case 19:if(Oe(Ve),r=e.memoizedState,r===null)return Bt(e),null;if(s=(e.flags&128)!==0,o=r.rendering,o===null)if(s)Iu(r,!1);else{if(ft!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(o=wg(n),o!==null){for(e.flags|=128,Iu(r,!1),s=o.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=t,t=e.child;t!==null;)r=t,n=s,r.flags&=14680066,o=r.alternate,o===null?(r.childLanes=0,r.lanes=n,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=o.childLanes,r.lanes=o.lanes,r.child=o.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=o.memoizedProps,r.memoizedState=o.memoizedState,r.updateQueue=o.updateQueue,r.type=o.type,n=o.dependencies,r.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return Ne(Ve,Ve.current&1|2),e.child}n=n.sibling}r.tail!==null&&tt()>mu&&(e.flags|=128,s=!0,Iu(r,!1),e.lanes=4194304)}else{if(!s)if(n=wg(o),n!==null){if(e.flags|=128,s=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),Iu(r,!0),r.tail===null&&r.tailMode==="hidden"&&!o.alternate&&!$e)return Bt(e),null}else 2*tt()-r.renderingStartTime>mu&&t!==1073741824&&(e.flags|=128,s=!0,Iu(r,!1),e.lanes=4194304);r.isBackwards?(o.sibling=e.child,e.child=o):(t=r.last,t!==null?t.sibling=o:e.child=o,r.last=o)}return r.tail!==null?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=tt(),e.sibling=null,t=Ve.current,Ne(Ve,s?t&1|2:t&1),e):(Bt(e),null);case 22:case 23:return Cw(),s=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?Xn&1073741824&&(Bt(e),e.subtreeFlags&6&&(e.flags|=8192)):Bt(e),null;case 24:return null;case 25:return null}throw Error(D(156,e.tag))}function UT(n,e){switch(ow(e),e.tag){case 1:return Sn(e.type)&&hg(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return pu(),Oe(xn),Oe(Qt),gw(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return pw(e),null;case 13:if(Oe(Ve),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(D(340));hu()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return Oe(Ve),null;case 4:return pu(),null;case 10:return uw(e.type._context),null;case 22:case 23:return Cw(),null;case 24:return null;default:return null}}var ip=!1,Yt=!1,VT=typeof WeakSet=="function"?WeakSet:Set,X=null;function Bl(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(s){Ke(n,e,s)}else t.current=null}function uv(n,e,t){try{t()}catch(s){Ke(n,e,s)}}var dx=!1;function GT(n,e){if(Xy=lg,n=yA(),iw(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var s=t.getSelection&&t.getSelection();if(s&&s.rangeCount!==0){t=s.anchorNode;var i=s.anchorOffset,r=s.focusNode;s=s.focusOffset;try{t.nodeType,r.nodeType}catch{t=null;break e}var o=0,a=-1,c=-1,u=0,d=0,h=n,f=null;t:for(;;){for(var p;h!==t||i!==0&&h.nodeType!==3||(a=o+i),h!==r||s!==0&&h.nodeType!==3||(c=o+s),h.nodeType===3&&(o+=h.nodeValue.length),(p=h.firstChild)!==null;)f=h,h=p;for(;;){if(h===n)break t;if(f===t&&++u===i&&(a=o),f===r&&++d===s&&(c=o),(p=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=p}t=a===-1||c===-1?null:{start:a,end:c}}else t=null}t=t||{start:0,end:0}}else t=null;for(qy={focusedElem:n,selectionRange:t},lg=!1,X=e;X!==null;)if(e=X,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,X=n;else for(;X!==null;){e=X;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var g=y.memoizedProps,A=y.memoizedState,v=e.stateNode,w=v.getSnapshotBeforeUpdate(e.elementType===e.type?g:Ts(e.type,g),A);v.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(D(163))}}catch(E){Ke(e,e.return,E)}if(n=e.sibling,n!==null){n.return=e.return,X=n;break}X=e.return}return y=dx,dx=!1,y}function yd(n,e,t){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var i=s=s.next;do{if((i.tag&n)===n){var r=i.destroy;i.destroy=void 0,r!==void 0&&uv(e,t,r)}i=i.next}while(i!==s)}}function fm(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var s=t.create;t.destroy=s()}t=t.next}while(t!==e)}}function dv(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function f1(n){var e=n.alternate;e!==null&&(n.alternate=null,f1(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[Si],delete e[Dd],delete e[Qy],delete e[kT],delete e[TT])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function p1(n){return n.tag===5||n.tag===3||n.tag===4}function hx(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||p1(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function hv(n,e,t){var s=n.tag;if(s===5||s===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=dg));else if(s!==4&&(n=n.child,n!==null))for(hv(n,e,t),n=n.sibling;n!==null;)hv(n,e,t),n=n.sibling}function fv(n,e,t){var s=n.tag;if(s===5||s===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(s!==4&&(n=n.child,n!==null))for(fv(n,e,t),n=n.sibling;n!==null;)fv(n,e,t),n=n.sibling}var Mt=null,Hs=!1;function Nr(n,e,t){for(t=t.child;t!==null;)g1(n,e,t),t=t.sibling}function g1(n,e,t){if(_i&&typeof _i.onCommitFiberUnmount=="function")try{_i.onCommitFiberUnmount(rm,t)}catch{}switch(t.tag){case 5:Yt||Bl(t,e);case 6:var s=Mt,i=Hs;Mt=null,Nr(n,e,t),Mt=s,Hs=i,Mt!==null&&(Hs?(n=Mt,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):Mt.removeChild(t.stateNode));break;case 18:Mt!==null&&(Hs?(n=Mt,t=t.stateNode,n.nodeType===8?ny(n.parentNode,t):n.nodeType===1&&ny(n,t),Pd(n)):ny(Mt,t.stateNode));break;case 4:s=Mt,i=Hs,Mt=t.stateNode.containerInfo,Hs=!0,Nr(n,e,t),Mt=s,Hs=i;break;case 0:case 11:case 14:case 15:if(!Yt&&(s=t.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){i=s=s.next;do{var r=i,o=r.destroy;r=r.tag,o!==void 0&&(r&2||r&4)&&uv(t,e,o),i=i.next}while(i!==s)}Nr(n,e,t);break;case 1:if(!Yt&&(Bl(t,e),s=t.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=t.memoizedProps,s.state=t.memoizedState,s.componentWillUnmount()}catch(a){Ke(t,e,a)}Nr(n,e,t);break;case 21:Nr(n,e,t);break;case 22:t.mode&1?(Yt=(s=Yt)||t.memoizedState!==null,Nr(n,e,t),Yt=s):Nr(n,e,t);break;default:Nr(n,e,t)}}function fx(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new VT),e.forEach(function(s){var i=eP.bind(null,n,s);t.has(s)||(t.add(s),s.then(i,i))})}}function _s(n,e){var t=e.deletions;if(t!==null)for(var s=0;s<t.length;s++){var i=t[s];try{var r=n,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Mt=a.stateNode,Hs=!1;break e;case 3:Mt=a.stateNode.containerInfo,Hs=!0;break e;case 4:Mt=a.stateNode.containerInfo,Hs=!0;break e}a=a.return}if(Mt===null)throw Error(D(160));g1(r,o,i),Mt=null,Hs=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(u){Ke(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)m1(e,n),e=e.sibling}function m1(n,e){var t=n.alternate,s=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(_s(e,n),ti(n),s&4){try{yd(3,n,n.return),fm(3,n)}catch(g){Ke(n,n.return,g)}try{yd(5,n,n.return)}catch(g){Ke(n,n.return,g)}}break;case 1:_s(e,n),ti(n),s&512&&t!==null&&Bl(t,t.return);break;case 5:if(_s(e,n),ti(n),s&512&&t!==null&&Bl(t,t.return),n.flags&32){var i=n.stateNode;try{_d(i,"")}catch(g){Ke(n,n.return,g)}}if(s&4&&(i=n.stateNode,i!=null)){var r=n.memoizedProps,o=t!==null?t.memoizedProps:r,a=n.type,c=n.updateQueue;if(n.updateQueue=null,c!==null)try{a==="input"&&r.type==="radio"&&r.name!=null&&jS(i,r),Fy(a,o);var u=Fy(a,r);for(o=0;o<c.length;o+=2){var d=c[o],h=c[o+1];d==="style"?US(i,h):d==="dangerouslySetInnerHTML"?BS(i,h):d==="children"?_d(i,h):G0(i,d,h,u)}switch(a){case"input":Ny(i,r);break;case"textarea":zS(i,r);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!r.multiple;var p=r.value;p!=null?Xl(i,!!r.multiple,p,!1):f!==!!r.multiple&&(r.defaultValue!=null?Xl(i,!!r.multiple,r.defaultValue,!0):Xl(i,!!r.multiple,r.multiple?[]:"",!1))}i[Dd]=r}catch(g){Ke(n,n.return,g)}}break;case 6:if(_s(e,n),ti(n),s&4){if(n.stateNode===null)throw Error(D(162));i=n.stateNode,r=n.memoizedProps;try{i.nodeValue=r}catch(g){Ke(n,n.return,g)}}break;case 3:if(_s(e,n),ti(n),s&4&&t!==null&&t.memoizedState.isDehydrated)try{Pd(e.containerInfo)}catch(g){Ke(n,n.return,g)}break;case 4:_s(e,n),ti(n);break;case 13:_s(e,n),ti(n),i=n.child,i.flags&8192&&(r=i.memoizedState!==null,i.stateNode.isHidden=r,!r||i.alternate!==null&&i.alternate.memoizedState!==null||(Ew=tt())),s&4&&fx(n);break;case 22:if(d=t!==null&&t.memoizedState!==null,n.mode&1?(Yt=(u=Yt)||d,_s(e,n),Yt=u):_s(e,n),ti(n),s&8192){if(u=n.memoizedState!==null,(n.stateNode.isHidden=u)&&!d&&n.mode&1)for(X=n,d=n.child;d!==null;){for(h=X=d;X!==null;){switch(f=X,p=f.child,f.tag){case 0:case 11:case 14:case 15:yd(4,f,f.return);break;case 1:Bl(f,f.return);var y=f.stateNode;if(typeof y.componentWillUnmount=="function"){s=f,t=f.return;try{e=s,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(g){Ke(s,t,g)}}break;case 5:Bl(f,f.return);break;case 22:if(f.memoizedState!==null){gx(h);continue}}p!==null?(p.return=f,X=p):gx(h)}d=d.sibling}e:for(d=null,h=n;;){if(h.tag===5){if(d===null){d=h;try{i=h.stateNode,u?(r=i.style,typeof r.setProperty=="function"?r.setProperty("display","none","important"):r.display="none"):(a=h.stateNode,c=h.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=HS("display",o))}catch(g){Ke(n,n.return,g)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(g){Ke(n,n.return,g)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===n)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===n)break e;for(;h.sibling===null;){if(h.return===null||h.return===n)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:_s(e,n),ti(n),s&4&&fx(n);break;case 21:break;default:_s(e,n),ti(n)}}function ti(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(p1(t)){var s=t;break e}t=t.return}throw Error(D(160))}switch(s.tag){case 5:var i=s.stateNode;s.flags&32&&(_d(i,""),s.flags&=-33);var r=hx(n);fv(n,r,i);break;case 3:case 4:var o=s.stateNode.containerInfo,a=hx(n);hv(n,a,o);break;default:throw Error(D(161))}}catch(c){Ke(n,n.return,c)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function WT(n,e,t){X=n,y1(n)}function y1(n,e,t){for(var s=(n.mode&1)!==0;X!==null;){var i=X,r=i.child;if(i.tag===22&&s){var o=i.memoizedState!==null||ip;if(!o){var a=i.alternate,c=a!==null&&a.memoizedState!==null||Yt;a=ip;var u=Yt;if(ip=o,(Yt=c)&&!u)for(X=i;X!==null;)o=X,c=o.child,o.tag===22&&o.memoizedState!==null?mx(i):c!==null?(c.return=o,X=c):mx(i);for(;r!==null;)X=r,y1(r),r=r.sibling;X=i,ip=a,Yt=u}px(n)}else i.subtreeFlags&8772&&r!==null?(r.return=i,X=r):px(n)}}function px(n){for(;X!==null;){var e=X;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Yt||fm(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!Yt)if(t===null)s.componentDidMount();else{var i=e.elementType===e.type?t.memoizedProps:Ts(e.type,t.memoizedProps);s.componentDidUpdate(i,t.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var r=e.updateQueue;r!==null&&Jb(e,r,s);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}Jb(e,o,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&t.focus();break;case"img":c.src&&(t.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&Pd(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(D(163))}Yt||e.flags&512&&dv(e)}catch(f){Ke(e,e.return,f)}}if(e===n){X=null;break}if(t=e.sibling,t!==null){t.return=e.return,X=t;break}X=e.return}}function gx(n){for(;X!==null;){var e=X;if(e===n){X=null;break}var t=e.sibling;if(t!==null){t.return=e.return,X=t;break}X=e.return}}function mx(n){for(;X!==null;){var e=X;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{fm(4,e)}catch(c){Ke(e,t,c)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var i=e.return;try{s.componentDidMount()}catch(c){Ke(e,i,c)}}var r=e.return;try{dv(e)}catch(c){Ke(e,r,c)}break;case 5:var o=e.return;try{dv(e)}catch(c){Ke(e,o,c)}}}catch(c){Ke(e,e.return,c)}if(e===n){X=null;break}var a=e.sibling;if(a!==null){a.return=e.return,X=a;break}X=e.return}}var XT=Math.ceil,Sg=kr.ReactCurrentDispatcher,Sw=kr.ReactCurrentOwner,vs=kr.ReactCurrentBatchConfig,me=0,Et=null,rt=null,Ft=0,Xn=0,Hl=Ho(0),ft=0,$d=null,hl=0,pm=0,Aw=0,vd=null,wn=null,Ew=0,mu=1/0,Oi=null,Ag=!1,pv=null,Ro=null,rp=!1,Eo=null,Eg=0,wd=0,gv=null,Ap=-1,Ep=0;function cn(){return me&6?tt():Ap!==-1?Ap:Ap=tt()}function Lo(n){return n.mode&1?me&2&&Ft!==0?Ft&-Ft:RT.transition!==null?(Ep===0&&(Ep=tA()),Ep):(n=Se,n!==0||(n=window.event,n=n===void 0?16:lA(n.type)),n):1}function Ws(n,e,t,s){if(50<wd)throw wd=0,gv=null,Error(D(185));Cf(n,t,s),(!(me&2)||n!==Et)&&(n===Et&&(!(me&2)&&(pm|=t),ft===4&&jr(n,Ft)),An(n,s),t===1&&me===0&&!(e.mode&1)&&(mu=tt()+500,um&&Uo()))}function An(n,e){var t=n.callbackNode;Rk(n,e);var s=ag(n,n===Et?Ft:0);if(s===0)t!==null&&_b(t),n.callbackNode=null,n.callbackPriority=0;else if(e=s&-s,n.callbackPriority!==e){if(t!=null&&_b(t),e===1)n.tag===0?PT(yx.bind(null,n)):kA(yx.bind(null,n)),_T(function(){!(me&6)&&Uo()}),t=null;else{switch(nA(s)){case 1:t=K0;break;case 4:t=ZS;break;case 16:t=og;break;case 536870912:t=eA;break;default:t=og}t=_1(t,v1.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function v1(n,e){if(Ap=-1,Ep=0,me&6)throw Error(D(327));var t=n.callbackNode;if(Jl()&&n.callbackNode!==t)return null;var s=ag(n,n===Et?Ft:0);if(s===0)return null;if(s&30||s&n.expiredLanes||e)e=_g(n,s);else{e=s;var i=me;me|=2;var r=b1();(Et!==n||Ft!==e)&&(Oi=null,mu=tt()+500,al(n,e));do try{KT();break}catch(a){w1(n,a)}while(!0);cw(),Sg.current=r,me=i,rt!==null?e=0:(Et=null,Ft=0,e=ft)}if(e!==0){if(e===2&&(i=Hy(n),i!==0&&(s=i,e=mv(n,i))),e===1)throw t=$d,al(n,0),jr(n,s),An(n,tt()),t;if(e===6)jr(n,s);else{if(i=n.current.alternate,!(s&30)&&!qT(i)&&(e=_g(n,s),e===2&&(r=Hy(n),r!==0&&(s=r,e=mv(n,r))),e===1))throw t=$d,al(n,0),jr(n,s),An(n,tt()),t;switch(n.finishedWork=i,n.finishedLanes=s,e){case 0:case 1:throw Error(D(345));case 2:Wo(n,wn,Oi);break;case 3:if(jr(n,s),(s&130023424)===s&&(e=Ew+500-tt(),10<e)){if(ag(n,0)!==0)break;if(i=n.suspendedLanes,(i&s)!==s){cn(),n.pingedLanes|=n.suspendedLanes&i;break}n.timeoutHandle=Ky(Wo.bind(null,n,wn,Oi),e);break}Wo(n,wn,Oi);break;case 4:if(jr(n,s),(s&4194240)===s)break;for(e=n.eventTimes,i=-1;0<s;){var o=31-Gs(s);r=1<<o,o=e[o],o>i&&(i=o),s&=~r}if(s=i,s=tt()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*XT(s/1960))-s,10<s){n.timeoutHandle=Ky(Wo.bind(null,n,wn,Oi),s);break}Wo(n,wn,Oi);break;case 5:Wo(n,wn,Oi);break;default:throw Error(D(329))}}}return An(n,tt()),n.callbackNode===t?v1.bind(null,n):null}function mv(n,e){var t=vd;return n.current.memoizedState.isDehydrated&&(al(n,e).flags|=256),n=_g(n,e),n!==2&&(e=wn,wn=t,e!==null&&yv(e)),n}function yv(n){wn===null?wn=n:wn.push.apply(wn,n)}function qT(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var s=0;s<t.length;s++){var i=t[s],r=i.getSnapshot;i=i.value;try{if(!Xs(r(),i))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function jr(n,e){for(e&=~Aw,e&=~pm,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-Gs(e),s=1<<t;n[t]=-1,e&=~s}}function yx(n){if(me&6)throw Error(D(327));Jl();var e=ag(n,0);if(!(e&1))return An(n,tt()),null;var t=_g(n,e);if(n.tag!==0&&t===2){var s=Hy(n);s!==0&&(e=s,t=mv(n,s))}if(t===1)throw t=$d,al(n,0),jr(n,e),An(n,tt()),t;if(t===6)throw Error(D(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,Wo(n,wn,Oi),An(n,tt()),null}function _w(n,e){var t=me;me|=1;try{return n(e)}finally{me=t,me===0&&(mu=tt()+500,um&&Uo())}}function fl(n){Eo!==null&&Eo.tag===0&&!(me&6)&&Jl();var e=me;me|=1;var t=vs.transition,s=Se;try{if(vs.transition=null,Se=1,n)return n()}finally{Se=s,vs.transition=t,me=e,!(me&6)&&Uo()}}function Cw(){Xn=Hl.current,Oe(Hl)}function al(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,ET(t)),rt!==null)for(t=rt.return;t!==null;){var s=t;switch(ow(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&hg();break;case 3:pu(),Oe(xn),Oe(Qt),gw();break;case 5:pw(s);break;case 4:pu();break;case 13:Oe(Ve);break;case 19:Oe(Ve);break;case 10:uw(s.type._context);break;case 22:case 23:Cw()}t=t.return}if(Et=n,rt=n=No(n.current,null),Ft=Xn=e,ft=0,$d=null,Aw=pm=hl=0,wn=vd=null,Zo!==null){for(e=0;e<Zo.length;e++)if(t=Zo[e],s=t.interleaved,s!==null){t.interleaved=null;var i=s.next,r=t.pending;if(r!==null){var o=r.next;r.next=i,s.next=o}t.pending=s}Zo=null}return n}function w1(n,e){do{var t=rt;try{if(cw(),bp.current=xg,bg){for(var s=Ge.memoizedState;s!==null;){var i=s.queue;i!==null&&(i.pending=null),s=s.next}bg=!1}if(dl=0,St=dt=Ge=null,md=!1,Fd=0,Sw.current=null,t===null||t.return===null){ft=1,$d=e,rt=null;break}e:{var r=n,o=t.return,a=t,c=e;if(e=Ft,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=a,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=ix(o);if(p!==null){p.flags&=-257,rx(p,o,a,r,e),p.mode&1&&sx(r,u,e),e=p,c=u;var y=e.updateQueue;if(y===null){var g=new Set;g.add(c),e.updateQueue=g}else y.add(c);break e}else{if(!(e&1)){sx(r,u,e),kw();break e}c=Error(D(426))}}else if($e&&a.mode&1){var A=ix(o);if(A!==null){!(A.flags&65536)&&(A.flags|=256),rx(A,o,a,r,e),aw(gu(c,a));break e}}r=c=gu(c,a),ft!==4&&(ft=2),vd===null?vd=[r]:vd.push(r),r=o;do{switch(r.tag){case 3:r.flags|=65536,e&=-e,r.lanes|=e;var v=n1(r,c,e);Qb(r,v);break e;case 1:a=c;var w=r.type,b=r.stateNode;if(!(r.flags&128)&&(typeof w.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Ro===null||!Ro.has(b)))){r.flags|=65536,e&=-e,r.lanes|=e;var E=s1(r,a,e);Qb(r,E);break e}}r=r.return}while(r!==null)}S1(t)}catch(C){e=C,rt===t&&t!==null&&(rt=t=t.return);continue}break}while(!0)}function b1(){var n=Sg.current;return Sg.current=xg,n===null?xg:n}function kw(){(ft===0||ft===3||ft===2)&&(ft=4),Et===null||!(hl&268435455)&&!(pm&268435455)||jr(Et,Ft)}function _g(n,e){var t=me;me|=2;var s=b1();(Et!==n||Ft!==e)&&(Oi=null,al(n,e));do try{YT();break}catch(i){w1(n,i)}while(!0);if(cw(),me=t,Sg.current=s,rt!==null)throw Error(D(261));return Et=null,Ft=0,ft}function YT(){for(;rt!==null;)x1(rt)}function KT(){for(;rt!==null&&!xk();)x1(rt)}function x1(n){var e=E1(n.alternate,n,Xn);n.memoizedProps=n.pendingProps,e===null?S1(n):rt=e,Sw.current=null}function S1(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=UT(t,e),t!==null){t.flags&=32767,rt=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{ft=6,rt=null;return}}else if(t=HT(t,e,Xn),t!==null){rt=t;return}if(e=e.sibling,e!==null){rt=e;return}rt=e=n}while(e!==null);ft===0&&(ft=5)}function Wo(n,e,t){var s=Se,i=vs.transition;try{vs.transition=null,Se=1,QT(n,e,t,s)}finally{vs.transition=i,Se=s}return null}function QT(n,e,t,s){do Jl();while(Eo!==null);if(me&6)throw Error(D(327));t=n.finishedWork;var i=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(D(177));n.callbackNode=null,n.callbackPriority=0;var r=t.lanes|t.childLanes;if(Lk(n,r),n===Et&&(rt=Et=null,Ft=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||rp||(rp=!0,_1(og,function(){return Jl(),null})),r=(t.flags&15990)!==0,t.subtreeFlags&15990||r){r=vs.transition,vs.transition=null;var o=Se;Se=1;var a=me;me|=4,Sw.current=null,GT(n,t),m1(t,n),yT(qy),lg=!!Xy,qy=Xy=null,n.current=t,WT(t),Sk(),me=a,Se=o,vs.transition=r}else n.current=t;if(rp&&(rp=!1,Eo=n,Eg=i),r=n.pendingLanes,r===0&&(Ro=null),_k(t.stateNode),An(n,tt()),e!==null)for(s=n.onRecoverableError,t=0;t<e.length;t++)i=e[t],s(i.value,{componentStack:i.stack,digest:i.digest});if(Ag)throw Ag=!1,n=pv,pv=null,n;return Eg&1&&n.tag!==0&&Jl(),r=n.pendingLanes,r&1?n===gv?wd++:(wd=0,gv=n):wd=0,Uo(),null}function Jl(){if(Eo!==null){var n=nA(Eg),e=vs.transition,t=Se;try{if(vs.transition=null,Se=16>n?16:n,Eo===null)var s=!1;else{if(n=Eo,Eo=null,Eg=0,me&6)throw Error(D(331));var i=me;for(me|=4,X=n.current;X!==null;){var r=X,o=r.child;if(X.flags&16){var a=r.deletions;if(a!==null){for(var c=0;c<a.length;c++){var u=a[c];for(X=u;X!==null;){var d=X;switch(d.tag){case 0:case 11:case 15:yd(8,d,r)}var h=d.child;if(h!==null)h.return=d,X=h;else for(;X!==null;){d=X;var f=d.sibling,p=d.return;if(f1(d),d===u){X=null;break}if(f!==null){f.return=p,X=f;break}X=p}}}var y=r.alternate;if(y!==null){var g=y.child;if(g!==null){y.child=null;do{var A=g.sibling;g.sibling=null,g=A}while(g!==null)}}X=r}}if(r.subtreeFlags&2064&&o!==null)o.return=r,X=o;else e:for(;X!==null;){if(r=X,r.flags&2048)switch(r.tag){case 0:case 11:case 15:yd(9,r,r.return)}var v=r.sibling;if(v!==null){v.return=r.return,X=v;break e}X=r.return}}var w=n.current;for(X=w;X!==null;){o=X;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,X=b;else e:for(o=w;X!==null;){if(a=X,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:fm(9,a)}}catch(C){Ke(a,a.return,C)}if(a===o){X=null;break e}var E=a.sibling;if(E!==null){E.return=a.return,X=E;break e}X=a.return}}if(me=i,Uo(),_i&&typeof _i.onPostCommitFiberRoot=="function")try{_i.onPostCommitFiberRoot(rm,n)}catch{}s=!0}return s}finally{Se=t,vs.transition=e}}return!1}function vx(n,e,t){e=gu(t,e),e=n1(n,e,1),n=Po(n,e,1),e=cn(),n!==null&&(Cf(n,1,e),An(n,e))}function Ke(n,e,t){if(n.tag===3)vx(n,n,t);else for(;e!==null;){if(e.tag===3){vx(e,n,t);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(Ro===null||!Ro.has(s))){n=gu(t,n),n=s1(e,n,1),e=Po(e,n,1),n=cn(),e!==null&&(Cf(e,1,n),An(e,n));break}}e=e.return}}function JT(n,e,t){var s=n.pingCache;s!==null&&s.delete(e),e=cn(),n.pingedLanes|=n.suspendedLanes&t,Et===n&&(Ft&t)===t&&(ft===4||ft===3&&(Ft&130023424)===Ft&&500>tt()-Ew?al(n,0):Aw|=t),An(n,e)}function A1(n,e){e===0&&(n.mode&1?(e=Yf,Yf<<=1,!(Yf&130023424)&&(Yf=4194304)):e=1);var t=cn();n=Sr(n,e),n!==null&&(Cf(n,e,t),An(n,t))}function ZT(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),A1(n,t)}function eP(n,e){var t=0;switch(n.tag){case 13:var s=n.stateNode,i=n.memoizedState;i!==null&&(t=i.retryLane);break;case 19:s=n.stateNode;break;default:throw Error(D(314))}s!==null&&s.delete(e),A1(n,t)}var E1;E1=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||xn.current)bn=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return bn=!1,BT(n,e,t);bn=!!(n.flags&131072)}else bn=!1,$e&&e.flags&1048576&&TA(e,gg,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;Sp(n,e),n=e.pendingProps;var i=du(e,Qt.current);Ql(e,t),i=yw(null,e,s,n,i,t);var r=vw();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Sn(s)?(r=!0,fg(e)):r=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,hw(e),i.updater=hm,e.stateNode=i,i._reactInternals=e,sv(e,s,n,t),e=ov(null,e,s,!0,r,t)):(e.tag=0,$e&&r&&rw(e),on(null,e,i,t),e=e.child),e;case 16:s=e.elementType;e:{switch(Sp(n,e),n=e.pendingProps,i=s._init,s=i(s._payload),e.type=s,i=e.tag=nP(s),n=Ts(s,n),i){case 0:e=rv(null,e,s,n,t);break e;case 1:e=lx(null,e,s,n,t);break e;case 11:e=ox(null,e,s,n,t);break e;case 14:e=ax(null,e,s,Ts(s.type,n),t);break e}throw Error(D(306,s,""))}return e;case 0:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:Ts(s,i),rv(n,e,s,i,t);case 1:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:Ts(s,i),lx(n,e,s,i,t);case 3:e:{if(a1(e),n===null)throw Error(D(387));s=e.pendingProps,r=e.memoizedState,i=r.element,DA(n,e),vg(e,s,null,t);var o=e.memoizedState;if(s=o.element,r.isDehydrated)if(r={element:s,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=r,e.memoizedState=r,e.flags&256){i=gu(Error(D(423)),e),e=cx(n,e,s,t,i);break e}else if(s!==i){i=gu(Error(D(424)),e),e=cx(n,e,s,t,i);break e}else for(Kn=To(e.stateNode.containerInfo.firstChild),Qn=e,$e=!0,Us=null,t=NA(e,null,s,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(hu(),s===i){e=Ar(n,e,t);break e}on(n,e,s,t)}e=e.child}return e;case 5:return IA(e),n===null&&ev(e),s=e.type,i=e.pendingProps,r=n!==null?n.memoizedProps:null,o=i.children,Yy(s,i)?o=null:r!==null&&Yy(s,r)&&(e.flags|=32),o1(n,e),on(n,e,o,t),e.child;case 6:return n===null&&ev(e),null;case 13:return l1(n,e,t);case 4:return fw(e,e.stateNode.containerInfo),s=e.pendingProps,n===null?e.child=fu(e,null,s,t):on(n,e,s,t),e.child;case 11:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:Ts(s,i),ox(n,e,s,i,t);case 7:return on(n,e,e.pendingProps,t),e.child;case 8:return on(n,e,e.pendingProps.children,t),e.child;case 12:return on(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(s=e.type._context,i=e.pendingProps,r=e.memoizedProps,o=i.value,Ne(mg,s._currentValue),s._currentValue=o,r!==null)if(Xs(r.value,o)){if(r.children===i.children&&!xn.current){e=Ar(n,e,t);break e}}else for(r=e.child,r!==null&&(r.return=e);r!==null;){var a=r.dependencies;if(a!==null){o=r.child;for(var c=a.firstContext;c!==null;){if(c.context===s){if(r.tag===1){c=yr(-1,t&-t),c.tag=2;var u=r.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}r.lanes|=t,c=r.alternate,c!==null&&(c.lanes|=t),tv(r.return,t,e),a.lanes|=t;break}c=c.next}}else if(r.tag===10)o=r.type===e.type?null:r.child;else if(r.tag===18){if(o=r.return,o===null)throw Error(D(341));o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),tv(o,t,e),o=r.sibling}else o=r.child;if(o!==null)o.return=r;else for(o=r;o!==null;){if(o===e){o=null;break}if(r=o.sibling,r!==null){r.return=o.return,o=r;break}o=o.return}r=o}on(n,e,i.children,t),e=e.child}return e;case 9:return i=e.type,s=e.pendingProps.children,Ql(e,t),i=bs(i),s=s(i),e.flags|=1,on(n,e,s,t),e.child;case 14:return s=e.type,i=Ts(s,e.pendingProps),i=Ts(s.type,i),ax(n,e,s,i,t);case 15:return i1(n,e,e.type,e.pendingProps,t);case 17:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:Ts(s,i),Sp(n,e),e.tag=1,Sn(s)?(n=!0,fg(e)):n=!1,Ql(e,t),t1(e,s,i),sv(e,s,i,t),ov(null,e,s,!0,n,t);case 19:return c1(n,e,t);case 22:return r1(n,e,t)}throw Error(D(156,e.tag))};function _1(n,e){return JS(n,e)}function tP(n,e,t,s){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ys(n,e,t,s){return new tP(n,e,t,s)}function Tw(n){return n=n.prototype,!(!n||!n.isReactComponent)}function nP(n){if(typeof n=="function")return Tw(n)?1:0;if(n!=null){if(n=n.$$typeof,n===X0)return 11;if(n===q0)return 14}return 2}function No(n,e){var t=n.alternate;return t===null?(t=ys(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function _p(n,e,t,s,i,r){var o=2;if(s=n,typeof n=="function")Tw(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case Nl:return ll(t.children,i,r,e);case W0:o=8,i|=8;break;case ky:return n=ys(12,t,e,i|2),n.elementType=ky,n.lanes=r,n;case Ty:return n=ys(13,t,e,i),n.elementType=Ty,n.lanes=r,n;case Py:return n=ys(19,t,e,i),n.elementType=Py,n.lanes=r,n;case IS:return gm(t,i,r,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case MS:o=10;break e;case DS:o=9;break e;case X0:o=11;break e;case q0:o=14;break e;case Dr:o=16,s=null;break e}throw Error(D(130,n==null?n:typeof n,""))}return e=ys(o,t,e,i),e.elementType=n,e.type=s,e.lanes=r,e}function ll(n,e,t,s){return n=ys(7,n,s,e),n.lanes=t,n}function gm(n,e,t,s){return n=ys(22,n,s,e),n.elementType=IS,n.lanes=t,n.stateNode={isHidden:!1},n}function uy(n,e,t){return n=ys(6,n,null,e),n.lanes=t,n}function dy(n,e,t){return e=ys(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function sP(n,e,t,s,i){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Gm(0),this.expirationTimes=Gm(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Gm(0),this.identifierPrefix=s,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Pw(n,e,t,s,i,r,o,a,c){return n=new sP(n,e,t,a,c),e===1?(e=1,r===!0&&(e|=8)):e=0,r=ys(3,null,null,e),n.current=r,r.stateNode=n,r.memoizedState={element:s,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},hw(r),n}function iP(n,e,t){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ll,key:s==null?null:""+s,children:n,containerInfo:e,implementation:t}}function C1(n){if(!n)return Do;n=n._reactInternals;e:{if(yl(n)!==n||n.tag!==1)throw Error(D(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Sn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(D(171))}if(n.tag===1){var t=n.type;if(Sn(t))return CA(n,t,e)}return e}function k1(n,e,t,s,i,r,o,a,c){return n=Pw(t,s,!0,n,i,r,o,a,c),n.context=C1(null),t=n.current,s=cn(),i=Lo(t),r=yr(s,i),r.callback=e??null,Po(t,r,i),n.current.lanes=i,Cf(n,i,s),An(n,s),n}function mm(n,e,t,s){var i=e.current,r=cn(),o=Lo(i);return t=C1(t),e.context===null?e.context=t:e.pendingContext=t,e=yr(r,o),e.payload={element:n},s=s===void 0?null:s,s!==null&&(e.callback=s),n=Po(i,e,o),n!==null&&(Ws(n,i,o,r),wp(n,i,o)),o}function Cg(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function wx(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function Rw(n,e){wx(n,e),(n=n.alternate)&&wx(n,e)}function rP(){return null}var T1=typeof reportError=="function"?reportError:function(n){console.error(n)};function Lw(n){this._internalRoot=n}ym.prototype.render=Lw.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(D(409));mm(n,e,null,null)};ym.prototype.unmount=Lw.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;fl(function(){mm(null,n,null,null)}),e[xr]=null}};function ym(n){this._internalRoot=n}ym.prototype.unstable_scheduleHydration=function(n){if(n){var e=rA();n={blockedOn:null,target:n,priority:e};for(var t=0;t<Fr.length&&e!==0&&e<Fr[t].priority;t++);Fr.splice(t,0,n),t===0&&aA(n)}};function Nw(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function vm(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function bx(){}function oP(n,e,t,s,i){if(i){if(typeof s=="function"){var r=s;s=function(){var u=Cg(o);r.call(u)}}var o=k1(e,s,n,0,null,!1,!1,"",bx);return n._reactRootContainer=o,n[xr]=o.current,Nd(n.nodeType===8?n.parentNode:n),fl(),o}for(;i=n.lastChild;)n.removeChild(i);if(typeof s=="function"){var a=s;s=function(){var u=Cg(c);a.call(u)}}var c=Pw(n,0,!1,null,null,!1,!1,"",bx);return n._reactRootContainer=c,n[xr]=c.current,Nd(n.nodeType===8?n.parentNode:n),fl(function(){mm(e,c,t,s)}),c}function wm(n,e,t,s,i){var r=t._reactRootContainer;if(r){var o=r;if(typeof i=="function"){var a=i;i=function(){var c=Cg(o);a.call(c)}}mm(e,o,n,i)}else o=oP(t,e,n,i,s);return Cg(o)}sA=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=Vu(e.pendingLanes);t!==0&&(Q0(e,t|1),An(e,tt()),!(me&6)&&(mu=tt()+500,Uo()))}break;case 13:fl(function(){var s=Sr(n,1);if(s!==null){var i=cn();Ws(s,n,1,i)}}),Rw(n,1)}};J0=function(n){if(n.tag===13){var e=Sr(n,134217728);if(e!==null){var t=cn();Ws(e,n,134217728,t)}Rw(n,134217728)}};iA=function(n){if(n.tag===13){var e=Lo(n),t=Sr(n,e);if(t!==null){var s=cn();Ws(t,n,e,s)}Rw(n,e)}};rA=function(){return Se};oA=function(n,e){var t=Se;try{return Se=n,e()}finally{Se=t}};zy=function(n,e,t){switch(e){case"input":if(Ny(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var s=t[e];if(s!==n&&s.form===n.form){var i=cm(s);if(!i)throw Error(D(90));FS(s),Ny(s,i)}}}break;case"textarea":zS(n,t);break;case"select":e=t.value,e!=null&&Xl(n,!!t.multiple,e,!1)}};WS=_w;XS=fl;var aP={usingClientEntryPoint:!1,Events:[Tf,Ol,cm,VS,GS,_w]},Ou={findFiberByHostInstance:Jo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},lP={bundleType:Ou.bundleType,version:Ou.version,rendererPackageName:Ou.rendererPackageName,rendererConfig:Ou.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:kr.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=KS(n),n===null?null:n.stateNode},findFiberByHostInstance:Ou.findFiberByHostInstance||rP,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var op=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!op.isDisabled&&op.supportsFiber)try{rm=op.inject(lP),_i=op}catch{}}es.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=aP;es.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Nw(e))throw Error(D(200));return iP(n,e,null,t)};es.createRoot=function(n,e){if(!Nw(n))throw Error(D(299));var t=!1,s="",i=T1;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Pw(n,1,!1,null,null,t,!1,s,i),n[xr]=e.current,Nd(n.nodeType===8?n.parentNode:n),new Lw(e)};es.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(D(188)):(n=Object.keys(n).join(","),Error(D(268,n)));return n=KS(e),n=n===null?null:n.stateNode,n};es.flushSync=function(n){return fl(n)};es.hydrate=function(n,e,t){if(!vm(e))throw Error(D(200));return wm(null,n,e,!0,t)};es.hydrateRoot=function(n,e,t){if(!Nw(n))throw Error(D(405));var s=t!=null&&t.hydratedSources||null,i=!1,r="",o=T1;if(t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=k1(e,null,n,1,t??null,i,!1,r,o),n[xr]=e.current,Nd(n),s)for(n=0;n<s.length;n++)t=s[n],i=t._getVersion,i=i(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,i]:e.mutableSourceEagerHydrationData.push(t,i);return new ym(e)};es.render=function(n,e,t){if(!vm(e))throw Error(D(200));return wm(null,n,e,!1,t)};es.unmountComponentAtNode=function(n){if(!vm(n))throw Error(D(40));return n._reactRootContainer?(fl(function(){wm(null,null,n,!1,function(){n._reactRootContainer=null,n[xr]=null})}),!0):!1};es.unstable_batchedUpdates=_w;es.unstable_renderSubtreeIntoContainer=function(n,e,t,s){if(!vm(t))throw Error(D(200));if(n==null||n._reactInternals===void 0)throw Error(D(38));return wm(n,e,t,!1,s)};es.version="18.3.1-next-f1338f8080-20240426";function P1(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(P1)}catch(n){console.error(n)}}P1(),PS.exports=es;var Ul=PS.exports,xx=Ul;_y.createRoot=xx.createRoot,_y.hydrateRoot=xx.hydrateRoot;const cP={},Sx=n=>{let e;const t=new Set,s=(d,h)=>{const f=typeof d=="function"?d(e):d;if(!Object.is(f,e)){const p=e;e=h??(typeof f!="object"||f===null)?f:Object.assign({},e,f),t.forEach(y=>y(e,p))}},i=()=>e,c={setState:s,getState:i,getInitialState:()=>u,subscribe:d=>(t.add(d),()=>t.delete(d)),destroy:()=>{(cP?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},u=e=n(s,i,c);return c},uP=n=>n?Sx(n):Sx;var R1={exports:{}},L1={},N1={exports:{}},M1={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yu=P;function dP(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var hP=typeof Object.is=="function"?Object.is:dP,fP=yu.useState,pP=yu.useEffect,gP=yu.useLayoutEffect,mP=yu.useDebugValue;function yP(n,e){var t=e(),s=fP({inst:{value:t,getSnapshot:e}}),i=s[0].inst,r=s[1];return gP(function(){i.value=t,i.getSnapshot=e,hy(i)&&r({inst:i})},[n,t,e]),pP(function(){return hy(i)&&r({inst:i}),n(function(){hy(i)&&r({inst:i})})},[n]),mP(t),t}function hy(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!hP(n,t)}catch{return!0}}function vP(n,e){return e()}var wP=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?vP:yP;M1.useSyncExternalStore=yu.useSyncExternalStore!==void 0?yu.useSyncExternalStore:wP;N1.exports=M1;var bP=N1.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bm=P,xP=bP;function SP(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var AP=typeof Object.is=="function"?Object.is:SP,EP=xP.useSyncExternalStore,_P=bm.useRef,CP=bm.useEffect,kP=bm.useMemo,TP=bm.useDebugValue;L1.useSyncExternalStoreWithSelector=function(n,e,t,s,i){var r=_P(null);if(r.current===null){var o={hasValue:!1,value:null};r.current=o}else o=r.current;r=kP(function(){function c(p){if(!u){if(u=!0,d=p,p=s(p),i!==void 0&&o.hasValue){var y=o.value;if(i(y,p))return h=y}return h=p}if(y=h,AP(d,p))return y;var g=s(p);return i!==void 0&&i(y,g)?(d=p,y):(d=p,h=g)}var u=!1,d,h,f=t===void 0?null:t;return[function(){return c(e())},f===null?void 0:function(){return c(f())}]},[e,t,s,i]);var a=EP(n,r[0],r[1]);return CP(function(){o.hasValue=!0,o.value=a},[a]),TP(a),a};R1.exports=L1;var PP=R1.exports;const RP=j0(PP),D1={},{useDebugValue:LP}=an,{useSyncExternalStoreWithSelector:NP}=RP;let Ax=!1;const MP=n=>n;function DP(n,e=MP,t){(D1?"production":void 0)!=="production"&&t&&!Ax&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),Ax=!0);const s=NP(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return LP(s),s}const Ex=n=>{(D1?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?uP(n):n,t=(s,i)=>DP(e,s,i);return Object.assign(t,e),t},IP=n=>n?Ex(n):Ex,de="http://localhost:8000/api/v1",Cs={async getComponents(){const n=await fetch(`${de}/components/`);if(!n.ok)throw new Error("Failed to fetch components");return n.json()},async getLinks(){const n=await fetch(`${de}/links/`);if(!n.ok)throw new Error("Failed to fetch links");return n.json()},async createComponent(n){const e=await fetch(`${de}/components/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!e.ok)throw new Error("Failed to create component");return e.json()},async createLink(n){const e=await fetch(`${de}/links/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!e.ok)throw new Error("Failed to create link");return e.json()},async updateComponent(n,e){const t=await fetch(`${de}/components/${n}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw new Error("Failed to update component");return t.json()},async deleteComponent(n){if(!(await fetch(`${de}/components/${n}`,{method:"DELETE"})).ok)throw new Error("Failed to delete component")},async getPlan(n,e){const t=e!=null&&e.sessionId?`${de}/odl/${encodeURIComponent(e.sessionId)}/plan`:`${de}/ai/plan`,s=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({command:n})});if(!s.ok){const i=await s.text();throw new Error(`Plan endpoint error ${s.status}: ${i.slice(0,120)}`)}return s.json()},async analyzeDesign(n,e){const t=await fetch(`${de}/ai/analyze-design`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({command:e,snapshot:n})});if(!t.ok)throw new Error(`Analyze failed: ${t.status}`);return t.json()},async act(n,e,t){const s=await fetch(`${de}/odl/${encodeURIComponent(n)}/act`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({task_id:e,action:t})});if(!s.ok){const i=await s.text();throw new Error(`Act endpoint error ${s.status}: ${i.slice(0,120)}`)}return s.json()},async createOdlSession(n){const e=await fetch(`${de}/odl/sessions`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session_id:n})});if(!e.ok){const t=await e.text();throw new Error(`Create session error ${e.status}: ${t.slice(0,200)}`)}return e.text()},async getPlanForSession(n,e){const t=await fetch(`${de}/odl/${encodeURIComponent(n)}/plan`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({command:e})});if(!t.ok){const s=await t.text();throw new Error(`Plan session error ${t.status}: ${s.slice(0,200)}`)}return t.json()},async sendCommandToAI(n){const e=await fetch(`${de}/ai/command`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({command:n})});if(!e.ok){const t=await e.text();throw new Error(`AI endpoint error ${e.status}: ${t.slice(0,120)}`)}return e.json()}};async function I1(n,e){return new Promise((t,s)=>{const i=new XMLHttpRequest,r=new FormData;r.append("file",n),i.upload.onprogress=o=>{o.lengthComputable&&e(Math.round(o.loaded/o.total*100))},i.onload=()=>{i.status>=200&&i.status<300?t(JSON.parse(i.responseText)):s(i)},i.onerror=()=>s(i),i.open("POST",`${de}/files/upload`),i.send(r)})}async function OP(){const n=await fetch(`${de}/files/`);if(!n.ok)throw new Error("Failed to fetch files");return n.json()}async function Mw(n){const e=await fetch(`${de}/files/${n}/parse`,{method:"POST"});if(!e.ok){const t=await e.json();throw new Error(t.detail||"Failed to parse datasheet")}return e.json()}async function Bd(n){const e=await fetch(`${de}/files/${n}`);if(!e.ok){const t=await e.json();throw new Error(t.detail||"Failed to fetch status")}return e.json()}async function FP(n,e,t){const s={parsed_payload:e};s.is_human_verified=t;const i=await fetch(`${de}/files/${n}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!i.ok){const r=await i.json();throw new Error(r.detail||"Failed to save datasheet")}return i.json()}async function jP(n){const e=await fetch(`${de}/files/${n}/images`);if(!e.ok){const t=await e.json();throw new Error(t.detail||"Failed to list images")}return e.json()}async function zP(n,e){const t=new FormData;e.forEach(i=>{t.append("files",i)});const s=await fetch(`${de}/files/${n}/images`,{method:"POST",body:t});if(!s.ok){const i=await s.json();throw new Error(i.detail||"Failed to upload images")}return s.json()}async function $P(n,e){const t=await fetch(`${de}/files/${n}/images/${e}`,{method:"DELETE"});if(!t.ok){const s=await t.json();throw new Error(s.detail||"Failed to delete image")}}async function BP(n,e){const t=await fetch(`${de}/files/${n}/images/${e}/primary`,{method:"PATCH"});if(!t.ok){const s=await t.json();throw new Error(s.detail||"Failed to set primary image")}}const $=IP((n,e)=>({canvasComponents:[],links:[],ghostLinks:[],bomItems:null,selectedComponentId:null,messages:[],sessionId:"global",planTasks:[],setPlanTasks:t=>n({planTasks:t}),updatePlanTaskStatus:(t,s)=>n(i=>({planTasks:i.planTasks.map(r=>r.id===t?{...r,status:s}:r)})),clearPlanTasks:()=>n({planTasks:[]}),async performPlanTask(t){var i,r;const s=e().sessionId||"global";e().updatePlanTaskStatus(t.id,"in_progress"),n({isAiProcessing:!0});try{const{patch:o,card:a}=await Cs.act(s,t.id);o.add_nodes&&n(c=>({canvasComponents:[...c.canvasComponents,...o.add_nodes.map(u=>{var d;return{id:u.id,name:((d=u.data)==null?void 0:d.label)??u.type,type:u.type,x:Math.random()*500,y:Math.random()*300,ports:[{id:"input",type:"in"},{id:"output",type:"out"}]}})]})),o.add_edges&&n(c=>({links:[...c.links,...o.add_edges.map(u=>({id:`${u.source}_${u.target}_${crypto.randomUUID()}`,source_id:u.source,target_id:u.target}))]})),a&&e().addMessage({id:crypto.randomUUID(),author:"AI",text:a.title,card:{title:a.title,description:a.description,imageUrl:a.image_url,specs:(i=a.specs)==null?void 0:i.map(c=>({label:c.label,value:c.value})),actions:(r=a.actions)==null?void 0:r.map(c=>({label:c.label,command:c.command}))},type:"card"}),e().updatePlanTaskStatus(t.id,"complete")}catch(o){console.error("Failed to perform plan task",o),e().updatePlanTaskStatus(t.id,"blocked"),e().addStatusMessage("Failed to perform task","error")}finally{n({isAiProcessing:!1})}},quickActions:[],setQuickActions:t=>n({quickActions:t}),currentMode:"design",setCurrentMode:t=>n({currentMode:t}),lastPrompt:"",status:"loading",statusMessages:[],chatMode:"default",isAiProcessing:!1,costTotal:null,setCostTotal:t=>n({costTotal:t}),performanceMetrics:{annualKwh:null},setPerformanceMetrics:t=>n({performanceMetrics:t}),datasheetDirty:!1,setDatasheetDirty:t=>n({datasheetDirty:t}),history:[],historyIndex:-1,recordHistory:()=>{const t=e(),s={components:t.canvasComponents.map(i=>({...i})),links:t.links.map(i=>({...i}))};n(i=>{const r=i.history.slice(0,i.historyIndex+1);return{history:[...r,s],historyIndex:r.length}})},undo:()=>{const t=e();if(t.historyIndex<=0)return;const s=t.historyIndex-1,i=t.history[s];i&&n({canvasComponents:i.components.map(r=>({...r})),links:i.links.map(r=>({...r})),historyIndex:s})},redo:()=>{const t=e();if(t.historyIndex<0||t.historyIndex>=t.history.length-1)return;const s=t.historyIndex+1,i=t.history[s];i&&n({canvasComponents:i.components.map(r=>({...r})),links:i.links.map(r=>({...r})),historyIndex:s})},route:"projects",isSubNavVisible:!0,uploads:[],useRuleBased:!0,useTableExtraction:!0,useAiExtraction:!0,useOcrFallback:!1,layers:["Single-Line Diagram","High-Level Overview","Civil/Structural","Networking/Monitoring"],currentLayer:"Single-Line Diagram",setCurrentLayer:t=>n({currentLayer:t}),voiceMode:"idle",isContinuousConversation:!1,voiceTranscript:"",voiceOutputEnabled:!1,chatDraft:"",activeDatasheet:null,setActiveDatasheet:t=>n({activeDatasheet:t}),setVoiceMode:t=>n({voiceMode:t}),toggleContinuousConversation:()=>n(t=>({isContinuousConversation:!t.isContinuousConversation})),startListening:()=>{n({voiceTranscript:"",voiceMode:"listening"})},stopListening:t=>{n({voiceMode:"idle",voiceTranscript:""}),t&&t.trim()&&e().analyzeAndExecute(t.trim())},updateVoiceTranscript:t=>n({voiceTranscript:t}),toggleVoiceOutput:()=>n(t=>({voiceOutputEnabled:!t.voiceOutputEnabled})),setChatDraft:t=>n({chatDraft:t}),clearChatDraft:()=>n({chatDraft:""}),toggleSubNav:()=>n(t=>({isSubNavVisible:!t.isSubNavVisible})),setExtractionSetting:(t,s)=>n(i=>({...i,[t]:s})),addStatusMessage:(t,s)=>n(i=>({statusMessages:[...i.statusMessages,{id:crypto.randomUUID(),message:t,icon:s}]})),removeStatusMessage:t=>n(s=>({statusMessages:s.statusMessages.filter(i=>i.id!==t)})),addMessage:t=>n(s=>({messages:[...s.messages,t]})),selectComponent:t=>n({selectedComponentId:t}),async fetchProject(){n({status:"loading"}),e().addStatusMessage("Loading project...","info");try{const[t,s]=await Promise.all([Cs.getComponents(),Cs.getLinks()]),i=t.map(r=>({...r,layer:r.layer??"Single-Line Diagram",ports:[{id:"input",type:"in"},{id:"output",type:"out"}]}));n({canvasComponents:i,links:s,status:"ready"}),e().addStatusMessage("Project loaded","success")}catch(t){console.error("Failed to load project:",t),n({status:"Error: Could not load project"}),e().addStatusMessage("Failed to load project","error")}},async addComponent(t){n({status:`Adding ${t.type}...`}),e().addStatusMessage(`Adding ${t.type}...`,"info");try{const s={...t,layer:e().currentLayer},i=await Cs.createComponent(s),r={...i,ports:[{id:"input",type:"in"},{id:"output",type:"out"}],layer:e().currentLayer};n(o=>({canvasComponents:[...o.canvasComponents,r],status:`Component ${i.name} added`})),e().addStatusMessage(`Component ${i.name} added`,"success")}catch(s){console.error("Failed to add component:",s),n({status:"Error: Could not add component"}),e().addStatusMessage("Failed to add component","error")}},async updateComponentName(t,s){const i=e().canvasComponents,r=i.map(o=>o.id===t?{...o,name:s}:o);n({canvasComponents:r});try{await Cs.updateComponent(t,{name:s})}catch(o){console.error("Failed to update component name:",o),n({canvasComponents:i})}},async updateComponentPosition(t,s){const i=e().canvasComponents,r=i.find(u=>u.id===t);if(!r)return;const o=Math.round(r.x+s.x),a=Math.round(r.y+s.y),c={...r,x:o,y:a};n({canvasComponents:i.map(u=>u.id===t?c:u)});try{await Cs.updateComponent(t,{x:o,y:a})}catch(u){console.error("Failed to save new position:",u),n({canvasComponents:i})}},async deleteComponent(t){n(s=>({canvasComponents:s.canvasComponents.filter(i=>i.id!==t),links:s.links.filter(i=>i.source_id!==t&&i.target_id!==t),selectedComponentId:null}));try{await Cs.deleteComponent(t)}catch(s){console.error("Failed to delete component:",s),e().fetchProject()}},async addLink({source_id:t,target_id:s}){if(!(e().links.some(r=>r.source_id===t&&r.target_id===s)||t===s)){n({status:"Creating link..."}),e().addStatusMessage("Creating link...","info");try{const r=await Cs.createLink({source_id:t,target_id:s});n(o=>({links:[...o.links,r],status:"Link created"})),e().addStatusMessage("Link created","success")}catch(r){console.error("Failed to add link:",r),n({status:"Error: Could not create link"}),e().addStatusMessage("Failed to create link","error")}}},async executeAiActions(t){var i;const s=[];for(const r of t)switch(r.action){case"addComponent":case"addLink":case"removeComponent":case"updatePosition":case"suggestLink":s.push(r);break;case"validation":{const o=(i=r.payload)==null?void 0:i.message;o&&e().addMessage({id:crypto.randomUUID(),author:"AI",text:o});break}case"report":{e().setBom(r.payload.items);break}default:console.error("AI action not implemented",r)}s.length>0&&(e().recordHistory(),await e().applyAiActions(s),e().addMessage({id:crypto.randomUUID(),author:"AI",text:` Applied ${s.length} action(s) automatically.`}))},async applyAiActions(t){for(const s of t)switch(s.action){case"addComponent":await e().addComponent(s.payload);break;case"removeComponent":await e().deleteComponent(s.payload.id);break;case"addLink":await e().addLink(s.payload);break;case"suggestLink":{const{source_name:i,target_name:r,source_id:o,target_id:a}=s.payload,c=e().canvasComponents;let u=c.find(h=>i&&h.name===i),d=c.find(h=>r&&h.name===r);if(!u&&o&&(u=c.find(h=>h.id===o)),!d&&a&&(d=c.find(h=>h.id===a)),u&&d)try{await e().addLink({source_id:u.id,target_id:d.id})}catch(h){console.error("Failed to create link from suggestion",h),n(f=>({ghostLinks:[...f.ghostLinks,s.payload]}))}else n(h=>({ghostLinks:[...h.ghostLinks,s.payload]}));break}case"updatePosition":n(i=>({canvasComponents:i.canvasComponents.map(r=>r.id===s.payload.id?{...r,x:s.payload.x,y:s.payload.y}:r)}));break;case"report":e().setBom(s.payload.items);break;default:console.warn("AI action not implemented",s)}},async analyzeAndExecute(t){const{addMessage:s,setIsAiProcessing:i,setPlanTasks:r,setQuickActions:o}=e();n({lastPrompt:t}),s({id:crypto.randomUUID(),author:"User",text:t}),i(!0),e().addStatusMessage("Processing command","info"),(async()=>{try{const a=e().sessionId||"global";try{await Cs.createOdlSession(a)}catch(u){console.warn("ODL session init failed",u)}const c=await Cs.getPlanForSession(a,t);if(c.tasks&&Array.isArray(c.tasks)){const u=e().planTasks,d=c.tasks.map(h=>{const f=u.find(p=>p.id===h.id);return{id:h.id,title:h.title,description:h.description,status:f?f.status:h.status??"pending"}});r(d)}if(c.quick_actions&&Array.isArray(c.quick_actions)&&o(c.quick_actions.map(u=>({id:u.id,label:u.label,command:u.command}))),c.tasks&&Array.isArray(c.tasks))for(const u of c.tasks)await e().performPlanTask({id:u.id,title:u.title,description:u.description,status:u.status??"pending"})}catch(a){console.error("Failed to load plan",a)}})();try{const{canvasComponents:a,links:c}=e(),u=t.toLowerCase(),d={components:a,links:c};let h=[];u.includes("design")||(h=await Cs.analyzeDesign(d,t)),h.length>0&&await e().executeAiActions(h)}catch(a){console.error("Failed to analyze design",a),e().addStatusMessage("Failed to perform actions","error")}finally{i(!1)}},setBom(t){n({bomItems:t})},setChatMode(t){n({chatMode:t})},setIsAiProcessing(t){n({isAiProcessing:t})},setRoute(t){n({route:t})},addUpload(t){n(s=>({uploads:[...s.uploads,t]}))},updateUpload(t,s){n(i=>({uploads:i.uploads.map(r=>r.id===t?{...r,...s}:r)}))},async loadUploads(){try{const t=await OP();n({uploads:t.map(s=>({id:s.id,name:s.filename,size:s.size,mime:s.mime,progress:101,assetType:"component",parsed_at:s.parsed_at,parsing_status:s.parsing_status??null,parsing_error:s.parsing_error??null,is_human_verified:s.is_human_verified??!1}))})}catch(t){console.error("Failed to load uploads",t)}}}));/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HP=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),UP=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase()),_x=n=>{const e=UP(n);return e.charAt(0).toUpperCase()+e.slice(1)},O1=(...n)=>n.filter((e,t,s)=>!!e&&e.trim()!==""&&s.indexOf(e)===t).join(" ").trim(),VP=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var GP={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WP=P.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:s,className:i="",children:r,iconNode:o,...a},c)=>P.createElement("svg",{ref:c,...GP,width:e,height:e,stroke:n,strokeWidth:s?Number(t)*24/Number(e):t,className:O1("lucide",i),...!r&&!VP(a)&&{"aria-hidden":"true"},...a},[...o.map(([u,d])=>P.createElement(u,d)),...Array.isArray(r)?r:[r]]));/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const st=(n,e)=>{const t=P.forwardRef(({className:s,...i},r)=>P.createElement(WP,{ref:r,iconNode:e,className:O1(`lucide-${HP(_x(n))}`,`lucide-${n}`,s),...i}));return t.displayName=_x(n),t};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XP=[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]],qP=st("book",XP);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YP=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],KP=st("bot",YP);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QP=[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]],JP=st("box",QP);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZP=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],eR=st("chevron-left",ZP);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tR=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],nR=st("chevron-right",tR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sR=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],iR=st("circle-check-big",sR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rR=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],oR=st("circle",rR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aR=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],lR=st("funnel",aR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cR=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.93 4.93 4.24 4.24",key:"1ymg45"}],["path",{d:"m14.83 9.17 4.24-4.24",key:"1cb5xl"}],["path",{d:"m14.83 14.83 4.24 4.24",key:"q42g0n"}],["path",{d:"m9.17 14.83-4.24 4.24",key:"bqpfvv"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}]],uR=st("life-buoy",cR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dR=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Dw=st("loader-circle",dR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hR=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["rect",{x:"9",y:"2",width:"6",height:"13",rx:"3",key:"s6n7sd"}]],fR=st("mic",hR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pR=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"m16 15-3-3 3-3",key:"14y99z"}]],gR=st("panel-left-close",pR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mR=[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]],yR=st("paperclip",mR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vR=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],wR=st("search",vR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bR=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],xR=st("send",bR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SR=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],F1=st("settings",SR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AR=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],ER=st("star",AR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _R=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],CR=st("trash-2",_R);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kR=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],TR=st("triangle-alert",kR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PR=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],RR=st("zoom-in",PR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LR=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],NR=st("zoom-out",LR),MR=({toggleSidebar:n,toggleToolbar:e})=>_.jsxs("header",{className:"grid-in-header h-16 flex items-center justify-between px-4 bg-white text-black border-b border-gray-200",children:[_.jsx("div",{className:"flex items-center gap-2",children:_.jsx("button",{onClick:n,className:"p-2 rounded-md hover:bg-gray-100 focus:ring-2 focus:ring-blue-500","aria-label":"Toggle sidebar",children:_.jsx(gR,{size:24})})}),_.jsxs("div",{className:"flex items-center gap-4",children:[_.jsx("nav",{role:"tablist","aria-label":"Primary navigation",className:"flex gap-2",children:["GlobalNav_1","GlobalNav_2","GlobalNav_3"].map(t=>_.jsx("button",{role:"tab",className:"px-4 py-2 rounded-md hover:bg-gray-100 aria-selected:bg-blue-100","aria-selected":t==="GlobalNav_1",children:t},t))}),_.jsx("button",{onClick:e,className:"p-2 rounded-full hover:bg-gray-100","aria-label":"Toggle sub-navigation",title:"Toggle Sub-Nav",children:_.jsx(F1,{className:"h-5 w-5"})})]}),_.jsxs("div",{className:"flex gap-1",children:[_.jsx("span",{className:"h-6 w-6 rounded-full bg-blue-200 text-xs flex items-center justify-center",children:"AI_1"}),_.jsx("span",{className:"h-6 w-6 rounded-full bg-gray-300 text-xs flex items-center justify-center",children:"Eng_1"})]})]}),xm=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Au(n){const e=Object.prototype.toString.call(n);return e==="[object Window]"||e==="[object global]"}function Iw(n){return"nodeType"in n}function En(n){var e,t;return n?Au(n)?n:Iw(n)&&(e=(t=n.ownerDocument)==null?void 0:t.defaultView)!=null?e:window:window}function Ow(n){const{Document:e}=En(n);return n instanceof e}function Rf(n){return Au(n)?!1:n instanceof En(n).HTMLElement}function j1(n){return n instanceof En(n).SVGElement}function Eu(n){return n?Au(n)?n.document:Iw(n)?Ow(n)?n:Rf(n)||j1(n)?n.ownerDocument:document:document:document}const Io=xm?P.useLayoutEffect:P.useEffect;function Fw(n){const e=P.useRef(n);return Io(()=>{e.current=n}),P.useCallback(function(){for(var t=arguments.length,s=new Array(t),i=0;i<t;i++)s[i]=arguments[i];return e.current==null?void 0:e.current(...s)},[])}function DR(){const n=P.useRef(null),e=P.useCallback((s,i)=>{n.current=setInterval(s,i)},[]),t=P.useCallback(()=>{n.current!==null&&(clearInterval(n.current),n.current=null)},[]);return[e,t]}function Hd(n,e){e===void 0&&(e=[n]);const t=P.useRef(n);return Io(()=>{t.current!==n&&(t.current=n)},e),t}function Lf(n,e){const t=P.useRef();return P.useMemo(()=>{const s=n(t.current);return t.current=s,s},[...e])}function kg(n){const e=Fw(n),t=P.useRef(null),s=P.useCallback(i=>{i!==t.current&&(e==null||e(i,t.current)),t.current=i},[]);return[t,s]}function vv(n){const e=P.useRef();return P.useEffect(()=>{e.current=n},[n]),e.current}let fy={};function Sm(n,e){return P.useMemo(()=>{if(e)return e;const t=fy[n]==null?0:fy[n]+1;return fy[n]=t,n+"-"+t},[n,e])}function z1(n){return function(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),i=1;i<t;i++)s[i-1]=arguments[i];return s.reduce((r,o)=>{const a=Object.entries(o);for(const[c,u]of a){const d=r[c];d!=null&&(r[c]=d+n*u)}return r},{...e})}}const Zl=z1(1),Tg=z1(-1);function IR(n){return"clientX"in n&&"clientY"in n}function $1(n){if(!n)return!1;const{KeyboardEvent:e}=En(n.target);return e&&n instanceof e}function OR(n){if(!n)return!1;const{TouchEvent:e}=En(n.target);return e&&n instanceof e}function wv(n){if(OR(n)){if(n.touches&&n.touches.length){const{clientX:e,clientY:t}=n.touches[0];return{x:e,y:t}}else if(n.changedTouches&&n.changedTouches.length){const{clientX:e,clientY:t}=n.changedTouches[0];return{x:e,y:t}}}return IR(n)?{x:n.clientX,y:n.clientY}:null}const Cx="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function FR(n){return n.matches(Cx)?n:n.querySelector(Cx)}const jR={display:"none"};function zR(n){let{id:e,value:t}=n;return an.createElement("div",{id:e,style:jR},t)}function $R(n){let{id:e,announcement:t,ariaLiveType:s="assertive"}=n;const i={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return an.createElement("div",{id:e,style:i,role:"status","aria-live":s,"aria-atomic":!0},t)}function BR(){const[n,e]=P.useState("");return{announce:P.useCallback(s=>{s!=null&&e(s)},[]),announcement:n}}const B1=P.createContext(null);function HR(n){const e=P.useContext(B1);P.useEffect(()=>{if(!e)throw new Error("useDndMonitor must be used within a children of <DndContext>");return e(n)},[n,e])}function UR(){const[n]=P.useState(()=>new Set),e=P.useCallback(s=>(n.add(s),()=>n.delete(s)),[n]);return[P.useCallback(s=>{let{type:i,event:r}=s;n.forEach(o=>{var a;return(a=o[i])==null?void 0:a.call(o,r)})},[n]),e]}const VR={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},GR={onDragStart(n){let{active:e}=n;return"Picked up draggable item "+e.id+"."},onDragOver(n){let{active:e,over:t}=n;return t?"Draggable item "+e.id+" was moved over droppable area "+t.id+".":"Draggable item "+e.id+" is no longer over a droppable area."},onDragEnd(n){let{active:e,over:t}=n;return t?"Draggable item "+e.id+" was dropped over droppable area "+t.id:"Draggable item "+e.id+" was dropped."},onDragCancel(n){let{active:e}=n;return"Dragging was cancelled. Draggable item "+e.id+" was dropped."}};function WR(n){let{announcements:e=GR,container:t,hiddenTextDescribedById:s,screenReaderInstructions:i=VR}=n;const{announce:r,announcement:o}=BR(),a=Sm("DndLiveRegion"),[c,u]=P.useState(!1);if(P.useEffect(()=>{u(!0)},[]),HR(P.useMemo(()=>({onDragStart(h){let{active:f}=h;r(e.onDragStart({active:f}))},onDragMove(h){let{active:f,over:p}=h;e.onDragMove&&r(e.onDragMove({active:f,over:p}))},onDragOver(h){let{active:f,over:p}=h;r(e.onDragOver({active:f,over:p}))},onDragEnd(h){let{active:f,over:p}=h;r(e.onDragEnd({active:f,over:p}))},onDragCancel(h){let{active:f,over:p}=h;r(e.onDragCancel({active:f,over:p}))}}),[r,e])),!c)return null;const d=an.createElement(an.Fragment,null,an.createElement(zR,{id:s,value:i.draggable}),an.createElement($R,{id:a,announcement:o}));return t?Ul.createPortal(d,t):d}var ht;(function(n){n.DragStart="dragStart",n.DragMove="dragMove",n.DragEnd="dragEnd",n.DragCancel="dragCancel",n.DragOver="dragOver",n.RegisterDroppable="registerDroppable",n.SetDroppableDisabled="setDroppableDisabled",n.UnregisterDroppable="unregisterDroppable"})(ht||(ht={}));function Pg(){}function XR(n,e){return P.useMemo(()=>({sensor:n,options:{}}),[n,e])}function qR(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return P.useMemo(()=>[...e].filter(s=>s!=null),[...e])}const qs=Object.freeze({x:0,y:0});function YR(n,e){let{data:{value:t}}=n,{data:{value:s}}=e;return s-t}function KR(n,e){if(!n||n.length===0)return null;const[t]=n;return t[e]}function QR(n,e){const t=Math.max(e.top,n.top),s=Math.max(e.left,n.left),i=Math.min(e.left+e.width,n.left+n.width),r=Math.min(e.top+e.height,n.top+n.height),o=i-s,a=r-t;if(s<i&&t<r){const c=e.width*e.height,u=n.width*n.height,d=o*a,h=d/(c+u-d);return Number(h.toFixed(4))}return 0}const JR=n=>{let{collisionRect:e,droppableRects:t,droppableContainers:s}=n;const i=[];for(const r of s){const{id:o}=r,a=t.get(o);if(a){const c=QR(a,e);c>0&&i.push({id:o,data:{droppableContainer:r,value:c}})}}return i.sort(YR)};function ZR(n,e,t){return{...n,scaleX:e&&t?e.width/t.width:1,scaleY:e&&t?e.height/t.height:1}}function H1(n,e){return n&&e?{x:n.left-e.left,y:n.top-e.top}:qs}function e2(n){return function(t){for(var s=arguments.length,i=new Array(s>1?s-1:0),r=1;r<s;r++)i[r-1]=arguments[r];return i.reduce((o,a)=>({...o,top:o.top+n*a.y,bottom:o.bottom+n*a.y,left:o.left+n*a.x,right:o.right+n*a.x}),{...t})}}const t2=e2(1);function n2(n){if(n.startsWith("matrix3d(")){const e=n.slice(9,-1).split(/, /);return{x:+e[12],y:+e[13],scaleX:+e[0],scaleY:+e[5]}}else if(n.startsWith("matrix(")){const e=n.slice(7,-1).split(/, /);return{x:+e[4],y:+e[5],scaleX:+e[0],scaleY:+e[3]}}return null}function s2(n,e,t){const s=n2(e);if(!s)return n;const{scaleX:i,scaleY:r,x:o,y:a}=s,c=n.left-o-(1-i)*parseFloat(t),u=n.top-a-(1-r)*parseFloat(t.slice(t.indexOf(" ")+1)),d=i?n.width/i:n.width,h=r?n.height/r:n.height;return{width:d,height:h,top:u,right:c+d,bottom:u+h,left:c}}const i2={ignoreTransform:!1};function Nf(n,e){e===void 0&&(e=i2);let t=n.getBoundingClientRect();if(e.ignoreTransform){const{transform:u,transformOrigin:d}=En(n).getComputedStyle(n);u&&(t=s2(t,u,d))}const{top:s,left:i,width:r,height:o,bottom:a,right:c}=t;return{top:s,left:i,width:r,height:o,bottom:a,right:c}}function kx(n){return Nf(n,{ignoreTransform:!0})}function r2(n){const e=n.innerWidth,t=n.innerHeight;return{top:0,left:0,right:e,bottom:t,width:e,height:t}}function o2(n,e){return e===void 0&&(e=En(n).getComputedStyle(n)),e.position==="fixed"}function a2(n,e){e===void 0&&(e=En(n).getComputedStyle(n));const t=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(i=>{const r=e[i];return typeof r=="string"?t.test(r):!1})}function jw(n,e){const t=[];function s(i){if(e!=null&&t.length>=e||!i)return t;if(Ow(i)&&i.scrollingElement!=null&&!t.includes(i.scrollingElement))return t.push(i.scrollingElement),t;if(!Rf(i)||j1(i)||t.includes(i))return t;const r=En(n).getComputedStyle(i);return i!==n&&a2(i,r)&&t.push(i),o2(i,r)?t:s(i.parentNode)}return n?s(n):t}function U1(n){const[e]=jw(n,1);return e??null}function py(n){return!xm||!n?null:Au(n)?n:Iw(n)?Ow(n)||n===Eu(n).scrollingElement?window:Rf(n)?n:null:null}function V1(n){return Au(n)?n.scrollX:n.scrollLeft}function G1(n){return Au(n)?n.scrollY:n.scrollTop}function bv(n){return{x:V1(n),y:G1(n)}}var At;(function(n){n[n.Forward=1]="Forward",n[n.Backward=-1]="Backward"})(At||(At={}));function W1(n){return!xm||!n?!1:n===document.scrollingElement}function X1(n){const e={x:0,y:0},t=W1(n)?{height:window.innerHeight,width:window.innerWidth}:{height:n.clientHeight,width:n.clientWidth},s={x:n.scrollWidth-t.width,y:n.scrollHeight-t.height},i=n.scrollTop<=e.y,r=n.scrollLeft<=e.x,o=n.scrollTop>=s.y,a=n.scrollLeft>=s.x;return{isTop:i,isLeft:r,isBottom:o,isRight:a,maxScroll:s,minScroll:e}}const l2={x:.2,y:.2};function c2(n,e,t,s,i){let{top:r,left:o,right:a,bottom:c}=t;s===void 0&&(s=10),i===void 0&&(i=l2);const{isTop:u,isBottom:d,isLeft:h,isRight:f}=X1(n),p={x:0,y:0},y={x:0,y:0},g={height:e.height*i.y,width:e.width*i.x};return!u&&r<=e.top+g.height?(p.y=At.Backward,y.y=s*Math.abs((e.top+g.height-r)/g.height)):!d&&c>=e.bottom-g.height&&(p.y=At.Forward,y.y=s*Math.abs((e.bottom-g.height-c)/g.height)),!f&&a>=e.right-g.width?(p.x=At.Forward,y.x=s*Math.abs((e.right-g.width-a)/g.width)):!h&&o<=e.left+g.width&&(p.x=At.Backward,y.x=s*Math.abs((e.left+g.width-o)/g.width)),{direction:p,speed:y}}function u2(n){if(n===document.scrollingElement){const{innerWidth:r,innerHeight:o}=window;return{top:0,left:0,right:r,bottom:o,width:r,height:o}}const{top:e,left:t,right:s,bottom:i}=n.getBoundingClientRect();return{top:e,left:t,right:s,bottom:i,width:n.clientWidth,height:n.clientHeight}}function q1(n){return n.reduce((e,t)=>Zl(e,bv(t)),qs)}function d2(n){return n.reduce((e,t)=>e+V1(t),0)}function h2(n){return n.reduce((e,t)=>e+G1(t),0)}function f2(n,e){if(e===void 0&&(e=Nf),!n)return;const{top:t,left:s,bottom:i,right:r}=e(n);U1(n)&&(i<=0||r<=0||t>=window.innerHeight||s>=window.innerWidth)&&n.scrollIntoView({block:"center",inline:"center"})}const p2=[["x",["left","right"],d2],["y",["top","bottom"],h2]];class zw{constructor(e,t){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const s=jw(t),i=q1(s);this.rect={...e},this.width=e.width,this.height=e.height;for(const[r,o,a]of p2)for(const c of o)Object.defineProperty(this,c,{get:()=>{const u=a(s),d=i[r]-u;return this.rect[c]+d},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class bd{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(t=>{var s;return(s=this.target)==null?void 0:s.removeEventListener(...t)})},this.target=e}add(e,t,s){var i;(i=this.target)==null||i.addEventListener(e,t,s),this.listeners.push([e,t,s])}}function g2(n){const{EventTarget:e}=En(n);return n instanceof e?n:Eu(n)}function gy(n,e){const t=Math.abs(n.x),s=Math.abs(n.y);return typeof e=="number"?Math.sqrt(t**2+s**2)>e:"x"in e&&"y"in e?t>e.x&&s>e.y:"x"in e?t>e.x:"y"in e?s>e.y:!1}var hs;(function(n){n.Click="click",n.DragStart="dragstart",n.Keydown="keydown",n.ContextMenu="contextmenu",n.Resize="resize",n.SelectionChange="selectionchange",n.VisibilityChange="visibilitychange"})(hs||(hs={}));function Tx(n){n.preventDefault()}function m2(n){n.stopPropagation()}var Te;(function(n){n.Space="Space",n.Down="ArrowDown",n.Right="ArrowRight",n.Left="ArrowLeft",n.Up="ArrowUp",n.Esc="Escape",n.Enter="Enter",n.Tab="Tab"})(Te||(Te={}));const Y1={start:[Te.Space,Te.Enter],cancel:[Te.Esc],end:[Te.Space,Te.Enter,Te.Tab]},y2=(n,e)=>{let{currentCoordinates:t}=e;switch(n.code){case Te.Right:return{...t,x:t.x+25};case Te.Left:return{...t,x:t.x-25};case Te.Down:return{...t,y:t.y+25};case Te.Up:return{...t,y:t.y-25}}};class K1{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:t}}=e;this.props=e,this.listeners=new bd(Eu(t)),this.windowListeners=new bd(En(t)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(hs.Resize,this.handleCancel),this.windowListeners.add(hs.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(hs.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:e,onStart:t}=this.props,s=e.node.current;s&&f2(s),t(qs)}handleKeyDown(e){if($1(e)){const{active:t,context:s,options:i}=this.props,{keyboardCodes:r=Y1,coordinateGetter:o=y2,scrollBehavior:a="smooth"}=i,{code:c}=e;if(r.end.includes(c)){this.handleEnd(e);return}if(r.cancel.includes(c)){this.handleCancel(e);return}const{collisionRect:u}=s.current,d=u?{x:u.left,y:u.top}:qs;this.referenceCoordinates||(this.referenceCoordinates=d);const h=o(e,{active:t,context:s.current,currentCoordinates:d});if(h){const f=Tg(h,d),p={x:0,y:0},{scrollableAncestors:y}=s.current;for(const g of y){const A=e.code,{isTop:v,isRight:w,isLeft:b,isBottom:E,maxScroll:C,minScroll:T}=X1(g),k=u2(g),R={x:Math.min(A===Te.Right?k.right-k.width/2:k.right,Math.max(A===Te.Right?k.left:k.left+k.width/2,h.x)),y:Math.min(A===Te.Down?k.bottom-k.height/2:k.bottom,Math.max(A===Te.Down?k.top:k.top+k.height/2,h.y))},M=A===Te.Right&&!w||A===Te.Left&&!b,L=A===Te.Down&&!E||A===Te.Up&&!v;if(M&&R.x!==h.x){const N=g.scrollLeft+f.x,B=A===Te.Right&&N<=C.x||A===Te.Left&&N>=T.x;if(B&&!f.y){g.scrollTo({left:N,behavior:a});return}B?p.x=g.scrollLeft-N:p.x=A===Te.Right?g.scrollLeft-C.x:g.scrollLeft-T.x,p.x&&g.scrollBy({left:-p.x,behavior:a});break}else if(L&&R.y!==h.y){const N=g.scrollTop+f.y,B=A===Te.Down&&N<=C.y||A===Te.Up&&N>=T.y;if(B&&!f.x){g.scrollTo({top:N,behavior:a});return}B?p.y=g.scrollTop-N:p.y=A===Te.Down?g.scrollTop-C.y:g.scrollTop-T.y,p.y&&g.scrollBy({top:-p.y,behavior:a});break}}this.handleMove(e,Zl(Tg(h,this.referenceCoordinates),p))}}}handleMove(e,t){const{onMove:s}=this.props;e.preventDefault(),s(t)}handleEnd(e){const{onEnd:t}=this.props;e.preventDefault(),this.detach(),t()}handleCancel(e){const{onCancel:t}=this.props;e.preventDefault(),this.detach(),t()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}K1.activators=[{eventName:"onKeyDown",handler:(n,e,t)=>{let{keyboardCodes:s=Y1,onActivation:i}=e,{active:r}=t;const{code:o}=n.nativeEvent;if(s.start.includes(o)){const a=r.activatorNode.current;return a&&n.target!==a?!1:(n.preventDefault(),i==null||i({event:n.nativeEvent}),!0)}return!1}}];function Px(n){return!!(n&&"distance"in n)}function Rx(n){return!!(n&&"delay"in n)}class $w{constructor(e,t,s){var i;s===void 0&&(s=g2(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=t;const{event:r}=e,{target:o}=r;this.props=e,this.events=t,this.document=Eu(o),this.documentListeners=new bd(this.document),this.listeners=new bd(s),this.windowListeners=new bd(En(o)),this.initialCoordinates=(i=wv(r))!=null?i:qs,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:t,bypassActivationConstraint:s}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(hs.Resize,this.handleCancel),this.windowListeners.add(hs.DragStart,Tx),this.windowListeners.add(hs.VisibilityChange,this.handleCancel),this.windowListeners.add(hs.ContextMenu,Tx),this.documentListeners.add(hs.Keydown,this.handleKeydown),t){if(s!=null&&s({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(Rx(t)){this.timeoutId=setTimeout(this.handleStart,t.delay),this.handlePending(t);return}if(Px(t)){this.handlePending(t);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,t){const{active:s,onPending:i}=this.props;i(s,e,this.initialCoordinates,t)}handleStart(){const{initialCoordinates:e}=this,{onStart:t}=this.props;e&&(this.activated=!0,this.documentListeners.add(hs.Click,m2,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(hs.SelectionChange,this.removeTextSelection),t(e))}handleMove(e){var t;const{activated:s,initialCoordinates:i,props:r}=this,{onMove:o,options:{activationConstraint:a}}=r;if(!i)return;const c=(t=wv(e))!=null?t:qs,u=Tg(i,c);if(!s&&a){if(Px(a)){if(a.tolerance!=null&&gy(u,a.tolerance))return this.handleCancel();if(gy(u,a.distance))return this.handleStart()}if(Rx(a)&&gy(u,a.tolerance))return this.handleCancel();this.handlePending(a,u);return}e.cancelable&&e.preventDefault(),o(c)}handleEnd(){const{onAbort:e,onEnd:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleCancel(){const{onAbort:e,onCancel:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleKeydown(e){e.code===Te.Esc&&this.handleCancel()}removeTextSelection(){var e;(e=this.document.getSelection())==null||e.removeAllRanges()}}const v2={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class Bw extends $w{constructor(e){const{event:t}=e,s=Eu(t.target);super(e,v2,s)}}Bw.activators=[{eventName:"onPointerDown",handler:(n,e)=>{let{nativeEvent:t}=n,{onActivation:s}=e;return!t.isPrimary||t.button!==0?!1:(s==null||s({event:t}),!0)}}];const w2={move:{name:"mousemove"},end:{name:"mouseup"}};var xv;(function(n){n[n.RightClick=2]="RightClick"})(xv||(xv={}));class b2 extends $w{constructor(e){super(e,w2,Eu(e.event.target))}}b2.activators=[{eventName:"onMouseDown",handler:(n,e)=>{let{nativeEvent:t}=n,{onActivation:s}=e;return t.button===xv.RightClick?!1:(s==null||s({event:t}),!0)}}];const my={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class x2 extends $w{constructor(e){super(e,my)}static setup(){return window.addEventListener(my.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(my.move.name,e)};function e(){}}}x2.activators=[{eventName:"onTouchStart",handler:(n,e)=>{let{nativeEvent:t}=n,{onActivation:s}=e;const{touches:i}=t;return i.length>1?!1:(s==null||s({event:t}),!0)}}];var xd;(function(n){n[n.Pointer=0]="Pointer",n[n.DraggableRect=1]="DraggableRect"})(xd||(xd={}));var Rg;(function(n){n[n.TreeOrder=0]="TreeOrder",n[n.ReversedTreeOrder=1]="ReversedTreeOrder"})(Rg||(Rg={}));function S2(n){let{acceleration:e,activator:t=xd.Pointer,canScroll:s,draggingRect:i,enabled:r,interval:o=5,order:a=Rg.TreeOrder,pointerCoordinates:c,scrollableAncestors:u,scrollableAncestorRects:d,delta:h,threshold:f}=n;const p=E2({delta:h,disabled:!r}),[y,g]=DR(),A=P.useRef({x:0,y:0}),v=P.useRef({x:0,y:0}),w=P.useMemo(()=>{switch(t){case xd.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case xd.DraggableRect:return i}},[t,i,c]),b=P.useRef(null),E=P.useCallback(()=>{const T=b.current;if(!T)return;const k=A.current.x*v.current.x,R=A.current.y*v.current.y;T.scrollBy(k,R)},[]),C=P.useMemo(()=>a===Rg.TreeOrder?[...u].reverse():u,[a,u]);P.useEffect(()=>{if(!r||!u.length||!w){g();return}for(const T of C){if((s==null?void 0:s(T))===!1)continue;const k=u.indexOf(T),R=d[k];if(!R)continue;const{direction:M,speed:L}=c2(T,R,w,e,f);for(const N of["x","y"])p[N][M[N]]||(L[N]=0,M[N]=0);if(L.x>0||L.y>0){g(),b.current=T,y(E,o),A.current=L,v.current=M;return}}A.current={x:0,y:0},v.current={x:0,y:0},g()},[e,E,s,g,r,o,JSON.stringify(w),JSON.stringify(p),y,u,C,d,JSON.stringify(f)])}const A2={x:{[At.Backward]:!1,[At.Forward]:!1},y:{[At.Backward]:!1,[At.Forward]:!1}};function E2(n){let{delta:e,disabled:t}=n;const s=vv(e);return Lf(i=>{if(t||!s||!i)return A2;const r={x:Math.sign(e.x-s.x),y:Math.sign(e.y-s.y)};return{x:{[At.Backward]:i.x[At.Backward]||r.x===-1,[At.Forward]:i.x[At.Forward]||r.x===1},y:{[At.Backward]:i.y[At.Backward]||r.y===-1,[At.Forward]:i.y[At.Forward]||r.y===1}}},[t,e,s])}function _2(n,e){const t=e!=null?n.get(e):void 0,s=t?t.node.current:null;return Lf(i=>{var r;return e==null?null:(r=s??i)!=null?r:null},[s,e])}function C2(n,e){return P.useMemo(()=>n.reduce((t,s)=>{const{sensor:i}=s,r=i.activators.map(o=>({eventName:o.eventName,handler:e(o.handler,s)}));return[...t,...r]},[]),[n,e])}var Ud;(function(n){n[n.Always=0]="Always",n[n.BeforeDragging=1]="BeforeDragging",n[n.WhileDragging=2]="WhileDragging"})(Ud||(Ud={}));var Sv;(function(n){n.Optimized="optimized"})(Sv||(Sv={}));const Lx=new Map;function k2(n,e){let{dragging:t,dependencies:s,config:i}=e;const[r,o]=P.useState(null),{frequency:a,measure:c,strategy:u}=i,d=P.useRef(n),h=A(),f=Hd(h),p=P.useCallback(function(v){v===void 0&&(v=[]),!f.current&&o(w=>w===null?v:w.concat(v.filter(b=>!w.includes(b))))},[f]),y=P.useRef(null),g=Lf(v=>{if(h&&!t)return Lx;if(!v||v===Lx||d.current!==n||r!=null){const w=new Map;for(let b of n){if(!b)continue;if(r&&r.length>0&&!r.includes(b.id)&&b.rect.current){w.set(b.id,b.rect.current);continue}const E=b.node.current,C=E?new zw(c(E),E):null;b.rect.current=C,C&&w.set(b.id,C)}return w}return v},[n,r,t,h,c]);return P.useEffect(()=>{d.current=n},[n]),P.useEffect(()=>{h||p()},[t,h]),P.useEffect(()=>{r&&r.length>0&&o(null)},[JSON.stringify(r)]),P.useEffect(()=>{h||typeof a!="number"||y.current!==null||(y.current=setTimeout(()=>{p(),y.current=null},a))},[a,h,p,...s]),{droppableRects:g,measureDroppableContainers:p,measuringScheduled:r!=null};function A(){switch(u){case Ud.Always:return!1;case Ud.BeforeDragging:return t;default:return!t}}}function Q1(n,e){return Lf(t=>n?t||(typeof e=="function"?e(n):n):null,[e,n])}function T2(n,e){return Q1(n,e)}function P2(n){let{callback:e,disabled:t}=n;const s=Fw(e),i=P.useMemo(()=>{if(t||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:r}=window;return new r(s)},[s,t]);return P.useEffect(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function Am(n){let{callback:e,disabled:t}=n;const s=Fw(e),i=P.useMemo(()=>{if(t||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:r}=window;return new r(s)},[t]);return P.useEffect(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function R2(n){return new zw(Nf(n),n)}function Nx(n,e,t){e===void 0&&(e=R2);const[s,i]=P.useState(null);function r(){i(c=>{if(!n)return null;if(n.isConnected===!1){var u;return(u=c??t)!=null?u:null}const d=e(n);return JSON.stringify(c)===JSON.stringify(d)?c:d})}const o=P2({callback(c){if(n)for(const u of c){const{type:d,target:h}=u;if(d==="childList"&&h instanceof HTMLElement&&h.contains(n)){r();break}}}}),a=Am({callback:r});return Io(()=>{r(),n?(a==null||a.observe(n),o==null||o.observe(document.body,{childList:!0,subtree:!0})):(a==null||a.disconnect(),o==null||o.disconnect())},[n]),s}function L2(n){const e=Q1(n);return H1(n,e)}const Mx=[];function N2(n){const e=P.useRef(n),t=Lf(s=>n?s&&s!==Mx&&n&&e.current&&n.parentNode===e.current.parentNode?s:jw(n):Mx,[n]);return P.useEffect(()=>{e.current=n},[n]),t}function M2(n){const[e,t]=P.useState(null),s=P.useRef(n),i=P.useCallback(r=>{const o=py(r.target);o&&t(a=>a?(a.set(o,bv(o)),new Map(a)):null)},[]);return P.useEffect(()=>{const r=s.current;if(n!==r){o(r);const a=n.map(c=>{const u=py(c);return u?(u.addEventListener("scroll",i,{passive:!0}),[u,bv(u)]):null}).filter(c=>c!=null);t(a.length?new Map(a):null),s.current=n}return()=>{o(n),o(r)};function o(a){a.forEach(c=>{const u=py(c);u==null||u.removeEventListener("scroll",i)})}},[i,n]),P.useMemo(()=>n.length?e?Array.from(e.values()).reduce((r,o)=>Zl(r,o),qs):q1(n):qs,[n,e])}function Dx(n,e){e===void 0&&(e=[]);const t=P.useRef(null);return P.useEffect(()=>{t.current=null},e),P.useEffect(()=>{const s=n!==qs;s&&!t.current&&(t.current=n),!s&&t.current&&(t.current=null)},[n]),t.current?Tg(n,t.current):qs}function D2(n){P.useEffect(()=>{if(!xm)return;const e=n.map(t=>{let{sensor:s}=t;return s.setup==null?void 0:s.setup()});return()=>{for(const t of e)t==null||t()}},n.map(e=>{let{sensor:t}=e;return t}))}function I2(n,e){return P.useMemo(()=>n.reduce((t,s)=>{let{eventName:i,handler:r}=s;return t[i]=o=>{r(o,e)},t},{}),[n,e])}function J1(n){return P.useMemo(()=>n?r2(n):null,[n])}const Ix=[];function O2(n,e){e===void 0&&(e=Nf);const[t]=n,s=J1(t?En(t):null),[i,r]=P.useState(Ix);function o(){r(()=>n.length?n.map(c=>W1(c)?s:new zw(e(c),c)):Ix)}const a=Am({callback:o});return Io(()=>{a==null||a.disconnect(),o(),n.forEach(c=>a==null?void 0:a.observe(c))},[n]),i}function F2(n){if(!n)return null;if(n.children.length>1)return n;const e=n.children[0];return Rf(e)?e:n}function j2(n){let{measure:e}=n;const[t,s]=P.useState(null),i=P.useCallback(u=>{for(const{target:d}of u)if(Rf(d)){s(h=>{const f=e(d);return h?{...h,width:f.width,height:f.height}:f});break}},[e]),r=Am({callback:i}),o=P.useCallback(u=>{const d=F2(u);r==null||r.disconnect(),d&&(r==null||r.observe(d)),s(d?e(d):null)},[e,r]),[a,c]=kg(o);return P.useMemo(()=>({nodeRef:a,rect:t,setRef:c}),[t,a,c])}const z2=[{sensor:Bw,options:{}},{sensor:K1,options:{}}],$2={current:{}},Cp={draggable:{measure:kx},droppable:{measure:kx,strategy:Ud.WhileDragging,frequency:Sv.Optimized},dragOverlay:{measure:Nf}};class Sd extends Map{get(e){var t;return e!=null&&(t=super.get(e))!=null?t:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:t}=e;return!t})}getNodeFor(e){var t,s;return(t=(s=this.get(e))==null?void 0:s.node.current)!=null?t:void 0}}const B2={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Sd,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Pg},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Cp,measureDroppableContainers:Pg,windowRect:null,measuringScheduled:!1},H2={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Pg,draggableNodes:new Map,over:null,measureDroppableContainers:Pg},Em=P.createContext(H2),U2=P.createContext(B2);function V2(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Sd}}}function G2(n,e){switch(e.type){case ht.DragStart:return{...n,draggable:{...n.draggable,initialCoordinates:e.initialCoordinates,active:e.active}};case ht.DragMove:return n.draggable.active==null?n:{...n,draggable:{...n.draggable,translate:{x:e.coordinates.x-n.draggable.initialCoordinates.x,y:e.coordinates.y-n.draggable.initialCoordinates.y}}};case ht.DragEnd:case ht.DragCancel:return{...n,draggable:{...n.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case ht.RegisterDroppable:{const{element:t}=e,{id:s}=t,i=new Sd(n.droppable.containers);return i.set(s,t),{...n,droppable:{...n.droppable,containers:i}}}case ht.SetDroppableDisabled:{const{id:t,key:s,disabled:i}=e,r=n.droppable.containers.get(t);if(!r||s!==r.key)return n;const o=new Sd(n.droppable.containers);return o.set(t,{...r,disabled:i}),{...n,droppable:{...n.droppable,containers:o}}}case ht.UnregisterDroppable:{const{id:t,key:s}=e,i=n.droppable.containers.get(t);if(!i||s!==i.key)return n;const r=new Sd(n.droppable.containers);return r.delete(t),{...n,droppable:{...n.droppable,containers:r}}}default:return n}}function W2(n){let{disabled:e}=n;const{active:t,activatorEvent:s,draggableNodes:i}=P.useContext(Em),r=vv(s),o=vv(t==null?void 0:t.id);return P.useEffect(()=>{if(!e&&!s&&r&&o!=null){if(!$1(r)||document.activeElement===r.target)return;const a=i.get(o);if(!a)return;const{activatorNode:c,node:u}=a;if(!c.current&&!u.current)return;requestAnimationFrame(()=>{for(const d of[c.current,u.current]){if(!d)continue;const h=FR(d);if(h){h.focus();break}}})}},[s,e,i,o,r]),null}function X2(n,e){let{transform:t,...s}=e;return n!=null&&n.length?n.reduce((i,r)=>r({transform:i,...s}),t):t}function q2(n){return P.useMemo(()=>({draggable:{...Cp.draggable,...n==null?void 0:n.draggable},droppable:{...Cp.droppable,...n==null?void 0:n.droppable},dragOverlay:{...Cp.dragOverlay,...n==null?void 0:n.dragOverlay}}),[n==null?void 0:n.draggable,n==null?void 0:n.droppable,n==null?void 0:n.dragOverlay])}function Y2(n){let{activeNode:e,measure:t,initialRect:s,config:i=!0}=n;const r=P.useRef(!1),{x:o,y:a}=typeof i=="boolean"?{x:i,y:i}:i;Io(()=>{if(!o&&!a||!e){r.current=!1;return}if(r.current||!s)return;const u=e==null?void 0:e.node.current;if(!u||u.isConnected===!1)return;const d=t(u),h=H1(d,s);if(o||(h.x=0),a||(h.y=0),r.current=!0,Math.abs(h.x)>0||Math.abs(h.y)>0){const f=U1(u);f&&f.scrollBy({top:h.y,left:h.x})}},[e,o,a,s,t])}const Z1=P.createContext({...qs,scaleX:1,scaleY:1});var Or;(function(n){n[n.Uninitialized=0]="Uninitialized",n[n.Initializing=1]="Initializing",n[n.Initialized=2]="Initialized"})(Or||(Or={}));const K2=P.memo(function(e){var t,s,i,r;let{id:o,accessibility:a,autoScroll:c=!0,children:u,sensors:d=z2,collisionDetection:h=JR,measuring:f,modifiers:p,...y}=e;const g=P.useReducer(G2,void 0,V2),[A,v]=g,[w,b]=UR(),[E,C]=P.useState(Or.Uninitialized),T=E===Or.Initialized,{draggable:{active:k,nodes:R,translate:M},droppable:{containers:L}}=A,N=k!=null?R.get(k):null,B=P.useRef({initial:null,translated:null}),H=P.useMemo(()=>{var zt;return k!=null?{id:k,data:(zt=N==null?void 0:N.data)!=null?zt:$2,rect:B}:null},[k,N]),W=P.useRef(null),[ee,j]=P.useState(null),[O,I]=P.useState(null),V=Hd(y,Object.values(y)),K=Sm("DndDescribedBy",o),re=P.useMemo(()=>L.getEnabled(),[L]),J=q2(f),{droppableRects:oe,measureDroppableContainers:Re,measuringScheduled:Xe}=k2(re,{dragging:T,dependencies:[M.x,M.y],config:J.droppable}),fe=_2(R,k),pe=P.useMemo(()=>O?wv(O):null,[O]),_n=IC(),Cn=T2(fe,J.draggable.measure);Y2({activeNode:k!=null?R.get(k):null,config:_n.layoutShiftCompensation,initialRect:Cn,measure:J.draggable.measure});const ue=Nx(fe,J.draggable.measure,Cn),kn=Nx(fe?fe.parentElement:null),Ct=P.useRef({activatorEvent:null,active:null,activeNode:fe,collisionRect:null,collisions:null,droppableRects:oe,draggableNodes:R,draggingNode:null,draggingNodeRect:null,droppableContainers:L,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),gt=L.getNodeFor((t=Ct.current.over)==null?void 0:t.id),ge=j2({measure:J.dragOverlay.measure}),Be=(s=ge.nodeRef.current)!=null?s:fe,Ae=T?(i=ge.rect)!=null?i:ue:null,As=!!(ge.nodeRef.current&&ge.rect),Pi=L2(As?null:ue),Ri=J1(Be?En(Be):null),Qs=N2(T?gt??fe:null),Li=O2(Qs),bl=X2(p,{transform:{x:M.x-Pi.x,y:M.y-Pi.y,scaleX:1,scaleY:1},activatorEvent:O,active:H,activeNodeRect:ue,containerNodeRect:kn,draggingNodeRect:Ae,over:Ct.current.over,overlayNodeRect:ge.rect,scrollableAncestors:Qs,scrollableAncestorRects:Li,windowRect:Ri}),Hf=pe?Zl(pe,M):null,Uf=M2(Qs),Im=Dx(Uf),Om=Dx(Uf,[ue]),Tn=Zl(bl,Im),Es=Ae?t2(Ae,bl):null,Js=H&&Es?h({active:H,collisionRect:Es,droppableRects:oe,droppableContainers:re,pointerCoordinates:Hf}):null,xl=KR(Js,"id"),[Tr,cb]=P.useState(null),RC=As?bl:Zl(bl,Om),LC=ZR(RC,(r=Tr==null?void 0:Tr.rect)!=null?r:null,ue),Fm=P.useRef(null),ub=P.useCallback((zt,Pn)=>{let{sensor:Rn,options:Pr}=Pn;if(W.current==null)return;const ns=R.get(W.current);if(!ns)return;const Ln=zt.nativeEvent,Zs=new Rn({active:W.current,activeNode:ns,event:Ln,options:Pr,context:Ct,onAbort(kt){if(!R.get(kt))return;const{onDragAbort:ei}=V.current,Ni={id:kt};ei==null||ei(Ni),w({type:"onDragAbort",event:Ni})},onPending(kt,Rr,ei,Ni){if(!R.get(kt))return;const{onDragPending:ku}=V.current,Lr={id:kt,constraint:Rr,initialCoordinates:ei,offset:Ni};ku==null||ku(Lr),w({type:"onDragPending",event:Lr})},onStart(kt){const Rr=W.current;if(Rr==null)return;const ei=R.get(Rr);if(!ei)return;const{onDragStart:Ni}=V.current,Cu={activatorEvent:Ln,active:{id:Rr,data:ei.data,rect:B}};Ul.unstable_batchedUpdates(()=>{Ni==null||Ni(Cu),C(Or.Initializing),v({type:ht.DragStart,initialCoordinates:kt,active:Rr}),w({type:"onDragStart",event:Cu}),j(Fm.current),I(Ln)})},onMove(kt){v({type:ht.DragMove,coordinates:kt})},onEnd:Sl(ht.DragEnd),onCancel:Sl(ht.DragCancel)});Fm.current=Zs;function Sl(kt){return async function(){const{active:ei,collisions:Ni,over:Cu,scrollAdjustedTranslate:ku}=Ct.current;let Lr=null;if(ei&&ku){const{cancelDrop:Tu}=V.current;Lr={activatorEvent:Ln,active:ei,collisions:Ni,delta:ku,over:Cu},kt===ht.DragEnd&&typeof Tu=="function"&&await Promise.resolve(Tu(Lr))&&(kt=ht.DragCancel)}W.current=null,Ul.unstable_batchedUpdates(()=>{v({type:kt}),C(Or.Uninitialized),cb(null),j(null),I(null),Fm.current=null;const Tu=kt===ht.DragEnd?"onDragEnd":"onDragCancel";if(Lr){const jm=V.current[Tu];jm==null||jm(Lr),w({type:Tu,event:Lr})}})}}},[R]),NC=P.useCallback((zt,Pn)=>(Rn,Pr)=>{const ns=Rn.nativeEvent,Ln=R.get(Pr);if(W.current!==null||!Ln||ns.dndKit||ns.defaultPrevented)return;const Zs={active:Ln};zt(Rn,Pn.options,Zs)===!0&&(ns.dndKit={capturedBy:Pn.sensor},W.current=Pr,ub(Rn,Pn))},[R,ub]),db=C2(d,NC);D2(d),Io(()=>{ue&&E===Or.Initializing&&C(Or.Initialized)},[ue,E]),P.useEffect(()=>{const{onDragMove:zt}=V.current,{active:Pn,activatorEvent:Rn,collisions:Pr,over:ns}=Ct.current;if(!Pn||!Rn)return;const Ln={active:Pn,activatorEvent:Rn,collisions:Pr,delta:{x:Tn.x,y:Tn.y},over:ns};Ul.unstable_batchedUpdates(()=>{zt==null||zt(Ln),w({type:"onDragMove",event:Ln})})},[Tn.x,Tn.y]),P.useEffect(()=>{const{active:zt,activatorEvent:Pn,collisions:Rn,droppableContainers:Pr,scrollAdjustedTranslate:ns}=Ct.current;if(!zt||W.current==null||!Pn||!ns)return;const{onDragOver:Ln}=V.current,Zs=Pr.get(xl),Sl=Zs&&Zs.rect.current?{id:Zs.id,rect:Zs.rect.current,data:Zs.data,disabled:Zs.disabled}:null,kt={active:zt,activatorEvent:Pn,collisions:Rn,delta:{x:ns.x,y:ns.y},over:Sl};Ul.unstable_batchedUpdates(()=>{cb(Sl),Ln==null||Ln(kt),w({type:"onDragOver",event:kt})})},[xl]),Io(()=>{Ct.current={activatorEvent:O,active:H,activeNode:fe,collisionRect:Es,collisions:Js,droppableRects:oe,draggableNodes:R,draggingNode:Be,draggingNodeRect:Ae,droppableContainers:L,over:Tr,scrollableAncestors:Qs,scrollAdjustedTranslate:Tn},B.current={initial:Ae,translated:Es}},[H,fe,Js,Es,R,Be,Ae,oe,L,Tr,Qs,Tn]),S2({..._n,delta:M,draggingRect:Es,pointerCoordinates:Hf,scrollableAncestors:Qs,scrollableAncestorRects:Li});const MC=P.useMemo(()=>({active:H,activeNode:fe,activeNodeRect:ue,activatorEvent:O,collisions:Js,containerNodeRect:kn,dragOverlay:ge,draggableNodes:R,droppableContainers:L,droppableRects:oe,over:Tr,measureDroppableContainers:Re,scrollableAncestors:Qs,scrollableAncestorRects:Li,measuringConfiguration:J,measuringScheduled:Xe,windowRect:Ri}),[H,fe,ue,O,Js,kn,ge,R,L,oe,Tr,Re,Qs,Li,J,Xe,Ri]),DC=P.useMemo(()=>({activatorEvent:O,activators:db,active:H,activeNodeRect:ue,ariaDescribedById:{draggable:K},dispatch:v,draggableNodes:R,over:Tr,measureDroppableContainers:Re}),[O,db,H,ue,v,K,R,Tr,Re]);return an.createElement(B1.Provider,{value:b},an.createElement(Em.Provider,{value:DC},an.createElement(U2.Provider,{value:MC},an.createElement(Z1.Provider,{value:LC},u)),an.createElement(W2,{disabled:(a==null?void 0:a.restoreFocus)===!1})),an.createElement(WR,{...a,hiddenTextDescribedById:K}));function IC(){const zt=(ee==null?void 0:ee.autoScrollEnabled)===!1,Pn=typeof c=="object"?c.enabled===!1:c===!1,Rn=T&&!zt&&!Pn;return typeof c=="object"?{...c,enabled:Rn}:{enabled:Rn}}}),Q2=P.createContext(null),Ox="button",J2="Draggable";function eE(n){let{id:e,data:t,disabled:s=!1,attributes:i}=n;const r=Sm(J2),{activators:o,activatorEvent:a,active:c,activeNodeRect:u,ariaDescribedById:d,draggableNodes:h,over:f}=P.useContext(Em),{role:p=Ox,roleDescription:y="draggable",tabIndex:g=0}=i??{},A=(c==null?void 0:c.id)===e,v=P.useContext(A?Z1:Q2),[w,b]=kg(),[E,C]=kg(),T=I2(o,e),k=Hd(t);Io(()=>(h.set(e,{id:e,key:r,node:w,activatorNode:E,data:k}),()=>{const M=h.get(e);M&&M.key===r&&h.delete(e)}),[h,e]);const R=P.useMemo(()=>({role:p,tabIndex:g,"aria-disabled":s,"aria-pressed":A&&p===Ox?!0:void 0,"aria-roledescription":y,"aria-describedby":d.draggable}),[s,p,g,A,y,d.draggable]);return{active:c,activatorEvent:a,activeNodeRect:u,attributes:R,isDragging:A,listeners:s?void 0:T,node:w,over:f,setNodeRef:b,setActivatorNodeRef:C,transform:v}}const Z2="Droppable",eL={timeout:25};function tE(n){let{data:e,disabled:t=!1,id:s,resizeObserverConfig:i}=n;const r=Sm(Z2),{active:o,dispatch:a,over:c,measureDroppableContainers:u}=P.useContext(Em),d=P.useRef({disabled:t}),h=P.useRef(!1),f=P.useRef(null),p=P.useRef(null),{disabled:y,updateMeasurementsFor:g,timeout:A}={...eL,...i},v=Hd(g??s),w=P.useCallback(()=>{if(!h.current){h.current=!0;return}p.current!=null&&clearTimeout(p.current),p.current=setTimeout(()=>{u(Array.isArray(v.current)?v.current:[v.current]),p.current=null},A)},[A]),b=Am({callback:w,disabled:y||!o}),E=P.useCallback((R,M)=>{b&&(M&&(b.unobserve(M),h.current=!1),R&&b.observe(R))},[b]),[C,T]=kg(E),k=Hd(e);return P.useEffect(()=>{!b||!C.current||(b.disconnect(),h.current=!1,b.observe(C.current))},[C,b]),P.useEffect(()=>(a({type:ht.RegisterDroppable,element:{id:s,key:r,disabled:t,node:C,rect:f,data:k}}),()=>a({type:ht.UnregisterDroppable,key:r,id:s})),[s]),P.useEffect(()=>{t!==d.current.disabled&&(a({type:ht.SetDroppableDisabled,id:s,key:r,disabled:t}),d.current.disabled=t)},[s,r,t,a]),{active:o,rect:f,isOver:(c==null?void 0:c.id)===s,node:C,over:c,setNodeRef:T}}const Fu=(n,e)=>{const t=document.getElementById(`port_${n}_${e}`);if(!t)return null;const s=t.closest(".canvas-area-container");if(!s)return null;const i=s.getBoundingClientRect(),r=t.getBoundingClientRect();return{x:r.left-i.left+r.width/2,y:r.top-i.top+r.height/2}},tL=({pendingLink:n,mousePos:e})=>{const t=$(c=>c.links),s=$(c=>c.ghostLinks||[]),i=$(c=>c.canvasComponents),[,r]=P.useState(0);P.useLayoutEffect(()=>{r(c=>c+1)},[t,i]);const o=t.map(c=>{const u=Fu(c.source_id,"output"),d=Fu(c.target_id,"input");return!u||!d?null:_.jsx("line",{x1:u.x,y1:u.y,x2:d.x,y2:d.y,className:"stroke-gray-500 stroke-2"},c.id)}).filter(Boolean);let a=null;if(n){const c=Fu(n.sourceId,n.portId);c&&(a=_.jsx("line",{x1:c.x,y1:c.y,x2:e.x,y2:e.y,className:"stroke-blue-500 stroke-2 stroke-dasharray-4"}))}return _.jsxs("svg",{className:"absolute top-0 left-0 w-full h-full pointer-events-none",children:[o,s.map(c=>{const u=Fu(c.source_id,"output"),d=Fu(c.target_id,"input");return!u||!d?null:_.jsx("line",{x1:u.x,y1:u.y,x2:d.x,y2:d.y,className:"stroke-blue-500 stroke-2",strokeDasharray:"4 4"},c.source_id+c.target_id)}),a]})},nL=()=>{const n=$(s=>s.layers),e=$(s=>s.currentLayer),t=$(s=>s.setCurrentLayer);return _.jsx("div",{className:"flex space-x-2 mb-2","aria-label":"Layer selector",children:n.map(s=>_.jsx("button",{onClick:()=>t(s),className:"px-3 py-1 rounded-md text-sm "+(e===s?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:s},s))})},sL=()=>{const n=$(i=>i.analyzeAndExecute),e=$(i=>i.selectedComponentId),t=$(i=>i.canvasComponents),s=()=>{const i=t.find(r=>r.id===e);i&&n(`generate sub assembly for ${i.name}`)};return _.jsx("button",{onClick:s,disabled:!e,className:"px-2 py-1 text-sm rounded bg-gray-100 hover:bg-gray-200 disabled:opacity-50",children:"Generate Sub-Assembly"})};function nE(n){var e,t,s="";if(typeof n=="string"||typeof n=="number")s+=n;else if(typeof n=="object")if(Array.isArray(n)){var i=n.length;for(e=0;e<i;e++)n[e]&&(t=nE(n[e]))&&(s&&(s+=" "),s+=t)}else for(t in n)n[t]&&(s&&(s+=" "),s+=t);return s}function ki(){for(var n,e,t=0,s="",i=arguments.length;t<i;t++)(n=arguments[t])&&(e=nE(n))&&(s&&(s+=" "),s+=e);return s}const iL=({id:n,port:e,isPending:t,onMouseDown:s,onMouseUp:i})=>{const r=e.type==="in";return _.jsx("div",{id:n,onMouseDown:o=>{o.stopPropagation(),s(e.id,o)},onMouseUp:o=>{o.stopPropagation(),i(e.id,o)},className:ki("absolute top-1/2 -translate-y-1/2 w-4 h-4 rounded-full border-2 border-white cursor-crosshair z-10 transition-transform",{" -left-2 bg-green-400":r," -right-2 bg-red-400":!r,"transform scale-150 shadow-lg":t})})},rL=({component:n,isPendingLinkSource:e,onStartLink:t,onEndLink:s})=>{const{selectedComponentId:i,selectComponent:r,deleteComponent:o}=$(),a=i===n.id,{attributes:c,listeners:u,setNodeRef:d,transform:h}=eE({id:n.id,data:{type:"canvas-card"}}),f={top:n.y,left:n.x,transform:h?`translate3d(${h.x}px, ${h.y}px, 0)`:void 0,position:"absolute"};return _.jsxs("div",{id:`component-card-${n.id}`,ref:d,style:f,onClick:()=>r(n.id),onContextMenu:p=>{p.preventDefault(),window.confirm(`Are you sure you want to delete "${n.name}"?`)&&o(n.id)},className:ki("absolute h-24 w-32 bg-white border-2 rounded-lg shadow-sm flex flex-col items-center justify-center p-2 cursor-grab",{"border-blue-500 ring-2 ring-blue-500":a,"border-gray-300":!a}),children:[_.jsx("div",{...u,...c,className:"w-full h-full cursor-grab"}),_.jsxs("div",{className:"absolute top-0 left-0 w-full h-full flex flex-col items-center justify-center pointer-events-none",children:[_.jsx("span",{className:"text-sm font-bold",children:n.name}),_.jsx("span",{className:"text-xs text-gray-500",children:n.type})]}),n.ports.map(p=>_.jsx(iL,{id:`port_${n.id}_${p.id}`,port:p,isPending:e&&p.id==="output",onMouseDown:y=>t(n.id,y),onMouseUp:y=>s(n.id,y)},p.id))]})},oL=({pendingLinkSourceId:n,onStartLink:e,onEndLink:t})=>{const{setNodeRef:s}=tE({id:"canvas-area"}),i=$(a=>a.currentLayer),o=$(a=>a.canvasComponents).filter(a=>!a.layer||a.layer===i);return _.jsx("div",{className:"flex-grow h-full relative",children:_.jsx("div",{ref:s,className:"canvas-area-container w-full h-full border-2 border-dashed border-gray-300 rounded-lg",children:o.map(a=>_.jsx(rL,{component:a,isPendingLinkSource:n===a.id,onStartLink:e,onEndLink:t},a.id))})})},aL=()=>{const{addComponent:n,updateComponentPosition:e,addLink:t,fetchProject:s,selectedComponentId:i,deleteComponent:r}=$();P.useEffect(()=>{s()},[s]),P.useEffect(()=>{const y=g=>{(g.key==="Delete"||g.key==="Backspace")&&i&&r(i)};return window.addEventListener("keydown",y),()=>window.removeEventListener("keydown",y)},[i,r]);const[o,a]=P.useState(null),[c,u]=P.useState({x:0,y:0}),d=(y,g)=>{g==="output"&&a({sourceId:y,portId:g})},h=async(y,g)=>{o&&g==="input"&&o.sourceId!==y&&await t({source_id:o.sourceId,target_id:y}),a(null)},f=y=>{if(o){const g=y.currentTarget.getBoundingClientRect();u({x:y.clientX-g.left,y:y.clientY-g.top})}},p=()=>{a(null)};return _.jsxs("div",{className:"flex-grow h-full relative flex flex-col",onMouseMove:f,onMouseUp:p,children:[_.jsxs("div",{className:"p-2 flex flex-col space-y-2 sm:flex-row sm:space-y-0 sm:space-x-2",children:[_.jsx(nL,{}),_.jsx(sL,{})]}),_.jsxs("div",{className:"flex-grow relative",children:[_.jsx(tL,{pendingLink:o,mousePos:c}),_.jsx(oL,{pendingLinkSourceId:(o==null?void 0:o.sourceId)??null,onStartLink:d,onEndLink:h})]})]})},lL="modulepreload",cL=function(n){return"/"+n},Fx={},uL=function(e,t,s){let i=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(t.map(c=>{if(c=cL(c),c in Fx)return;Fx[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":lL,u||(h.as="script"),h.crossOrigin="",h.href=c,a&&h.setAttribute("nonce",a),document.head.appendChild(h),u)return new Promise((f,p)=>{h.addEventListener("load",f),h.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${c}`)))})}))}function r(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&r(a.reason);return e().catch(r)})},rn=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),Av=[.001,0,0,.001,0,0],yy=1.35,Wn={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Ai={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},dL="pdfjs_internal_editor_",te={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,SIGNATURE:101},he={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},sE={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Ht={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Ad={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Qe={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},El={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Mf={ERRORS:0,WARNINGS:1,INFOS:5},Vd={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},ap={moveTo:0,lineTo:1,curveTo:2,closePath:3},iE={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let _m=Mf.WARNINGS;function hL(n){Number.isInteger(n)&&(_m=n)}function fL(){return _m}function Cm(n){_m>=Mf.INFOS&&console.log(`Info: ${n}`)}function ne(n){_m>=Mf.WARNINGS&&console.log(`Warning: ${n}`)}function Ce(n){throw new Error(n)}function ot(n,e){n||Ce(e)}function pL(n){switch(n==null?void 0:n.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Hw(n,e=null,t=null){if(!n)return null;if(t&&typeof n=="string"){if(t.addDefaultProtocol&&n.startsWith("www.")){const i=n.match(/\./g);(i==null?void 0:i.length)>=2&&(n=`http://${n}`)}if(t.tryConvertEncoding)try{n=wL(n)}catch{}}const s=e?URL.parse(n,e):URL.parse(n);return pL(s)?s:null}function Uw(n,e,t=!1){const s=URL.parse(n);return s?(s.hash=e,s.href):t&&Hw(n,"http://example.com")?n.split("#",1)[0]+`${e?`#${e}`:""}`:""}function le(n,e,t,s=!1){return Object.defineProperty(n,e,{value:t,enumerable:!s,configurable:!0,writable:!1}),t}const vl=function(){function e(t,s){this.message=t,this.name=s}return e.prototype=new Error,e.constructor=e,e}();class jx extends vl{constructor(e,t){super(e,"PasswordException"),this.code=t}}class vy extends vl{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class Lg extends vl{constructor(e){super(e,"InvalidPDFException")}}class Gd extends vl{constructor(e,t,s){super(e,"ResponseException"),this.status=t,this.missing=s}}class gL extends vl{constructor(e){super(e,"FormatError")}}class Er extends vl{constructor(e){super(e,"AbortException")}}function rE(n){(typeof n!="object"||(n==null?void 0:n.length)===void 0)&&Ce("Invalid argument for bytesToString");const e=n.length,t=8192;if(e<t)return String.fromCharCode.apply(null,n);const s=[];for(let i=0;i<e;i+=t){const r=Math.min(i+t,e),o=n.subarray(i,r);s.push(String.fromCharCode.apply(null,o))}return s.join("")}function Df(n){typeof n!="string"&&Ce("Invalid argument for stringToBytes");const e=n.length,t=new Uint8Array(e);for(let s=0;s<e;++s)t[s]=n.charCodeAt(s)&255;return t}function mL(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function yL(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function vL(){try{return new Function(""),!0}catch{return!1}}class _t{static get isLittleEndian(){return le(this,"isLittleEndian",yL())}static get isEvalSupported(){return le(this,"isEvalSupported",vL())}static get isOffscreenCanvasSupported(){return le(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return le(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return le(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){var e,t;return le(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const wy=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));var vr,kp,Ev;class Q{static makeHexColor(e,t,s){return`#${wy[e]}${wy[t]}${wy[s]}`}static scaleMinMax(e,t){let s;e[0]?(e[0]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[3],t[3]*=e[3]):(s=t[0],t[0]=t[1],t[1]=s,s=t[2],t[2]=t[3],t[3]=s,e[1]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t,s=0){const i=e[s],r=e[s+1];e[s]=i*t[0]+r*t[2]+t[4],e[s+1]=i*t[1]+r*t[3]+t[5]}static applyTransformToBezier(e,t,s=0){const i=t[0],r=t[1],o=t[2],a=t[3],c=t[4],u=t[5];for(let d=0;d<6;d+=2){const h=e[s+d],f=e[s+d+1];e[s+d]=h*i+f*o+c,e[s+d+1]=h*r+f*a+u}}static applyInverseTransform(e,t){const s=e[0],i=e[1],r=t[0]*t[3]-t[1]*t[2];e[0]=(s*t[3]-i*t[2]+t[2]*t[5]-t[4]*t[3])/r,e[1]=(-s*t[1]+i*t[0]+t[4]*t[1]-t[5]*t[0])/r}static axialAlignedBoundingBox(e,t,s){const i=t[0],r=t[1],o=t[2],a=t[3],c=t[4],u=t[5],d=e[0],h=e[1],f=e[2],p=e[3];let y=i*d+c,g=y,A=i*f+c,v=A,w=a*h+u,b=w,E=a*p+u,C=E;if(r!==0||o!==0){const T=r*d,k=r*f,R=o*h,M=o*p;y+=R,v+=R,A+=M,g+=M,w+=T,C+=T,E+=k,b+=k}s[0]=Math.min(s[0],y,A,g,v),s[1]=Math.min(s[1],w,E,b,C),s[2]=Math.max(s[2],y,A,g,v),s[3]=Math.max(s[3],w,E,b,C)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const s=e[0],i=e[1],r=e[2],o=e[3],a=s**2+i**2,c=s*r+i*o,u=r**2+o**2,d=(a+u)/2,h=Math.sqrt(d**2-(a*u-c**2));t[0]=Math.sqrt(d+h||1),t[1]=Math.sqrt(d-h||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const s=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),i=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(s>i)return null;const r=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),o=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return r>o?null:[s,r,i,o]}static pointBoundingBox(e,t,s){s[0]=Math.min(s[0],e),s[1]=Math.min(s[1],t),s[2]=Math.max(s[2],e),s[3]=Math.max(s[3],t)}static rectBoundingBox(e,t,s,i,r){r[0]=Math.min(r[0],e,s),r[1]=Math.min(r[1],t,i),r[2]=Math.max(r[2],e,s),r[3]=Math.max(r[3],t,i)}static bezierBoundingBox(e,t,s,i,r,o,a,c,u){u[0]=Math.min(u[0],e,a),u[1]=Math.min(u[1],t,c),u[2]=Math.max(u[2],e,a),u[3]=Math.max(u[3],t,c),S(this,vr,Ev).call(this,e,s,r,a,t,i,o,c,3*(-e+3*(s-r)+a),6*(e-2*s+r),3*(s-e),u),S(this,vr,Ev).call(this,e,s,r,a,t,i,o,c,3*(-t+3*(i-o)+c),6*(t-2*i+o),3*(i-t),u)}}vr=new WeakSet,kp=function(e,t,s,i,r,o,a,c,u,d){if(u<=0||u>=1)return;const h=1-u,f=u*u,p=f*u,y=h*(h*(h*e+3*u*t)+3*f*s)+p*i,g=h*(h*(h*r+3*u*o)+3*f*a)+p*c;d[0]=Math.min(d[0],y),d[1]=Math.min(d[1],g),d[2]=Math.max(d[2],y),d[3]=Math.max(d[3],g)},Ev=function(e,t,s,i,r,o,a,c,u,d,h,f){if(Math.abs(u)<1e-12){Math.abs(d)>=1e-12&&S(this,vr,kp).call(this,e,t,s,i,r,o,a,c,-h/d,f);return}const p=d**2-4*h*u;if(p<0)return;const y=Math.sqrt(p),g=2*u;S(this,vr,kp).call(this,e,t,s,i,r,o,a,c,(-d+y)/g,f),S(this,vr,kp).call(this,e,t,s,i,r,o,a,c,(-d-y)/g,f)},x(Q,vr);function wL(n){return decodeURIComponent(escape(n))}let by=null,zx=null;function oE(n){return by||(by=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,zx=new Map([["","t"]])),n.replaceAll(by,(e,t,s)=>t?t.normalize("NFKC"):zx.get(s))}function Vw(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),rE(n)}const Gw="pdfjs_internal_id_";function bL(n,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[s,i,...r]=t;if(!n(s)&&!Number.isInteger(s)||!e(i))return!1;const o=r.length;let a=!0;switch(i.name){case"XYZ":if(o<2||o>3)return!1;break;case"Fit":case"FitB":return o===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(o>1)return!1;break;case"FitR":if(o!==4)return!1;a=!1;break;default:return!1}for(const c of r)if(!(typeof c=="number"||a&&c===null))return!1;return!0}function qt(n,e,t){return Math.min(Math.max(n,e),t)}function aE(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(rE(n))}function xL(n){return Uint8Array.fromBase64?Uint8Array.fromBase64(n):Df(atob(n))}typeof Promise.try!="function"&&(Promise.try=function(n,...e){return new Promise(t=>{t(n(...e))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(n){return n.reduce((e,t)=>e+t,0)});const Mi="http://www.w3.org/2000/svg",Ko=class Ko{};F(Ko,"CSS",96),F(Ko,"PDF",72),F(Ko,"PDF_TO_CSS_UNITS",Ko.CSS/Ko.PDF);let _r=Ko;async function _u(n,e="text"){if(Wu(n,document.baseURI)){const t=await fetch(n);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,s)=>{const i=new XMLHttpRequest;i.open("GET",n,!0),i.responseType=e,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){if(i.status===200||i.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(i.response);return}t(i.responseText);return}s(new Error(i.statusText))}},i.send(null)})}class If{constructor({viewBox:e,userUnit:t,scale:s,rotation:i,offsetX:r=0,offsetY:o=0,dontFlip:a=!1}){this.viewBox=e,this.userUnit=t,this.scale=s,this.rotation=i,this.offsetX=r,this.offsetY=o,s*=t;const c=(e[2]+e[0])/2,u=(e[3]+e[1])/2;let d,h,f,p;switch(i%=360,i<0&&(i+=360),i){case 180:d=-1,h=0,f=0,p=1;break;case 90:d=0,h=1,f=1,p=0;break;case 270:d=0,h=-1,f=-1,p=0;break;case 0:d=1,h=0,f=0,p=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}a&&(f=-f,p=-p);let y,g,A,v;d===0?(y=Math.abs(u-e[1])*s+r,g=Math.abs(c-e[0])*s+o,A=(e[3]-e[1])*s,v=(e[2]-e[0])*s):(y=Math.abs(c-e[0])*s+r,g=Math.abs(u-e[1])*s+o,A=(e[2]-e[0])*s,v=(e[3]-e[1])*s),this.transform=[d*s,h*s,f*s,p*s,y-d*s*c-f*s*u,g-h*s*c-p*s*u],this.width=A,this.height=v}get rawDims(){const e=this.viewBox;return le(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:s=this.offsetX,offsetY:i=this.offsetY,dontFlip:r=!1}={}){return new If({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:s,offsetY:i,dontFlip:r})}convertToViewportPoint(e,t){const s=[e,t];return Q.applyTransform(s,this.transform),s}convertToViewportRectangle(e){const t=[e[0],e[1]];Q.applyTransform(t,this.transform);const s=[e[2],e[3]];return Q.applyTransform(s,this.transform),[t[0],t[1],s[0],s[1]]}convertToPdfPoint(e,t){const s=[e,t];return Q.applyInverseTransform(s,this.transform),s}}class km extends vl{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function Of(n){const e=n.length;let t=0;for(;t<e&&n[t].trim()==="";)t++;return n.substring(t,t+5).toLowerCase()==="data:"}function Tm(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function lE(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function cE(n,e="document.pdf"){if(typeof n!="string")return e;if(Of(n))return ne('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const t=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,s=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,i=t.exec(n);let r=s.exec(i[1])||s.exec(i[2])||s.exec(i[3]);if(r&&(r=r[0],r.includes("%")))try{r=s.exec(decodeURIComponent(r))[0]}catch{}return r||e}class $x{constructor(){F(this,"started",Object.create(null));F(this,"times",[])}time(e){e in this.started&&ne(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||ne(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:s}of this.times)t=Math.max(s.length,t);for(const{name:s,start:i,end:r}of this.times)e.push(`${s.padEnd(t)} ${r-i}ms
`);return e.join("")}}function Wu(n,e){const t=e?URL.parse(n,e):URL.parse(n);return(t==null?void 0:t.protocol)==="http:"||(t==null?void 0:t.protocol)==="https:"}function Ss(n){n.preventDefault()}function et(n){n.preventDefault(),n.stopPropagation()}function SL(n){console.log("Deprecated API usage: "+n)}var Qd;class Pm{static toDateObject(e){if(!e||typeof e!="string")return null;l(this,Qd)||m(this,Qd,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=l(this,Qd).exec(e);if(!t)return null;const s=parseInt(t[1],10);let i=parseInt(t[2],10);i=i>=1&&i<=12?i-1:0;let r=parseInt(t[3],10);r=r>=1&&r<=31?r:1;let o=parseInt(t[4],10);o=o>=0&&o<=23?o:0;let a=parseInt(t[5],10);a=a>=0&&a<=59?a:0;let c=parseInt(t[6],10);c=c>=0&&c<=59?c:0;const u=t[7]||"Z";let d=parseInt(t[8],10);d=d>=0&&d<=23?d:0;let h=parseInt(t[9],10)||0;return h=h>=0&&h<=59?h:0,u==="-"?(o+=d,a+=h):u==="+"&&(o-=d,a-=h),new Date(Date.UTC(s,i,r,o,a,c))}}Qd=new WeakMap,x(Pm,Qd);function uE(n,{scale:e=1,rotation:t=0}){const{width:s,height:i}=n.attributes.style,r=[0,0,parseInt(s),parseInt(i)];return new If({viewBox:r,userUnit:1,scale:e,rotation:t})}function Ww(n){if(n.startsWith("#")){const e=parseInt(n.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(e=>parseInt(e)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(ne(`Not a valid color format: "${n}"`),[0,0,0])}function AL(n){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of n.keys()){e.style.color=t;const s=window.getComputedStyle(e).color;n.set(t,Ww(s))}e.remove()}function Ue(n){const{a:e,b:t,c:s,d:i,e:r,f:o}=n.getTransform();return[e,t,s,i,r,o]}function ni(n){const{a:e,b:t,c:s,d:i,e:r,f:o}=n.getTransform().invertSelf();return[e,t,s,i,r,o]}function Oo(n,e,t=!1,s=!0){if(e instanceof If){const{pageWidth:i,pageHeight:r}=e.rawDims,{style:o}=n,a=_t.isCSSRoundSupported,c=`var(--total-scale-factor) * ${i}px`,u=`var(--total-scale-factor) * ${r}px`,d=a?`round(down, ${c}, var(--scale-round-x))`:`calc(${c})`,h=a?`round(down, ${u}, var(--scale-round-y))`:`calc(${u})`;!t||e.rotation%180===0?(o.width=d,o.height=h):(o.width=h,o.height=d)}s&&n.setAttribute("data-main-rotation",e.rotation)}class Ys{constructor(){const{pixelRatio:e}=Ys;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,s,i,r=-1){let o=1/0,a=1/0,c=1/0;s=Ys.capPixels(s,r),s>0&&(o=Math.sqrt(s/(e*t))),i!==-1&&(a=i/e,c=i/t);const u=Math.min(o,a,c);return this.sx>u||this.sy>u?(this.sx=u,this.sy=u,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const s=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,s):s}return e}}const Ng=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];var zr,ta,is,$r,Jd,sc,Zd,zg,dE,Ot,hE,fE,Xu,pE,Tp;const Fi=class Fi{constructor(e){x(this,Ot);x(this,zr,null);x(this,ta,null);x(this,is);x(this,$r,null);x(this,Jd,null);x(this,sc,null);m(this,is,e),l(Fi,Zd)||m(Fi,Zd,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const e=m(this,zr,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=l(this,is)._uiManager._signal;e.addEventListener("contextmenu",Ss,{signal:t}),e.addEventListener("pointerdown",S(Fi,zg,dE),{signal:t});const s=m(this,$r,document.createElement("div"));s.className="buttons",e.append(s);const i=l(this,is).toolbarPosition;if(i){const{style:r}=e,o=l(this,is)._uiManager.direction==="ltr"?1-i[0]:i[0];r.insetInlineEnd=`${100*o}%`,r.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return S(this,Ot,pE).call(this),e}get div(){return l(this,zr)}hide(){var e;l(this,zr).classList.add("hidden"),(e=l(this,ta))==null||e.hideDropdown()}show(){var e;l(this,zr).classList.remove("hidden"),(e=l(this,Jd))==null||e.shown()}async addAltText(e){const t=await e.render();S(this,Ot,Xu).call(this,t),l(this,$r).prepend(t,l(this,Ot,Tp)),m(this,Jd,e)}addColorPicker(e){m(this,ta,e);const t=e.renderButton();S(this,Ot,Xu).call(this,t),l(this,$r).prepend(t,l(this,Ot,Tp))}async addEditSignatureButton(e){const t=m(this,sc,await e.renderEditButton(l(this,is)));S(this,Ot,Xu).call(this,t),l(this,$r).prepend(t,l(this,Ot,Tp))}updateEditSignatureButton(e){l(this,sc)&&(l(this,sc).title=e)}remove(){var e;l(this,zr).remove(),(e=l(this,ta))==null||e.destroy(),m(this,ta,null)}};zr=new WeakMap,ta=new WeakMap,is=new WeakMap,$r=new WeakMap,Jd=new WeakMap,sc=new WeakMap,Zd=new WeakMap,zg=new WeakSet,dE=function(e){e.stopPropagation()},Ot=new WeakSet,hE=function(e){l(this,is)._focusEventsAllowed=!1,et(e)},fE=function(e){l(this,is)._focusEventsAllowed=!0,et(e)},Xu=function(e){const t=l(this,is)._uiManager._signal;e.addEventListener("focusin",S(this,Ot,hE).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",S(this,Ot,fE).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",Ss,{signal:t})},pE=function(){const{editorType:e,_uiManager:t}=l(this,is),s=document.createElement("button");s.className="delete",s.tabIndex=0,s.setAttribute("data-l10n-id",l(Fi,Zd)[e]),S(this,Ot,Xu).call(this,s),s.addEventListener("click",i=>{t.delete()},{signal:t._signal}),l(this,$r).append(s)},Tp=function(){const e=document.createElement("div");return e.className="divider",e},x(Fi,zg),x(Fi,Zd,null);let _v=Fi;var eh,na,sa,jo,gE,mE,yE;class EL{constructor(e){x(this,jo);x(this,eh,null);x(this,na,null);x(this,sa);m(this,sa,e)}show(e,t,s){const[i,r]=S(this,jo,mE).call(this,t,s),{style:o}=l(this,na)||m(this,na,S(this,jo,gE).call(this));e.append(l(this,na)),o.insetInlineEnd=`${100*i}%`,o.top=`calc(${100*r}% + var(--editor-toolbar-vert-offset))`}hide(){l(this,na).remove()}}eh=new WeakMap,na=new WeakMap,sa=new WeakMap,jo=new WeakSet,gE=function(){const e=m(this,na,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",Ss,{signal:l(this,sa)._signal});const t=m(this,eh,document.createElement("div"));return t.className="buttons",e.append(t),S(this,jo,yE).call(this),e},mE=function(e,t){let s=0,i=0;for(const r of e){const o=r.y+r.height;if(o<s)continue;const a=r.x+(t?r.width:0);if(o>s){i=a,s=o;continue}t?a>i&&(i=a):a<i&&(i=a)}return[t?1-i:i,s]},yE=function(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const s=l(this,sa)._signal;e.addEventListener("contextmenu",Ss,{signal:s}),e.addEventListener("click",()=>{l(this,sa).highlightSelection("floating_button")},{signal:s}),l(this,eh).append(e)};function vE(n,e,t){for(const s of t)e.addEventListener(s,n[s].bind(n))}var $g;class _L{constructor(){x(this,$g,0)}get id(){return`${dL}${Jt(this,$g)._++}`}}$g=new WeakMap;var ic,th,Vt,rc,Pp;const rb=class rb{constructor(){x(this,rc);x(this,ic,Vw());x(this,th,0);x(this,Vt,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',s=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),i=new Image;i.src=e;const r=i.decode().then(()=>(s.drawImage(i,0,0,1,1,0,0,1,3),new Uint32Array(s.getImageData(0,0,1,1).data.buffer)[0]===0));return le(this,"_isSVGFittingCanvas",r)}async getFromFile(e){const{lastModified:t,name:s,size:i,type:r}=e;return S(this,rc,Pp).call(this,`${t}_${s}_${i}_${r}`,e)}async getFromUrl(e){return S(this,rc,Pp).call(this,e,e)}async getFromBlob(e,t){const s=await t;return S(this,rc,Pp).call(this,e,s)}async getFromId(e){l(this,Vt)||m(this,Vt,new Map);const t=l(this,Vt).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:s}=t;return delete t.blobPromise,this.getFromBlob(t.id,s)}return this.getFromUrl(t.url)}getFromCanvas(e,t){l(this,Vt)||m(this,Vt,new Map);let s=l(this,Vt).get(e);if(s!=null&&s.bitmap)return s.refCounter+=1,s;const i=new OffscreenCanvas(t.width,t.height);return i.getContext("2d").drawImage(t,0,0),s={bitmap:i.transferToImageBitmap(),id:`image_${l(this,ic)}_${Jt(this,th)._++}`,refCounter:1,isSvg:!1},l(this,Vt).set(e,s),l(this,Vt).set(s.id,s),s}getSvgUrl(e){const t=l(this,Vt).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var i;l(this,Vt)||m(this,Vt,new Map);const t=l(this,Vt).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:s}=t;if(!t.url&&!t.file){const r=new OffscreenCanvas(s.width,s.height);r.getContext("bitmaprenderer").transferFromImageBitmap(s),t.blobPromise=r.convertToBlob()}(i=s.close)==null||i.call(s),t.bitmap=null}isValidId(e){return e.startsWith(`image_${l(this,ic)}_`)}};ic=new WeakMap,th=new WeakMap,Vt=new WeakMap,rc=new WeakSet,Pp=async function(e,t){l(this,Vt)||m(this,Vt,new Map);let s=l(this,Vt).get(e);if(s===null)return null;if(s!=null&&s.bitmap)return s.refCounter+=1,s;try{s||(s={bitmap:null,id:`image_${l(this,ic)}_${Jt(this,th)._++}`,refCounter:0,isSvg:!1});let i;if(typeof t=="string"?(s.url=t,i=await _u(t,"blob")):t instanceof File?i=s.file=t:t instanceof Blob&&(i=t),i.type==="image/svg+xml"){const r=rb._isSVGFittingCanvas,o=new FileReader,a=new Image,c=new Promise((u,d)=>{a.onload=()=>{s.bitmap=a,s.isSvg=!0,u()},o.onload=async()=>{const h=s.svgUrl=o.result;a.src=await r?`${h}#svgView(preserveAspectRatio(none))`:h},a.onerror=o.onerror=d});o.readAsDataURL(i),await c}else s.bitmap=await createImageBitmap(i);s.refCounter=1}catch(i){ne(i),s=null}return l(this,Vt).set(e,s),s&&l(this,Vt).set(s.id,s),s};let Cv=rb;var Je,Br,nh,He;class CL{constructor(e=128){x(this,Je,[]);x(this,Br,!1);x(this,nh);x(this,He,-1);m(this,nh,e)}add({cmd:e,undo:t,post:s,mustExec:i,type:r=NaN,overwriteIfSameType:o=!1,keepUndo:a=!1}){if(i&&e(),l(this,Br))return;const c={cmd:e,undo:t,post:s,type:r};if(l(this,He)===-1){l(this,Je).length>0&&(l(this,Je).length=0),m(this,He,0),l(this,Je).push(c);return}if(o&&l(this,Je)[l(this,He)].type===r){a&&(c.undo=l(this,Je)[l(this,He)].undo),l(this,Je)[l(this,He)]=c;return}const u=l(this,He)+1;u===l(this,nh)?l(this,Je).splice(0,1):(m(this,He,u),u<l(this,Je).length&&l(this,Je).splice(u)),l(this,Je).push(c)}undo(){if(l(this,He)===-1)return;m(this,Br,!0);const{undo:e,post:t}=l(this,Je)[l(this,He)];e(),t==null||t(),m(this,Br,!1),m(this,He,l(this,He)-1)}redo(){if(l(this,He)<l(this,Je).length-1){m(this,He,l(this,He)+1),m(this,Br,!0);const{cmd:e,post:t}=l(this,Je)[l(this,He)];e(),t==null||t(),m(this,Br,!1)}}hasSomethingToUndo(){return l(this,He)!==-1}hasSomethingToRedo(){return l(this,He)<l(this,Je).length-1}cleanType(e){if(l(this,He)!==-1){for(let t=l(this,He);t>=0;t--)if(l(this,Je)[t].type!==e){l(this,Je).splice(t+1,l(this,He)-t),m(this,He,t);return}l(this,Je).length=0,m(this,He,-1)}}destroy(){m(this,Je,null)}}Je=new WeakMap,Br=new WeakMap,nh=new WeakMap,He=new WeakMap;var Bg,wE;class Ff{constructor(e){x(this,Bg);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=_t.platform;for(const[s,i,r={}]of e)for(const o of s){const a=o.startsWith("mac+");t&&a?(this.callbacks.set(o.slice(4),{callback:i,options:r}),this.allKeys.add(o.split("+").at(-1))):!t&&!a&&(this.callbacks.set(o,{callback:i,options:r}),this.allKeys.add(o.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const s=this.callbacks.get(S(this,Bg,wE).call(this,t));if(!s)return;const{callback:i,options:{bubbles:r=!1,args:o=[],checker:a=null}}=s;a&&!a(e,t)||(i.bind(e,...o,t)(),r||et(t))}}Bg=new WeakSet,wE=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const Hg=class Hg{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return AL(e),le(this,"_colors",e)}convert(e){const t=Ww(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[s,i]of this._colors)if(i.every((r,o)=>r===t[o]))return Hg._colorsMapping.get(s);return t}getHexCode(e){const t=this._colors.get(e);return t?Q.makeHexColor(...t):e}};F(Hg,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let kv=Hg;var oc,Mn,ct,Tt,ac,$i,lc,rs,Hr,Ur,cc,ia,oi,Ps,ra,sh,ih,uc,rh,ai,Vr,dc,Gr,li,Ug,Wr,oh,Xr,oa,aa,qr,ah,mt,xe,Bi,Yr,la,lh,ch,Kr,ci,Hi,uh,os,z,Rp,Tv,bE,xE,Lp,SE,AE,EE,Pv,_E,Rv,Lv,CE,Zt,Di,kE,TE,Nv,PE,qu,Mv;const Gl=class Gl{constructor(e,t,s,i,r,o,a,c,u,d,h,f,p,y){x(this,z);x(this,oc,new AbortController);x(this,Mn,null);x(this,ct,new Map);x(this,Tt,new Map);x(this,ac,null);x(this,$i,null);x(this,lc,null);x(this,rs,new CL);x(this,Hr,null);x(this,Ur,null);x(this,cc,0);x(this,ia,new Set);x(this,oi,null);x(this,Ps,null);x(this,ra,new Set);F(this,"_editorUndoBar",null);x(this,sh,!1);x(this,ih,!1);x(this,uc,!1);x(this,rh,null);x(this,ai,null);x(this,Vr,null);x(this,dc,null);x(this,Gr,!1);x(this,li,null);x(this,Ug,new _L);x(this,Wr,!1);x(this,oh,!1);x(this,Xr,null);x(this,oa,null);x(this,aa,null);x(this,qr,null);x(this,ah,null);x(this,mt,te.NONE);x(this,xe,new Set);x(this,Bi,null);x(this,Yr,null);x(this,la,null);x(this,lh,null);x(this,ch,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});x(this,Kr,[0,0]);x(this,ci,null);x(this,Hi,null);x(this,uh,null);x(this,os,null);const g=this._signal=l(this,oc).signal;m(this,Hi,e),m(this,uh,t),m(this,ac,s),m(this,Yr,i),this._eventBus=r,r._on("editingaction",this.onEditingAction.bind(this),{signal:g}),r._on("pagechanging",this.onPageChanging.bind(this),{signal:g}),r._on("scalechanging",this.onScaleChanging.bind(this),{signal:g}),r._on("rotationchanging",this.onRotationChanging.bind(this),{signal:g}),r._on("setpreference",this.onSetPreference.bind(this),{signal:g}),r._on("switchannotationeditorparams",A=>this.updateParams(A.type,A.value),{signal:g}),S(this,z,SE).call(this),S(this,z,CE).call(this),S(this,z,Pv).call(this),m(this,$i,o.annotationStorage),m(this,rh,o.filterFactory),m(this,la,a),m(this,dc,c||null),m(this,sh,u),m(this,ih,d),m(this,uc,h),m(this,ah,f||null),this.viewParameters={realScale:_r.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=p||null,this._supportsPinchToZoom=y!==!1}static get _keyboardManager(){const e=Gl.prototype,t=o=>l(o,Hi).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&o.hasSomethingToControl(),s=(o,{target:a})=>{if(a instanceof HTMLInputElement){const{type:c}=a;return c!=="text"&&c!=="number"}return!0},i=this.TRANSLATE_SMALL,r=this.TRANSLATE_BIG;return le(this,"_keyboardManager",new Ff([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],e.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:s}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(o,{target:a})=>!(a instanceof HTMLButtonElement)&&l(o,Hi).contains(a)&&!o.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(o,{target:a})=>!(a instanceof HTMLButtonElement)&&l(o,Hi).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-r,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[r,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-r],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,r],checker:t}]]))}destroy(){var e,t,s,i,r,o,a,c;(e=l(this,os))==null||e.resolve(),m(this,os,null),(t=l(this,oc))==null||t.abort(),m(this,oc,null),this._signal=null;for(const u of l(this,Tt).values())u.destroy();l(this,Tt).clear(),l(this,ct).clear(),l(this,ra).clear(),(s=l(this,qr))==null||s.clear(),m(this,Mn,null),l(this,xe).clear(),l(this,rs).destroy(),(i=l(this,ac))==null||i.destroy(),(r=l(this,Yr))==null||r.destroy(),(o=l(this,li))==null||o.hide(),m(this,li,null),(a=l(this,aa))==null||a.destroy(),m(this,aa,null),l(this,ai)&&(clearTimeout(l(this,ai)),m(this,ai,null)),l(this,ci)&&(clearTimeout(l(this,ci)),m(this,ci,null)),(c=this._editorUndoBar)==null||c.destroy()}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return l(this,ah)}get useNewAltTextFlow(){return l(this,ih)}get useNewAltTextWhenAddingImage(){return l(this,uc)}get hcmFilter(){return le(this,"hcmFilter",l(this,la)?l(this,rh).addHCMFilter(l(this,la).foreground,l(this,la).background):"none")}get direction(){return le(this,"direction",getComputedStyle(l(this,Hi)).direction)}get highlightColors(){return le(this,"highlightColors",l(this,dc)?new Map(l(this,dc).split(",").map(e=>e.split("=").map(t=>t.trim()))):null)}get highlightColorNames(){return le(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),m(this,Ur,e)}setMainHighlightColorPicker(e){m(this,aa,e)}editAltText(e,t=!1){var s;(s=l(this,ac))==null||s.editAltText(this,e,t)}getSignature(e){var t;(t=l(this,Yr))==null||t.getSignature({uiManager:this,editor:e})}get signatureManager(){return l(this,Yr)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":m(this,uc,t);break}}onPageChanging({pageNumber:e}){m(this,cc,e-1)}focusMainContainer(){l(this,Hi).focus()}findParent(e,t){for(const s of l(this,Tt).values()){const{x:i,y:r,width:o,height:a}=s.div.getBoundingClientRect();if(e>=i&&e<=i+o&&t>=r&&t<=r+a)return s}return null}disableUserSelect(e=!1){l(this,uh).classList.toggle("noUserSelect",e)}addShouldRescale(e){l(this,ra).add(e)}removeShouldRescale(e){l(this,ra).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*_r.PDF_TO_CSS_UNITS;for(const s of l(this,ra))s.onScaleChanging();(t=l(this,Ur))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e=""){const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:s,anchorOffset:i,focusNode:r,focusOffset:o}=t,a=t.toString(),u=S(this,z,Rp).call(this,t).closest(".textLayer"),d=this.getSelectionBoxes(u);if(!d)return;t.empty();const h=S(this,z,Tv).call(this,u),f=l(this,mt)===te.NONE,p=()=>{h==null||h.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:d,anchorNode:s,anchorOffset:i,focusNode:r,focusOffset:o,text:a}),f&&this.showAllEditors("highlight",!0,!0)};if(f){this.switchToMode(te.HIGHLIGHT,p);return}p()}addToAnnotationStorage(e){!e.isEmpty()&&l(this,$i)&&!l(this,$i).has(e.id)&&l(this,$i).setValue(e.id,e)}blur(){if(this.isShiftKeyDown=!1,l(this,Gr)&&(m(this,Gr,!1),S(this,z,Lp).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of l(this,xe))if(t.div.contains(e)){m(this,oa,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!l(this,oa))return;const[e,t]=l(this,oa);m(this,oa,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){S(this,z,Pv).call(this),S(this,z,Rv).call(this)}removeEditListeners(){S(this,z,_E).call(this),S(this,z,Lv).call(this)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const s of l(this,Ps))if(s.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const s of l(this,Ps))if(s.isHandlingMimeForPasting(t.type)){s.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var s;if(e.preventDefault(),(s=l(this,Mn))==null||s.commitOrRemove(),!this.hasSelection)return;const t=[];for(const i of l(this,xe)){const r=i.serialize(!0);r&&t.push(r)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const r of t.items)for(const o of l(this,Ps))if(o.isHandlingMimeForPasting(r.type)){o.paste(r,this.currentLayer);return}let s=t.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(r){ne(`paste: "${r.message}".`);return}if(!Array.isArray(s))return;this.unselectAll();const i=this.currentLayer;try{const r=[];for(const c of s){const u=await i.deserialize(c);if(!u)return;r.push(u)}const o=()=>{for(const c of r)S(this,z,Nv).call(this,c);S(this,z,Mv).call(this,r)},a=()=>{for(const c of r)c.remove()};this.addCommands({cmd:o,undo:a,mustExec:!0})}catch(r){ne(`paste: "${r.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),l(this,mt)!==te.NONE&&!this.isEditorHandlingKeyboard&&Gl._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,l(this,Gr)&&(m(this,Gr,!1),S(this,z,Lp).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(e){e?(S(this,z,AE).call(this),S(this,z,Rv).call(this),S(this,z,Zt).call(this,{isEditing:l(this,mt)!==te.NONE,isEmpty:S(this,z,qu).call(this),hasSomethingToUndo:l(this,rs).hasSomethingToUndo(),hasSomethingToRedo:l(this,rs).hasSomethingToRedo(),hasSelectedEditor:!1})):(S(this,z,EE).call(this),S(this,z,Lv).call(this),S(this,z,Zt).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!l(this,Ps)){m(this,Ps,e);for(const t of l(this,Ps))S(this,z,Di).call(this,t.defaultPropertiesToUpdate)}}getId(){return l(this,Ug).id}get currentLayer(){return l(this,Tt).get(l(this,cc))}getLayer(e){return l(this,Tt).get(e)}get currentPageIndex(){return l(this,cc)}addLayer(e){l(this,Tt).set(e.pageIndex,e),l(this,Wr)?e.enable():e.disable()}removeLayer(e){l(this,Tt).delete(e.pageIndex)}async updateMode(e,t=null,s=!1){var i,r,o;if(l(this,mt)!==e&&!(l(this,os)&&(await l(this,os).promise,!l(this,os)))){if(m(this,os,Promise.withResolvers()),(i=l(this,Ur))==null||i.commitOrRemove(),m(this,mt,e),e===te.NONE){this.setEditingState(!1),S(this,z,TE).call(this),(r=this._editorUndoBar)==null||r.hide(),l(this,os).resolve();return}e===te.SIGNATURE&&await((o=l(this,Yr))==null?void 0:o.loadSignatures()),this.setEditingState(!0),await S(this,z,kE).call(this),this.unselectAll();for(const a of l(this,Tt).values())a.updateMode(e);if(!t){s&&this.addNewEditorFromKeyboard(),l(this,os).resolve();return}for(const a of l(this,ct).values())a.annotationElementId===t||a.id===t?(this.setSelected(a),a.enterInEditMode()):a.unselect();l(this,os).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==l(this,mt)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){var s;if(l(this,Ps)){switch(e){case he.CREATE:this.currentLayer.addNewEditor(t);return;case he.HIGHLIGHT_DEFAULT_COLOR:(s=l(this,aa))==null||s.updateColor(t);break;case he.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(l(this,lh)||m(this,lh,new Map)).set(e,t),this.showAllEditors("highlight",t);break}for(const i of l(this,xe))i.updateParams(e,t);for(const i of l(this,Ps))i.updateDefaultParams(e,t)}}showAllEditors(e,t,s=!1){var r;for(const o of l(this,ct).values())o.editorType===e&&o.show(t);(((r=l(this,lh))==null?void 0:r.get(he.HIGHLIGHT_SHOW_ALL))??!0)!==t&&S(this,z,Di).call(this,[[he.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(l(this,oh)!==e){m(this,oh,e);for(const t of l(this,Tt).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}getEditors(e){const t=[];for(const s of l(this,ct).values())s.pageIndex===e&&t.push(s);return t}getEditor(e){return l(this,ct).get(e)}addEditor(e){l(this,ct).set(e.id,e)}removeEditor(e){var t,s;e.div.contains(document.activeElement)&&(l(this,ai)&&clearTimeout(l(this,ai)),m(this,ai,setTimeout(()=>{this.focusMainContainer(),m(this,ai,null)},0))),l(this,ct).delete(e.id),e.annotationElementId&&((t=l(this,qr))==null||t.delete(e.annotationElementId)),this.unselect(e),(!e.annotationElementId||!l(this,ia).has(e.annotationElementId))&&((s=l(this,$i))==null||s.remove(e.id))}addDeletedAnnotationElement(e){l(this,ia).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return l(this,ia).has(e)}removeDeletedAnnotationElement(e){l(this,ia).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){l(this,Mn)!==e&&(m(this,Mn,e),e&&S(this,z,Di).call(this,e.propertiesToUpdate))}updateUI(e){l(this,z,PE)===e&&S(this,z,Di).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){S(this,z,Di).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(l(this,xe).has(e)){l(this,xe).delete(e),e.unselect(),S(this,z,Zt).call(this,{hasSelectedEditor:this.hasSelection});return}l(this,xe).add(e),e.select(),S(this,z,Di).call(this,e.propertiesToUpdate),S(this,z,Zt).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;(t=l(this,Ur))==null||t.commitOrRemove();for(const s of l(this,xe))s!==e&&s.unselect();l(this,xe).clear(),l(this,xe).add(e),e.select(),S(this,z,Di).call(this,e.propertiesToUpdate),S(this,z,Zt).call(this,{hasSelectedEditor:!0})}isSelected(e){return l(this,xe).has(e)}get firstSelectedEditor(){return l(this,xe).values().next().value}unselect(e){e.unselect(),l(this,xe).delete(e),S(this,z,Zt).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return l(this,xe).size!==0}get isEnterHandled(){return l(this,xe).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;l(this,rs).undo(),S(this,z,Zt).call(this,{hasSomethingToUndo:l(this,rs).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:S(this,z,qu).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){l(this,rs).redo(),S(this,z,Zt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:l(this,rs).hasSomethingToRedo(),isEmpty:S(this,z,qu).call(this)})}addCommands(e){l(this,rs).add(e),S(this,z,Zt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:S(this,z,qu).call(this)})}cleanUndoStack(e){l(this,rs).cleanType(e)}delete(){var r;this.commitOrRemove();const e=(r=this.currentLayer)==null?void 0:r.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...l(this,xe)],s=()=>{var o;(o=this._editorUndoBar)==null||o.show(i,t.length===1?t[0].editorType:t.length);for(const a of t)a.remove()},i=()=>{for(const o of t)S(this,z,Nv).call(this,o)};this.addCommands({cmd:s,undo:i,mustExec:!0})}commitOrRemove(){var e;(e=l(this,Mn))==null||e.commitOrRemove()}hasSomethingToControl(){return l(this,Mn)||this.hasSelection}selectAll(){for(const e of l(this,xe))e.commit();S(this,z,Mv).call(this,l(this,ct).values())}unselectAll(){var e;if(!(l(this,Mn)&&(l(this,Mn).commitOrRemove(),l(this,mt)!==te.NONE))&&!((e=l(this,Ur))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of l(this,xe))t.unselect();l(this,xe).clear(),S(this,z,Zt).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,s=!1){if(s||this.commitOrRemove(),!this.hasSelection)return;l(this,Kr)[0]+=e,l(this,Kr)[1]+=t;const[i,r]=l(this,Kr),o=[...l(this,xe)],a=1e3;l(this,ci)&&clearTimeout(l(this,ci)),m(this,ci,setTimeout(()=>{m(this,ci,null),l(this,Kr)[0]=l(this,Kr)[1]=0,this.addCommands({cmd:()=>{for(const c of o)l(this,ct).has(c.id)&&(c.translateInPage(i,r),c.translationDone())},undo:()=>{for(const c of o)l(this,ct).has(c.id)&&(c.translateInPage(-i,-r),c.translationDone())},mustExec:!1})},a));for(const c of o)c.translateInPage(e,t),c.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),m(this,oi,new Map);for(const e of l(this,xe))l(this,oi).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!l(this,oi))return!1;this.disableUserSelect(!1);const e=l(this,oi);m(this,oi,null);let t=!1;for(const[{x:i,y:r,pageIndex:o},a]of e)a.newX=i,a.newY=r,a.newPageIndex=o,t||(t=i!==a.savedX||r!==a.savedY||o!==a.savedPageIndex);if(!t)return!1;const s=(i,r,o,a)=>{if(l(this,ct).has(i.id)){const c=l(this,Tt).get(a);c?i._setParentAndPosition(c,r,o):(i.pageIndex=a,i.x=r,i.y=o)}};return this.addCommands({cmd:()=>{for(const[i,{newX:r,newY:o,newPageIndex:a}]of e)s(i,r,o,a)},undo:()=>{for(const[i,{savedX:r,savedY:o,savedPageIndex:a}]of e)s(i,r,o,a)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(l(this,oi))for(const s of l(this,oi).keys())s.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||l(this,xe).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return l(this,Mn)===e}getActive(){return l(this,Mn)}getMode(){return l(this,mt)}get imageManager(){return le(this,"imageManager",new Cv)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let u=0,d=t.rangeCount;u<d;u++)if(!e.contains(t.getRangeAt(u).commonAncestorContainer))return null;const{x:s,y:i,width:r,height:o}=e.getBoundingClientRect();let a;switch(e.getAttribute("data-main-rotation")){case"90":a=(u,d,h,f)=>({x:(d-i)/o,y:1-(u+h-s)/r,width:f/o,height:h/r});break;case"180":a=(u,d,h,f)=>({x:1-(u+h-s)/r,y:1-(d+f-i)/o,width:h/r,height:f/o});break;case"270":a=(u,d,h,f)=>({x:1-(d+f-i)/o,y:(u-s)/r,width:f/o,height:h/r});break;default:a=(u,d,h,f)=>({x:(u-s)/r,y:(d-i)/o,width:h/r,height:f/o});break}const c=[];for(let u=0,d=t.rangeCount;u<d;u++){const h=t.getRangeAt(u);if(!h.collapsed)for(const{x:f,y:p,width:y,height:g}of h.getClientRects())y===0||g===0||c.push(a(f,p,y,g))}return c.length===0?null:c}addChangedExistingAnnotation({annotationElementId:e,id:t}){(l(this,lc)||m(this,lc,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=l(this,lc))==null||t.delete(e)}renderAnnotationElement(e){var i;const t=(i=l(this,lc))==null?void 0:i.get(e.data.id);if(!t)return;const s=l(this,$i).getRawValue(t);s&&(l(this,mt)===te.NONE&&!s.hasBeenModified||s.renderAnnotationElement(e))}setMissingCanvas(e,t,s){var r;const i=(r=l(this,qr))==null?void 0:r.get(e);i&&(i.setCanvas(t,s),l(this,qr).delete(e))}addMissingCanvas(e,t){(l(this,qr)||m(this,qr,new Map)).set(e,t)}};oc=new WeakMap,Mn=new WeakMap,ct=new WeakMap,Tt=new WeakMap,ac=new WeakMap,$i=new WeakMap,lc=new WeakMap,rs=new WeakMap,Hr=new WeakMap,Ur=new WeakMap,cc=new WeakMap,ia=new WeakMap,oi=new WeakMap,Ps=new WeakMap,ra=new WeakMap,sh=new WeakMap,ih=new WeakMap,uc=new WeakMap,rh=new WeakMap,ai=new WeakMap,Vr=new WeakMap,dc=new WeakMap,Gr=new WeakMap,li=new WeakMap,Ug=new WeakMap,Wr=new WeakMap,oh=new WeakMap,Xr=new WeakMap,oa=new WeakMap,aa=new WeakMap,qr=new WeakMap,ah=new WeakMap,mt=new WeakMap,xe=new WeakMap,Bi=new WeakMap,Yr=new WeakMap,la=new WeakMap,lh=new WeakMap,ch=new WeakMap,Kr=new WeakMap,ci=new WeakMap,Hi=new WeakMap,uh=new WeakMap,os=new WeakMap,z=new WeakSet,Rp=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},Tv=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const s of l(this,Tt).values())if(s.hasTextLayer(e))return s;return null},bE=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const s=S(this,z,Rp).call(this,e).closest(".textLayer"),i=this.getSelectionBoxes(s);i&&(l(this,li)||m(this,li,new EL(this)),l(this,li).show(s,i,this.direction==="ltr"))},xE=function(){var r,o,a;const e=document.getSelection();if(!e||e.isCollapsed){l(this,Bi)&&((r=l(this,li))==null||r.hide(),m(this,Bi,null),S(this,z,Zt).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===l(this,Bi))return;const i=S(this,z,Rp).call(this,e).closest(".textLayer");if(!i){l(this,Bi)&&((o=l(this,li))==null||o.hide(),m(this,Bi,null),S(this,z,Zt).call(this,{hasSelectedText:!1}));return}if((a=l(this,li))==null||a.hide(),m(this,Bi,t),S(this,z,Zt).call(this,{hasSelectedText:!0}),!(l(this,mt)!==te.HIGHLIGHT&&l(this,mt)!==te.NONE)&&(l(this,mt)===te.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),m(this,Gr,this.isShiftKeyDown),!this.isShiftKeyDown)){const c=l(this,mt)===te.HIGHLIGHT?S(this,z,Tv).call(this,i):null;c==null||c.toggleDrawing();const u=new AbortController,d=this.combinedSignal(u),h=f=>{f.type==="pointerup"&&f.button!==0||(u.abort(),c==null||c.toggleDrawing(!0),f.type==="pointerup"&&S(this,z,Lp).call(this,"main_toolbar"))};window.addEventListener("pointerup",h,{signal:d}),window.addEventListener("blur",h,{signal:d})}},Lp=function(e=""){l(this,mt)===te.HIGHLIGHT?this.highlightSelection(e):l(this,sh)&&S(this,z,bE).call(this)},SE=function(){document.addEventListener("selectionchange",S(this,z,xE).bind(this),{signal:this._signal})},AE=function(){if(l(this,Vr))return;m(this,Vr,new AbortController);const e=this.combinedSignal(l(this,Vr));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},EE=function(){var e;(e=l(this,Vr))==null||e.abort(),m(this,Vr,null)},Pv=function(){if(l(this,Xr))return;m(this,Xr,new AbortController);const e=this.combinedSignal(l(this,Xr));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},_E=function(){var e;(e=l(this,Xr))==null||e.abort(),m(this,Xr,null)},Rv=function(){if(l(this,Hr))return;m(this,Hr,new AbortController);const e=this.combinedSignal(l(this,Hr));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},Lv=function(){var e;(e=l(this,Hr))==null||e.abort(),m(this,Hr,null)},CE=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},Zt=function(e){Object.entries(e).some(([s,i])=>l(this,ch)[s]!==i)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(l(this,ch),e)}),l(this,mt)===te.HIGHLIGHT&&e.hasSelectedEditor===!1&&S(this,z,Di).call(this,[[he.HIGHLIGHT_FREE,!0]]))},Di=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},kE=async function(){if(!l(this,Wr)){m(this,Wr,!0);const e=[];for(const t of l(this,Tt).values())e.push(t.enable());await Promise.all(e);for(const t of l(this,ct).values())t.enable()}},TE=function(){if(this.unselectAll(),l(this,Wr)){m(this,Wr,!1);for(const e of l(this,Tt).values())e.disable();for(const e of l(this,ct).values())e.disable()}},Nv=function(e){const t=l(this,Tt).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},PE=function(){let e=null;for(e of l(this,xe));return e},qu=function(){if(l(this,ct).size===0)return!0;if(l(this,ct).size===1)for(const e of l(this,ct).values())return e.isEmpty();return!1},Mv=function(e){for(const t of l(this,xe))t.unselect();l(this,xe).clear();for(const t of e)t.isEmpty()||(l(this,xe).add(t),t.select());S(this,z,Zt).call(this,{hasSelectedEditor:this.hasSelection})},F(Gl,"TRANSLATE_SMALL",1),F(Gl,"TRANSLATE_BIG",10);let Fo=Gl;var yt,ui,Rs,hc,di,Dn,fc,hi,gn,Ui,ca,fi,Qr,Vs,Yu,Np;const en=class en{constructor(e){x(this,Vs);x(this,yt,null);x(this,ui,!1);x(this,Rs,null);x(this,hc,null);x(this,di,null);x(this,Dn,null);x(this,fc,!1);x(this,hi,null);x(this,gn,null);x(this,Ui,null);x(this,ca,null);x(this,fi,!1);m(this,gn,e),m(this,fi,e._uiManager.useNewAltTextFlow),l(en,Qr)||m(en,Qr,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){en._l10n??(en._l10n=e)}async render(){const e=m(this,Rs,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=m(this,hc,document.createElement("span"));e.append(t),l(this,fi)?(e.classList.add("new"),e.setAttribute("data-l10n-id",l(en,Qr).missing),t.setAttribute("data-l10n-id",l(en,Qr)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const s=l(this,gn)._uiManager._signal;e.addEventListener("contextmenu",Ss,{signal:s}),e.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:s});const i=r=>{r.preventDefault(),l(this,gn)._uiManager.editAltText(l(this,gn)),l(this,fi)&&l(this,gn)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:l(this,Vs,Yu)}})};return e.addEventListener("click",i,{capture:!0,signal:s}),e.addEventListener("keydown",r=>{r.target===e&&r.key==="Enter"&&(m(this,fc,!0),i(r))},{signal:s}),await S(this,Vs,Np).call(this),e}finish(){l(this,Rs)&&(l(this,Rs).focus({focusVisible:l(this,fc)}),m(this,fc,!1))}isEmpty(){return l(this,fi)?l(this,yt)===null:!l(this,yt)&&!l(this,ui)}hasData(){return l(this,fi)?l(this,yt)!==null||!!l(this,Ui):this.isEmpty()}get guessedText(){return l(this,Ui)}async setGuessedText(e){l(this,yt)===null&&(m(this,Ui,e),m(this,ca,await en._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),S(this,Vs,Np).call(this))}toggleAltTextBadge(e=!1){var t;if(!l(this,fi)||l(this,yt)){(t=l(this,hi))==null||t.remove(),m(this,hi,null);return}if(!l(this,hi)){const s=m(this,hi,document.createElement("div"));s.className="noAltTextBadge",l(this,gn).div.append(s)}l(this,hi).classList.toggle("hidden",!e)}serialize(e){let t=l(this,yt);return!e&&l(this,Ui)===t&&(t=l(this,ca)),{altText:t,decorative:l(this,ui),guessedText:l(this,Ui),textWithDisclaimer:l(this,ca)}}get data(){return{altText:l(this,yt),decorative:l(this,ui)}}set data({altText:e,decorative:t,guessedText:s,textWithDisclaimer:i,cancel:r=!1}){s&&(m(this,Ui,s),m(this,ca,i)),!(l(this,yt)===e&&l(this,ui)===t)&&(r||(m(this,yt,e),m(this,ui,t)),S(this,Vs,Np).call(this))}toggle(e=!1){l(this,Rs)&&(!e&&l(this,Dn)&&(clearTimeout(l(this,Dn)),m(this,Dn,null)),l(this,Rs).disabled=!e)}shown(){l(this,gn)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:l(this,Vs,Yu)}})}destroy(){var e,t;(e=l(this,Rs))==null||e.remove(),m(this,Rs,null),m(this,hc,null),m(this,di,null),(t=l(this,hi))==null||t.remove(),m(this,hi,null)}};yt=new WeakMap,ui=new WeakMap,Rs=new WeakMap,hc=new WeakMap,di=new WeakMap,Dn=new WeakMap,fc=new WeakMap,hi=new WeakMap,gn=new WeakMap,Ui=new WeakMap,ca=new WeakMap,fi=new WeakMap,Qr=new WeakMap,Vs=new WeakSet,Yu=function(){return l(this,yt)&&"added"||l(this,yt)===null&&this.guessedText&&"review"||"missing"},Np=async function(){var i,r,o;const e=l(this,Rs);if(!e)return;if(l(this,fi)){if(e.classList.toggle("done",!!l(this,yt)),e.setAttribute("data-l10n-id",l(en,Qr)[l(this,Vs,Yu)]),(i=l(this,hc))==null||i.setAttribute("data-l10n-id",l(en,Qr)[`${l(this,Vs,Yu)}-label`]),!l(this,yt)){(r=l(this,di))==null||r.remove();return}}else{if(!l(this,yt)&&!l(this,ui)){e.classList.remove("done"),(o=l(this,di))==null||o.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=l(this,di);if(!t){m(this,di,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${l(this,gn).id}`;const a=100,c=l(this,gn)._uiManager._signal;c.addEventListener("abort",()=>{clearTimeout(l(this,Dn)),m(this,Dn,null)},{once:!0}),e.addEventListener("mouseenter",()=>{m(this,Dn,setTimeout(()=>{m(this,Dn,null),l(this,di).classList.add("show"),l(this,gn)._reportTelemetry({action:"alt_text_tooltip"})},a))},{signal:c}),e.addEventListener("mouseleave",()=>{var u;l(this,Dn)&&(clearTimeout(l(this,Dn)),m(this,Dn,null)),(u=l(this,di))==null||u.classList.remove("show")},{signal:c})}l(this,ui)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=l(this,yt)),t.parentNode||e.append(t);const s=l(this,gn).getElementForAltText();s==null||s.setAttribute("aria-describedby",t.id)},x(en,Qr,null),F(en,"_l10n",null);let Mg=en;var pc,ua,dh,hh,fh,ph,gh,Vi,da,Gi,ha,Wi,zo,RE,LE,NE;const ob=class ob{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:s=null,onPinchStart:i=null,onPinching:r=null,onPinchEnd:o=null,signal:a}){x(this,zo);x(this,pc);x(this,ua,!1);x(this,dh,null);x(this,hh);x(this,fh);x(this,ph);x(this,gh);x(this,Vi,null);x(this,da);x(this,Gi,null);x(this,ha);x(this,Wi,null);m(this,pc,e),m(this,dh,s),m(this,hh,t),m(this,fh,i),m(this,ph,r),m(this,gh,o),m(this,ha,new AbortController),m(this,da,AbortSignal.any([a,l(this,ha).signal])),e.addEventListener("touchstart",S(this,zo,RE).bind(this),{passive:!1,signal:l(this,da)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Ys.pixelRatio}destroy(){var e,t;(e=l(this,ha))==null||e.abort(),m(this,ha,null),(t=l(this,Vi))==null||t.abort(),m(this,Vi,null)}};pc=new WeakMap,ua=new WeakMap,dh=new WeakMap,hh=new WeakMap,fh=new WeakMap,ph=new WeakMap,gh=new WeakMap,Vi=new WeakMap,da=new WeakMap,Gi=new WeakMap,ha=new WeakMap,Wi=new WeakMap,zo=new WeakSet,RE=function(e){var i,r,o;if((i=l(this,hh))!=null&&i.call(this))return;if(e.touches.length===1){if(l(this,Vi))return;const a=m(this,Vi,new AbortController),c=AbortSignal.any([l(this,da),a.signal]),u=l(this,pc),d={capture:!0,signal:c,passive:!1},h=f=>{var p;f.pointerType==="touch"&&((p=l(this,Vi))==null||p.abort(),m(this,Vi,null))};u.addEventListener("pointerdown",f=>{f.pointerType==="touch"&&(et(f),h(f))},d),u.addEventListener("pointerup",h,d),u.addEventListener("pointercancel",h,d);return}if(!l(this,Wi)){m(this,Wi,new AbortController);const a=AbortSignal.any([l(this,da),l(this,Wi).signal]),c=l(this,pc),u={signal:a,capture:!1,passive:!1};c.addEventListener("touchmove",S(this,zo,LE).bind(this),u);const d=S(this,zo,NE).bind(this);c.addEventListener("touchend",d,u),c.addEventListener("touchcancel",d,u),u.capture=!0,c.addEventListener("pointerdown",et,u),c.addEventListener("pointermove",et,u),c.addEventListener("pointercancel",et,u),c.addEventListener("pointerup",et,u),(r=l(this,fh))==null||r.call(this)}if(et(e),e.touches.length!==2||(o=l(this,dh))!=null&&o.call(this)){m(this,Gi,null);return}let[t,s]=e.touches;t.identifier>s.identifier&&([t,s]=[s,t]),m(this,Gi,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:s.screenX,touch1Y:s.screenY})},LE=function(e){var E;if(!l(this,Gi)||e.touches.length!==2)return;et(e);let[t,s]=e.touches;t.identifier>s.identifier&&([t,s]=[s,t]);const{screenX:i,screenY:r}=t,{screenX:o,screenY:a}=s,c=l(this,Gi),{touch0X:u,touch0Y:d,touch1X:h,touch1Y:f}=c,p=h-u,y=f-d,g=o-i,A=a-r,v=Math.hypot(g,A)||1,w=Math.hypot(p,y)||1;if(!l(this,ua)&&Math.abs(w-v)<=ob.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(c.touch0X=i,c.touch0Y=r,c.touch1X=o,c.touch1Y=a,!l(this,ua)){m(this,ua,!0);return}const b=[(i+o)/2,(r+a)/2];(E=l(this,ph))==null||E.call(this,b,w,v)},NE=function(e){var t;e.touches.length>=2||(l(this,Wi)&&(l(this,Wi).abort(),m(this,Wi,null),(t=l(this,gh))==null||t.call(this)),l(this,Gi)&&(et(e),m(this,Gi,null),m(this,ua,!1)))};let Wd=ob;var fa,Ls,Ie,gc,Jr,mh,pa,Pt,ga,Xi,Zr,yh,ma,In,vh,ya,qi,pi,mc,yc,as,va,wh,Vg,Z,Dv,bh,Iv,Mp,ME,DE,Ov,Dp,Fv,IE,OE,FE,jv,jE,zv,zE,$E,BE,$v,Ku;const ie=class ie{constructor(e){x(this,Z);x(this,fa,null);x(this,Ls,null);x(this,Ie,null);x(this,gc,!1);x(this,Jr,null);x(this,mh,"");x(this,pa,!1);x(this,Pt,null);x(this,ga,null);x(this,Xi,null);x(this,Zr,null);x(this,yh,"");x(this,ma,!1);x(this,In,null);x(this,vh,!1);x(this,ya,!1);x(this,qi,!1);x(this,pi,null);x(this,mc,0);x(this,yc,0);x(this,as,null);x(this,va,null);F(this,"isSelected",!1);F(this,"_isCopy",!1);F(this,"_editToolbar",null);F(this,"_initialOptions",Object.create(null));F(this,"_initialData",null);F(this,"_isVisible",!0);F(this,"_uiManager",null);F(this,"_focusEventsAllowed",!0);x(this,wh,!1);x(this,Vg,ie._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null;const{rotation:t,rawDims:{pageWidth:s,pageHeight:i,pageX:r,pageY:o}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,i],this.pageTranslation=[r,o];const[a,c]=this.parentDimensions;this.x=e.x/a,this.y=e.y/c,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=ie.prototype._resizeWithKeyboard,t=Fo.TRANSLATE_SMALL,s=Fo.TRANSLATE_BIG;return le(this,"_resizerKeyboardManager",new Ff([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,s]}],[["Escape","mac+Escape"],ie.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return le(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new kL({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(ie._l10n??(ie._l10n=e),ie._l10nResizer||(ie._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),ie._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);ie._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){Ce("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return l(this,wh)}set _isDraggable(e){var t;m(this,wh,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=l(this,Vg)}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):S(this,Z,Ku).call(this),this.parent=e}focusin(e){this._focusEventsAllowed&&(l(this,ma)?m(this,ma,!1):this.parent.setSelected(this))}focusout(e){var s;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(s=this.parent)!=null&&s.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,s,i){const[r,o]=this.parentDimensions;[s,i]=this.screenToPageTranslation(s,i),this.x=(e+s)/r,this.y=(t+i)/o,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[s,i]=this.parentDimensions;this.setAt(e*s,t*i,this.width*s,this.height*i),this._onTranslated()}translate(e,t){S(this,Z,Dv).call(this,this.parentDimensions,e,t)}translateInPage(e,t){l(this,In)||m(this,In,[this.x,this.y,this.width,this.height]),S(this,Z,Dv).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){l(this,In)||m(this,In,[this.x,this.y,this.width,this.height]);const{div:s,parentDimensions:[i,r]}=this;if(this.x+=e/i,this.y+=t/r,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:h,y:f}=this.div.getBoundingClientRect();this.parent.findNewParent(this,h,f)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:o,y:a}=this;const[c,u]=this.getBaseTranslation();o+=c,a+=u;const{style:d}=s;d.left=`${(100*o).toFixed(2)}%`,d.top=`${(100*a).toFixed(2)}%`,this._onTranslating(o,a),s.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!l(this,In)&&(l(this,In)[0]!==this.x||l(this,In)[1]!==this.y)}get _hasBeenResized(){return!!l(this,In)&&(l(this,In)[2]!==this.width||l(this,In)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:s}=ie,i=s/e,r=s/t;switch(this.rotation){case 90:return[-i,r];case 180:return[i,r];case 270:return[i,-r];default:return[-i,-r]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[s,i]}=this;let{x:r,y:o,width:a,height:c}=this;if(a*=s,c*=i,r*=s,o*=i,this._mustFixPosition)switch(e){case 0:r=qt(r,0,s-a),o=qt(o,0,i-c);break;case 90:r=qt(r,0,s-c),o=qt(o,a,i);break;case 180:r=qt(r,a,s),o=qt(o,c,i);break;case 270:r=qt(r,c,s),o=qt(o,0,i-a);break}this.x=r/=s,this.y=o/=i;const[u,d]=this.getBaseTranslation();r+=u,o+=d,t.left=`${(100*r).toFixed(2)}%`,t.top=`${(100*o).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var s;return S(s=ie,bh,Iv).call(s,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var s;return S(s=ie,bh,Iv).call(s,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,s]}=this;return[t*e,s*e]}setDims(e,t){const[s,i]=this.parentDimensions,{style:r}=this.div;r.width=`${(100*e/s).toFixed(2)}%`,l(this,pa)||(r.height=`${(100*t/i).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:s}=e,i=s.endsWith("%"),r=!l(this,pa)&&t.endsWith("%");if(i&&r)return;const[o,a]=this.parentDimensions;i||(e.width=`${(100*parseFloat(s)/o).toFixed(2)}%`),!l(this,pa)&&!r&&(e.height=`${(100*parseFloat(t)/a).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=l(this,Ie))==null||e.finish()}async addEditToolbar(){return this._editToolbar||l(this,ya)?this._editToolbar:(this._editToolbar=new _v(this),this.div.append(this._editToolbar.render()),l(this,Ie)&&await this._editToolbar.addAltText(l(this,Ie)),this._editToolbar)}removeEditToolbar(){var e;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(e=l(this,Ie))==null||e.destroy())}addContainer(e){var s;const t=(s=this._editToolbar)==null?void 0:s.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){l(this,Ie)||(Mg.initialize(ie._l10n),m(this,Ie,new Mg(this)),l(this,fa)&&(l(this,Ie).data=l(this,fa),m(this,fa,null)),await this.addEditToolbar())}get altTextData(){var e;return(e=l(this,Ie))==null?void 0:e.data}set altTextData(e){l(this,Ie)&&(l(this,Ie).data=e)}get guessedAltText(){var e;return(e=l(this,Ie))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=l(this,Ie))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=l(this,Ie))==null?void 0:t.serialize(e)}hasAltText(){return!!l(this,Ie)&&!l(this,Ie).isEmpty()}hasAltTextData(){var e;return((e=l(this,Ie))==null?void 0:e.hasData())??!1}render(){var o;const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=l(this,gc)?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),S(this,Z,zv).call(this);const[t,s]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*s/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/s).toFixed(2)}%`);const[i,r]=this.getInitialTranslation();return this.translate(i,r),vE(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(l(this,va)||m(this,va,new Wd({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:S(this,Z,IE).bind(this),onPinching:S(this,Z,OE).bind(this),onPinchEnd:S(this,Z,FE).bind(this),signal:this._uiManager._signal}))),(o=this._uiManager._editorUndoBar)==null||o.hide(),e}pointerdown(e){const{isMac:t}=_t.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(m(this,ma,!0),this._isDraggable){S(this,Z,jE).call(this,e);return}S(this,Z,jv).call(this,e)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){l(this,pi)&&clearTimeout(l(this,pi)),m(this,pi,setTimeout(()=>{var e;m(this,pi,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,s){e.changeParent(this),this.x=t,this.y=s,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,s=this.rotation){const i=this.parentScale,[r,o]=this.pageDimensions,[a,c]=this.pageTranslation,u=e/i,d=t/i,h=this.x*r,f=this.y*o,p=this.width*r,y=this.height*o;switch(s){case 0:return[h+u+a,o-f-d-y+c,h+u+p+a,o-f-d+c];case 90:return[h+d+a,o-f+u+c,h+d+y+a,o-f+u+p+c];case 180:return[h-u-p+a,o-f+d+c,h-u+a,o-f+d+y+c];case 270:return[h-d-y+a,o-f-u-p+c,h-d+a,o-f-u+c];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[s,i,r,o]=e,a=r-s,c=o-i;switch(this.rotation){case 0:return[s,t-o,a,c];case 90:return[s,t-i,c,a];case 180:return[r,t-i,a,c];case 270:return[r,t-o,c,a];default:throw new Error("Invalid rotation")}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),m(this,ya,!0),!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),m(this,ya,!1),!0):!1}isInEditMode(){return l(this,ya)}shouldGetKeyboardEvents(){return l(this,qi)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:s,right:i}=this.getClientDimensions(),{innerHeight:r,innerWidth:o}=window;return t<o&&i>0&&e<r&&s>0}rebuild(){S(this,Z,zv).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){Ce("An editor must be serializable")}static async deserialize(e,t,s){const i=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:s});i.rotation=e.rotation,m(i,fa,e.accessibilityData),i._isCopy=e.isCopy||!1;const[r,o]=i.pageDimensions,[a,c,u,d]=i.getRectInCurrentCoords(e.rect,o);return i.x=a/r,i.y=c/o,i.width=u/r,i.height=d/o,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,t;if((e=l(this,Zr))==null||e.abort(),m(this,Zr,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),l(this,pi)&&(clearTimeout(l(this,pi)),m(this,pi,null)),S(this,Z,Ku).call(this),this.removeEditToolbar(),l(this,as)){for(const s of l(this,as).values())clearTimeout(s);m(this,as,null)}this.parent=null,(t=l(this,va))==null||t.destroy(),m(this,va,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(S(this,Z,ME).call(this),l(this,Pt).classList.remove("hidden"))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),m(this,Xi,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=l(this,Pt).children;if(!l(this,Ls)){m(this,Ls,Array.from(t));const o=S(this,Z,zE).bind(this),a=S(this,Z,$E).bind(this),c=this._uiManager._signal;for(const u of l(this,Ls)){const d=u.getAttribute("data-resizer-name");u.setAttribute("role","spinbutton"),u.addEventListener("keydown",o,{signal:c}),u.addEventListener("blur",a,{signal:c}),u.addEventListener("focus",S(this,Z,BE).bind(this,d),{signal:c}),u.setAttribute("data-l10n-id",ie._l10nResizer[d])}}const s=l(this,Ls)[0];let i=0;for(const o of t){if(o===s)break;i++}const r=(360-this.rotation+this.parentRotation)%360/90*(l(this,Ls).length/4);if(r!==i){if(r<i)for(let a=0;a<i-r;a++)l(this,Pt).append(l(this,Pt).firstChild);else if(r>i)for(let a=0;a<r-i;a++)l(this,Pt).firstChild.before(l(this,Pt).lastChild);let o=0;for(const a of t){const u=l(this,Ls)[o++].getAttribute("data-resizer-name");a.setAttribute("data-l10n-id",ie._l10nResizer[u])}}S(this,Z,$v).call(this,0),m(this,qi,!0),l(this,Pt).firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){l(this,qi)&&S(this,Z,Fv).call(this,l(this,yh),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){S(this,Z,Ku).call(this),this.div.focus()}select(){var e,t,s;if(!(this.isSelected&&this._editToolbar)){if(this.isSelected=!0,this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var i,r;(i=this.div)!=null&&i.classList.contains("selectedEditor")&&((r=this._editToolbar)==null||r.show())});return}(t=this._editToolbar)==null||t.show(),(s=l(this,Ie))==null||s.toggleAltTextBadge(!1)}}unselect(){var e,t,s,i,r;this.isSelected&&(this.isSelected=!1,(e=l(this,Pt))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(s=this.div)!=null&&s.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(i=this._editToolbar)==null||i.hide(),(r=l(this,Ie))==null||r.toggleAltTextBadge(!0))}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id})}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return l(this,vh)}set isEditing(e){m(this,vh,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){m(this,pa,!0);const s=e/t,{style:i}=this.div;i.aspectRatio=s,i.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){l(this,as)||m(this,as,new Map);const{action:s}=e;let i=l(this,as).get(s);i&&clearTimeout(i),i=setTimeout(()=>{this._reportTelemetry(e),l(this,as).delete(s),l(this,as).size===0&&m(this,as,null)},ie._telemetryTimeout),l(this,as).set(s,i);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),m(this,gc,!1)}disable(){this.div&&(this.div.tabIndex=-1),m(this,gc,!0)}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const s=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),s.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};fa=new WeakMap,Ls=new WeakMap,Ie=new WeakMap,gc=new WeakMap,Jr=new WeakMap,mh=new WeakMap,pa=new WeakMap,Pt=new WeakMap,ga=new WeakMap,Xi=new WeakMap,Zr=new WeakMap,yh=new WeakMap,ma=new WeakMap,In=new WeakMap,vh=new WeakMap,ya=new WeakMap,qi=new WeakMap,pi=new WeakMap,mc=new WeakMap,yc=new WeakMap,as=new WeakMap,va=new WeakMap,wh=new WeakMap,Vg=new WeakMap,Z=new WeakSet,Dv=function([e,t],s,i){[s,i]=this.screenToPageTranslation(s,i),this.x+=s/e,this.y+=i/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},bh=new WeakSet,Iv=function(e,t,s){switch(s){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},Mp=function(e){switch(e){case 90:{const[t,s]=this.pageDimensions;return[0,-t/s,s/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,s]=this.pageDimensions;return[0,t/s,-s/t,0]}default:return[1,0,0,1]}},ME=function(){if(l(this,Pt))return;m(this,Pt,document.createElement("div")),l(this,Pt).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const s of e){const i=document.createElement("div");l(this,Pt).append(i),i.classList.add("resizer",s),i.setAttribute("data-resizer-name",s),i.addEventListener("pointerdown",S(this,Z,DE).bind(this,s),{signal:t}),i.addEventListener("contextmenu",Ss,{signal:t}),i.tabIndex=-1}this.div.prepend(l(this,Pt))},DE=function(e,t){var d;t.preventDefault();const{isMac:s}=_t.platform;if(t.button!==0||t.ctrlKey&&s)return;(d=l(this,Ie))==null||d.toggle(!1);const i=this._isDraggable;this._isDraggable=!1,m(this,ga,[t.screenX,t.screenY]);const r=new AbortController,o=this._uiManager.combinedSignal(r);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",S(this,Z,Fv).bind(this,e),{passive:!0,capture:!0,signal:o}),window.addEventListener("touchmove",et,{passive:!1,signal:o}),window.addEventListener("contextmenu",Ss,{signal:o}),m(this,Xi,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const a=this.parent.div.style.cursor,c=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const u=()=>{var h;r.abort(),this.parent.togglePointerEvents(!0),(h=l(this,Ie))==null||h.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=a,this.div.style.cursor=c,S(this,Z,Dp).call(this)};window.addEventListener("pointerup",u,{signal:o}),window.addEventListener("blur",u,{signal:o})},Ov=function(e,t,s,i){this.width=s,this.height=i,this.x=e,this.y=t;const[r,o]=this.parentDimensions;this.setDims(r*s,o*i),this.fixAndSetPosition(),this._onResized()},Dp=function(){if(!l(this,Xi))return;const{savedX:e,savedY:t,savedWidth:s,savedHeight:i}=l(this,Xi);m(this,Xi,null);const r=this.x,o=this.y,a=this.width,c=this.height;r===e&&o===t&&a===s&&c===i||this.addCommands({cmd:S(this,Z,Ov).bind(this,r,o,a,c),undo:S(this,Z,Ov).bind(this,e,t,s,i),mustExec:!0})},Fv=function(e,t){const[s,i]=this.parentDimensions,r=this.x,o=this.y,a=this.width,c=this.height,u=ie.MIN_SIZE/s,d=ie.MIN_SIZE/i,h=S(this,Z,Mp).call(this,this.rotation),f=(j,O)=>[h[0]*j+h[2]*O,h[1]*j+h[3]*O],p=S(this,Z,Mp).call(this,360-this.rotation),y=(j,O)=>[p[0]*j+p[2]*O,p[1]*j+p[3]*O];let g,A,v=!1,w=!1;switch(e){case"topLeft":v=!0,g=(j,O)=>[0,0],A=(j,O)=>[j,O];break;case"topMiddle":g=(j,O)=>[j/2,0],A=(j,O)=>[j/2,O];break;case"topRight":v=!0,g=(j,O)=>[j,0],A=(j,O)=>[0,O];break;case"middleRight":w=!0,g=(j,O)=>[j,O/2],A=(j,O)=>[0,O/2];break;case"bottomRight":v=!0,g=(j,O)=>[j,O],A=(j,O)=>[0,0];break;case"bottomMiddle":g=(j,O)=>[j/2,O],A=(j,O)=>[j/2,0];break;case"bottomLeft":v=!0,g=(j,O)=>[0,O],A=(j,O)=>[j,0];break;case"middleLeft":w=!0,g=(j,O)=>[0,O/2],A=(j,O)=>[j,O/2];break}const b=g(a,c),E=A(a,c);let C=f(...E);const T=ie._round(r+C[0]),k=ie._round(o+C[1]);let R=1,M=1,L,N;if(t.fromKeyboard)({deltaX:L,deltaY:N}=t);else{const{screenX:j,screenY:O}=t,[I,V]=l(this,ga);[L,N]=this.screenToPageTranslation(j-I,O-V),l(this,ga)[0]=j,l(this,ga)[1]=O}if([L,N]=y(L/s,N/i),v){const j=Math.hypot(a,c);R=M=Math.max(Math.min(Math.hypot(E[0]-b[0]-L,E[1]-b[1]-N)/j,1/a,1/c),u/a,d/c)}else w?R=qt(Math.abs(E[0]-b[0]-L),u,1)/a:M=qt(Math.abs(E[1]-b[1]-N),d,1)/c;const B=ie._round(a*R),H=ie._round(c*M);C=f(...A(B,H));const W=T-C[0],ee=k-C[1];l(this,In)||m(this,In,[this.x,this.y,this.width,this.height]),this.width=B,this.height=H,this.x=W,this.y=ee,this.setDims(s*B,i*H),this.fixAndSetPosition(),this._onResizing()},IE=function(){var e;m(this,Xi,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=l(this,Ie))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},OE=function(e,t,s){let r=.7*(s/t)+1-.7;if(r===1)return;const o=S(this,Z,Mp).call(this,this.rotation),a=(T,k)=>[o[0]*T+o[2]*k,o[1]*T+o[3]*k],[c,u]=this.parentDimensions,d=this.x,h=this.y,f=this.width,p=this.height,y=ie.MIN_SIZE/c,g=ie.MIN_SIZE/u;r=Math.max(Math.min(r,1/f,1/p),y/f,g/p);const A=ie._round(f*r),v=ie._round(p*r);if(A===f&&v===p)return;l(this,In)||m(this,In,[d,h,f,p]);const w=a(f/2,p/2),b=ie._round(d+w[0]),E=ie._round(h+w[1]),C=a(A/2,v/2);this.x=b-C[0],this.y=E-C[1],this.width=A,this.height=v,this.setDims(c*A,u*v),this.fixAndSetPosition(),this._onResizing()},FE=function(){var e;(e=l(this,Ie))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),S(this,Z,Dp).call(this)},jv=function(e){const{isMac:t}=_t.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},jE=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let s=!1;const i=new AbortController,r=this._uiManager.combinedSignal(i),o={capture:!0,passive:!1,signal:r},a=u=>{i.abort(),m(this,Jr,null),m(this,ma,!1),this._uiManager.endDragSession()||S(this,Z,jv).call(this,u),s&&this._onStopDragging()};t&&(m(this,mc,e.clientX),m(this,yc,e.clientY),m(this,Jr,e.pointerId),m(this,mh,e.pointerType),window.addEventListener("pointermove",u=>{s||(s=!0,this._onStartDragging());const{clientX:d,clientY:h,pointerId:f}=u;if(f!==l(this,Jr)){et(u);return}const[p,y]=this.screenToPageTranslation(d-l(this,mc),h-l(this,yc));m(this,mc,d),m(this,yc,h),this._uiManager.dragSelectedEditors(p,y)},o),window.addEventListener("touchmove",et,o),window.addEventListener("pointerdown",u=>{u.pointerType===l(this,mh)&&(l(this,va)||u.isPrimary)&&a(u),et(u)},o));const c=u=>{if(!l(this,Jr)||l(this,Jr)===u.pointerId){a(u);return}et(u)};window.addEventListener("pointerup",c,{signal:r}),window.addEventListener("blur",c,{signal:r})},zv=function(){if(l(this,Zr)||!this.div)return;m(this,Zr,new AbortController);const e=this._uiManager.combinedSignal(l(this,Zr));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},zE=function(e){ie._resizerKeyboardManager.exec(this,e)},$E=function(e){var t;l(this,qi)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==l(this,Pt)&&S(this,Z,Ku).call(this)},BE=function(e){m(this,yh,l(this,qi)?e:"")},$v=function(e){if(l(this,Ls))for(const t of l(this,Ls))t.tabIndex=e},Ku=function(){m(this,qi,!1),S(this,Z,$v).call(this,-1),S(this,Z,Dp).call(this)},x(ie,bh),F(ie,"_l10n",null),F(ie,"_l10nResizer",null),F(ie,"_borderLineWidth",-1),F(ie,"_colorManager",new kv),F(ie,"_zIndex",1),F(ie,"_telemetryTimeout",1e3);let Me=ie;class kL extends Me{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Bx=3285377520,ss=4294901760,si=65535;class HE{constructor(e){this.h1=e?e&4294967295:Bx,this.h2=e?e&4294967295:Bx}update(e){let t,s;if(typeof e=="string"){t=new Uint8Array(e.length*2),s=0;for(let g=0,A=e.length;g<A;g++){const v=e.charCodeAt(g);v<=255?t[s++]=v:(t[s++]=v>>>8,t[s++]=v&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),s=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const i=s>>2,r=s-i*4,o=new Uint32Array(t.buffer,0,i);let a=0,c=0,u=this.h1,d=this.h2;const h=3432918353,f=461845907,p=h&si,y=f&si;for(let g=0;g<i;g++)g&1?(a=o[g],a=a*h&ss|a*p&si,a=a<<15|a>>>17,a=a*f&ss|a*y&si,u^=a,u=u<<13|u>>>19,u=u*5+3864292196):(c=o[g],c=c*h&ss|c*p&si,c=c<<15|c>>>17,c=c*f&ss|c*y&si,d^=c,d=d<<13|d>>>19,d=d*5+3864292196);switch(a=0,r){case 3:a^=t[i*4+2]<<16;case 2:a^=t[i*4+1]<<8;case 1:a^=t[i*4],a=a*h&ss|a*p&si,a=a<<15|a>>>17,a=a*f&ss|a*y&si,i&1?u^=a:d^=a}this.h1=u,this.h2=d}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&ss|e*36045&si,t=t*4283543511&ss|((t<<16|e>>>16)*2950163797&ss)>>>16,e^=t>>>1,e=e*444984403&ss|e*60499&si,t=t*3301882366&ss|((t<<16|e>>>16)*3120437893&ss)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const Bv=Object.freeze({map:null,hash:"",transfer:void 0});var wa,ba,Rt,Gg,UE;class Xw{constructor(){x(this,Gg);x(this,wa,!1);x(this,ba,null);x(this,Rt,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const s=l(this,Rt).get(e);return s===void 0?t:Object.assign(t,s)}getRawValue(e){return l(this,Rt).get(e)}remove(e){if(l(this,Rt).delete(e),l(this,Rt).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of l(this,Rt).values())if(t instanceof Me)return;this.onAnnotationEditor(null)}}setValue(e,t){const s=l(this,Rt).get(e);let i=!1;if(s!==void 0)for(const[r,o]of Object.entries(t))s[r]!==o&&(i=!0,s[r]=o);else i=!0,l(this,Rt).set(e,t);i&&S(this,Gg,UE).call(this),t instanceof Me&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return l(this,Rt).has(e)}get size(){return l(this,Rt).size}resetModified(){l(this,wa)&&(m(this,wa,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new VE(this)}get serializable(){if(l(this,Rt).size===0)return Bv;const e=new Map,t=new HE,s=[],i=Object.create(null);let r=!1;for(const[o,a]of l(this,Rt)){const c=a instanceof Me?a.serialize(!1,i):a;c&&(e.set(o,c),t.update(`${o}:${JSON.stringify(c)}`),r||(r=!!c.bitmap))}if(r)for(const o of e.values())o.bitmap&&s.push(o.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:s}:Bv}get editorStats(){let e=null;const t=new Map;for(const s of l(this,Rt).values()){if(!(s instanceof Me))continue;const i=s.telemetryFinalData;if(!i)continue;const{type:r}=i;t.has(r)||t.set(r,Object.getPrototypeOf(s).constructor),e||(e=Object.create(null));const o=e[r]||(e[r]=new Map);for(const[a,c]of Object.entries(i)){if(a==="type")continue;let u=o.get(a);u||(u=new Map,o.set(a,u));const d=u.get(c)??0;u.set(c,d+1)}}for(const[s,i]of t)e[s]=i.computeTelemetryFinalData(e[s]);return e}resetModifiedIds(){m(this,ba,null)}get modifiedIds(){if(l(this,ba))return l(this,ba);const e=[];for(const t of l(this,Rt).values())!(t instanceof Me)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return m(this,ba,{ids:new Set(e),hash:e.join(",")})}[Symbol.iterator](){return l(this,Rt).entries()}}wa=new WeakMap,ba=new WeakMap,Rt=new WeakMap,Gg=new WeakSet,UE=function(){l(this,wa)||(m(this,wa,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var xh;class VE extends Xw{constructor(t){super();x(this,xh);const{map:s,hash:i,transfer:r}=t.serializable,o=structuredClone(s,r?{transfer:r}:null);m(this,xh,{map:o,hash:i,transfer:r})}get print(){Ce("Should not call PrintAnnotationStorage.print")}get serializable(){return l(this,xh)}get modifiedIds(){return le(this,"modifiedIds",{ids:new Set,hash:""})}}xh=new WeakMap;var vc;class TL{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){x(this,vc,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),l(this,vc).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:s}){if(!(!e||l(this,vc).has(e.loadedName))){if(ot(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:i,src:r,style:o}=e,a=new FontFace(i,r,o);this.addNativeFontFace(a);try{await a.load(),l(this,vc).add(i),s==null||s(e)}catch{ne(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(a)}return}Ce("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const s=e.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(i){throw ne(`Failed to load font '${s.family}': '${i}'.`),e.disableFontFace=!0,i}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const i=this._queueLoadingCallback(s);this._prepareFontLoadEvent(e,i)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return le(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return le(this,"isSyncFontLoadingSupported",rn||_t.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(ot(!i.done,"completeRequest() cannot be called twice."),i.done=!0;s.length>0&&s[0].done;){const r=s.shift();setTimeout(r.callback,0)}}const{loadingRequests:s}=this,i={done:!1,complete:t,callback:e};return s.push(i),i}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return le(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function s(E,C){return E.charCodeAt(C)<<24|E.charCodeAt(C+1)<<16|E.charCodeAt(C+2)<<8|E.charCodeAt(C+3)&255}function i(E,C,T,k){const R=E.substring(0,C),M=E.substring(C+T);return R+k+M}let r,o;const a=this._document.createElement("canvas");a.width=1,a.height=1;const c=a.getContext("2d");let u=0;function d(E,C){if(++u>30){ne("Load test font never loaded."),C();return}if(c.font="30px "+E,c.fillText(".",0,20),c.getImageData(0,0,1,1).data[3]>0){C();return}setTimeout(d.bind(null,E,C))}const h=`lt${Date.now()}${this.loadTestFontId++}`;let f=this._loadTestFont;f=i(f,976,h.length,h);const y=16,g=1482184792;let A=s(f,y);for(r=0,o=h.length-3;r<o;r+=4)A=A-g+s(h,r)|0;r<h.length&&(A=A-g+s(h+"XXX",r)|0),f=i(f,y,4,mL(A));const v=`url(data:font/opentype;base64,${btoa(f)});`,w=`@font-face {font-family:"${h}";src:${v}}`;this.insertRule(w);const b=this._document.createElement("div");b.style.visibility="hidden",b.style.width=b.style.height="10px",b.style.position="absolute",b.style.top=b.style.left="0px";for(const E of[e.loadedName,h]){const C=this._document.createElement("span");C.textContent="Hi",C.style.fontFamily=E,b.append(C)}this._document.body.append(b),d(h,()=>{b.remove(),t.complete()})}}vc=new WeakMap;class PL{constructor(e,t=null){this.compiledGlyphs=Object.create(null);for(const s in e)this[s]=e[s];this._inspectFont=t}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const s={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(s.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,s)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var s;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${aE(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${e}}`}return(s=this._inspectFont)==null||s.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const s=this.loadedName+"_path_"+t;let i;try{i=e.get(s)}catch(o){ne(`getPathGenerator - ignoring character: "${o}".`)}const r=new Path2D(i||"");return this.fontExtraProperties||e.delete(s),this.compiledGlyphs[t]=r}}function RL(n){if(n instanceof URL)return n.href;if(typeof n=="string"){if(rn)return n;const e=URL.parse(n,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function LL(n){if(rn&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return Df(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n==null?void 0:n.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function lp(n){if(typeof n!="string")return null;if(n.endsWith("/"))return n;throw new Error(`Invalid factory url: "${n}" must include trailing slash.`)}const Hv=n=>typeof n=="object"&&Number.isInteger(n==null?void 0:n.num)&&n.num>=0&&Number.isInteger(n==null?void 0:n.gen)&&n.gen>=0,NL=n=>typeof n=="object"&&typeof(n==null?void 0:n.name)=="string",GE=bL.bind(null,Hv,NL);var Yi,Wg;class ML{constructor(){x(this,Yi,new Map);x(this,Wg,Promise.resolve())}postMessage(e,t){const s={data:structuredClone(e,t?{transfer:t}:null)};l(this,Wg).then(()=>{for(const[i]of l(this,Yi))i.call(this,s)})}addEventListener(e,t,s=null){let i=null;if((s==null?void 0:s.signal)instanceof AbortSignal){const{signal:r}=s;if(r.aborted){ne("LoopbackPort - cannot use an `aborted` signal.");return}const o=()=>this.removeEventListener(e,t);i=()=>r.removeEventListener("abort",o),r.addEventListener("abort",o)}l(this,Yi).set(t,i)}removeEventListener(e,t){const s=l(this,Yi).get(t);s==null||s(),l(this,Yi).delete(t)}terminate(){for(const[,e]of l(this,Yi))e==null||e();l(this,Yi).clear()}}Yi=new WeakMap,Wg=new WeakMap;const cp={DATA:1,ERROR:2},it={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function Hx(){}function fn(n){if(n instanceof Er||n instanceof Lg||n instanceof jx||n instanceof Gd||n instanceof vy)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||Ce('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new Er(n.message);case"InvalidPDFException":return new Lg(n.message);case"PasswordException":return new jx(n.message,n.code);case"ResponseException":return new Gd(n.message,n.status,n.missing);case"UnknownErrorException":return new vy(n.message,n.details)}return new vy(n.message,n.toString())}var wc,ws,WE,XE,qE,Ip;class Qu{constructor(e,t,s){x(this,ws);x(this,wc,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),s.addEventListener("message",S(this,ws,WE).bind(this),{signal:l(this,wc).signal})}on(e,t){const s=this.actionHandler;if(s[e])throw new Error(`There is already an actionName called "${e}"`);s[e]=t}send(e,t,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},s)}sendWithPromise(e,t,s){const i=this.callbackId++,r=Promise.withResolvers();this.callbackCapabilities[i]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:i,data:t},s)}catch(o){r.reject(o)}return r.promise}sendWithStream(e,t,s,i){const r=this.streamId++,o=this.sourceName,a=this.targetName,c=this.comObj;return new ReadableStream({start:u=>{const d=Promise.withResolvers();return this.streamControllers[r]={controller:u,startCall:d,pullCall:null,cancelCall:null,isClosed:!1},c.postMessage({sourceName:o,targetName:a,action:e,streamId:r,data:t,desiredSize:u.desiredSize},i),d.promise},pull:u=>{const d=Promise.withResolvers();return this.streamControllers[r].pullCall=d,c.postMessage({sourceName:o,targetName:a,stream:it.PULL,streamId:r,desiredSize:u.desiredSize}),d.promise},cancel:u=>{ot(u instanceof Error,"cancel must have a valid reason");const d=Promise.withResolvers();return this.streamControllers[r].cancelCall=d,this.streamControllers[r].isClosed=!0,c.postMessage({sourceName:o,targetName:a,stream:it.CANCEL,streamId:r,reason:fn(u)}),d.promise}},s)}destroy(){var e;(e=l(this,wc))==null||e.abort(),m(this,wc,null)}}wc=new WeakMap,ws=new WeakSet,WE=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){S(this,ws,qE).call(this,e);return}if(e.callback){const s=e.callbackId,i=this.callbackCapabilities[s];if(!i)throw new Error(`Cannot resolve callback ${s}`);if(delete this.callbackCapabilities[s],e.callback===cp.DATA)i.resolve(e.data);else if(e.callback===cp.ERROR)i.reject(fn(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const s=this.sourceName,i=e.sourceName,r=this.comObj;Promise.try(t,e.data).then(function(o){r.postMessage({sourceName:s,targetName:i,callback:cp.DATA,callbackId:e.callbackId,data:o})},function(o){r.postMessage({sourceName:s,targetName:i,callback:cp.ERROR,callbackId:e.callbackId,reason:fn(o)})});return}if(e.streamId){S(this,ws,XE).call(this,e);return}t(e.data)},XE=function(e){const t=e.streamId,s=this.sourceName,i=e.sourceName,r=this.comObj,o=this,a=this.actionHandler[e.action],c={enqueue(u,d=1,h){if(this.isCancelled)return;const f=this.desiredSize;this.desiredSize-=d,f>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),r.postMessage({sourceName:s,targetName:i,stream:it.ENQUEUE,streamId:t,chunk:u},h)},close(){this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:s,targetName:i,stream:it.CLOSE,streamId:t}),delete o.streamSinks[t])},error(u){ot(u instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,r.postMessage({sourceName:s,targetName:i,stream:it.ERROR,streamId:t,reason:fn(u)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};c.sinkCapability.resolve(),c.ready=c.sinkCapability.promise,this.streamSinks[t]=c,Promise.try(a,e.data,c).then(function(){r.postMessage({sourceName:s,targetName:i,stream:it.START_COMPLETE,streamId:t,success:!0})},function(u){r.postMessage({sourceName:s,targetName:i,stream:it.START_COMPLETE,streamId:t,reason:fn(u)})})},qE=function(e){const t=e.streamId,s=this.sourceName,i=e.sourceName,r=this.comObj,o=this.streamControllers[t],a=this.streamSinks[t];switch(e.stream){case it.START_COMPLETE:e.success?o.startCall.resolve():o.startCall.reject(fn(e.reason));break;case it.PULL_COMPLETE:e.success?o.pullCall.resolve():o.pullCall.reject(fn(e.reason));break;case it.PULL:if(!a){r.postMessage({sourceName:s,targetName:i,stream:it.PULL_COMPLETE,streamId:t,success:!0});break}a.desiredSize<=0&&e.desiredSize>0&&a.sinkCapability.resolve(),a.desiredSize=e.desiredSize,Promise.try(a.onPull||Hx).then(function(){r.postMessage({sourceName:s,targetName:i,stream:it.PULL_COMPLETE,streamId:t,success:!0})},function(u){r.postMessage({sourceName:s,targetName:i,stream:it.PULL_COMPLETE,streamId:t,reason:fn(u)})});break;case it.ENQUEUE:if(ot(o,"enqueue should have stream controller"),o.isClosed)break;o.controller.enqueue(e.chunk);break;case it.CLOSE:if(ot(o,"close should have stream controller"),o.isClosed)break;o.isClosed=!0,o.controller.close(),S(this,ws,Ip).call(this,o,t);break;case it.ERROR:ot(o,"error should have stream controller"),o.controller.error(fn(e.reason)),S(this,ws,Ip).call(this,o,t);break;case it.CANCEL_COMPLETE:e.success?o.cancelCall.resolve():o.cancelCall.reject(fn(e.reason)),S(this,ws,Ip).call(this,o,t);break;case it.CANCEL:if(!a)break;const c=fn(e.reason);Promise.try(a.onCancel||Hx,c).then(function(){r.postMessage({sourceName:s,targetName:i,stream:it.CANCEL_COMPLETE,streamId:t,success:!0})},function(u){r.postMessage({sourceName:s,targetName:i,stream:it.CANCEL_COMPLETE,streamId:t,reason:fn(u)})}),a.sinkCapability.reject(c),a.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},Ip=async function(e,t){var s,i,r;await Promise.allSettled([(s=e.startCall)==null?void 0:s.promise,(i=e.pullCall)==null?void 0:i.promise,(r=e.cancelCall)==null?void 0:r.promise]),delete this.streamControllers[t]};var Sh;class YE{constructor({enableHWA:e=!1}){x(this,Sh,!1);m(this,Sh,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(e,t);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!l(this,Sh)})}}reset(e,t,s){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||s<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=s}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){Ce("Abstract method `_createCanvas` called.")}}Sh=new WeakMap;class DL extends YE{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const s=this._document.createElement("canvas");return s.width=e,s.height=t,s}}class KE{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(s=>({cMapData:s,isCompressed:this.isCompressed})).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){Ce("Abstract method `_fetch` called.")}}class Ux extends KE{async _fetch(e){const t=await _u(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):Df(t)}}class QE{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,s,i,r){return"none"}destroy(e=!1){}}var xa,bc,Ki,Qi,Gt,Sa,Aa,U,Ut,Ju,_l,Op,Cl,JE,Uv,kl,Zu,ed,Vv,td;class IL extends QE{constructor({docId:t,ownerDocument:s=globalThis.document}){super();x(this,U);x(this,xa);x(this,bc);x(this,Ki);x(this,Qi);x(this,Gt);x(this,Sa);x(this,Aa,0);m(this,Qi,t),m(this,Gt,s)}addFilter(t){if(!t)return"none";let s=l(this,U,Ut).get(t);if(s)return s;const[i,r,o]=S(this,U,Op).call(this,t),a=t.length===1?i:`${i}${r}${o}`;if(s=l(this,U,Ut).get(a),s)return l(this,U,Ut).set(t,s),s;const c=`g_${l(this,Qi)}_transfer_map_${Jt(this,Aa)._++}`,u=S(this,U,Cl).call(this,c);l(this,U,Ut).set(t,u),l(this,U,Ut).set(a,u);const d=S(this,U,kl).call(this,c);return S(this,U,ed).call(this,i,r,o,d),u}addHCMFilter(t,s){var y;const i=`${t}-${s}`,r="base";let o=l(this,U,Ju).get(r);if((o==null?void 0:o.key)===i||(o?((y=o.filter)==null||y.remove(),o.key=i,o.url="none",o.filter=null):(o={key:i,url:"none",filter:null},l(this,U,Ju).set(r,o)),!t||!s))return o.url;const a=S(this,U,td).call(this,t);t=Q.makeHexColor(...a);const c=S(this,U,td).call(this,s);if(s=Q.makeHexColor(...c),l(this,U,_l).style.color="",t==="#000000"&&s==="#ffffff"||t===s)return o.url;const u=new Array(256);for(let g=0;g<=255;g++){const A=g/255;u[g]=A<=.03928?A/12.92:((A+.055)/1.055)**2.4}const d=u.join(","),h=`g_${l(this,Qi)}_hcm_filter`,f=o.filter=S(this,U,kl).call(this,h);S(this,U,ed).call(this,d,d,d,f),S(this,U,Uv).call(this,f);const p=(g,A)=>{const v=a[g]/255,w=c[g]/255,b=new Array(A+1);for(let E=0;E<=A;E++)b[E]=v+E/A*(w-v);return b.join(",")};return S(this,U,ed).call(this,p(0,5),p(1,5),p(2,5),f),o.url=S(this,U,Cl).call(this,h),o.url}addAlphaFilter(t){let s=l(this,U,Ut).get(t);if(s)return s;const[i]=S(this,U,Op).call(this,[t]),r=`alpha_${i}`;if(s=l(this,U,Ut).get(r),s)return l(this,U,Ut).set(t,s),s;const o=`g_${l(this,Qi)}_alpha_map_${Jt(this,Aa)._++}`,a=S(this,U,Cl).call(this,o);l(this,U,Ut).set(t,a),l(this,U,Ut).set(r,a);const c=S(this,U,kl).call(this,o);return S(this,U,Vv).call(this,i,c),a}addLuminosityFilter(t){let s=l(this,U,Ut).get(t||"luminosity");if(s)return s;let i,r;if(t?([i]=S(this,U,Op).call(this,[t]),r=`luminosity_${i}`):r="luminosity",s=l(this,U,Ut).get(r),s)return l(this,U,Ut).set(t,s),s;const o=`g_${l(this,Qi)}_luminosity_map_${Jt(this,Aa)._++}`,a=S(this,U,Cl).call(this,o);l(this,U,Ut).set(t,a),l(this,U,Ut).set(r,a);const c=S(this,U,kl).call(this,o);return S(this,U,JE).call(this,c),t&&S(this,U,Vv).call(this,i,c),a}addHighlightHCMFilter(t,s,i,r,o){var w;const a=`${s}-${i}-${r}-${o}`;let c=l(this,U,Ju).get(t);if((c==null?void 0:c.key)===a||(c?((w=c.filter)==null||w.remove(),c.key=a,c.url="none",c.filter=null):(c={key:a,url:"none",filter:null},l(this,U,Ju).set(t,c)),!s||!i))return c.url;const[u,d]=[s,i].map(S(this,U,td).bind(this));let h=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),f=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),[p,y]=[r,o].map(S(this,U,td).bind(this));f<h&&([h,f,p,y]=[f,h,y,p]),l(this,U,_l).style.color="";const g=(b,E,C)=>{const T=new Array(256),k=(f-h)/C,R=b/255,M=(E-b)/(255*C);let L=0;for(let N=0;N<=C;N++){const B=Math.round(h+N*k),H=R+N*M;for(let W=L;W<=B;W++)T[W]=H;L=B+1}for(let N=L;N<256;N++)T[N]=T[L-1];return T.join(",")},A=`g_${l(this,Qi)}_hcm_${t}_filter`,v=c.filter=S(this,U,kl).call(this,A);return S(this,U,Uv).call(this,v),S(this,U,ed).call(this,g(p[0],y[0],5),g(p[1],y[1],5),g(p[2],y[2],5),v),c.url=S(this,U,Cl).call(this,A),c.url}destroy(t=!1){var s,i,r,o;t&&((s=l(this,Sa))!=null&&s.size)||((i=l(this,Ki))==null||i.parentNode.parentNode.remove(),m(this,Ki,null),(r=l(this,bc))==null||r.clear(),m(this,bc,null),(o=l(this,Sa))==null||o.clear(),m(this,Sa,null),m(this,Aa,0))}}xa=new WeakMap,bc=new WeakMap,Ki=new WeakMap,Qi=new WeakMap,Gt=new WeakMap,Sa=new WeakMap,Aa=new WeakMap,U=new WeakSet,Ut=function(){return l(this,bc)||m(this,bc,new Map)},Ju=function(){return l(this,Sa)||m(this,Sa,new Map)},_l=function(){if(!l(this,Ki)){const t=l(this,Gt).createElement("div"),{style:s}=t;s.visibility="hidden",s.contain="strict",s.width=s.height=0,s.position="absolute",s.top=s.left=0,s.zIndex=-1;const i=l(this,Gt).createElementNS(Mi,"svg");i.setAttribute("width",0),i.setAttribute("height",0),m(this,Ki,l(this,Gt).createElementNS(Mi,"defs")),t.append(i),i.append(l(this,Ki)),l(this,Gt).body.append(t)}return l(this,Ki)},Op=function(t){if(t.length===1){const u=t[0],d=new Array(256);for(let f=0;f<256;f++)d[f]=u[f]/255;const h=d.join(",");return[h,h,h]}const[s,i,r]=t,o=new Array(256),a=new Array(256),c=new Array(256);for(let u=0;u<256;u++)o[u]=s[u]/255,a[u]=i[u]/255,c[u]=r[u]/255;return[o.join(","),a.join(","),c.join(",")]},Cl=function(t){if(l(this,xa)===void 0){m(this,xa,"");const s=l(this,Gt).URL;s!==l(this,Gt).baseURI&&(Of(s)?ne('#createUrl: ignore "data:"-URL for performance reasons.'):m(this,xa,Uw(s,"")))}return`url(${l(this,xa)}#${t})`},JE=function(t){const s=l(this,Gt).createElementNS(Mi,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(s)},Uv=function(t){const s=l(this,Gt).createElementNS(Mi,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(s)},kl=function(t){const s=l(this,Gt).createElementNS(Mi,"filter");return s.setAttribute("color-interpolation-filters","sRGB"),s.setAttribute("id",t),l(this,U,_l).append(s),s},Zu=function(t,s,i){const r=l(this,Gt).createElementNS(Mi,s);r.setAttribute("type","discrete"),r.setAttribute("tableValues",i),t.append(r)},ed=function(t,s,i,r){const o=l(this,Gt).createElementNS(Mi,"feComponentTransfer");r.append(o),S(this,U,Zu).call(this,o,"feFuncR",t),S(this,U,Zu).call(this,o,"feFuncG",s),S(this,U,Zu).call(this,o,"feFuncB",i)},Vv=function(t,s){const i=l(this,Gt).createElementNS(Mi,"feComponentTransfer");s.append(i),S(this,U,Zu).call(this,i,"feFuncA",t)},td=function(t){return l(this,U,_l).style.color=t,Ww(getComputedStyle(l(this,U,_l)).getPropertyValue("color"))};class ZE{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(s=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){Ce("Abstract method `_fetch` called.")}}class Vx extends ZE{async _fetch(e){const t=await _u(e,"arraybuffer");return new Uint8Array(t)}}class e_{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(s=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){Ce("Abstract method `_fetch` called.")}}class Gx extends e_{async _fetch(e){const t=await _u(e,"arraybuffer");return new Uint8Array(t)}}rn&&ne("Please use the `legacy` build in Node.js environments.");async function qw(n){const t=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(t)}class OL extends QE{}class FL extends YE{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class jL extends KE{async _fetch(e){return qw(e)}}class zL extends ZE{async _fetch(e){return qw(e)}}class $L extends e_{async _fetch(e){return qw(e)}}const Dt={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Gv(n,e){if(!e)return;const t=e[2]-e[0],s=e[3]-e[1],i=new Path2D;i.rect(e[0],e[1],t,s),n.clip(i)}class Yw{isModifyingCurrentTransform(){return!1}getPattern(){Ce("Abstract method `getPattern` called.")}}class BL extends Yw{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const s of this._colorStops)t.addColorStop(s[0],s[1]);return t}getPattern(e,t,s,i){let r;if(i===Dt.STROKE||i===Dt.FILL){const o=t.current.getClippedPathBoundingBox(i,Ue(e))||[0,0,0,0],a=Math.ceil(o[2]-o[0])||1,c=Math.ceil(o[3]-o[1])||1,u=t.cachedCanvases.getCanvas("pattern",a,c),d=u.context;d.clearRect(0,0,d.canvas.width,d.canvas.height),d.beginPath(),d.rect(0,0,d.canvas.width,d.canvas.height),d.translate(-o[0],-o[1]),s=Q.transform(s,[1,0,0,1,o[0],o[1]]),d.transform(...t.baseTransform),this.matrix&&d.transform(...this.matrix),Gv(d,this._bbox),d.fillStyle=this._createGradient(d),d.fill(),r=e.createPattern(u.canvas,"no-repeat");const h=new DOMMatrix(s);r.setTransform(h)}else Gv(e,this._bbox),r=this._createGradient(e);return r}}function xy(n,e,t,s,i,r,o,a){const c=e.coords,u=e.colors,d=n.data,h=n.width*4;let f;c[t+1]>c[s+1]&&(f=t,t=s,s=f,f=r,r=o,o=f),c[s+1]>c[i+1]&&(f=s,s=i,i=f,f=o,o=a,a=f),c[t+1]>c[s+1]&&(f=t,t=s,s=f,f=r,r=o,o=f);const p=(c[t]+e.offsetX)*e.scaleX,y=(c[t+1]+e.offsetY)*e.scaleY,g=(c[s]+e.offsetX)*e.scaleX,A=(c[s+1]+e.offsetY)*e.scaleY,v=(c[i]+e.offsetX)*e.scaleX,w=(c[i+1]+e.offsetY)*e.scaleY;if(y>=w)return;const b=u[r],E=u[r+1],C=u[r+2],T=u[o],k=u[o+1],R=u[o+2],M=u[a],L=u[a+1],N=u[a+2],B=Math.round(y),H=Math.round(w);let W,ee,j,O,I,V,K,re;for(let J=B;J<=H;J++){if(J<A){const pe=J<y?0:(y-J)/(y-A);W=p-(p-g)*pe,ee=b-(b-T)*pe,j=E-(E-k)*pe,O=C-(C-R)*pe}else{let pe;J>w?pe=1:A===w?pe=0:pe=(A-J)/(A-w),W=g-(g-v)*pe,ee=T-(T-M)*pe,j=k-(k-L)*pe,O=R-(R-N)*pe}let oe;J<y?oe=0:J>w?oe=1:oe=(y-J)/(y-w),I=p-(p-v)*oe,V=b-(b-M)*oe,K=E-(E-L)*oe,re=C-(C-N)*oe;const Re=Math.round(Math.min(W,I)),Xe=Math.round(Math.max(W,I));let fe=h*J+Re*4;for(let pe=Re;pe<=Xe;pe++)oe=(W-pe)/(W-I),oe<0?oe=0:oe>1&&(oe=1),d[fe++]=ee-(ee-V)*oe|0,d[fe++]=j-(j-K)*oe|0,d[fe++]=O-(O-re)*oe|0,d[fe++]=255}}function HL(n,e,t){const s=e.coords,i=e.colors;let r,o;switch(e.type){case"lattice":const a=e.verticesPerRow,c=Math.floor(s.length/a)-1,u=a-1;for(r=0;r<c;r++){let d=r*a;for(let h=0;h<u;h++,d++)xy(n,t,s[d],s[d+1],s[d+a],i[d],i[d+1],i[d+a]),xy(n,t,s[d+a+1],s[d+1],s[d+a],i[d+a+1],i[d+1],i[d+a])}break;case"triangles":for(r=0,o=s.length;r<o;r+=3)xy(n,t,s[r],s[r+1],s[r+2],i[r],i[r+1],i[r+2]);break;default:throw new Error("illegal figure")}}class UL extends Yw{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,s){const a=Math.floor(this._bounds[0]),c=Math.floor(this._bounds[1]),u=Math.ceil(this._bounds[2])-a,d=Math.ceil(this._bounds[3])-c,h=Math.min(Math.ceil(Math.abs(u*e[0]*1.1)),3e3),f=Math.min(Math.ceil(Math.abs(d*e[1]*1.1)),3e3),p=u/h,y=d/f,g={coords:this._coords,colors:this._colors,offsetX:-a,offsetY:-c,scaleX:1/p,scaleY:1/y},A=h+2*2,v=f+2*2,w=s.getCanvas("mesh",A,v),b=w.context,E=b.createImageData(h,f);if(t){const T=E.data;for(let k=0,R=T.length;k<R;k+=4)T[k]=t[0],T[k+1]=t[1],T[k+2]=t[2],T[k+3]=255}for(const T of this._figures)HL(E,T,g);return b.putImageData(E,2,2),{canvas:w.canvas,offsetX:a-2*p,offsetY:c-2*y,scaleX:p,scaleY:y}}isModifyingCurrentTransform(){return!0}getPattern(e,t,s,i){Gv(e,this._bbox);const r=new Float32Array(2);if(i===Dt.SHADING)Q.singularValueDecompose2dScale(Ue(e),r);else if(this.matrix){Q.singularValueDecompose2dScale(this.matrix,r);const[a,c]=r;Q.singularValueDecompose2dScale(t.baseTransform,r),r[0]*=a,r[1]*=c}else Q.singularValueDecompose2dScale(t.baseTransform,r);const o=this._createMeshCanvas(r,i===Dt.SHADING?null:this._background,t.cachedCanvases);return i!==Dt.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(o.offsetX,o.offsetY),e.scale(o.scaleX,o.scaleY),e.createPattern(o.canvas,"no-repeat")}}class VL extends Yw{getPattern(){return"hotpink"}}function GL(n){switch(n[0]){case"RadialAxial":return new BL(n);case"Mesh":return new UL(n);case"Dummy":return new VL}throw new Error(`Unknown IR type: ${n[0]}`)}const Wx={COLORED:1,UNCOLORED:2},Xg=class Xg{constructor(e,t,s,i){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=s,this.baseTransform=i}createPatternCanvas(e){const{bbox:t,operatorList:s,paintType:i,tilingType:r,color:o,canvasGraphicsFactory:a}=this;let{xstep:c,ystep:u}=this;c=Math.abs(c),u=Math.abs(u),Cm("TilingType: "+r);const d=t[0],h=t[1],f=t[2],p=t[3],y=f-d,g=p-h,A=new Float32Array(2);Q.singularValueDecompose2dScale(this.matrix,A);const[v,w]=A;Q.singularValueDecompose2dScale(this.baseTransform,A);const b=v*A[0],E=w*A[1];let C=y,T=g,k=!1,R=!1;const M=Math.ceil(c*b),L=Math.ceil(u*E),N=Math.ceil(y*b),B=Math.ceil(g*E);M>=N?C=c:k=!0,L>=B?T=u:R=!0;const H=this.getSizeAndScale(C,this.ctx.canvas.width,b),W=this.getSizeAndScale(T,this.ctx.canvas.height,E),ee=e.cachedCanvases.getCanvas("pattern",H.size,W.size),j=ee.context,O=a.createCanvasGraphics(j);if(O.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(O,i,o),j.translate(-H.scale*d,-W.scale*h),O.transform(H.scale,0,0,W.scale,0,0),j.save(),this.clipBbox(O,d,h,f,p),O.baseTransform=Ue(O.ctx),O.executeOperatorList(s),O.endDrawing(),j.restore(),k||R){const I=ee.canvas;k&&(C=c),R&&(T=u);const V=this.getSizeAndScale(C,this.ctx.canvas.width,b),K=this.getSizeAndScale(T,this.ctx.canvas.height,E),re=V.size,J=K.size,oe=e.cachedCanvases.getCanvas("pattern-workaround",re,J),Re=oe.context,Xe=k?Math.floor(y/c):0,fe=R?Math.floor(g/u):0;for(let pe=0;pe<=Xe;pe++)for(let _n=0;_n<=fe;_n++)Re.drawImage(I,re*pe,J*_n,re,J,0,0,re,J);return{canvas:oe.canvas,scaleX:V.scale,scaleY:K.scale,offsetX:d,offsetY:h}}return{canvas:ee.canvas,scaleX:H.scale,scaleY:W.scale,offsetX:d,offsetY:h}}getSizeAndScale(e,t,s){const i=Math.max(Xg.MAX_PATTERN_SIZE,t);let r=Math.ceil(e*s);return r>=i?r=i:s=r/e,{scale:s,size:r}}clipBbox(e,t,s,i,r){const o=i-t,a=r-s;e.ctx.rect(t,s,o,a),Q.axialAlignedBoundingBox([t,s,i,r],Ue(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,s){const i=e.ctx,r=e.current;switch(t){case Wx.COLORED:const{fillStyle:o,strokeStyle:a}=this.ctx;i.fillStyle=r.fillColor=o,i.strokeStyle=r.strokeColor=a;break;case Wx.UNCOLORED:i.fillStyle=i.strokeStyle=s,r.fillColor=r.strokeColor=s;break;default:throw new gL(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,s,i){let r=s;i!==Dt.SHADING&&(r=Q.transform(r,t.baseTransform),this.matrix&&(r=Q.transform(r,this.matrix)));const o=this.createPatternCanvas(t);let a=new DOMMatrix(r);a=a.translate(o.offsetX,o.offsetY),a=a.scale(1/o.scaleX,1/o.scaleY);const c=e.createPattern(o.canvas,"repeat");return c.setTransform(a),c}};F(Xg,"MAX_PATTERN_SIZE",3e3);let Wv=Xg;function WL({src:n,srcPos:e=0,dest:t,width:s,height:i,nonBlackColor:r=4294967295,inverseDecode:o=!1}){const a=_t.isLittleEndian?4278190080:255,[c,u]=o?[r,a]:[a,r],d=s>>3,h=s&7,f=n.length;t=new Uint32Array(t.buffer);let p=0;for(let y=0;y<i;y++){for(const A=e+d;e<A;e++){const v=e<f?n[e]:255;t[p++]=v&128?u:c,t[p++]=v&64?u:c,t[p++]=v&32?u:c,t[p++]=v&16?u:c,t[p++]=v&8?u:c,t[p++]=v&4?u:c,t[p++]=v&2?u:c,t[p++]=v&1?u:c}if(h===0)continue;const g=e<f?n[e++]:255;for(let A=0;A<h;A++)t[p++]=g&1<<7-A?u:c}return{srcPos:e,destPos:p}}const Xx=16,qx=100,XL=15,Yx=10,vn=16,Sy=new DOMMatrix,qn=new Float32Array(2),Vl=new Float32Array([1/0,1/0,-1/0,-1/0]);function qL(n,e){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){e.save(),this.__originalSave()},n.restore=function(){e.restore(),this.__originalRestore()},n.translate=function(t,s){e.translate(t,s),this.__originalTranslate(t,s)},n.scale=function(t,s){e.scale(t,s),this.__originalScale(t,s)},n.transform=function(t,s,i,r,o,a){e.transform(t,s,i,r,o,a),this.__originalTransform(t,s,i,r,o,a)},n.setTransform=function(t,s,i,r,o,a){e.setTransform(t,s,i,r,o,a),this.__originalSetTransform(t,s,i,r,o,a)},n.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},n.rotate=function(t){e.rotate(t),this.__originalRotate(t)},n.clip=function(t){e.clip(t),this.__originalClip(t)},n.moveTo=function(t,s){e.moveTo(t,s),this.__originalMoveTo(t,s)},n.lineTo=function(t,s){e.lineTo(t,s),this.__originalLineTo(t,s)},n.bezierCurveTo=function(t,s,i,r,o,a){e.bezierCurveTo(t,s,i,r,o,a),this.__originalBezierCurveTo(t,s,i,r,o,a)},n.rect=function(t,s,i,r){e.rect(t,s,i,r),this.__originalRect(t,s,i,r)},n.closePath=function(){e.closePath(),this.__originalClosePath()},n.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class YL{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,s){let i;return this.cache[e]!==void 0?(i=this.cache[e],this.canvasFactory.reset(i,t,s)):(i=this.canvasFactory.create(t,s),this.cache[e]=i),i}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function up(n,e,t,s,i,r,o,a,c,u){const[d,h,f,p,y,g]=Ue(n);if(h===0&&f===0){const w=o*d+y,b=Math.round(w),E=a*p+g,C=Math.round(E),T=(o+c)*d+y,k=Math.abs(Math.round(T)-b)||1,R=(a+u)*p+g,M=Math.abs(Math.round(R)-C)||1;return n.setTransform(Math.sign(d),0,0,Math.sign(p),b,C),n.drawImage(e,t,s,i,r,0,0,k,M),n.setTransform(d,h,f,p,y,g),[k,M]}if(d===0&&p===0){const w=a*f+y,b=Math.round(w),E=o*h+g,C=Math.round(E),T=(a+u)*f+y,k=Math.abs(Math.round(T)-b)||1,R=(o+c)*h+g,M=Math.abs(Math.round(R)-C)||1;return n.setTransform(0,Math.sign(h),Math.sign(f),0,b,C),n.drawImage(e,t,s,i,r,0,0,M,k),n.setTransform(d,h,f,p,y,g),[M,k]}n.drawImage(e,t,s,i,r,o,a,c,u);const A=Math.hypot(d,h),v=Math.hypot(f,p);return[A*c,v*u]}class Kx{constructor(e,t){F(this,"alphaIsShape",!1);F(this,"fontSize",0);F(this,"fontSizeScale",1);F(this,"textMatrix",null);F(this,"textMatrixScale",1);F(this,"fontMatrix",Av);F(this,"leading",0);F(this,"x",0);F(this,"y",0);F(this,"lineX",0);F(this,"lineY",0);F(this,"charSpacing",0);F(this,"wordSpacing",0);F(this,"textHScale",1);F(this,"textRenderingMode",Ht.FILL);F(this,"textRise",0);F(this,"fillColor","#000000");F(this,"strokeColor","#000000");F(this,"patternFill",!1);F(this,"patternStroke",!1);F(this,"fillAlpha",1);F(this,"strokeAlpha",1);F(this,"lineWidth",1);F(this,"activeSMask",null);F(this,"transferMaps","none");this.clipBox=new Float32Array([0,0,e,t]),this.minMax=Vl.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=Dt.FILL,t=null){const s=this.minMax.slice();if(e===Dt.STROKE){t||Ce("Stroke bounding box must include transform."),Q.singularValueDecompose2dScale(t,qn);const i=qn[0]*this.lineWidth/2,r=qn[1]*this.lineWidth/2;s[0]-=i,s[1]-=r,s[2]+=i,s[3]+=r}return s}updateClipFromPath(){const e=Q.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(Vl,0)}getClippedPathBoundingBox(e=Dt.FILL,t=null){return Q.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function Qx(n,e){if(e instanceof ImageData){n.putImageData(e,0,0);return}const t=e.height,s=e.width,i=t%vn,r=(t-i)/vn,o=i===0?r:r+1,a=n.createImageData(s,vn);let c=0,u;const d=e.data,h=a.data;let f,p,y,g;if(e.kind===Ad.GRAYSCALE_1BPP){const A=d.byteLength,v=new Uint32Array(h.buffer,0,h.byteLength>>2),w=v.length,b=s+7>>3,E=4294967295,C=_t.isLittleEndian?4278190080:255;for(f=0;f<o;f++){for(y=f<r?vn:i,u=0,p=0;p<y;p++){const T=A-c;let k=0;const R=T>b?s:T*8-7,M=R&-8;let L=0,N=0;for(;k<M;k+=8)N=d[c++],v[u++]=N&128?E:C,v[u++]=N&64?E:C,v[u++]=N&32?E:C,v[u++]=N&16?E:C,v[u++]=N&8?E:C,v[u++]=N&4?E:C,v[u++]=N&2?E:C,v[u++]=N&1?E:C;for(;k<R;k++)L===0&&(N=d[c++],L=128),v[u++]=N&L?E:C,L>>=1}for(;u<w;)v[u++]=0;n.putImageData(a,0,f*vn)}}else if(e.kind===Ad.RGBA_32BPP){for(p=0,g=s*vn*4,f=0;f<r;f++)h.set(d.subarray(c,c+g)),c+=g,n.putImageData(a,0,p),p+=vn;f<o&&(g=s*i*4,h.set(d.subarray(c,c+g)),n.putImageData(a,0,p))}else if(e.kind===Ad.RGB_24BPP)for(y=vn,g=s*y,f=0;f<o;f++){for(f>=r&&(y=i,g=s*y),u=0,p=g;p--;)h[u++]=d[c++],h[u++]=d[c++],h[u++]=d[c++],h[u++]=255;n.putImageData(a,0,f*vn)}else throw new Error(`bad image kind: ${e.kind}`)}function Jx(n,e){if(e.bitmap){n.drawImage(e.bitmap,0,0);return}const t=e.height,s=e.width,i=t%vn,r=(t-i)/vn,o=i===0?r:r+1,a=n.createImageData(s,vn);let c=0;const u=e.data,d=a.data;for(let h=0;h<o;h++){const f=h<r?vn:i;({srcPos:c}=WL({src:u,srcPos:c,dest:d,width:s,height:f,nonBlackColor:0})),n.putImageData(a,0,h*vn)}}function ju(n,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of t)n[s]!==void 0&&(e[s]=n[s]);n.setLineDash!==void 0&&(e.setLineDash(n.getLineDash()),e.lineDashOffset=n.lineDashOffset)}function dp(n){n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0);const{filter:e}=n;e!=="none"&&e!==""&&(n.filter="none")}function Zx(n,e){if(e)return!0;Q.singularValueDecompose2dScale(n,qn);const t=Math.fround(Ys.pixelRatio*_r.PDF_TO_CSS_UNITS);return qn[0]<=t&&qn[1]<=t}const KL=["butt","round","square"],QL=["miter","round","bevel"],JL={},eS={};var Ks,Xv,qv,Yv;const ab=class ab{constructor(e,t,s,i,r,{optionalContentConfig:o,markedContentStack:a=null},c,u){x(this,Ks);this.ctx=e,this.current=new Kx(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=s,this.canvasFactory=i,this.filterFactory=r,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=a||[],this.optionalContentConfig=o,this.cachedCanvases=new YL(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=c,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=u,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:s=!1,background:i=null}){const r=this.ctx.canvas.width,o=this.ctx.canvas.height,a=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,r,o),this.ctx.fillStyle=a,s){const c=this.cachedCanvases.getCanvas("transparent",r,o);this.compositeCtx=this.ctx,this.transparentCanvas=c.canvas,this.ctx=c.context,this.ctx.save(),this.ctx.transform(...Ue(this.compositeCtx))}this.ctx.save(),dp(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=Ue(this.ctx)}executeOperatorList(e,t,s,i){const r=e.argsArray,o=e.fnArray;let a=t||0;const c=r.length;if(c===a)return a;const u=c-a>Yx&&typeof s=="function",d=u?Date.now()+XL:0;let h=0;const f=this.commonObjs,p=this.objs;let y;for(;;){if(i!==void 0&&a===i.nextBreakPoint)return i.breakIt(a,s),a;if(y=o[a],y!==Vd.dependency)this[y].apply(this,r[a]);else for(const g of r[a]){const A=g.startsWith("g_")?f:p;if(!A.has(g))return A.get(g,s),a}if(a++,a===c)return a;if(u&&++h>Yx){if(Date.now()>d)return s(),a;h=0}}}endDrawing(){S(this,Ks,Xv).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),S(this,Ks,qv).call(this)}_scaleImage(e,t){const s=e.width??e.displayWidth,i=e.height??e.displayHeight;let r=Math.max(Math.hypot(t[0],t[1]),1),o=Math.max(Math.hypot(t[2],t[3]),1),a=s,c=i,u="prescale1",d,h;for(;r>2&&a>1||o>2&&c>1;){let f=a,p=c;r>2&&a>1&&(f=a>=16384?Math.floor(a/2)-1||1:Math.ceil(a/2),r/=a/f),o>2&&c>1&&(p=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c)/2,o/=c/p),d=this.cachedCanvases.getCanvas(u,f,p),h=d.context,h.clearRect(0,0,f,p),h.drawImage(e,0,0,a,c,0,0,f,p),e=d.canvas,a=f,c=p,u=u==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:a,paintHeight:c}}_createMaskCanvas(e){const t=this.ctx,{width:s,height:i}=e,r=this.current.fillColor,o=this.current.patternFill,a=Ue(t);let c,u,d,h;if((e.bitmap||e.data)&&e.count>1){const M=e.bitmap||e.data.buffer;u=JSON.stringify(o?a:[a.slice(0,4),r]),c=this._cachedBitmapsMap.get(M),c||(c=new Map,this._cachedBitmapsMap.set(M,c));const L=c.get(u);if(L&&!o){const N=Math.round(Math.min(a[0],a[2])+a[4]),B=Math.round(Math.min(a[1],a[3])+a[5]);return{canvas:L,offsetX:N,offsetY:B}}d=L}d||(h=this.cachedCanvases.getCanvas("maskCanvas",s,i),Jx(h.context,e));let f=Q.transform(a,[1/s,0,0,-1/i,0,0]);f=Q.transform(f,[1,0,0,1,0,-i]);const p=Vl.slice();Q.axialAlignedBoundingBox([0,0,s,i],f,p);const[y,g,A,v]=p,w=Math.round(A-y)||1,b=Math.round(v-g)||1,E=this.cachedCanvases.getCanvas("fillCanvas",w,b),C=E.context,T=y,k=g;C.translate(-T,-k),C.transform(...f),d||(d=this._scaleImage(h.canvas,ni(C)),d=d.img,c&&o&&c.set(u,d)),C.imageSmoothingEnabled=Zx(Ue(C),e.interpolate),up(C,d,0,0,d.width,d.height,0,0,s,i),C.globalCompositeOperation="source-in";const R=Q.transform(ni(C),[1,0,0,1,-T,-k]);return C.fillStyle=o?r.getPattern(t,this,R,Dt.FILL):r,C.fillRect(0,0,s,i),c&&!o&&(this.cachedCanvases.delete("fillCanvas"),c.set(u,E.canvas)),{canvas:E.canvas,offsetX:Math.round(T),offsetY:Math.round(k)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=KL[e]}setLineJoin(e){this.ctx.lineJoin=QL[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const s=this.ctx;s.setLineDash!==void 0&&(s.setLineDash(e),s.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,s]of e)switch(t){case"LW":this.setLineWidth(s);break;case"LC":this.setLineCap(s);break;case"LJ":this.setLineJoin(s);break;case"ML":this.setMiterLimit(s);break;case"D":this.setDash(s[0],s[1]);break;case"RI":this.setRenderingIntent(s);break;case"FL":this.setFlatness(s);break;case"Font":this.setFont(s[0],s[1]);break;case"CA":this.current.strokeAlpha=s;break;case"ca":this.ctx.globalAlpha=this.current.fillAlpha=s;break;case"BM":this.ctx.globalCompositeOperation=s;break;case"SMask":this.current.activeSMask=s?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(s);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(s,e,t);this.suspendedCtx=this.ctx;const r=this.ctx=i.context;r.setTransform(this.suspendedCtx.getTransform()),ju(this.suspendedCtx,r),qL(r,this.suspendedCtx),this.setGState([["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),ju(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,s,i){const r=i[0],o=i[1],a=i[2]-r,c=i[3]-o;a===0||c===0||(this.genericComposeSMask(t.context,s,a,c,t.subtype,t.backdrop,t.transferMap,r,o,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(s.canvas,0,0),e.restore())}genericComposeSMask(e,t,s,i,r,o,a,c,u,d,h){let f=e.canvas,p=c-d,y=u-h;if(o)if(p<0||y<0||p+s>f.width||y+i>f.height){const A=this.cachedCanvases.getCanvas("maskExtension",s,i),v=A.context;v.drawImage(f,-p,-y),v.globalCompositeOperation="destination-atop",v.fillStyle=o,v.fillRect(0,0,s,i),v.globalCompositeOperation="source-over",f=A.canvas,p=y=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const A=new Path2D;A.rect(p,y,s,i),e.clip(A),e.globalCompositeOperation="destination-atop",e.fillStyle=o,e.fillRect(p,y,s,i),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),r==="Alpha"&&a?t.filter=this.filterFactory.addAlphaFilter(a):r==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(a));const g=new Path2D;g.rect(c,u,s,i),t.clip(g),t.globalCompositeOperation="destination-in",t.drawImage(f,p,y,s,i,c,u,s,i),t.restore()}save(){this.inSMaskMode&&ju(this.ctx,this.suspendedCtx),this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){if(this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&ju(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,s,i,r,o){this.ctx.transform(e,t,s,i,r,o),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,s){let[i]=t;if(!s){i||(i=t[0]=new Path2D),this[e](i);return}if(!(i instanceof Path2D)){const r=t[0]=new Path2D;for(let o=0,a=i.length;o<a;)switch(i[o++]){case ap.moveTo:r.moveTo(i[o++],i[o++]);break;case ap.lineTo:r.lineTo(i[o++],i[o++]);break;case ap.curveTo:r.bezierCurveTo(i[o++],i[o++],i[o++],i[o++],i[o++],i[o++]);break;case ap.closePath:r.closePath();break;default:ne(`Unrecognized drawing path operator: ${i[o-1]}`);break}i=r}Q.axialAlignedBoundingBox(s,Ue(this.ctx),this.current.minMax),this[e](i)}closePath(){this.ctx.closePath()}stroke(e,t=!0){const s=this.ctx,i=this.current.strokeColor;if(s.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof i=="object"&&(i!=null&&i.getPattern)){const r=i.isModifyingCurrentTransform()?s.getTransform():null;if(s.save(),s.strokeStyle=i.getPattern(s,this,ni(s),Dt.STROKE),r){const o=new Path2D;o.addPath(e,s.getTransform().invertSelf().multiplySelf(r)),e=o}this.rescaleAndStroke(e,!1),s.restore()}else this.rescaleAndStroke(e,!0);t&&this.consumePath(e,this.current.getClippedPathBoundingBox(Dt.STROKE,Ue(this.ctx))),s.globalAlpha=this.current.fillAlpha}closeStroke(e){this.stroke(e)}fill(e,t=!0){const s=this.ctx,i=this.current.fillColor,r=this.current.patternFill;let o=!1;if(r){const c=i.isModifyingCurrentTransform()?s.getTransform():null;if(s.save(),s.fillStyle=i.getPattern(s,this,ni(s),Dt.FILL),c){const u=new Path2D;u.addPath(e,s.getTransform().invertSelf().multiplySelf(c)),e=u}o=!0}const a=this.current.getClippedPathBoundingBox();this.contentVisible&&a!==null&&(this.pendingEOFill?(s.fill(e,"evenodd"),this.pendingEOFill=!1):s.fill(e)),o&&s.restore(),t&&this.consumePath(e,a)}eoFill(e){this.pendingEOFill=!0,this.fill(e)}fillStroke(e){this.fill(e,!1),this.stroke(e,!1),this.consumePath(e)}eoFillStroke(e){this.pendingEOFill=!0,this.fillStroke(e)}closeFillStroke(e){this.fillStroke(e)}closeEOFillStroke(e){this.pendingEOFill=!0,this.fillStroke(e)}endPath(e){this.consumePath(e)}rawFillPath(e){this.ctx.fill(e)}clip(){this.pendingClip=JL}eoClip(){this.pendingClip=eS}beginText(){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(e===void 0)return;const s=new Path2D,i=t.getTransform().invertSelf();for(const{transform:r,x:o,y:a,fontSize:c,path:u}of e)s.addPath(u,new DOMMatrix(r).preMultiplySelf(i).translate(o,a).scale(c,-c));t.clip(s),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){var d;const s=this.commonObjs.get(e),i=this.current;if(!s)throw new Error(`Can't find font for ${e}`);if(i.fontMatrix=s.fontMatrix||Av,(i.fontMatrix[0]===0||i.fontMatrix[3]===0)&&ne("Invalid font matrix for font "+e),t<0?(t=-t,i.fontDirection=-1):i.fontDirection=1,this.current.font=s,this.current.fontSize=t,s.isType3Font)return;const r=s.loadedName||"sans-serif",o=((d=s.systemFontInfo)==null?void 0:d.css)||`"${r}", ${s.fallbackName}`;let a="normal";s.black?a="900":s.bold&&(a="bold");const c=s.italic?"italic":"normal";let u=t;t<Xx?u=Xx:t>qx&&(u=qx),this.current.fontSizeScale=t/u,this.ctx.font=`${c} ${a} ${u}px ${o}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e){const{current:t}=this;t.textMatrix=e,t.textMatrixScale=Math.hypot(e[0],e[1]),t.x=t.lineX=0,t.y=t.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,t,s,i,r){const o=this.ctx,a=this.current,c=a.font,u=a.textRenderingMode,d=a.fontSize/a.fontSizeScale,h=u&Ht.FILL_STROKE_MASK,f=!!(u&Ht.ADD_TO_PATH_FLAG),p=a.patternFill&&!c.missingFile,y=a.patternStroke&&!c.missingFile;let g;if((c.disableFontFace||f||p||y)&&(g=c.getPathGenerator(this.commonObjs,e)),c.disableFontFace||p||y){o.save(),o.translate(t,s),o.scale(d,-d);let A;if((h===Ht.FILL||h===Ht.FILL_STROKE)&&(i?(A=o.getTransform(),o.setTransform(...i),o.fill(S(this,Ks,Yv).call(this,g,A,i))):o.fill(g)),h===Ht.STROKE||h===Ht.FILL_STROKE)if(r){A||(A=o.getTransform()),o.setTransform(...r);const{a:v,b:w,c:b,d:E}=A,C=Q.inverseTransform(r),T=Q.transform([v,w,b,E,0,0],C);Q.singularValueDecompose2dScale(T,qn),o.lineWidth*=Math.max(qn[0],qn[1])/d,o.stroke(S(this,Ks,Yv).call(this,g,A,r))}else o.lineWidth/=d,o.stroke(g);o.restore()}else(h===Ht.FILL||h===Ht.FILL_STROKE)&&o.fillText(e,t,s),(h===Ht.STROKE||h===Ht.FILL_STROKE)&&o.strokeText(e,t,s);f&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:Ue(o),x:t,y:s,fontSize:d,path:g})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let s=!1;for(let i=3;i<t.length;i+=4)if(t[i]>0&&t[i]<255){s=!0;break}return le(this,"isFontSubpixelAAEnabled",s)}showText(e){const t=this.current,s=t.font;if(s.isType3Font)return this.showType3Text(e);const i=t.fontSize;if(i===0)return;const r=this.ctx,o=t.fontSizeScale,a=t.charSpacing,c=t.wordSpacing,u=t.fontDirection,d=t.textHScale*u,h=e.length,f=s.vertical,p=f?1:-1,y=s.defaultVMetrics,g=i*t.fontMatrix[0],A=t.textRenderingMode===Ht.FILL&&!s.disableFontFace&&!t.patternFill;r.save(),t.textMatrix&&r.transform(...t.textMatrix),r.translate(t.x,t.y+t.textRise),u>0?r.scale(d,-1):r.scale(d,1);let v,w;if(t.patternFill){r.save();const k=t.fillColor.getPattern(r,this,ni(r),Dt.FILL);v=Ue(r),r.restore(),r.fillStyle=k}if(t.patternStroke){r.save();const k=t.strokeColor.getPattern(r,this,ni(r),Dt.STROKE);w=Ue(r),r.restore(),r.strokeStyle=k}let b=t.lineWidth;const E=t.textMatrixScale;if(E===0||b===0){const k=t.textRenderingMode&Ht.FILL_STROKE_MASK;(k===Ht.STROKE||k===Ht.FILL_STROKE)&&(b=this.getSinglePixelWidth())}else b/=E;if(o!==1&&(r.scale(o,o),b/=o),r.lineWidth=b,s.isInvalidPDFjsFont){const k=[];let R=0;for(const M of e)k.push(M.unicode),R+=M.width;r.fillText(k.join(""),0,0),t.x+=R*g*d,r.restore(),this.compose();return}let C=0,T;for(T=0;T<h;++T){const k=e[T];if(typeof k=="number"){C+=p*k*i/1e3;continue}let R=!1;const M=(k.isSpace?c:0)+a,L=k.fontChar,N=k.accent;let B,H,W=k.width;if(f){const j=k.vmetric||y,O=-(k.vmetric?j[1]:W*.5)*g,I=j[2]*g;W=j?-j[0]:W,B=O/o,H=(C+I)/o}else B=C/o,H=0;if(s.remeasure&&W>0){const j=r.measureText(L).width*1e3/i*o;if(W<j&&this.isFontSubpixelAAEnabled){const O=W/j;R=!0,r.save(),r.scale(O,1),B/=O}else W!==j&&(B+=(W-j)/2e3*i/o)}if(this.contentVisible&&(k.isInFont||s.missingFile)){if(A&&!N)r.fillText(L,B,H);else if(this.paintChar(L,B,H,v,w),N){const j=B+i*N.offset.x/o,O=H-i*N.offset.y/o;this.paintChar(N.fontChar,j,O,v,w)}}const ee=f?W*g-M*u:W*g+M*u;C+=ee,R&&r.restore()}f?t.y-=C:t.x+=C*d,r.restore(),this.compose()}showType3Text(e){const t=this.ctx,s=this.current,i=s.font,r=s.fontSize,o=s.fontDirection,a=i.vertical?1:-1,c=s.charSpacing,u=s.wordSpacing,d=s.textHScale*o,h=s.fontMatrix||Av,f=e.length,p=s.textRenderingMode===Ht.INVISIBLE;let y,g,A,v;if(!(p||r===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),s.textMatrix&&t.transform(...s.textMatrix),t.translate(s.x,s.y+s.textRise),t.scale(d,o),y=0;y<f;++y){if(g=e[y],typeof g=="number"){v=a*g*r/1e3,this.ctx.translate(v,0),s.x+=v*d;continue}const w=(g.isSpace?u:0)+c,b=i.charProcOperatorList[g.operatorListId];b?this.contentVisible&&(this.save(),t.scale(r,r),t.transform(...h),this.executeOperatorList(b),this.restore()):ne(`Type3 character "${g.operatorListId}" is not available.`);const E=[g.width,0];Q.applyTransform(E,h),A=E[0]*r+w,t.translate(A,0),s.x+=A*d}t.restore()}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,s,i,r,o){const a=new Path2D;a.rect(s,i,r-s,o-i),this.ctx.clip(a),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){const s=this.baseTransform||Ue(this.ctx),i={createCanvasGraphics:r=>new ab(r,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new Wv(e,this.ctx,i,s)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e){this.ctx.strokeStyle=this.current.strokeColor=e,this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e){this.ctx.fillStyle=this.current.fillColor=e,this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let s;return this.cachedPatterns.has(e)?s=this.cachedPatterns.get(e):(s=GL(this.getObject(e)),this.cachedPatterns.set(e,s)),t&&(s.matrix=t),s}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const s=this._getPattern(e);t.fillStyle=s.getPattern(t,this,ni(t),Dt.SHADING);const i=ni(t);if(i){const{width:r,height:o}=t.canvas,a=Vl.slice();Q.axialAlignedBoundingBox([0,0,r,o],i,a);const[c,u,d,h]=a;this.ctx.fillRect(c,u,d-c,h-u)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){Ce("Should not call beginInlineImage")}beginImageData(){Ce("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=Ue(this.ctx),t)){Q.axialAlignedBoundingBox(t,this.baseTransform,this.current.minMax);const[s,i,r,o]=t,a=new Path2D;a.rect(s,i,r-s,o-i),this.ctx.clip(a),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||Cm("TODO: Support non-isolated groups."),e.knockout&&ne("Knockout groups not supported.");const s=Ue(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let i=Vl.slice();Q.axialAlignedBoundingBox(e.bbox,Ue(t),i);const r=[0,0,t.canvas.width,t.canvas.height];i=Q.intersect(i,r)||[0,0,0,0];const o=Math.floor(i[0]),a=Math.floor(i[1]),c=Math.max(Math.ceil(i[2])-o,1),u=Math.max(Math.ceil(i[3])-a,1);this.current.startNewPathAndClipBox([0,0,c,u]);let d="groupAt"+this.groupLevel;e.smask&&(d+="_smask_"+this.smaskCounter++%2);const h=this.cachedCanvases.getCanvas(d,c,u),f=h.context;f.translate(-o,-a),f.transform(...s);let p=new Path2D;const[y,g,A,v]=e.bbox;if(p.rect(y,g,A-y,v-g),e.matrix){const w=new Path2D;w.addPath(p,new DOMMatrix(e.matrix)),p=w}f.clip(p),e.smask?this.smaskStack.push({canvas:h.canvas,context:f,offsetX:o,offsetY:a,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(o,a),t.save()),ju(t,f),this.ctx=f,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const i=Ue(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...i);const r=Vl.slice();Q.axialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],i,r),this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(r)}}beginAnnotation(e,t,s,i,r){if(S(this,Ks,Xv).call(this),dp(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const o=t[2]-t[0],a=t[3]-t[1];if(r&&this.annotationCanvasMap){s=s.slice(),s[4]-=t[0],s[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=o,t[3]=a,Q.singularValueDecompose2dScale(Ue(this.ctx),qn);const{viewportScale:c}=this,u=Math.ceil(o*this.outputScaleX*c),d=Math.ceil(a*this.outputScaleY*c);this.annotationCanvas=this.canvasFactory.create(u,d);const{canvas:h,context:f}=this.annotationCanvas;this.annotationCanvasMap.set(e,h),this.annotationCanvas.savedCtx=this.ctx,this.ctx=f,this.ctx.save(),this.ctx.setTransform(qn[0],0,0,-qn[1],0,a*qn[1]),dp(this.ctx)}else{dp(this.ctx),this.endPath();const c=new Path2D;c.rect(t[0],t[1],o,a),this.ctx.clip(c)}}this.current=new Kx(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...s),this.transform(...i)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),S(this,Ks,qv).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;e=this.getObject(e.data,e),e.count=t;const s=this.ctx,i=this._createMaskCanvas(e),r=i.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(r,i.offsetX,i.offsetY),s.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,s=0,i=0,r,o){if(!this.contentVisible)return;e=this.getObject(e.data,e);const a=this.ctx;a.save();const c=Ue(a);a.transform(t,s,i,r,0,0);const u=this._createMaskCanvas(e);a.setTransform(1,0,0,1,u.offsetX-c[4],u.offsetY-c[5]);for(let d=0,h=o.length;d<h;d+=2){const f=Q.transform(c,[t,s,i,r,o[d],o[d+1]]);a.drawImage(u.canvas,f[4],f[5])}a.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,s=this.current.fillColor,i=this.current.patternFill;for(const r of e){const{data:o,width:a,height:c,transform:u}=r,d=this.cachedCanvases.getCanvas("maskCanvas",a,c),h=d.context;h.save();const f=this.getObject(o,r);Jx(h,f),h.globalCompositeOperation="source-in",h.fillStyle=i?s.getPattern(h,this,ni(t),Dt.FILL):s,h.fillRect(0,0,a,c),h.restore(),t.save(),t.transform(...u),t.scale(1,-1),up(t,d.canvas,0,0,a,c,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);if(!t){ne("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,s,i){if(!this.contentVisible)return;const r=this.getObject(e);if(!r){ne("Dependent image isn't ready yet");return}const o=r.width,a=r.height,c=[];for(let u=0,d=i.length;u<d;u+=2)c.push({transform:[t,0,0,s,i[u],i[u+1]],x:0,y:0,w:o,h:a});this.paintInlineImageXObjectGroup(r,c)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:s,height:i}=e,r=this.cachedCanvases.getCanvas("inlineImage",s,i),o=r.context;return o.filter=this.current.transferMaps,o.drawImage(t,0,0),o.filter="none",r.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,s=e.height,i=this.ctx;this.save();const{filter:r}=i;r!=="none"&&r!==""&&(i.filter="none"),i.scale(1/t,-1/s);let o;if(e.bitmap)o=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)o=e;else{const u=this.cachedCanvases.getCanvas("inlineImage",t,s).context;Qx(u,e),o=this.applyTransferMapsToCanvas(u)}const a=this._scaleImage(o,ni(i));i.imageSmoothingEnabled=Zx(Ue(i),e.interpolate),up(i,a.img,0,0,a.paintWidth,a.paintHeight,0,-s,t,s),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const s=this.ctx;let i;if(e.bitmap)i=e.bitmap;else{const r=e.width,o=e.height,c=this.cachedCanvases.getCanvas("inlineImage",r,o).context;Qx(c,e),i=this.applyTransferMapsToCanvas(c)}for(const r of t)s.save(),s.transform(...r.transform),s.scale(1,-1),up(s,i,r.x,r.y,r.w,r.h,0,-1,1,1),s.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e,t){const s=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(t);const i=this.ctx;this.pendingClip&&(s||(this.pendingClip===eS?i.clip(e,"evenodd"):i.clip(e)),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=Ue(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),s=Math.hypot(e[0],e[2]),i=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(s,i)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:s,c:i,d:r}=this.ctx.getTransform();let o,a;if(s===0&&i===0){const c=Math.abs(t),u=Math.abs(r);if(c===u)if(e===0)o=a=1/c;else{const d=c*e;o=a=d<1?1/d:1}else if(e===0)o=1/c,a=1/u;else{const d=c*e,h=u*e;o=d<1?1/d:1,a=h<1?1/h:1}}else{const c=Math.abs(t*r-s*i),u=Math.hypot(t,s),d=Math.hypot(i,r);if(e===0)o=d/c,a=u/c;else{const h=e*c;o=d>h?d/h:1,a=u>h?u/h:1}}this._cachedScaleForStroking[0]=o,this._cachedScaleForStroking[1]=a}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:s,current:{lineWidth:i}}=this,[r,o]=this.getScaleForStroking();if(r===o){s.lineWidth=(i||1)*r,s.stroke(e);return}const a=s.getLineDash();t&&s.save(),s.scale(r,o),Sy.a=1/r,Sy.d=1/o;const c=new Path2D;if(c.addPath(e,Sy),a.length>0){const u=Math.max(r,o);s.setLineDash(a.map(d=>d/u)),s.lineDashOffset/=u}s.lineWidth=i||1,s.stroke(c),t&&s.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};Ks=new WeakSet,Xv=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},qv=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},Yv=function(e,t,s){const i=new Path2D;return i.addPath(e,new DOMMatrix(s).invertSelf().multiplySelf(t)),i};let ec=ab;for(const n in Vd)ec.prototype[n]!==void 0&&(ec.prototype[Vd[n]]=ec.prototype[n]);var Ah,Eh;class gs{static get workerPort(){return l(this,Ah)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");m(this,Ah,e)}static get workerSrc(){return l(this,Eh)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");m(this,Eh,e)}}Ah=new WeakMap,Eh=new WeakMap,x(gs,Ah,null),x(gs,Eh,"");var xc,_h;class ZL{constructor({parsedData:e,rawData:t}){x(this,xc);x(this,_h);m(this,xc,e),m(this,_h,t)}getRaw(){return l(this,_h)}get(e){return l(this,xc).get(e)??null}[Symbol.iterator](){return l(this,xc).entries()}}xc=new WeakMap,_h=new WeakMap;const Tl=Symbol("INTERNAL");var Ch,kh,Th,Sc;class eN{constructor(e,{name:t,intent:s,usage:i,rbGroups:r}){x(this,Ch,!1);x(this,kh,!1);x(this,Th,!1);x(this,Sc,!0);m(this,Ch,!!(e&Wn.DISPLAY)),m(this,kh,!!(e&Wn.PRINT)),this.name=t,this.intent=s,this.usage=i,this.rbGroups=r}get visible(){if(l(this,Th))return l(this,Sc);if(!l(this,Sc))return!1;const{print:e,view:t}=this.usage;return l(this,Ch)?(t==null?void 0:t.viewState)!=="OFF":l(this,kh)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,s=!1){e!==Tl&&Ce("Internal method `_setVisible` called."),m(this,Th,s),m(this,Sc,t)}}Ch=new WeakMap,kh=new WeakMap,Th=new WeakMap,Sc=new WeakMap;var eo,Ee,Ac,Ec,Ph,Kv;class tN{constructor(e,t=Wn.DISPLAY){x(this,Ph);x(this,eo,null);x(this,Ee,new Map);x(this,Ac,null);x(this,Ec,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,m(this,Ec,e.order);for(const s of e.groups)l(this,Ee).set(s.id,new eN(t,s));if(e.baseState==="OFF")for(const s of l(this,Ee).values())s._setVisible(Tl,!1);for(const s of e.on)l(this,Ee).get(s)._setVisible(Tl,!0);for(const s of e.off)l(this,Ee).get(s)._setVisible(Tl,!1);m(this,Ac,this.getHash())}}isVisible(e){if(l(this,Ee).size===0)return!0;if(!e)return Cm("Optional content group not defined."),!0;if(e.type==="OCG")return l(this,Ee).has(e.id)?l(this,Ee).get(e.id).visible:(ne(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return S(this,Ph,Kv).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!l(this,Ee).has(t))return ne(`Optional content group not found: ${t}`),!0;if(l(this,Ee).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!l(this,Ee).has(t))return ne(`Optional content group not found: ${t}`),!0;if(!l(this,Ee).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!l(this,Ee).has(t))return ne(`Optional content group not found: ${t}`),!0;if(!l(this,Ee).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!l(this,Ee).has(t))return ne(`Optional content group not found: ${t}`),!0;if(l(this,Ee).get(t).visible)return!1}return!0}return ne(`Unknown optional content policy ${e.policy}.`),!0}return ne(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,s=!0){var r;const i=l(this,Ee).get(e);if(!i){ne(`Optional content group not found: ${e}`);return}if(s&&t&&i.rbGroups.length)for(const o of i.rbGroups)for(const a of o)a!==e&&((r=l(this,Ee).get(a))==null||r._setVisible(Tl,!1,!0));i._setVisible(Tl,!!t,!0),m(this,eo,null)}setOCGState({state:e,preserveRB:t}){let s;for(const i of e){switch(i){case"ON":case"OFF":case"Toggle":s=i;continue}const r=l(this,Ee).get(i);if(r)switch(s){case"ON":this.setVisibility(i,!0,t);break;case"OFF":this.setVisibility(i,!1,t);break;case"Toggle":this.setVisibility(i,!r.visible,t);break}}m(this,eo,null)}get hasInitialVisibility(){return l(this,Ac)===null||this.getHash()===l(this,Ac)}getOrder(){return l(this,Ee).size?l(this,Ec)?l(this,Ec).slice():[...l(this,Ee).keys()]:null}getGroup(e){return l(this,Ee).get(e)||null}getHash(){if(l(this,eo)!==null)return l(this,eo);const e=new HE;for(const[t,s]of l(this,Ee))e.update(`${t}:${s.visible}`);return m(this,eo,e.hexdigest())}[Symbol.iterator](){return l(this,Ee).entries()}}eo=new WeakMap,Ee=new WeakMap,Ac=new WeakMap,Ec=new WeakMap,Ph=new WeakSet,Kv=function(e){const t=e.length;if(t<2)return!0;const s=e[0];for(let i=1;i<t;i++){const r=e[i];let o;if(Array.isArray(r))o=S(this,Ph,Kv).call(this,r);else if(l(this,Ee).has(r))o=l(this,Ee).get(r).visible;else return ne(`Optional content group not found: ${r}`),!0;switch(s){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return s==="And"};class nN{constructor(e,{disableRange:t=!1,disableStream:s=!1}){ot(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:i,initialData:r,progressiveDone:o,contentDispositionFilename:a}=e;if(this._queuedChunks=[],this._progressiveDone=o,this._contentDispositionFilename=a,(r==null?void 0:r.length)>0){const c=r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer;this._queuedChunks.push(c)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!s,this._isRangeSupported=!t,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((c,u)=>{this._onReceiveData({begin:c,chunk:u})}),e.addProgressListener((c,u)=>{this._onProgress({loaded:c,total:u})}),e.addProgressiveReadListener(c=>{this._onReceiveData({chunk:c})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const s=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(s):this._queuedChunks.push(s);else{const i=this._rangeReaders.some(function(r){return r._begin!==e?!1:(r._enqueue(s),!0)});ot(i,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var t,s,i,r;e.total===void 0?(s=(t=this._rangeReaders[0])==null?void 0:t.onProgress)==null||s.call(t,{loaded:e.loaded}):(r=(i=this._fullRequestReader)==null?void 0:i.onProgress)==null||r.call(i,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){ot(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new sN(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new iN(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeReaders.slice(0))s.cancel(e);this._pdfDataRangeTransport.abort()}}class sN{constructor(e,t,s=!1,i=null){this._stream=e,this._done=s||!1,this._filename=Tm(i)?i:null,this._queuedChunks=t||[],this._loaded=0;for(const r of this._queuedChunks)this._loaded+=r.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class iN{constructor(e,t,s){this._stream=e,this._begin=t,this._end=s,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function rN(n){let e=!0,t=s("filename\\*","i").exec(n);if(t){t=t[1];let d=a(t);return d=unescape(d),d=c(d),d=u(d),r(d)}if(t=o(n),t){const d=u(t);return r(d)}if(t=s("filename","i").exec(n),t){t=t[1];let d=a(t);return d=u(d),r(d)}function s(d,h){return new RegExp("(?:^|;)\\s*"+d+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',h)}function i(d,h){if(d){if(!/^[\x00-\xFF]+$/.test(h))return h;try{const f=new TextDecoder(d,{fatal:!0}),p=Df(h);h=f.decode(p),e=!1}catch{}}return h}function r(d){return e&&/[\x80-\xff]/.test(d)&&(d=i("utf-8",d),e&&(d=i("iso-8859-1",d))),d}function o(d){const h=[];let f;const p=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(f=p.exec(d))!==null;){let[,g,A,v]=f;if(g=parseInt(g,10),g in h){if(g===0)break;continue}h[g]=[A,v]}const y=[];for(let g=0;g<h.length&&g in h;++g){let[A,v]=h[g];v=a(v),A&&(v=unescape(v),g===0&&(v=c(v))),y.push(v)}return y.join("")}function a(d){if(d.startsWith('"')){const h=d.slice(1).split('\\"');for(let f=0;f<h.length;++f){const p=h[f].indexOf('"');p!==-1&&(h[f]=h[f].slice(0,p),h.length=f+1),h[f]=h[f].replaceAll(/\\(.)/g,"$1")}d=h.join('"')}return d}function c(d){const h=d.indexOf("'");if(h===-1)return d;const f=d.slice(0,h),y=d.slice(h+1).replace(/^[^']*'/,"");return i(f,y)}function u(d){return!d.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(d)?d:d.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(h,f,p,y){if(p==="q"||p==="Q")return y=y.replaceAll("_"," "),y=y.replaceAll(/=([0-9a-fA-F]{2})/g,function(g,A){return String.fromCharCode(parseInt(A,16))}),i(f,y);try{y=atob(y)}catch{}return i(f,y)})}return""}function t_(n,e){const t=new Headers;if(!n||!e||typeof e!="object")return t;for(const s in e){const i=e[s];i!==void 0&&t.append(s,i)}return t}function Rm(n){var e;return((e=URL.parse(n))==null?void 0:e.origin)??null}function n_({responseHeaders:n,isHttp:e,rangeChunkSize:t,disableRange:s}){const i={allowRangeRequests:!1,suggestedLength:void 0},r=parseInt(n.get("Content-Length"),10);return!Number.isInteger(r)||(i.suggestedLength=r,r<=2*t)||s||!e||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(i.allowRangeRequests=!0),i}function s_(n){const e=n.get("Content-Disposition");if(e){let t=rN(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(Tm(t))return t}return null}function jf(n,e){return new Gd(`Unexpected server response (${n}) while retrieving PDF "${e}".`,n,n===404||n===0&&e.startsWith("file:"))}function i_(n){return n===200||n===206}function r_(n,e,t){return{method:"GET",headers:n,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function o_(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(ne(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class oN{constructor(e){F(this,"_responseOrigin",null);this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=t_(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return ot(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new aN(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new lN(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class aN{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const s=new Headers(e.headers),i=t.url;fetch(i,r_(s,this._withCredentials,this._abortController)).then(r=>{if(e._responseOrigin=Rm(r.url),!i_(r.status))throw jf(r.status,i);this._reader=r.body.getReader(),this._headersCapability.resolve();const o=r.headers,{allowRangeRequests:a,suggestedLength:c}=n_({responseHeaders:o,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=a,this._contentLength=c||this._contentLength,this._filename=s_(o),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Er("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:o_(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class lN{constructor(e,t,s){this._stream=e,this._reader=null,this._loaded=0;const i=e.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const r=new Headers(e.headers);r.append("Range",`bytes=${t}-${s-1}`);const o=i.url;fetch(o,r_(r,this._withCredentials,this._abortController)).then(a=>{const c=Rm(a.url);if(c!==e._responseOrigin)throw new Error(`Expected range response-origin "${c}" to match "${e._responseOrigin}".`);if(!i_(a.status))throw jf(a.status,o);this._readCapability.resolve(),this._reader=a.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:o_(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}const Ay=200,Ey=206;function cN(n){const e=n.response;return typeof e!="string"?e:Df(e).buffer}class uN{constructor({url:e,httpHeaders:t,withCredentials:s}){F(this,"_responseOrigin",null);this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=t_(this.isHttp,t),this.withCredentials=s||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,s=this.currXhrId++,i=this.pendingRequests[s]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[r,o]of this.headers)t.setRequestHeader(r,o);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),i.expectedStatus=Ey):i.expectedStatus=Ay,t.responseType="arraybuffer",ot(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,s),t.onprogress=this.onProgress.bind(this,s),i.onHeadersReceived=e.onHeadersReceived,i.onDone=e.onDone,i.onError=e.onError,i.onProgress=e.onProgress,t.send(null),s}onProgress(e,t){var i;const s=this.pendingRequests[e];s&&((i=s.onProgress)==null||i.call(s,t))}onStateChange(e,t){const s=this.pendingRequests[e];if(!s)return;const i=s.xhr;if(i.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),i.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],i.status===0&&this.isHttp){s.onError(i.status);return}const r=i.status||Ay;if(!(r===Ay&&s.expectedStatus===Ey)&&r!==s.expectedStatus){s.onError(i.status);return}const a=cN(i);if(r===Ey){const c=i.getResponseHeader("Content-Range"),u=/bytes (\d+)-(\d+)\/(\d+)/.exec(c);u?s.onDone({begin:parseInt(u[1],10),chunk:a}):(ne('Missing or invalid "Content-Range" header.'),s.onError(0))}else a?s.onDone({begin:0,chunk:a}):s.onError(i.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class dN{constructor(e){this._source=e,this._manager=new uN(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return ot(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new hN(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const s=new fN(this._manager,e,t);return s.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class hN{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=Rm(t.responseURL);const s=t.getAllResponseHeaders(),i=new Headers(s?s.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(a=>{const[c,...u]=a.split(": ");return[c,u.join(": ")]}):[]),{allowRangeRequests:r,suggestedLength:o}=n_({responseHeaders:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});r&&(this._isRangeSupported=!0),this._contentLength=o||this._contentLength,this._filename=s_(i),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=jf(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;(t=this.onProgress)==null||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class fN{constructor(e,t,s){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:s,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var t;const e=Rm((t=this._manager.getRequestXhr(this._requestId))==null?void 0:t.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=jf(e,this._url));for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(t=this.onProgress)==null||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const pN=/^[a-z][a-z0-9\-+.]+:/i;function gN(n){if(pN.test(n))return new URL(n);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(n))}class mN{constructor(e){this.source=e,this.url=gN(e.url),ot(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return ot(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new yN(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new vN(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class yN{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const s=process.getBuiltinModule("fs");s.promises.lstat(this._url).then(i=>{this._contentLength=i.size,this._setReadableStream(s.createReadStream(this._url)),this._headersCapability.resolve()},i=>{i.code==="ENOENT"&&(i=jf(0,this._url.href)),this._storedError=i,this._headersCapability.reject(i)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Er("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class vN{constructor(e,t,s){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const i=e.source;this._isStreamingSupported=!i.disableStream;const r=process.getBuiltinModule("fs");this._setReadableStream(r.createReadStream(this._url,{start:t,end:s-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const zu=Symbol("INITIAL_DATA");var On,Rh,Qv;class a_{constructor(){x(this,Rh);x(this,On,Object.create(null))}get(e,t=null){if(t){const i=S(this,Rh,Qv).call(this,e);return i.promise.then(()=>t(i.data)),null}const s=l(this,On)[e];if(!s||s.data===zu)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return s.data}has(e){const t=l(this,On)[e];return!!t&&t.data!==zu}delete(e){const t=l(this,On)[e];return!t||t.data===zu?!1:(delete l(this,On)[e],!0)}resolve(e,t=null){const s=S(this,Rh,Qv).call(this,e);s.data=t,s.resolve()}clear(){var e;for(const t in l(this,On)){const{data:s}=l(this,On)[t];(e=s==null?void 0:s.bitmap)==null||e.close()}m(this,On,Object.create(null))}*[Symbol.iterator](){for(const e in l(this,On)){const{data:t}=l(this,On)[e];t!==zu&&(yield[e,t])}}}On=new WeakMap,Rh=new WeakSet,Qv=function(e){var t;return(t=l(this,On))[e]||(t[e]={...Promise.withResolvers(),data:zu})};const wN=1e5,tS=30;var mS,to,mn,Lh,Nh,Ea,Ji,Mh,Dh,_a,_c,Cc,no,kc,Ih,Tc,Ca,Oh,Fh,Ye,Pc,ka,jh,so,Rc,Cr,l_,c_,Jv,Jn,Fp,Zv,u_,d_;let Xd=(Ye=class{constructor({textContentSource:e,container:t,viewport:s}){x(this,Cr);x(this,to,Promise.withResolvers());x(this,mn,null);x(this,Lh,!1);x(this,Nh,!!((mS=globalThis.FontInspector)!=null&&mS.enabled));x(this,Ea,null);x(this,Ji,null);x(this,Mh,0);x(this,Dh,0);x(this,_a,null);x(this,_c,null);x(this,Cc,0);x(this,no,0);x(this,kc,Object.create(null));x(this,Ih,[]);x(this,Tc,null);x(this,Ca,[]);x(this,Oh,new WeakMap);x(this,Fh,null);var c;if(e instanceof ReadableStream)m(this,Tc,e);else if(typeof e=="object")m(this,Tc,new ReadableStream({start(u){u.enqueue(e),u.close()}}));else throw new Error('No "textContentSource" parameter specified.');m(this,mn,m(this,_c,t)),m(this,no,s.scale*Ys.pixelRatio),m(this,Cc,s.rotation),m(this,Ji,{div:null,properties:null,ctx:null});const{pageWidth:i,pageHeight:r,pageX:o,pageY:a}=s.rawDims;m(this,Fh,[1,0,0,-1,-o,a+r]),m(this,Dh,i),m(this,Mh,r),S(c=Ye,Jn,u_).call(c),Oo(t,s),l(this,to).promise.finally(()=>{l(Ye,Rc).delete(this),m(this,Ji,null),m(this,kc,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=_t.platform;return le(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{l(this,_a).read().then(({value:t,done:s})=>{if(s){l(this,to).resolve();return}l(this,Ea)??m(this,Ea,t.lang),Object.assign(l(this,kc),t.styles),S(this,Cr,l_).call(this,t.items),e()},l(this,to).reject)};return m(this,_a,l(this,Tc).getReader()),l(Ye,Rc).add(this),e(),l(this,to).promise}update({viewport:e,onBefore:t=null}){var r;const s=e.scale*Ys.pixelRatio,i=e.rotation;if(i!==l(this,Cc)&&(t==null||t(),m(this,Cc,i),Oo(l(this,_c),{rotation:i})),s!==l(this,no)){t==null||t(),m(this,no,s);const o={div:null,properties:null,ctx:S(r=Ye,Jn,Fp).call(r,l(this,Ea))};for(const a of l(this,Ca))o.properties=l(this,Oh).get(a),o.div=a,S(this,Cr,Jv).call(this,o)}}cancel(){var t;const e=new Er("TextLayer task cancelled.");(t=l(this,_a))==null||t.cancel(e).catch(()=>{}),m(this,_a,null),l(this,to).reject(e)}get textDivs(){return l(this,Ca)}get textContentItemsStr(){return l(this,Ih)}static cleanup(){if(!(l(this,Rc).size>0)){l(this,Pc).clear();for(const{canvas:e}of l(this,ka).values())e.remove();l(this,ka).clear()}}},to=new WeakMap,mn=new WeakMap,Lh=new WeakMap,Nh=new WeakMap,Ea=new WeakMap,Ji=new WeakMap,Mh=new WeakMap,Dh=new WeakMap,_a=new WeakMap,_c=new WeakMap,Cc=new WeakMap,no=new WeakMap,kc=new WeakMap,Ih=new WeakMap,Tc=new WeakMap,Ca=new WeakMap,Oh=new WeakMap,Fh=new WeakMap,Pc=new WeakMap,ka=new WeakMap,jh=new WeakMap,so=new WeakMap,Rc=new WeakMap,Cr=new WeakSet,l_=function(e){var i,r;if(l(this,Lh))return;(r=l(this,Ji)).ctx??(r.ctx=S(i=Ye,Jn,Fp).call(i,l(this,Ea)));const t=l(this,Ca),s=l(this,Ih);for(const o of e){if(t.length>wN){ne("Ignoring additional textDivs for performance reasons."),m(this,Lh,!0);return}if(o.str===void 0){if(o.type==="beginMarkedContentProps"||o.type==="beginMarkedContent"){const a=l(this,mn);m(this,mn,document.createElement("span")),l(this,mn).classList.add("markedContent"),o.id!==null&&l(this,mn).setAttribute("id",`${o.id}`),a.append(l(this,mn))}else o.type==="endMarkedContent"&&m(this,mn,l(this,mn).parentNode);continue}s.push(o.str),S(this,Cr,c_).call(this,o)}},c_=function(e){var g;const t=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};l(this,Ca).push(t);const i=Q.transform(l(this,Fh),e.transform);let r=Math.atan2(i[1],i[0]);const o=l(this,kc)[e.fontName];o.vertical&&(r+=Math.PI/2);let a=l(this,Nh)&&o.fontSubstitution||o.fontFamily;a=Ye.fontFamilyMap.get(a)||a;const c=Math.hypot(i[2],i[3]),u=c*S(g=Ye,Jn,d_).call(g,a,o,l(this,Ea));let d,h;r===0?(d=i[4],h=i[5]-u):(d=i[4]+u*Math.sin(r),h=i[5]-u*Math.cos(r));const f="calc(var(--total-scale-factor) *",p=t.style;l(this,mn)===l(this,_c)?(p.left=`${(100*d/l(this,Dh)).toFixed(2)}%`,p.top=`${(100*h/l(this,Mh)).toFixed(2)}%`):(p.left=`${f}${d.toFixed(2)}px)`,p.top=`${f}${h.toFixed(2)}px)`),p.fontSize=`${f}${(l(Ye,so)*c).toFixed(2)}px)`,p.fontFamily=a,s.fontSize=c,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,l(this,Nh)&&(t.dataset.fontName=o.fontSubstitutionLoadedName||e.fontName),r!==0&&(s.angle=r*(180/Math.PI));let y=!1;if(e.str.length>1)y=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const A=Math.abs(e.transform[0]),v=Math.abs(e.transform[3]);A!==v&&Math.max(A,v)/Math.min(A,v)>1.5&&(y=!0)}if(y&&(s.canvasWidth=o.vertical?e.height:e.width),l(this,Oh).set(t,s),l(this,Ji).div=t,l(this,Ji).properties=s,S(this,Cr,Jv).call(this,l(this,Ji)),s.hasText&&l(this,mn).append(t),s.hasEOL){const A=document.createElement("br");A.setAttribute("role","presentation"),l(this,mn).append(A)}},Jv=function(e){var a;const{div:t,properties:s,ctx:i}=e,{style:r}=t;let o="";if(l(Ye,so)>1&&(o=`scale(${1/l(Ye,so)})`),s.canvasWidth!==0&&s.hasText){const{fontFamily:c}=r,{canvasWidth:u,fontSize:d}=s;S(a=Ye,Jn,Zv).call(a,i,d*l(this,no),c);const{width:h}=i.measureText(t.textContent);h>0&&(o=`scaleX(${u*l(this,no)/h}) ${o}`)}s.angle!==0&&(o=`rotate(${s.angle}deg) ${o}`),o.length>0&&(r.transform=o)},Jn=new WeakSet,Fp=function(e=null){let t=l(this,ka).get(e||(e=""));if(!t){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=e,document.body.append(s),t=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),l(this,ka).set(e,t),l(this,jh).set(t,{size:0,family:""})}return t},Zv=function(e,t,s){const i=l(this,jh).get(e);t===i.size&&s===i.family||(e.font=`${t}px ${s}`,i.size=t,i.family=s)},u_=function(){if(l(this,so)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),m(this,so,e.getBoundingClientRect().height),e.remove()},d_=function(e,t,s){const i=l(this,Pc).get(e);if(i)return i;const r=S(this,Jn,Fp).call(this,s);r.canvas.width=r.canvas.height=tS,S(this,Jn,Zv).call(this,r,tS,e);const o=r.measureText(""),a=o.fontBoundingBoxAscent,c=Math.abs(o.fontBoundingBoxDescent);r.canvas.width=r.canvas.height=0;let u=.8;return a?u=a/(a+c):(_t.platform.isFirefox&&ne("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?u=t.ascent:t.descent&&(u=1+t.descent)),l(this,Pc).set(e,u),u},x(Ye,Jn),x(Ye,Pc,new Map),x(Ye,ka,new Map),x(Ye,jh,new WeakMap),x(Ye,so,null),x(Ye,Rc,new Set),Ye);class qd{static textContent(e){const t=[],s={items:t,styles:Object.create(null)};function i(r){var c;if(!r)return;let o=null;const a=r.name;if(a==="#text")o=r.value;else if(qd.shouldBuildText(a))(c=r==null?void 0:r.attributes)!=null&&c.textContent?o=r.attributes.textContent:r.value&&(o=r.value);else return;if(o!==null&&t.push({str:o}),!!r.children)for(const u of r.children)i(u)}return i(e),s}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}const bN=100;function Kw(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const e=new e0,{docId:t}=e,s=n.url?RL(n.url):null,i=n.data?LL(n.data):null,r=n.httpHeaders||null,o=n.withCredentials===!0,a=n.password??null,c=n.range instanceof Qw?n.range:null,u=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:2**16;let d=n.worker instanceof vu?n.worker:null;const h=n.verbosity,f=typeof n.docBaseUrl=="string"&&!Of(n.docBaseUrl)?n.docBaseUrl:null,p=lp(n.cMapUrl),y=n.cMapPacked!==!1,g=n.CMapReaderFactory||(rn?jL:Ux),A=lp(n.iccUrl),v=lp(n.standardFontDataUrl),w=n.StandardFontDataFactory||(rn?zL:Vx),b=lp(n.wasmUrl),E=n.WasmFactory||(rn?$L:Gx),C=n.stopAtErrors!==!0,T=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,k=n.isEvalSupported!==!1,R=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!rn,M=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!rn&&(_t.platform.isFirefox||!globalThis.chrome),L=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,N=typeof n.disableFontFace=="boolean"?n.disableFontFace:rn,B=n.fontExtraProperties===!0,H=n.enableXfa===!0,W=n.ownerDocument||globalThis.document,ee=n.disableRange===!0,j=n.disableStream===!0,O=n.disableAutoFetch===!0,I=n.pdfBug===!0,V=n.CanvasFactory||(rn?FL:DL),K=n.FilterFactory||(rn?OL:IL),re=n.enableHWA===!0,J=n.useWasm!==!1,oe=c?c.length:n.length??NaN,Re=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!rn&&!N,Xe=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:!!(g===Ux&&w===Vx&&E===Gx&&p&&v&&b&&Wu(p,document.baseURI)&&Wu(v,document.baseURI)&&Wu(b,document.baseURI)),fe=null;hL(h);const pe={canvasFactory:new V({ownerDocument:W,enableHWA:re}),filterFactory:new K({docId:t,ownerDocument:W}),cMapReaderFactory:Xe?null:new g({baseUrl:p,isCompressed:y}),standardFontDataFactory:Xe?null:new w({baseUrl:v}),wasmFactory:Xe?null:new E({baseUrl:b})};d||(d=vu.create({verbosity:h,port:gs.workerPort}),e._worker=d);const _n={docId:t,apiVersion:"5.3.31",data:i,password:a,disableAutoFetch:O,rangeChunkSize:u,length:oe,docBaseUrl:f,enableXfa:H,evaluatorOptions:{maxImageSize:T,disableFontFace:N,ignoreErrors:C,isEvalSupported:k,isOffscreenCanvasSupported:R,isImageDecoderSupported:M,canvasMaxAreaInBytes:L,fontExtraProperties:B,useSystemFonts:Re,useWasm:J,useWorkerFetch:Xe,cMapUrl:p,iccUrl:A,standardFontDataUrl:v,wasmUrl:b}},Cn={ownerDocument:W,pdfBug:I,styleElement:fe,loadingParams:{disableAutoFetch:O,enableXfa:H}};return d.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const ue=d.messageHandler.sendWithPromise("GetDocRequest",_n,i?[i.buffer]:null);let kn;if(c)kn=new nN(c,{disableRange:ee,disableStream:j});else if(!i){if(!s)throw new Error("getDocument - no `url` parameter provided.");const Ct=Wu(s)?oN:rn?mN:dN;kn=new Ct({url:s,length:oe,httpHeaders:r,withCredentials:o,rangeChunkSize:u,disableRange:ee,disableStream:j})}return ue.then(Ct=>{if(e.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const gt=new Qu(t,Ct,d.port),ge=new AN(gt,e,kn,Cn,pe);e._transport=ge,gt.send("Ready",null)})}).catch(e._capability.reject),e}var qg;const Yg=class Yg{constructor(){F(this,"_capability",Promise.withResolvers());F(this,"_transport",null);F(this,"_worker",null);F(this,"docId",`d${Jt(Yg,qg)._++}`);F(this,"destroyed",!1);F(this,"onPassword",null);F(this,"onProgress",null)}get promise(){return this._capability.promise}async destroy(){var e,t,s,i;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(r){throw(s=this._worker)!=null&&s.port&&delete this._worker._pendingDestroy,r}this._transport=null,(i=this._worker)==null||i.destroy(),this._worker=null}async getData(){return this._transport.getData()}};qg=new WeakMap,x(Yg,qg,0);let e0=Yg;var Ta,zh,$h,Bh,Hh,yS;let Qw=(yS=class{constructor(e,t,s=!1,i=null){x(this,Ta,Promise.withResolvers());x(this,zh,[]);x(this,$h,[]);x(this,Bh,[]);x(this,Hh,[]);this.length=e,this.initialData=t,this.progressiveDone=s,this.contentDispositionFilename=i}addRangeListener(e){l(this,Hh).push(e)}addProgressListener(e){l(this,Bh).push(e)}addProgressiveReadListener(e){l(this,$h).push(e)}addProgressiveDoneListener(e){l(this,zh).push(e)}onDataRange(e,t){for(const s of l(this,Hh))s(e,t)}onDataProgress(e,t){l(this,Ta).promise.then(()=>{for(const s of l(this,Bh))s(e,t)})}onDataProgressiveRead(e){l(this,Ta).promise.then(()=>{for(const t of l(this,$h))t(e)})}onDataProgressiveDone(){l(this,Ta).promise.then(()=>{for(const e of l(this,zh))e()})}transportReady(){l(this,Ta).resolve()}requestDataRange(e,t){Ce("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}},Ta=new WeakMap,zh=new WeakMap,$h=new WeakMap,Bh=new WeakMap,Hh=new WeakMap,yS);class xN{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return le(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var Zi,Pa,nd;class SN{constructor(e,t,s,i=!1){x(this,Pa);x(this,Zi,!1);this._pageIndex=e,this._pageInfo=t,this._transport=s,this._stats=i?new $x:null,this._pdfBug=i,this.commonObjs=s.commonObjs,this.objs=new a_,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:s=0,offsetY:i=0,dontFlip:r=!1}={}){return new If({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:s,offsetY:i,dontFlip:r})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return le(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,viewport:t,intent:s="display",annotationMode:i=Ai.ENABLE,transform:r=null,background:o=null,optionalContentConfigPromise:a=null,annotationCanvasMap:c=null,pageColors:u=null,printAnnotationStorage:d=null,isEditing:h=!1}){var E,C;(E=this._stats)==null||E.time("Overall");const f=this._transport.getRenderingIntent(s,i,d,h),{renderingIntent:p,cacheKey:y}=f;m(this,Zi,!1),a||(a=this._transport.getOptionalContentConfig(p));let g=this._intentStates.get(y);g||(g=Object.create(null),this._intentStates.set(y,g)),g.streamReaderCancelTimeout&&(clearTimeout(g.streamReaderCancelTimeout),g.streamReaderCancelTimeout=null);const A=!!(p&Wn.PRINT);g.displayReadyCapability||(g.displayReadyCapability=Promise.withResolvers(),g.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(C=this._stats)==null||C.time("Page Request"),this._pumpOperatorList(f));const v=T=>{var k;g.renderTasks.delete(w),A&&m(this,Zi,!0),S(this,Pa,nd).call(this),T?(w.capability.reject(T),this._abortOperatorList({intentState:g,reason:T instanceof Error?T:new Error(T)})):w.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(k=globalThis.Stats)!=null&&k.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},w=new t0({callback:v,params:{canvasContext:e,viewport:t,transform:r,background:o},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:c,operatorList:g.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!A,pdfBug:this._pdfBug,pageColors:u});(g.renderTasks||(g.renderTasks=new Set)).add(w);const b=w.task;return Promise.all([g.displayReadyCapability.promise,a]).then(([T,k])=>{var R;if(this.destroyed){v();return}if((R=this._stats)==null||R.time("Rendering"),!(k.renderingIntent&p))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");w.initializeGraphics({transparency:T,optionalContentConfig:k}),w.operatorListChanged()}).catch(v),b}getOperatorList({intent:e="display",annotationMode:t=Ai.ENABLE,printAnnotationStorage:s=null,isEditing:i=!1}={}){var u;function r(){a.operatorList.lastChunk&&(a.opListReadCapability.resolve(a.operatorList),a.renderTasks.delete(c))}const o=this._transport.getRenderingIntent(e,t,s,i,!0);let a=this._intentStates.get(o.cacheKey);a||(a=Object.create(null),this._intentStates.set(o.cacheKey,a));let c;return a.opListReadCapability||(c=Object.create(null),c.operatorListChanged=r,a.opListReadCapability=Promise.withResolvers(),(a.renderTasks||(a.renderTasks=new Set)).add(c),a.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(u=this._stats)==null||u.time("Page Request"),this._pumpOperatorList(o)),a.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(s=>qd.textContent(s));const t=this.streamTextContent(e);return new Promise(function(s,i){function r(){o.read().then(function({value:c,done:u}){if(u){s(a);return}a.lang??(a.lang=c.lang),Object.assign(a.styles,c.styles),a.items.push(...c.items),r()},i)}const o=t.getReader(),a={items:[],styles:Object.create(null),lang:null};r()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const s of t.renderTasks)e.push(s.completed),s.cancel();return this.objs.clear(),m(this,Zi,!1),Promise.all(e)}cleanup(e=!1){m(this,Zi,!0);const t=S(this,Pa,nd).call(this);return e&&t&&this._stats&&(this._stats=new $x),t}_startRenderPage(e,t){var i,r;const s=this._intentStates.get(t);s&&((i=this._stats)==null||i.timeEnd("Page Request"),(r=s.displayReadyCapability)==null||r.resolve(e))}_renderPageChunk(e,t){for(let s=0,i=e.length;s<i;s++)t.operatorList.fnArray.push(e.fnArray[s]),t.operatorList.argsArray.push(e.argsArray[s]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const s of t.renderTasks)s.operatorListChanged();e.lastChunk&&S(this,Pa,nd).call(this)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:s,modifiedIds:i}){const{map:r,transfer:o}=s,c=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:r,modifiedIds:i},o).getReader(),u=this._intentStates.get(t);u.streamReader=c;const d=()=>{c.read().then(({value:h,done:f})=>{if(f){u.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(h,u),d())},h=>{if(u.streamReader=null,!this._transport.destroyed){if(u.operatorList){u.operatorList.lastChunk=!0;for(const f of u.renderTasks)f.operatorListChanged();S(this,Pa,nd).call(this)}if(u.displayReadyCapability)u.displayReadyCapability.reject(h);else if(u.opListReadCapability)u.opListReadCapability.reject(h);else throw h}})};d()}_abortOperatorList({intentState:e,reason:t,force:s=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!s){if(e.renderTasks.size>0)return;if(t instanceof km){let i=bN;t.extraDelay>0&&t.extraDelay<1e3&&(i+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},i);return}}if(e.streamReader.cancel(new Er(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[i,r]of this._intentStates)if(r===e){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}Zi=new WeakMap,Pa=new WeakSet,nd=function(){if(!l(this,Zi)||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),m(this,Zi,!1),!0};var io,Ns,er,Ra,Kg,La,Na,ln,jp,h_,f_,sd,Lc,zp;const Fe=class Fe{constructor({name:e=null,port:t=null,verbosity:s=fL()}={}){x(this,ln);x(this,io,Promise.withResolvers());x(this,Ns,null);x(this,er,null);x(this,Ra,null);if(this.name=e,this.destroyed=!1,this.verbosity=s,t){if(l(Fe,Na).has(t))throw new Error("Cannot use more than one PDFWorker per port.");l(Fe,Na).set(t,this),S(this,ln,h_).call(this,t)}else S(this,ln,f_).call(this)}get promise(){return l(this,io).promise}get port(){return l(this,er)}get messageHandler(){return l(this,Ns)}destroy(){var e,t;this.destroyed=!0,(e=l(this,Ra))==null||e.terminate(),m(this,Ra,null),l(Fe,Na).delete(l(this,er)),m(this,er,null),(t=l(this,Ns))==null||t.destroy(),m(this,Ns,null)}static create(e){const t=l(this,Na).get(e==null?void 0:e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new Fe(e)}static get workerSrc(){if(gs.workerSrc)return gs.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return le(this,"_setupFakeWorkerGlobal",(async()=>l(this,Lc,zp)?l(this,Lc,zp):(await import(this.workerSrc)).WorkerMessageHandler)())}};io=new WeakMap,Ns=new WeakMap,er=new WeakMap,Ra=new WeakMap,Kg=new WeakMap,La=new WeakMap,Na=new WeakMap,ln=new WeakSet,jp=function(){l(this,io).resolve(),l(this,Ns).send("configure",{verbosity:this.verbosity})},h_=function(e){m(this,er,e),m(this,Ns,new Qu("main","worker",e)),l(this,Ns).on("ready",()=>{}),S(this,ln,jp).call(this)},f_=function(){if(l(Fe,La)||l(Fe,Lc,zp)){S(this,ln,sd).call(this);return}let{workerSrc:e}=Fe;try{Fe._isSameOrigin(window.location,e)||(e=Fe._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),s=new Qu("main","worker",t),i=()=>{r.abort(),s.destroy(),t.terminate(),this.destroyed?l(this,io).reject(new Error("Worker was destroyed")):S(this,ln,sd).call(this)},r=new AbortController;t.addEventListener("error",()=>{l(this,Ra)||i()},{signal:r.signal}),s.on("test",a=>{if(r.abort(),this.destroyed||!a){i();return}m(this,Ns,s),m(this,er,t),m(this,Ra,t),S(this,ln,jp).call(this)}),s.on("ready",a=>{if(r.abort(),this.destroyed){i();return}try{o()}catch{S(this,ln,sd).call(this)}});const o=()=>{const a=new Uint8Array;s.send("test",a,[a.buffer])};o();return}catch{Cm("The worker has been disabled.")}S(this,ln,sd).call(this)},sd=function(){l(Fe,La)||(ne("Setting up fake worker."),m(Fe,La,!0)),Fe._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){l(this,io).reject(new Error("Worker was destroyed"));return}const t=new ML;m(this,er,t);const s=`fake${Jt(Fe,Kg)._++}`,i=new Qu(s+"_worker",s,t);e.setup(i,t),m(this,Ns,new Qu(s,s+"_worker",t)),S(this,ln,jp).call(this)}).catch(e=>{l(this,io).reject(new Error(`Setting up fake worker failed: "${e.message}".`))})},Lc=new WeakSet,zp=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},x(Fe,Lc),x(Fe,Kg,0),x(Fe,La,!1),x(Fe,Na,new WeakMap),rn&&(m(Fe,La,!0),gs.workerSrc||(gs.workerSrc="./pdf.worker.mjs")),Fe._isSameOrigin=(e,t)=>{const s=URL.parse(e);if(!(s!=null&&s.origin)||s.origin==="null")return!1;const i=new URL(t,s);return s.origin===i.origin},Fe._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},Fe.fromPort=e=>{if(SL("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return Fe.create(e)};let vu=Fe;var tr,gi,Nc,Mc,nr,Ma,id;class AN{constructor(e,t,s,i,r){x(this,Ma);x(this,tr,new Map);x(this,gi,new Map);x(this,Nc,new Map);x(this,Mc,new Map);x(this,nr,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new a_,this.fontLoader=new TL({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=r.canvasFactory,this.filterFactory=r.filterFactory,this.cMapReaderFactory=r.cMapReaderFactory,this.standardFontDataFactory=r.standardFontDataFactory,this.wasmFactory=r.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=s,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return le(this,"annotationStorage",new Xw)}getRenderingIntent(e,t=Ai.ENABLE,s=null,i=!1,r=!1){let o=Wn.DISPLAY,a=Bv;switch(e){case"any":o=Wn.ANY;break;case"display":break;case"print":o=Wn.PRINT;break;default:ne(`getRenderingIntent - invalid intent: ${e}`)}const c=o&Wn.PRINT&&s instanceof VE?s:this.annotationStorage;switch(t){case Ai.DISABLE:o+=Wn.ANNOTATIONS_DISABLE;break;case Ai.ENABLE:break;case Ai.ENABLE_FORMS:o+=Wn.ANNOTATIONS_FORMS;break;case Ai.ENABLE_STORAGE:o+=Wn.ANNOTATIONS_STORAGE,a=c.serializable;break;default:ne(`getRenderingIntent - invalid annotationMode: ${t}`)}i&&(o+=Wn.IS_EDITING),r&&(o+=Wn.OPLIST);const{ids:u,hash:d}=c.modifiedIds,h=[o,a.hash,d];return{renderingIntent:o,cacheKey:h.join("_"),annotationStorageSerializable:a,modifiedIds:u}}destroy(){var s;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(s=l(this,nr))==null||s.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const i of l(this,gi).values())e.push(i._destroy());l(this,gi).clear(),l(this,Nc).clear(),l(this,Mc).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var i,r;this.commonObjs.clear(),this.fontLoader.clear(),l(this,tr).clear(),this.filterFactory.destroy(),Xd.cleanup(),(i=this._networkStream)==null||i.cancelAllRequests(new Er("Worker was terminated.")),(r=this.messageHandler)==null||r.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(s,i)=>{ot(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=r=>{this._lastProgress={loaded:r.loaded,total:r.total}},i.onPull=()=>{this._fullReader.read().then(function({value:r,done:o}){if(o){i.close();return}ot(r instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(r),1,[r])}).catch(r=>{i.error(r)})},i.onCancel=r=>{this._fullReader.cancel(r),i.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("ReaderHeadersReady",async s=>{var a;await this._fullReader.headersReady;const{isStreamingSupported:i,isRangeSupported:r,contentLength:o}=this._fullReader;return(!i||!r)&&(this._lastProgress&&((a=t.onProgress)==null||a.call(t,this._lastProgress)),this._fullReader.onProgress=c=>{var u;(u=t.onProgress)==null||u.call(t,{loaded:c.loaded,total:c.total})}),{isStreamingSupported:i,isRangeSupported:r,contentLength:o}}),e.on("GetRangeReader",(s,i)=>{ot(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const r=this._networkStream.getRangeReader(s.begin,s.end);if(!r){i.close();return}i.onPull=()=>{r.read().then(function({value:o,done:a}){if(a){i.close();return}ot(o instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{i.error(o)})},i.onCancel=o=>{r.cancel(o),i.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("GetDoc",({pdfInfo:s})=>{this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,t._capability.resolve(new xN(s,this))}),e.on("DocException",s=>{t._capability.reject(fn(s))}),e.on("PasswordRequest",s=>{m(this,nr,Promise.withResolvers());try{if(!t.onPassword)throw fn(s);const i=r=>{r instanceof Error?l(this,nr).reject(r):l(this,nr).resolve({password:r})};t.onPassword(i,s.code)}catch(i){l(this,nr).reject(i)}return l(this,nr).promise}),e.on("DataLoaded",s=>{var i;(i=t.onProgress)==null||i.call(t,{loaded:s.length,total:s.length}),this.downloadInfoCapability.resolve(s)}),e.on("StartRenderPage",s=>{if(this.destroyed)return;l(this,gi).get(s.pageIndex)._startRenderPage(s.transparency,s.cacheKey)}),e.on("commonobj",([s,i,r])=>{var o;if(this.destroyed||this.commonObjs.has(s))return null;switch(i){case"Font":if("error"in r){const d=r.error;ne(`Error during font loading: ${d}`),this.commonObjs.resolve(s,d);break}const a=this._params.pdfBug&&((o=globalThis.FontInspector)!=null&&o.enabled)?(d,h)=>globalThis.FontInspector.fontAdded(d,h):null,c=new PL(r,a);this.fontLoader.bind(c).catch(()=>e.sendWithPromise("FontFallback",{id:s})).finally(()=>{!c.fontExtraProperties&&c.data&&(c.data=null),this.commonObjs.resolve(s,c)});break;case"CopyLocalImage":const{imageRef:u}=r;ot(u,"The imageRef must be defined.");for(const d of l(this,gi).values())for(const[,h]of d.objs)if((h==null?void 0:h.ref)===u)return h.dataLen?(this.commonObjs.resolve(s,structuredClone(h)),h.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(s,r);break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),e.on("obj",([s,i,r,o])=>{var c;if(this.destroyed)return;const a=l(this,gi).get(i);if(!a.objs.has(s)){if(a._intentStates.size===0){(c=o==null?void 0:o.bitmap)==null||c.close();return}switch(r){case"Image":case"Pattern":a.objs.resolve(s,o);break;default:throw new Error(`Got unknown object type ${r}`)}}}),e.on("DocProgress",s=>{var i;this.destroyed||(i=t.onProgress)==null||i.call(t,{loaded:s.loaded,total:s.total})}),e.on("FetchBinaryData",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");const i=this[s.type];if(!i)throw new Error(`${s.type} not initialized, see the \`useWorkerFetch\` parameter.`);return i.fetch(s)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var s;this.annotationStorage.size<=0&&ne("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((s=this._fullReader)==null?void 0:s.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,s=l(this,Nc).get(t);if(s)return s;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(r=>{if(this.destroyed)throw new Error("Transport destroyed");r.refStr&&l(this,Mc).set(r.refStr,e);const o=new SN(t,r,this,this._params.pdfBug);return l(this,gi).set(t,o),o});return l(this,Nc).set(t,i),i}getPageIndex(e){return Hv(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return S(this,Ma,id).call(this,"GetFieldObjects")}hasJSActions(){return S(this,Ma,id).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return S(this,Ma,id).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return S(this,Ma,id).call(this,"GetOptionalContentConfig").then(t=>new tN(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=l(this,tr).get(e);if(t)return t;const s=this.messageHandler.sendWithPromise(e,null).then(i=>{var r,o;return{info:i[0],metadata:i[1]?new ZL(i[1]):null,contentDispositionFilename:((r=this._fullReader)==null?void 0:r.filename)??null,contentLength:((o=this._fullReader)==null?void 0:o.contentLength)??null}});return l(this,tr).set(e,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of l(this,gi).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),l(this,tr).clear(),this.filterFactory.destroy(!0),Xd.cleanup()}}cachedPageNumber(e){if(!Hv(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return l(this,Mc).get(t)??null}}tr=new WeakMap,gi=new WeakMap,Nc=new WeakMap,Mc=new WeakMap,nr=new WeakMap,Ma=new WeakSet,id=function(e,t=null){const s=l(this,tr).get(e);if(s)return s;const i=this.messageHandler.sendWithPromise(e,t);return l(this,tr).set(e,i),i};var ro;class EN{constructor(e){x(this,ro,null);F(this,"onContinue",null);F(this,"onError",null);m(this,ro,e)}get promise(){return l(this,ro).capability.promise}cancel(e=0){l(this,ro).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=l(this,ro).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=l(this,ro);return e.form||e.canvas&&(t==null?void 0:t.size)>0}}ro=new WeakMap;var oo,Da;const Qo=class Qo{constructor({callback:e,params:t,objs:s,commonObjs:i,annotationCanvasMap:r,operatorList:o,pageIndex:a,canvasFactory:c,filterFactory:u,useRequestAnimationFrame:d=!1,pdfBug:h=!1,pageColors:f=null}){x(this,oo,null);this.callback=e,this.params=t,this.objs=s,this.commonObjs=i,this.annotationCanvasMap=r,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=a,this.canvasFactory=c,this.filterFactory=u,this._pdfBug=h,this.pageColors=f,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=d===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new EN(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var a,c;if(this.cancelled)return;if(this._canvas){if(l(Qo,Da).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");l(Qo,Da).add(this._canvas)}this._pdfBug&&((a=globalThis.StepperManager)!=null&&a.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:s,viewport:i,transform:r,background:o}=this.params;this.gfx=new ec(s,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:r,viewport:i,transparency:e,background:o}),this.operatorListIdx=0,this.graphicsReady=!0,(c=this.graphicsReadyCallback)==null||c.call(this)}cancel(e=null,t=0){var s,i,r;this.running=!1,this.cancelled=!0,(s=this.gfx)==null||s.endDrawing(),l(this,oo)&&(window.cancelAnimationFrame(l(this,oo)),m(this,oo,null)),l(Qo,Da).delete(this._canvas),e||(e=new km(`Rendering cancelled, page ${this._pageIndex+1}`,t)),this.callback(e),(r=(i=this.task).onError)==null||r.call(i,e)}operatorListChanged(){var e;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.stepper)==null||e.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?m(this,oo,window.requestAnimationFrame(()=>{m(this,oo,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),l(Qo,Da).delete(this._canvas),this.callback())))}};oo=new WeakMap,Da=new WeakMap,x(Qo,Da,new WeakSet);let t0=Qo;const p_="5.3.31",g_="47ad820d9";function nS(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function $u(n){return Math.max(0,Math.min(255,255*n))}class sS{static CMYK_G([e,t,s,i]){return["G",1-Math.min(1,.3*e+.59*s+.11*t+i)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=$u(e),[e,e,e]}static G_HTML([e]){const t=nS(e);return`#${t}${t}${t}`}static RGB_G([e,t,s]){return["G",.3*e+.59*t+.11*s]}static RGB_rgb(e){return e.map($u)}static RGB_HTML(e){return`#${e.map(nS).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,s,i]){return["RGB",1-Math.min(1,e+i),1-Math.min(1,s+i),1-Math.min(1,t+i)]}static CMYK_rgb([e,t,s,i]){return[$u(1-Math.min(1,e+i)),$u(1-Math.min(1,s+i)),$u(1-Math.min(1,t+i))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,s]){const i=1-e,r=1-t,o=1-s,a=Math.min(i,r,o);return["CMYK",i,r,o,a]}}class _N{create(e,t,s=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),s||(i.setAttribute("width",`${e}px`),i.setAttribute("height",`${t}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${e} ${t}`),i}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){Ce("Abstract method `_createSVG` called.")}}class Yd extends _N{_createSVG(e){return document.createElementNS(Mi,e)}}class Jw{static setupStorage(e,t,s,i,r){const o=i.getValue(t,{value:null});switch(s.name){case"textarea":if(o.value!==null&&(e.textContent=o.value),r==="print")break;e.addEventListener("input",a=>{i.setValue(t,{value:a.target.value})});break;case"input":if(s.attributes.type==="radio"||s.attributes.type==="checkbox"){if(o.value===s.attributes.xfaOn?e.setAttribute("checked",!0):o.value===s.attributes.xfaOff&&e.removeAttribute("checked"),r==="print")break;e.addEventListener("change",a=>{i.setValue(t,{value:a.target.checked?a.target.getAttribute("xfaOn"):a.target.getAttribute("xfaOff")})})}else{if(o.value!==null&&e.setAttribute("value",o.value),r==="print")break;e.addEventListener("input",a=>{i.setValue(t,{value:a.target.value})})}break;case"select":if(o.value!==null){e.setAttribute("value",o.value);for(const a of s.children)a.attributes.value===o.value?a.attributes.selected=!0:a.attributes.hasOwnProperty("selected")&&delete a.attributes.selected}e.addEventListener("input",a=>{const c=a.target.options,u=c.selectedIndex===-1?"":c[c.selectedIndex].value;i.setValue(t,{value:u})});break}}static setAttributes({html:e,element:t,storage:s=null,intent:i,linkService:r}){const{attributes:o}=t,a=e instanceof HTMLAnchorElement;o.type==="radio"&&(o.name=`${o.name}-${i}`);for(const[c,u]of Object.entries(o))if(u!=null)switch(c){case"class":u.length&&e.setAttribute(c,u.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",u);break;case"style":Object.assign(e.style,u);break;case"textContent":e.textContent=u;break;default:(!a||c!=="href"&&c!=="newWindow")&&e.setAttribute(c,u)}a&&r.addLinkAttributes(e,o.href,o.newWindow),s&&o.dataId&&this.setupStorage(e,o.dataId,t,s)}static render(e){var h,f;const t=e.annotationStorage,s=e.linkService,i=e.xfaHtml,r=e.intent||"display",o=document.createElement(i.name);i.attributes&&this.setAttributes({html:o,element:i,intent:r,linkService:s});const a=r!=="richText",c=e.div;if(c.append(o),e.viewport){const p=`matrix(${e.viewport.transform.join(",")})`;c.style.transform=p}a&&c.setAttribute("class","xfaLayer xfaFont");const u=[];if(i.children.length===0){if(i.value){const p=document.createTextNode(i.value);o.append(p),a&&qd.shouldBuildText(i.name)&&u.push(p)}return{textDivs:u}}const d=[[i,-1,o]];for(;d.length>0;){const[p,y,g]=d.at(-1);if(y+1===p.children.length){d.pop();continue}const A=p.children[++d.at(-1)[1]];if(A===null)continue;const{name:v}=A;if(v==="#text"){const b=document.createTextNode(A.value);u.push(b),g.append(b);continue}const w=(h=A==null?void 0:A.attributes)!=null&&h.xmlns?document.createElementNS(A.attributes.xmlns,v):document.createElement(v);if(g.append(w),A.attributes&&this.setAttributes({html:w,element:A,storage:t,intent:r,linkService:s}),((f=A.children)==null?void 0:f.length)>0)d.push([A,-1,w]);else if(A.value){const b=document.createTextNode(A.value);a&&qd.shouldBuildText(v)&&u.push(b),w.append(b)}}for(const p of c.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))p.setAttribute("readOnly",!0);return{textDivs:u}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const zf=1e3,CN=9,pl=new WeakSet;class iS{static create(e){switch(e.data.annotationType){case Qe.LINK:return new m_(e);case Qe.TEXT:return new kN(e);case Qe.WIDGET:switch(e.data.fieldType){case"Tx":return new TN(e);case"Btn":return e.data.radioButton?new w_(e):e.data.checkBox?new RN(e):new LN(e);case"Ch":return new NN(e);case"Sig":return new PN(e)}return new wl(e);case Qe.POPUP:return new s0(e);case Qe.FREETEXT:return new E_(e);case Qe.LINE:return new DN(e);case Qe.SQUARE:return new IN(e);case Qe.CIRCLE:return new ON(e);case Qe.POLYLINE:return new __(e);case Qe.CARET:return new jN(e);case Qe.INK:return new Zw(e);case Qe.POLYGON:return new FN(e);case Qe.HIGHLIGHT:return new C_(e);case Qe.UNDERLINE:return new zN(e);case Qe.SQUIGGLY:return new $N(e);case Qe.STRIKEOUT:return new BN(e);case Qe.STAMP:return new k_(e);case Qe.FILEATTACHMENT:return new HN(e);default:return new nt(e)}}}var Ia,Dc,Ic,Uh,n0;const lb=class lb{constructor(e,{isRenderable:t=!1,ignoreBorder:s=!1,createQuadrilaterals:i=!1}={}){x(this,Uh);x(this,Ia,null);x(this,Dc,!1);x(this,Ic,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(s)),i&&this._createQuadrilaterals()}static _hasPopupData({titleObj:e,contentsObj:t,richText:s}){return!!(e!=null&&e.str||t!=null&&t.str||s!=null&&s.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return lb._hasPopupData(this.data)}updateEdited(e){var s;if(!this.container)return;l(this,Ia)||m(this,Ia,{rect:this.data.rect.slice(0)});const{rect:t}=e;t&&S(this,Uh,n0).call(this,t),(s=l(this,Ic))==null||s.popup.updateEdited(e)}resetEdited(){var e;l(this,Ia)&&(S(this,Uh,n0).call(this,l(this,Ia).rect),(e=l(this,Ic))==null||e.popup.resetEdited(),m(this,Ia,null))}_createContainer(e){const{data:t,parent:{page:s,viewport:i}}=this,r=document.createElement("section");r.setAttribute("data-annotation-id",t.id),this instanceof wl||(r.tabIndex=zf);const{style:o}=r;if(o.zIndex=this.parent.zIndex++,t.alternativeText&&(r.title=t.alternativeText),t.noRotate&&r.classList.add("norotate"),!t.rect||this instanceof s0){const{rotation:g}=t;return!t.hasOwnCanvas&&g!==0&&this.setRotation(g,r),r}const{width:a,height:c}=this;if(!e&&t.borderStyle.width>0){o.borderWidth=`${t.borderStyle.width}px`;const g=t.borderStyle.horizontalCornerRadius,A=t.borderStyle.verticalCornerRadius;if(g>0||A>0){const w=`calc(${g}px * var(--total-scale-factor)) / calc(${A}px * var(--total-scale-factor))`;o.borderRadius=w}else if(this instanceof w_){const w=`calc(${a}px * var(--total-scale-factor)) / calc(${c}px * var(--total-scale-factor))`;o.borderRadius=w}switch(t.borderStyle.style){case El.SOLID:o.borderStyle="solid";break;case El.DASHED:o.borderStyle="dashed";break;case El.BEVELED:ne("Unimplemented border style: beveled");break;case El.INSET:ne("Unimplemented border style: inset");break;case El.UNDERLINE:o.borderBottomStyle="solid";break}const v=t.borderColor||null;v?(m(this,Dc,!0),o.borderColor=Q.makeHexColor(v[0]|0,v[1]|0,v[2]|0)):o.borderWidth=0}const u=Q.normalizeRect([t.rect[0],s.view[3]-t.rect[1]+s.view[1],t.rect[2],s.view[3]-t.rect[3]+s.view[1]]),{pageWidth:d,pageHeight:h,pageX:f,pageY:p}=i.rawDims;o.left=`${100*(u[0]-f)/d}%`,o.top=`${100*(u[1]-p)/h}%`;const{rotation:y}=t;return t.hasOwnCanvas||y===0?(o.width=`${100*a/d}%`,o.height=`${100*c/h}%`):this.setRotation(y,r),r}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:s,pageHeight:i}=this.parent.viewport.rawDims;let{width:r,height:o}=this;e%180!==0&&([r,o]=[o,r]),t.style.width=`${100*r/s}%`,t.style.height=`${100*o/i}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,s,i)=>{const r=i.detail[t],o=r[0],a=r.slice(1);i.target.style[s]=sS[`${o}_HTML`](a),this.annotationStorage.setValue(this.data.id,{[s]:sS[`${o}_rgb`](a)})};return le(this,"_commonActions",{display:t=>{const{display:s}=t.detail,i=s%2===1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:s===1||s===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:s}=t.detail;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:s,noView:s})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const s=t.detail.rotation;this.setRotation(s),this.annotationStorage.setValue(this.data.id,{rotation:s})}})}_dispatchEventFromSandbox(e,t){const s=this._commonActions;for(const i of Object.keys(t.detail)){const r=e[i]||s[i];r==null||r(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const s=this._commonActions;for(const[i,r]of Object.entries(t)){const o=s[i];if(o){const a={detail:{[i]:r},target:e};o(a),delete t[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,s,i,r]=this.data.rect.map(g=>Math.fround(g));if(e.length===8){const[g,A,v,w]=e.subarray(2,6);if(i===g&&r===A&&t===v&&s===w)return}const{style:o}=this.container;let a;if(l(this,Dc)){const{borderColor:g,borderWidth:A}=o;o.borderWidth=0,a=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${g}" stroke-width="${A}">`],this.container.classList.add("hasBorder")}const c=i-t,u=r-s,{svgFactory:d}=this,h=d.createElement("svg");h.classList.add("quadrilateralsContainer"),h.setAttribute("width",0),h.setAttribute("height",0);const f=d.createElement("defs");h.append(f);const p=d.createElement("clipPath"),y=`clippath_${this.data.id}`;p.setAttribute("id",y),p.setAttribute("clipPathUnits","objectBoundingBox"),f.append(p);for(let g=2,A=e.length;g<A;g+=8){const v=e[g],w=e[g+1],b=e[g+2],E=e[g+3],C=d.createElement("rect"),T=(b-t)/c,k=(r-w)/u,R=(v-b)/c,M=(w-E)/u;C.setAttribute("x",T),C.setAttribute("y",k),C.setAttribute("width",R),C.setAttribute("height",M),p.append(C),a==null||a.push(`<rect vector-effect="non-scaling-stroke" x="${T}" y="${k}" width="${R}" height="${M}"/>`)}l(this,Dc)&&(a.push("</g></svg>')"),o.backgroundImage=a.join("")),this.container.append(h),this.container.style.clipPath=`url(#${y})`}_createPopup(){const{data:e}=this,t=m(this,Ic,new s0({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]}));this.parent.div.append(t.render())}render(){Ce("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const s=[];if(this._fieldObjects){const i=this._fieldObjects[e];if(i)for(const{page:r,id:o,exportValues:a}of i){if(r===-1||o===t)continue;const c=typeof a=="string"?a:null,u=document.querySelector(`[data-element-id="${o}"]`);if(u&&!pl.has(u)){ne(`_getElementsByName - element not allowed: ${o}`);continue}s.push({id:o,exportValue:c,domElement:u})}return s}for(const i of document.getElementsByName(e)){const{exportValue:r}=i,o=i.getAttribute("data-element-id");o!==t&&pl.has(i)&&s.push({id:o,exportValue:r,domElement:i})}return s}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var s;(s=this.linkService.eventBus)==null||s.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}};Ia=new WeakMap,Dc=new WeakMap,Ic=new WeakMap,Uh=new WeakSet,n0=function(e){const{container:{style:t},data:{rect:s,rotation:i},parent:{viewport:{rawDims:{pageWidth:r,pageHeight:o,pageX:a,pageY:c}}}}=this;s==null||s.splice(0,4,...e),t.left=`${100*(e[0]-a)/r}%`,t.top=`${100*(o-e[3]+c)/o}%`,i===0?(t.width=`${100*(e[2]-e[0])/r}%`,t.height=`${100*(e[3]-e[1])/o}%`):this.setRotation(i)};let nt=lb;var Yn,Xo,y_,v_;class m_ extends nt{constructor(t,s=null){super(t,{isRenderable:!0,ignoreBorder:!!(s!=null&&s.ignoreBorder),createQuadrilaterals:!0});x(this,Yn);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:s}=this,i=document.createElement("a");i.setAttribute("data-element-id",t.id);let r=!1;return t.url?(s.addLinkAttributes(i,t.url,t.newWindow),r=!0):t.action?(this._bindNamedAction(i,t.action),r=!0):t.attachment?(S(this,Yn,y_).call(this,i,t.attachment,t.attachmentDest),r=!0):t.setOCGState?(S(this,Yn,v_).call(this,i,t.setOCGState),r=!0):t.dest?(this._bindLink(i,t.dest),r=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,t),r=!0),t.resetForm?(this._bindResetFormAction(i,t.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(i,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&this.container.append(i),this.container}_bindLink(t,s){t.href=this.linkService.getDestinationHash(s),t.onclick=()=>(s&&this.linkService.goToDestination(s),!1),(s||s==="")&&S(this,Yn,Xo).call(this)}_bindNamedAction(t,s){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(s),!1),S(this,Yn,Xo).call(this)}_bindJSAction(t,s){t.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(s.actions)){const o=i.get(r);o&&(t[o]=()=>{var a;return(a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s.id,name:r}}),!1})}t.onclick||(t.onclick=()=>!1),S(this,Yn,Xo).call(this)}_bindResetFormAction(t,s){const i=t.onclick;if(i||(t.href=this.linkService.getAnchorUrl("")),S(this,Yn,Xo).call(this),!this._fieldObjects){ne('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(t.onclick=()=>!1);return}t.onclick=()=>{var h;i==null||i();const{fields:r,refs:o,include:a}=s,c=[];if(r.length!==0||o.length!==0){const f=new Set(o);for(const p of r){const y=this._fieldObjects[p]||[];for(const{id:g}of y)f.add(g)}for(const p of Object.values(this._fieldObjects))for(const y of p)f.has(y.id)===a&&c.push(y)}else for(const f of Object.values(this._fieldObjects))c.push(...f);const u=this.annotationStorage,d=[];for(const f of c){const{id:p}=f;switch(d.push(p),f.type){case"text":{const g=f.defaultValue||"";u.setValue(p,{value:g});break}case"checkbox":case"radiobutton":{const g=f.defaultValue===f.exportValues;u.setValue(p,{value:g});break}case"combobox":case"listbox":{const g=f.defaultValue||"";u.setValue(p,{value:g});break}default:continue}const y=document.querySelector(`[data-element-id="${p}"]`);if(y){if(!pl.has(y)){ne(`_bindResetFormAction - element not allowed: ${p}`);continue}}else continue;y.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((h=this.linkService.eventBus)==null||h.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:d,name:"ResetForm"}})),!1}}}Yn=new WeakSet,Xo=function(){this.container.setAttribute("data-internal-link","")},y_=function(t,s,i=null){t.href=this.linkService.getAnchorUrl(""),s.description&&(t.title=s.description),t.onclick=()=>{var r;return(r=this.downloadManager)==null||r.openOrDownloadData(s.content,s.filename,i),!1},S(this,Yn,Xo).call(this)},v_=function(t,s){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(s),!1),S(this,Yn,Xo).call(this)};class kN extends nt{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class wl extends nt{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return _t.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,s,i,r){s.includes("mouse")?e.addEventListener(s,o=>{var a;(a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:r(o),shift:o.shiftKey,modifier:this._getKeyModifier(o)}})}):e.addEventListener(s,o=>{var a;if(s==="blur"){if(!t.focused||!o.relatedTarget)return;t.focused=!1}else if(s==="focus"){if(t.focused)return;t.focused=!0}r&&((a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:r(o)}}))})}_setEventListeners(e,t,s,i){var r,o,a;for(const[c,u]of s)(u==="Action"||(r=this.data.actions)!=null&&r[u])&&((u==="Focus"||u==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,c,u,i),u==="Focus"&&!((o=this.data.actions)!=null&&o.Blur)?this._setEventListener(e,t,"blur","Blur",null):u==="Blur"&&!((a=this.data.actions)!=null&&a.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":Q.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||CN,r=e.style;let o;const a=2,c=u=>Math.round(10*u)/10;if(this.data.multiLine){const u=Math.abs(this.data.rect[3]-this.data.rect[1]-a),d=Math.round(u/(yy*i))||1,h=u/d;o=Math.min(i,c(h/yy))}else{const u=Math.abs(this.data.rect[3]-this.data.rect[1]-a);o=Math.min(i,c(u/yy))}r.fontSize=`calc(${o}px * var(--total-scale-factor))`,r.color=Q.makeHexColor(s[0],s[1],s[2]),this.data.textAlignment!==null&&(r.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class TN extends wl{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,s,i){const r=this.annotationStorage;for(const o of this._getElementsByName(e.name,e.id))o.domElement&&(o.domElement[t]=s),r.setValue(o.id,{[i]:s})}render(){var i,r;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const o=e.getValue(t,{value:this.data.fieldValue});let a=o.value||"";const c=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;c&&a.length>c&&(a=a.slice(0,c));let u=o.formattedValue||((i=this.data.textContent)==null?void 0:i.join(`
`))||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const d={userValue:a,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=u??a,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type=this.data.password?"password":"text",s.setAttribute("value",u??a),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),pl.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=zf,this._setRequired(s,this.data.required),c&&(s.maxLength=c),s.addEventListener("input",f=>{e.setValue(t,{value:f.target.value}),this.setPropertyOnSiblings(s,"value",f.target.value,"value"),d.formattedValue=null}),s.addEventListener("resetform",f=>{const p=this.data.defaultFieldValue??"";s.value=d.userValue=p,d.formattedValue=null});let h=f=>{const{formattedValue:p}=d;p!=null&&(f.target.value=p),f.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",p=>{var g;if(d.focused)return;const{target:y}=p;d.userValue&&(y.value=d.userValue),d.lastCommittedValue=y.value,d.commitKey=1,(g=this.data.actions)!=null&&g.Focus||(d.focused=!0)}),s.addEventListener("updatefromsandbox",p=>{this.showElementAndHideCanvas(p.target);const y={value(g){d.userValue=g.detail.value??"",e.setValue(t,{value:d.userValue.toString()}),g.target.value=d.userValue},formattedValue(g){const{formattedValue:A}=g.detail;d.formattedValue=A,A!=null&&g.target!==document.activeElement&&(g.target.value=A),e.setValue(t,{formattedValue:A})},selRange(g){g.target.setSelectionRange(...g.detail.selRange)},charLimit:g=>{var b;const{charLimit:A}=g.detail,{target:v}=g;if(A===0){v.removeAttribute("maxLength");return}v.setAttribute("maxLength",A);let w=d.userValue;!w||w.length<=A||(w=w.slice(0,A),v.value=d.userValue=w,e.setValue(t,{value:w}),(b=this.linkService.eventBus)==null||b.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:w,willCommit:!0,commitKey:1,selStart:v.selectionStart,selEnd:v.selectionEnd}}))}};this._dispatchEventFromSandbox(y,p)}),s.addEventListener("keydown",p=>{var A;d.commitKey=1;let y=-1;if(p.key==="Escape"?y=0:p.key==="Enter"&&!this.data.multiLine?y=2:p.key==="Tab"&&(d.commitKey=3),y===-1)return;const{value:g}=p.target;d.lastCommittedValue!==g&&(d.lastCommittedValue=g,d.userValue=g,(A=this.linkService.eventBus)==null||A.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:g,willCommit:!0,commitKey:y,selStart:p.target.selectionStart,selEnd:p.target.selectionEnd}}))});const f=h;h=null,s.addEventListener("blur",p=>{var g,A;if(!d.focused||!p.relatedTarget)return;(g=this.data.actions)!=null&&g.Blur||(d.focused=!1);const{value:y}=p.target;d.userValue=y,d.lastCommittedValue!==y&&((A=this.linkService.eventBus)==null||A.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:y,willCommit:!0,commitKey:d.commitKey,selStart:p.target.selectionStart,selEnd:p.target.selectionEnd}})),f(p)}),(r=this.data.actions)!=null&&r.Keystroke&&s.addEventListener("beforeinput",p=>{var C;d.lastCommittedValue=null;const{data:y,target:g}=p,{value:A,selectionStart:v,selectionEnd:w}=g;let b=v,E=w;switch(p.inputType){case"deleteWordBackward":{const T=A.substring(0,v).match(/\w*[^\w]*$/);T&&(b-=T[0].length);break}case"deleteWordForward":{const T=A.substring(v).match(/^[^\w]*\w*/);T&&(E+=T[0].length);break}case"deleteContentBackward":v===w&&(b-=1);break;case"deleteContentForward":v===w&&(E+=1);break}p.preventDefault(),(C=this.linkService.eventBus)==null||C.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:A,change:y||"",willCommit:!1,selStart:b,selEnd:E}})}),this._setEventListeners(s,d,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],p=>p.target.value)}if(h&&s.addEventListener("blur",h),this.data.comb){const p=(this.data.rect[2]-this.data.rect[0])/c;s.classList.add("comb"),s.style.letterSpacing=`calc(${p}px * var(--total-scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class PN extends wl{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class RN extends wl{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,s=t.id;let i=e.getValue(s,{value:t.exportValue===t.fieldValue}).value;typeof i=="string"&&(i=i!=="Off",e.setValue(s,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const r=document.createElement("input");return pl.add(r),r.setAttribute("data-element-id",s),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="checkbox",r.name=t.fieldName,i&&r.setAttribute("checked",!0),r.setAttribute("exportValue",t.exportValue),r.tabIndex=zf,r.addEventListener("change",o=>{const{name:a,checked:c}=o.target;for(const u of this._getElementsByName(a,s)){const d=c&&u.exportValue===t.exportValue;u.domElement&&(u.domElement.checked=d),e.setValue(u.id,{value:d})}e.setValue(s,{value:c})}),r.addEventListener("resetform",o=>{const a=t.defaultFieldValue||"Off";o.target.checked=a===t.exportValue}),this.enableScripting&&this.hasJSActions&&(r.addEventListener("updatefromsandbox",o=>{const a={value(c){c.target.checked=c.detail.value!=="Off",e.setValue(s,{value:c.target.checked})}};this._dispatchEventFromSandbox(a,o)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class w_ extends wl{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,s=t.id;let i=e.getValue(s,{value:t.fieldValue===t.buttonValue}).value;if(typeof i=="string"&&(i=i!==t.buttonValue,e.setValue(s,{value:i})),i)for(const o of this._getElementsByName(t.fieldName,s))e.setValue(o.id,{value:!1});const r=document.createElement("input");if(pl.add(r),r.setAttribute("data-element-id",s),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="radio",r.name=t.fieldName,i&&r.setAttribute("checked",!0),r.tabIndex=zf,r.addEventListener("change",o=>{const{name:a,checked:c}=o.target;for(const u of this._getElementsByName(a,s))e.setValue(u.id,{value:!1});e.setValue(s,{value:c})}),r.addEventListener("resetform",o=>{const a=t.defaultFieldValue;o.target.checked=a!=null&&a===t.buttonValue}),this.enableScripting&&this.hasJSActions){const o=t.buttonValue;r.addEventListener("updatefromsandbox",a=>{const c={value:u=>{const d=o===u.detail.value;for(const h of this._getElementsByName(u.target.name)){const f=d&&h.id===s;h.domElement&&(h.domElement.checked=f),e.setValue(h.id,{value:f})}}};this._dispatchEventFromSandbox(c,a)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)}return this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class LN extends m_{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",s=>{this._dispatchEventFromSandbox({},s)})),e}}class NN extends wl{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,s=e.getValue(t,{value:this.data.fieldValue}),i=document.createElement("select");pl.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=zf;let r=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",d=>{const h=this.data.defaultFieldValue;for(const f of i.options)f.selected=f.value===h});for(const d of this.data.options){const h=document.createElement("option");h.textContent=d.displayValue,h.value=d.exportValue,s.value.includes(d.exportValue)&&(h.setAttribute("selected",!0),r=!1),i.append(h)}let o=null;if(r){const d=document.createElement("option");d.value=" ",d.setAttribute("hidden",!0),d.setAttribute("selected",!0),i.prepend(d),o=()=>{d.remove(),i.removeEventListener("input",o),o=null},i.addEventListener("input",o)}const a=d=>{const h=d?"value":"textContent",{options:f,multiple:p}=i;return p?Array.prototype.filter.call(f,y=>y.selected).map(y=>y[h]):f.selectedIndex===-1?null:f[f.selectedIndex][h]};let c=a(!1);const u=d=>{const h=d.target.options;return Array.prototype.map.call(h,f=>({displayValue:f.textContent,exportValue:f.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",d=>{const h={value(f){o==null||o();const p=f.detail.value,y=new Set(Array.isArray(p)?p:[p]);for(const g of i.options)g.selected=y.has(g.value);e.setValue(t,{value:a(!0)}),c=a(!1)},multipleSelection(f){i.multiple=!0},remove(f){const p=i.options,y=f.detail.remove;p[y].selected=!1,i.remove(y),p.length>0&&Array.prototype.findIndex.call(p,A=>A.selected)===-1&&(p[0].selected=!0),e.setValue(t,{value:a(!0),items:u(f)}),c=a(!1)},clear(f){for(;i.length!==0;)i.remove(0);e.setValue(t,{value:null,items:[]}),c=a(!1)},insert(f){const{index:p,displayValue:y,exportValue:g}=f.detail.insert,A=i.children[p],v=document.createElement("option");v.textContent=y,v.value=g,A?A.before(v):i.append(v),e.setValue(t,{value:a(!0),items:u(f)}),c=a(!1)},items(f){const{items:p}=f.detail;for(;i.length!==0;)i.remove(0);for(const y of p){const{displayValue:g,exportValue:A}=y,v=document.createElement("option");v.textContent=g,v.value=A,i.append(v)}i.options.length>0&&(i.options[0].selected=!0),e.setValue(t,{value:a(!0),items:u(f)}),c=a(!1)},indices(f){const p=new Set(f.detail.indices);for(const y of f.target.options)y.selected=p.has(y.index);e.setValue(t,{value:a(!0)}),c=a(!1)},editable(f){f.target.disabled=!f.detail.editable}};this._dispatchEventFromSandbox(h,d)}),i.addEventListener("input",d=>{var p;const h=a(!0),f=a(!1);e.setValue(t,{value:h}),d.preventDefault(),(p=this.linkService.eventBus)==null||p.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:c,change:f,changeEx:h,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],d=>d.target.value)):i.addEventListener("input",function(d){e.setValue(t,{value:a(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class s0 extends nt{constructor(e){const{data:t,elements:s}=e;super(e,{isRenderable:nt._hasPopupData(t)}),this.elements=s,this.popup=null}render(){this.container.classList.add("popupAnnotation");const e=this.popup=new MN({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),t=[];for(const s of this.elements)s.popup=e,s.container.ariaHasPopup="dialog",t.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",t.map(s=>`${Gw}${s}`).join(",")),this.container}}var Oc,Qg,Jg,Fc,jc,qe,sr,zc,Vh,Gh,$c,ir,Ms,rr,Wh,or,Xh,Oa,Fa,ke,$p,i0,b_,x_,S_,A_,Bp,Hp,r0;class MN{constructor({container:e,color:t,elements:s,titleObj:i,modificationDate:r,contentsObj:o,richText:a,parent:c,rect:u,parentRect:d,open:h}){x(this,ke);x(this,Oc,S(this,ke,S_).bind(this));x(this,Qg,S(this,ke,r0).bind(this));x(this,Jg,S(this,ke,Hp).bind(this));x(this,Fc,S(this,ke,Bp).bind(this));x(this,jc,null);x(this,qe,null);x(this,sr,null);x(this,zc,null);x(this,Vh,null);x(this,Gh,null);x(this,$c,null);x(this,ir,!1);x(this,Ms,null);x(this,rr,null);x(this,Wh,null);x(this,or,null);x(this,Xh,null);x(this,Oa,null);x(this,Fa,!1);var f;m(this,qe,e),m(this,Xh,i),m(this,sr,o),m(this,or,a),m(this,Gh,c),m(this,jc,t),m(this,Wh,u),m(this,$c,d),m(this,Vh,s),m(this,zc,Pm.toDateObject(r)),this.trigger=s.flatMap(p=>p.getElementsToTriggerPopup());for(const p of this.trigger)p.addEventListener("click",l(this,Fc)),p.addEventListener("mouseenter",l(this,Jg)),p.addEventListener("mouseleave",l(this,Qg)),p.classList.add("popupTriggerArea");for(const p of s)(f=p.container)==null||f.addEventListener("keydown",l(this,Oc));l(this,qe).hidden=!0,h&&S(this,ke,Bp).call(this)}render(){if(l(this,Ms))return;const e=m(this,Ms,document.createElement("div"));if(e.className="popup",l(this,jc)){const r=e.style.outlineColor=Q.makeHexColor(...l(this,jc));e.style.backgroundColor=`color-mix(in srgb, ${r} 30%, white)`}const t=document.createElement("span");t.className="header";const s=document.createElement("h1");if(t.append(s),{dir:s.dir,str:s.textContent}=l(this,Xh),e.append(t),l(this,zc)){const r=document.createElement("span");r.classList.add("popupDate"),r.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),r.setAttribute("data-l10n-args",JSON.stringify({dateObj:l(this,zc).valueOf()})),t.append(r)}const i=l(this,ke,$p);if(i)Jw.render({xfaHtml:i,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const r=this._formatContents(l(this,sr));e.append(r)}l(this,qe).append(e)}_formatContents({str:e,dir:t}){const s=document.createElement("p");s.classList.add("popupContent"),s.dir=t;const i=e.split(/(?:\r\n?|\n)/);for(let r=0,o=i.length;r<o;++r){const a=i[r];s.append(document.createTextNode(a)),r<o-1&&s.append(document.createElement("br"))}return s}updateEdited({rect:e,popupContent:t}){var s;l(this,Oa)||m(this,Oa,{contentsObj:l(this,sr),richText:l(this,or)}),e&&m(this,rr,null),t&&(m(this,or,S(this,ke,x_).call(this,t)),m(this,sr,null)),(s=l(this,Ms))==null||s.remove(),m(this,Ms,null)}resetEdited(){var e;l(this,Oa)&&({contentsObj:Jt(this,sr)._,richText:Jt(this,or)._}=l(this,Oa),m(this,Oa,null),(e=l(this,Ms))==null||e.remove(),m(this,Ms,null),m(this,rr,null))}forceHide(){m(this,Fa,this.isVisible),l(this,Fa)&&(l(this,qe).hidden=!0)}maybeShow(){l(this,Fa)&&(l(this,Ms)||S(this,ke,Hp).call(this),m(this,Fa,!1),l(this,qe).hidden=!1)}get isVisible(){return l(this,qe).hidden===!1}}Oc=new WeakMap,Qg=new WeakMap,Jg=new WeakMap,Fc=new WeakMap,jc=new WeakMap,qe=new WeakMap,sr=new WeakMap,zc=new WeakMap,Vh=new WeakMap,Gh=new WeakMap,$c=new WeakMap,ir=new WeakMap,Ms=new WeakMap,rr=new WeakMap,Wh=new WeakMap,or=new WeakMap,Xh=new WeakMap,Oa=new WeakMap,Fa=new WeakMap,ke=new WeakSet,$p=function(){const e=l(this,or),t=l(this,sr);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&l(this,or).html||null},i0=function(){var e,t,s;return((s=(t=(e=l(this,ke,$p))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:s.fontSize)||0},b_=function(){var e,t,s;return((s=(t=(e=l(this,ke,$p))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:s.color)||null},x_=function(e){const t=[],s={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},i={style:{color:l(this,ke,b_),fontSize:l(this,ke,i0)?`calc(${l(this,ke,i0)}px * var(--total-scale-factor))`:""}};for(const r of e.split(`
`))t.push({name:"span",value:r,attributes:i});return s},S_=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&l(this,ir))&&S(this,ke,Bp).call(this)},A_=function(){if(l(this,rr)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:s,pageX:i,pageY:r}}}=l(this,Gh);let o=!!l(this,$c),a=o?l(this,$c):l(this,Wh);for(const y of l(this,Vh))if(!a||Q.intersect(y.data.rect,a)!==null){a=y.data.rect,o=!0;break}const c=Q.normalizeRect([a[0],e[3]-a[1]+e[1],a[2],e[3]-a[3]+e[1]]),d=o?a[2]-a[0]+5:0,h=c[0]+d,f=c[1];m(this,rr,[100*(h-i)/t,100*(f-r)/s]);const{style:p}=l(this,qe);p.left=`${l(this,rr)[0]}%`,p.top=`${l(this,rr)[1]}%`},Bp=function(){m(this,ir,!l(this,ir)),l(this,ir)?(S(this,ke,Hp).call(this),l(this,qe).addEventListener("click",l(this,Fc)),l(this,qe).addEventListener("keydown",l(this,Oc))):(S(this,ke,r0).call(this),l(this,qe).removeEventListener("click",l(this,Fc)),l(this,qe).removeEventListener("keydown",l(this,Oc)))},Hp=function(){l(this,Ms)||this.render(),this.isVisible?l(this,ir)&&l(this,qe).classList.add("focused"):(S(this,ke,A_).call(this),l(this,qe).hidden=!1,l(this,qe).style.zIndex=parseInt(l(this,qe).style.zIndex)+1e3)},r0=function(){l(this,qe).classList.remove("focused"),!(l(this,ir)||!this.isVisible)&&(l(this,qe).hidden=!0,l(this,qe).style.zIndex=parseInt(l(this,qe).style.zIndex)-1e3)};class E_ extends nt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=te.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const s=document.createElement("span");s.textContent=t,e.append(s)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var qh;class DN extends nt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});x(this,qh,null)}render(){this.container.classList.add("lineAnnotation");const{data:t,width:s,height:i}=this,r=this.svgFactory.create(s,i,!0),o=m(this,qh,this.svgFactory.createElement("svg:line"));return o.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),o.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),o.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),o.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),o.setAttribute("stroke-width",t.borderStyle.width||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,qh)}addHighlightArea(){this.container.classList.add("highlightArea")}}qh=new WeakMap;var Yh;class IN extends nt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});x(this,Yh,null)}render(){this.container.classList.add("squareAnnotation");const{data:t,width:s,height:i}=this,r=this.svgFactory.create(s,i,!0),o=t.borderStyle.width,a=m(this,Yh,this.svgFactory.createElement("svg:rect"));return a.setAttribute("x",o/2),a.setAttribute("y",o/2),a.setAttribute("width",s-o),a.setAttribute("height",i-o),a.setAttribute("stroke-width",o||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),r.append(a),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,Yh)}addHighlightArea(){this.container.classList.add("highlightArea")}}Yh=new WeakMap;var Kh;class ON extends nt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});x(this,Kh,null)}render(){this.container.classList.add("circleAnnotation");const{data:t,width:s,height:i}=this,r=this.svgFactory.create(s,i,!0),o=t.borderStyle.width,a=m(this,Kh,this.svgFactory.createElement("svg:ellipse"));return a.setAttribute("cx",s/2),a.setAttribute("cy",i/2),a.setAttribute("rx",s/2-o/2),a.setAttribute("ry",i/2-o/2),a.setAttribute("stroke-width",o||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),r.append(a),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,Kh)}addHighlightArea(){this.container.classList.add("highlightArea")}}Kh=new WeakMap;var Qh;class __ extends nt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});x(this,Qh,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:s,borderStyle:i,popupRef:r},width:o,height:a}=this;if(!s)return this.container;const c=this.svgFactory.create(o,a,!0);let u=[];for(let h=0,f=s.length;h<f;h+=2){const p=s[h]-t[0],y=t[3]-s[h+1];u.push(`${p},${y}`)}u=u.join(" ");const d=m(this,Qh,this.svgFactory.createElement(this.svgElementName));return d.setAttribute("points",u),d.setAttribute("stroke-width",i.width||1),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),c.append(d),this.container.append(c),!r&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,Qh)}addHighlightArea(){this.container.classList.add("highlightArea")}}Qh=new WeakMap;class FN extends __{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class jN extends nt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var Jh,ja,Zh,o0;class Zw extends nt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});x(this,Zh);x(this,Jh,null);x(this,ja,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?te.HIGHLIGHT:te.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:s,inkLists:i,borderStyle:r,popupRef:o}}=this,{transform:a,width:c,height:u}=S(this,Zh,o0).call(this,s,t),d=this.svgFactory.create(c,u,!0),h=m(this,Jh,this.svgFactory.createElement("svg:g"));d.append(h),h.setAttribute("stroke-width",r.width||1),h.setAttribute("stroke-linecap","round"),h.setAttribute("stroke-linejoin","round"),h.setAttribute("stroke-miterlimit",10),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),h.setAttribute("transform",a);for(let f=0,p=i.length;f<p;f++){const y=this.svgFactory.createElement(this.svgElementName);l(this,ja).push(y),y.setAttribute("points",i[f].join(",")),h.append(y)}return!o&&this.hasPopupData&&this._createPopup(),this.container.append(d),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:s,points:i,rect:r}=t,o=l(this,Jh);if(s>=0&&o.setAttribute("stroke-width",s||1),i)for(let a=0,c=l(this,ja).length;a<c;a++)l(this,ja)[a].setAttribute("points",i[a].join(","));if(r){const{transform:a,width:c,height:u}=S(this,Zh,o0).call(this,this.data.rotation,r);o.parentElement.setAttribute("viewBox",`0 0 ${c} ${u}`),o.setAttribute("transform",a)}}getElementsToTriggerPopup(){return l(this,ja)}addHighlightArea(){this.container.classList.add("highlightArea")}}Jh=new WeakMap,ja=new WeakMap,Zh=new WeakSet,o0=function(t,s){switch(t){case 90:return{transform:`rotate(90) translate(${-s[0]},${s[1]}) scale(1,-1)`,width:s[3]-s[1],height:s[2]-s[0]};case 180:return{transform:`rotate(180) translate(${-s[2]},${s[1]}) scale(1,-1)`,width:s[2]-s[0],height:s[3]-s[1]};case 270:return{transform:`rotate(270) translate(${-s[2]},${s[3]}) scale(1,-1)`,width:s[3]-s[1],height:s[2]-s[0]};default:return{transform:`translate(${-s[0]},${s[3]}) scale(1,-1)`,width:s[2]-s[0],height:s[3]-s[1]}}};class C_ extends nt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=te.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class zN extends nt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class $N extends nt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class BN extends nt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class k_ extends nt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=te.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var ef,tf,a0;class HN extends nt{constructor(t){var i;super(t,{isRenderable:!0});x(this,tf);x(this,ef,null);const{file:s}=this.data;this.filename=s.filename,this.content=s.content,(i=this.linkService.eventBus)==null||i.dispatch("fileattachmentannotation",{source:this,...s})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:s}=this;let i;s.hasAppearance||s.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(s.name)?"paperclip":"pushpin"}.svg`,s.fillAlpha&&s.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(s.fillAlpha*100)}%);`)),i.addEventListener("dblclick",S(this,tf,a0).bind(this)),m(this,ef,i);const{isMac:r}=_t.platform;return t.addEventListener("keydown",o=>{o.key==="Enter"&&(r?o.metaKey:o.ctrlKey)&&S(this,tf,a0).call(this)}),!s.popupRef&&this.hasPopupData?this._createPopup():i.classList.add("popupTriggerArea"),t.append(i),t}getElementsToTriggerPopup(){return l(this,ef)}addHighlightArea(){this.container.classList.add("highlightArea")}}ef=new WeakMap,tf=new WeakSet,a0=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var nf,za,ao,sf,$o,l0,c0,Bc;let eb=(Bc=class{constructor({div:e,accessibilityManager:t,annotationCanvasMap:s,annotationEditorUIManager:i,page:r,viewport:o,structTreeLayer:a}){x(this,$o);x(this,nf,null);x(this,za,null);x(this,ao,new Map);x(this,sf,null);this.div=e,m(this,nf,t),m(this,za,s),m(this,sf,a||null),this.page=r,this.viewport=o,this.zIndex=0,this._annotationEditorUIManager=i}hasEditableAnnotations(){return l(this,ao).size>0}async render(e){var o;const{annotations:t}=e,s=this.div;Oo(s,this.viewport);const i=new Map,r={data:null,layer:s,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new Yd,annotationStorage:e.annotationStorage||new Xw,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const a of t){if(a.noHTML)continue;const c=a.annotationType===Qe.POPUP;if(c){const h=i.get(a.id);if(!h)continue;r.elements=h}else if(a.rect[2]===a.rect[0]||a.rect[3]===a.rect[1])continue;r.data=a;const u=iS.create(r);if(!u.isRenderable)continue;if(!c&&a.popupRef){const h=i.get(a.popupRef);h?h.push(u):i.set(a.popupRef,[u])}const d=u.render();a.hidden&&(d.style.visibility="hidden"),await S(this,$o,l0).call(this,d,a.id),u._isEditable&&(l(this,ao).set(u.data.id,u),(o=this._annotationEditorUIManager)==null||o.renderAnnotationElement(u))}S(this,$o,c0).call(this)}async addLinkAnnotations(e,t){const s={data:null,layer:this.div,linkService:t,svgFactory:new Yd,parent:this};for(const i of e){i.borderStyle||(i.borderStyle=Bc._defaultBorderStyle),s.data=i;const r=iS.create(s);if(!r.isRenderable)continue;const o=r.render();await S(this,$o,l0).call(this,o,i.id)}}update({viewport:e}){const t=this.div;this.viewport=e,Oo(t,{rotation:e.rotation}),S(this,$o,c0).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(l(this,ao).values())}getEditableAnnotation(e){return l(this,ao).get(e)}static get _defaultBorderStyle(){return le(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:El.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}},nf=new WeakMap,za=new WeakMap,ao=new WeakMap,sf=new WeakMap,$o=new WeakSet,l0=async function(e,t){var o,a;const s=e.firstChild||e,i=s.id=`${Gw}${t}`,r=await((o=l(this,sf))==null?void 0:o.getAriaAttributes(i));if(r)for(const[c,u]of r)s.setAttribute(c,u);this.div.append(e),(a=l(this,nf))==null||a.moveElementInDOM(this.div,e,s,!1)},c0=function(){var t;if(!l(this,za))return;const e=this.div;for(const[s,i]of l(this,za)){const r=e.querySelector(`[data-annotation-id="${s}"]`);if(!r)continue;i.className="annotationContent";const{firstChild:o}=r;o?o.nodeName==="CANVAS"?o.replaceWith(i):o.classList.contains("annotationContent")?o.after(i):o.before(i):r.append(i);const a=l(this,ao).get(s);a&&(a._hasNoCanvas?((t=this._annotationEditorUIManager)==null||t.setMissingCanvas(s,r.id,i),a._hasNoCanvas=!1):a.canvas=i)}l(this,za).clear()},Bc);const hp=/\r\n?|\n/g;var Ds,Fn,rf,$a,jn,at,T_,P_,R_,Up,wr,Vp,Gp,L_,d0,N_;const Le=class Le extends Me{constructor(t){super({...t,name:"freeTextEditor"});x(this,at);x(this,Ds);x(this,Fn,"");x(this,rf,`${this.id}-editor`);x(this,$a,null);x(this,jn);m(this,Ds,t.color||Le._defaultColor||Me._defaultLineColor),m(this,jn,t.fontSize||Le._defaultFontSize)}static get _keyboardManager(){const t=Le.prototype,s=o=>o.isEmpty(),i=Fo.TRANSLATE_SMALL,r=Fo.TRANSLATE_BIG;return le(this,"_keyboardManager",new Ff([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:s}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:s}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[i,0],checker:s}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[r,0],checker:s}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:s}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:s}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,i],checker:s}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,r],checker:s}]]))}static initialize(t,s){Me.initialize(t,s);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,s){switch(t){case he.FREETEXT_SIZE:Le._defaultFontSize=s;break;case he.FREETEXT_COLOR:Le._defaultColor=s;break}}updateParams(t,s){switch(t){case he.FREETEXT_SIZE:S(this,at,T_).call(this,s);break;case he.FREETEXT_COLOR:S(this,at,P_).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[he.FREETEXT_SIZE,Le._defaultFontSize],[he.FREETEXT_COLOR,Le._defaultColor||Me._defaultLineColor]]}get propertiesToUpdate(){return[[he.FREETEXT_SIZE,l(this,jn)],[he.FREETEXT_COLOR,l(this,Ds)]]}_translateEmpty(t,s){this._uiManager.translateSelectedEditors(t,s,!0)}getInitialTranslation(){const t=this.parentScale;return[-Le._internalPadding*t,-(Le._internalPadding+l(this,jn))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),m(this,$a,new AbortController);const t=this._uiManager.combinedSignal(l(this,$a));return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){var t;return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",l(this,rf)),this._isDraggable=!0,(t=l(this,$a))==null||t.abort(),m(this,$a,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var s;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(s=this._initialOptions)!=null&&s.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=l(this,Fn),s=m(this,Fn,S(this,at,R_).call(this).trimEnd());if(t===s)return;const i=r=>{if(m(this,Fn,r),!r){this.remove();return}S(this,at,Gp).call(this),this._uiManager.rebuild(this),S(this,at,Up).call(this)};this.addCommands({cmd:()=>{i(s)},undo:()=>{i(t)},mustExec:!1}),S(this,at,Up).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Le._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,s;(this._isCopy||this.annotationElementId)&&(t=this.x,s=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",l(this,rf)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${l(this,jn)}px * var(--total-scale-factor))`,i.color=l(this,Ds),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[r,o]=this.parentDimensions;if(this.annotationElementId){const{position:a}=this._initialData;let[c,u]=this.getInitialTranslation();[c,u]=this.pageTranslationToScreen(c,u);const[d,h]=this.pageDimensions,[f,p]=this.pageTranslation;let y,g;switch(this.rotation){case 0:y=t+(a[0]-f)/d,g=s+this.height-(a[1]-p)/h;break;case 90:y=t+(a[0]-f)/d,g=s-(a[1]-p)/h,[c,u]=[u,-c];break;case 180:y=t-this.width+(a[0]-f)/d,g=s-(a[1]-p)/h,[c,u]=[-c,-u];break;case 270:y=t+(a[0]-f-this.height*h)/d,g=s+(a[1]-p-this.width*d)/h,[c,u]=[-u,c];break}this.setAt(y*r,g*o,c,u)}else this._moveAfterPaste(t,s);S(this,at,Gp).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var y,g,A;const s=t.clipboardData||window.clipboardData,{types:i}=s;if(i.length===1&&i[0]==="text/plain")return;t.preventDefault();const r=S(y=Le,wr,d0).call(y,s.getData("text")||"").replaceAll(hp,`
`);if(!r)return;const o=window.getSelection();if(!o.rangeCount)return;this.editorDiv.normalize(),o.deleteFromDocument();const a=o.getRangeAt(0);if(!r.includes(`
`)){a.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),o.collapseToStart();return}const{startContainer:c,startOffset:u}=a,d=[],h=[];if(c.nodeType===Node.TEXT_NODE){const v=c.parentElement;if(h.push(c.nodeValue.slice(u).replaceAll(hp,"")),v!==this.editorDiv){let w=d;for(const b of this.editorDiv.childNodes){if(b===v){w=h;continue}w.push(S(g=Le,wr,Vp).call(g,b))}}d.push(c.nodeValue.slice(0,u).replaceAll(hp,""))}else if(c===this.editorDiv){let v=d,w=0;for(const b of this.editorDiv.childNodes)w++===u&&(v=h),v.push(S(A=Le,wr,Vp).call(A,b))}m(this,Fn,`${d.join(`
`)}${r}${h.join(`
`)}`),S(this,at,Gp).call(this);const f=new Range;let p=Math.sumPrecise(d.map(v=>v.length));for(const{firstChild:v}of this.editorDiv.childNodes)if(v.nodeType===Node.TEXT_NODE){const w=v.nodeValue.length;if(p<=w){f.setStart(v,p),f.setEnd(v,p);break}p-=w}o.removeAllRanges(),o.addRange(f)}get contentDiv(){return this.editorDiv}static async deserialize(t,s,i){var a;let r=null;if(t instanceof E_){const{data:{defaultAppearanceData:{fontSize:c,fontColor:u},rect:d,rotation:h,id:f,popupRef:p},textContent:y,textPosition:g,parent:{page:{pageNumber:A}}}=t;if(!y||y.length===0)return null;r=t={annotationType:te.FREETEXT,color:Array.from(u),fontSize:c,value:y.join(`
`),position:g,pageIndex:A-1,rect:d.slice(0),rotation:h,id:f,deleted:!1,popupRef:p}}const o=await super.deserialize(t,s,i);return m(o,jn,t.fontSize),m(o,Ds,Q.makeHexColor(...t.color)),m(o,Fn,S(a=Le,wr,d0).call(a,t.value)),o.annotationElementId=t.id||null,o._initialData=r,o}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s=Le._internalPadding*this.parentScale,i=this.getRect(s,s),r=Me._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:l(this,Ds)),o={annotationType:te.FREETEXT,color:r,fontSize:l(this,jn),value:S(this,at,L_).call(this),pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?(o.isCopy=!0,o):this.annotationElementId&&!S(this,at,N_).call(this,o)?null:(o.id=this.annotationElementId,o)}renderAnnotationElement(t){const s=super.renderAnnotationElement(t);if(this.deleted)return s;const{style:i}=s;i.fontSize=`calc(${l(this,jn)}px * var(--total-scale-factor))`,i.color=l(this,Ds),s.replaceChildren();for(const o of l(this,Fn).split(`
`)){const a=document.createElement("div");a.append(o?document.createTextNode(o):document.createElement("br")),s.append(a)}const r=Le._internalPadding*this.parentScale;return t.updateEdited({rect:this.getRect(r,r),popupContent:l(this,Fn)}),s}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};Ds=new WeakMap,Fn=new WeakMap,rf=new WeakMap,$a=new WeakMap,jn=new WeakMap,at=new WeakSet,T_=function(t){const s=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--total-scale-factor))`,this.translate(0,-(r-l(this,jn))*this.parentScale),m(this,jn,r),S(this,at,Up).call(this)},i=l(this,jn);this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:he.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},P_=function(t){const s=r=>{m(this,Ds,this.editorDiv.style.color=r)},i=l(this,Ds);this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:he.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},R_=function(){var i;const t=[];this.editorDiv.normalize();let s=null;for(const r of this.editorDiv.childNodes)(s==null?void 0:s.nodeType)===Node.TEXT_NODE&&r.nodeName==="BR"||(t.push(S(i=Le,wr,Vp).call(i,r)),s=r);return t.join(`
`)},Up=function(){const[t,s]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:r,div:o}=this,a=o.style.display,c=o.classList.contains("hidden");o.classList.remove("hidden"),o.style.display="hidden",r.div.append(this.div),i=o.getBoundingClientRect(),o.remove(),o.style.display=a,o.classList.toggle("hidden",c)}this.rotation%180===this.parentRotation%180?(this.width=i.width/t,this.height=i.height/s):(this.width=i.height/t,this.height=i.width/s),this.fixAndSetPosition()},wr=new WeakSet,Vp=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(hp,"")},Gp=function(){if(this.editorDiv.replaceChildren(),!!l(this,Fn))for(const t of l(this,Fn).split(`
`)){const s=document.createElement("div");s.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(s)}},L_=function(){return l(this,Fn).replaceAll(""," ")},d0=function(t){return t.replaceAll(" ","")},N_=function(t){const{value:s,fontSize:i,color:r,pageIndex:o}=this._initialData;return this._hasBeenMoved||t.value!==s||t.fontSize!==i||t.color.some((a,c)=>a!==r[c])||t.pageIndex!==o},x(Le,wr),F(Le,"_freeTextDefaultContent",""),F(Le,"_internalPadding",0),F(Le,"_defaultColor",null),F(Le,"_defaultFontSize",10),F(Le,"_type","freetext"),F(Le,"_editorType",te.FREETEXT);let u0=Le;class G{toSVGPath(){Ce("Abstract method `toSVGPath` must be implemented.")}get box(){Ce("Abstract getter `box` must be implemented.")}serialize(e,t){Ce("Abstract method `serialize` must be implemented.")}static _rescale(e,t,s,i,r,o){o||(o=new Float32Array(e.length));for(let a=0,c=e.length;a<c;a+=2)o[a]=t+e[a]*i,o[a+1]=s+e[a+1]*r;return o}static _rescaleAndSwap(e,t,s,i,r,o){o||(o=new Float32Array(e.length));for(let a=0,c=e.length;a<c;a+=2)o[a]=t+e[a+1]*i,o[a+1]=s+e[a]*r;return o}static _translate(e,t,s,i){i||(i=new Float32Array(e.length));for(let r=0,o=e.length;r<o;r+=2)i[r]=t+e[r],i[r+1]=s+e[r+1];return i}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,s,i,r){switch(r){case 90:return[1-t/s,e/i];case 180:return[1-e/s,1-t/i];case 270:return[t/s,1-e/i];default:return[e/s,t/i]}}static _normalizePagePoint(e,t,s){switch(s){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,s,i,r,o){return[(e+5*s)/6,(t+5*i)/6,(5*s+r)/6,(5*i+o)/6,(s+r)/2,(i+o)/2]}}F(G,"PRECISION",1e-4);var zn,Is,Hc,Uc,mi,ae,Ba,Ha,of,af,Vc,Gc,lo,lf,Zg,em,pt,rd,M_,D_,I_,O_,F_,j_;const ji=class ji{constructor({x:e,y:t},s,i,r,o,a=0){x(this,pt);x(this,zn);x(this,Is,[]);x(this,Hc);x(this,Uc);x(this,mi,[]);x(this,ae,new Float32Array(18));x(this,Ba);x(this,Ha);x(this,of);x(this,af);x(this,Vc);x(this,Gc);x(this,lo,[]);m(this,zn,s),m(this,Gc,r*i),m(this,Uc,o),l(this,ae).set([NaN,NaN,NaN,NaN,e,t],6),m(this,Hc,a),m(this,af,l(ji,lf)*i),m(this,of,l(ji,em)*i),m(this,Vc,i),l(this,lo).push(e,t)}isEmpty(){return isNaN(l(this,ae)[8])}add({x:e,y:t}){var M;m(this,Ba,e),m(this,Ha,t);const[s,i,r,o]=l(this,zn);let[a,c,u,d]=l(this,ae).subarray(8,12);const h=e-u,f=t-d,p=Math.hypot(h,f);if(p<l(this,of))return!1;const y=p-l(this,af),g=y/p,A=g*h,v=g*f;let w=a,b=c;a=u,c=d,u+=A,d+=v,(M=l(this,lo))==null||M.push(e,t);const E=-v/y,C=A/y,T=E*l(this,Gc),k=C*l(this,Gc);return l(this,ae).set(l(this,ae).subarray(2,8),0),l(this,ae).set([u+T,d+k],4),l(this,ae).set(l(this,ae).subarray(14,18),12),l(this,ae).set([u-T,d-k],16),isNaN(l(this,ae)[6])?(l(this,mi).length===0&&(l(this,ae).set([a+T,c+k],2),l(this,mi).push(NaN,NaN,NaN,NaN,(a+T-s)/r,(c+k-i)/o),l(this,ae).set([a-T,c-k],14),l(this,Is).push(NaN,NaN,NaN,NaN,(a-T-s)/r,(c-k-i)/o)),l(this,ae).set([w,b,a,c,u,d],6),!this.isEmpty()):(l(this,ae).set([w,b,a,c,u,d],6),Math.abs(Math.atan2(b-c,w-a)-Math.atan2(v,A))<Math.PI/2?([a,c,u,d]=l(this,ae).subarray(2,6),l(this,mi).push(NaN,NaN,NaN,NaN,((a+u)/2-s)/r,((c+d)/2-i)/o),[a,c,w,b]=l(this,ae).subarray(14,18),l(this,Is).push(NaN,NaN,NaN,NaN,((w+a)/2-s)/r,((b+c)/2-i)/o),!0):([w,b,a,c,u,d]=l(this,ae).subarray(0,6),l(this,mi).push(((w+5*a)/6-s)/r,((b+5*c)/6-i)/o,((5*a+u)/6-s)/r,((5*c+d)/6-i)/o,((a+u)/2-s)/r,((c+d)/2-i)/o),[u,d,a,c,w,b]=l(this,ae).subarray(12,18),l(this,Is).push(((w+5*a)/6-s)/r,((b+5*c)/6-i)/o,((5*a+u)/6-s)/r,((5*c+d)/6-i)/o,((a+u)/2-s)/r,((c+d)/2-i)/o),!0))}toSVGPath(){if(this.isEmpty())return"";const e=l(this,mi),t=l(this,Is);if(isNaN(l(this,ae)[6])&&!this.isEmpty())return S(this,pt,M_).call(this);const s=[];s.push(`M${e[4]} ${e[5]}`);for(let i=6;i<e.length;i+=6)isNaN(e[i])?s.push(`L${e[i+4]} ${e[i+5]}`):s.push(`C${e[i]} ${e[i+1]} ${e[i+2]} ${e[i+3]} ${e[i+4]} ${e[i+5]}`);S(this,pt,I_).call(this,s);for(let i=t.length-6;i>=6;i-=6)isNaN(t[i])?s.push(`L${t[i+4]} ${t[i+5]}`):s.push(`C${t[i]} ${t[i+1]} ${t[i+2]} ${t[i+3]} ${t[i+4]} ${t[i+5]}`);return S(this,pt,D_).call(this,s),s.join(" ")}newFreeDrawOutline(e,t,s,i,r,o){return new z_(e,t,s,i,r,o)}getOutlines(){var h;const e=l(this,mi),t=l(this,Is),s=l(this,ae),[i,r,o,a]=l(this,zn),c=new Float32Array((((h=l(this,lo))==null?void 0:h.length)??0)+2);for(let f=0,p=c.length-2;f<p;f+=2)c[f]=(l(this,lo)[f]-i)/o,c[f+1]=(l(this,lo)[f+1]-r)/a;if(c[c.length-2]=(l(this,Ba)-i)/o,c[c.length-1]=(l(this,Ha)-r)/a,isNaN(s[6])&&!this.isEmpty())return S(this,pt,O_).call(this,c);const u=new Float32Array(l(this,mi).length+24+l(this,Is).length);let d=e.length;for(let f=0;f<d;f+=2){if(isNaN(e[f])){u[f]=u[f+1]=NaN;continue}u[f]=e[f],u[f+1]=e[f+1]}d=S(this,pt,j_).call(this,u,d);for(let f=t.length-6;f>=6;f-=6)for(let p=0;p<6;p+=2){if(isNaN(t[f+p])){u[d]=u[d+1]=NaN,d+=2;continue}u[d]=t[f+p],u[d+1]=t[f+p+1],d+=2}return S(this,pt,F_).call(this,u,d),this.newFreeDrawOutline(u,c,l(this,zn),l(this,Vc),l(this,Hc),l(this,Uc))}};zn=new WeakMap,Is=new WeakMap,Hc=new WeakMap,Uc=new WeakMap,mi=new WeakMap,ae=new WeakMap,Ba=new WeakMap,Ha=new WeakMap,of=new WeakMap,af=new WeakMap,Vc=new WeakMap,Gc=new WeakMap,lo=new WeakMap,lf=new WeakMap,Zg=new WeakMap,em=new WeakMap,pt=new WeakSet,rd=function(){const e=l(this,ae).subarray(4,6),t=l(this,ae).subarray(16,18),[s,i,r,o]=l(this,zn);return[(l(this,Ba)+(e[0]-t[0])/2-s)/r,(l(this,Ha)+(e[1]-t[1])/2-i)/o,(l(this,Ba)+(t[0]-e[0])/2-s)/r,(l(this,Ha)+(t[1]-e[1])/2-i)/o]},M_=function(){const[e,t,s,i]=l(this,zn),[r,o,a,c]=S(this,pt,rd).call(this);return`M${(l(this,ae)[2]-e)/s} ${(l(this,ae)[3]-t)/i} L${(l(this,ae)[4]-e)/s} ${(l(this,ae)[5]-t)/i} L${r} ${o} L${a} ${c} L${(l(this,ae)[16]-e)/s} ${(l(this,ae)[17]-t)/i} L${(l(this,ae)[14]-e)/s} ${(l(this,ae)[15]-t)/i} Z`},D_=function(e){const t=l(this,Is);e.push(`L${t[4]} ${t[5]} Z`)},I_=function(e){const[t,s,i,r]=l(this,zn),o=l(this,ae).subarray(4,6),a=l(this,ae).subarray(16,18),[c,u,d,h]=S(this,pt,rd).call(this);e.push(`L${(o[0]-t)/i} ${(o[1]-s)/r} L${c} ${u} L${d} ${h} L${(a[0]-t)/i} ${(a[1]-s)/r}`)},O_=function(e){const t=l(this,ae),[s,i,r,o]=l(this,zn),[a,c,u,d]=S(this,pt,rd).call(this),h=new Float32Array(36);return h.set([NaN,NaN,NaN,NaN,(t[2]-s)/r,(t[3]-i)/o,NaN,NaN,NaN,NaN,(t[4]-s)/r,(t[5]-i)/o,NaN,NaN,NaN,NaN,a,c,NaN,NaN,NaN,NaN,u,d,NaN,NaN,NaN,NaN,(t[16]-s)/r,(t[17]-i)/o,NaN,NaN,NaN,NaN,(t[14]-s)/r,(t[15]-i)/o],0),this.newFreeDrawOutline(h,e,l(this,zn),l(this,Vc),l(this,Hc),l(this,Uc))},F_=function(e,t){const s=l(this,Is);return e.set([NaN,NaN,NaN,NaN,s[4],s[5]],t),t+=6},j_=function(e,t){const s=l(this,ae).subarray(4,6),i=l(this,ae).subarray(16,18),[r,o,a,c]=l(this,zn),[u,d,h,f]=S(this,pt,rd).call(this);return e.set([NaN,NaN,NaN,NaN,(s[0]-r)/a,(s[1]-o)/c,NaN,NaN,NaN,NaN,u,d,NaN,NaN,NaN,NaN,h,f,NaN,NaN,NaN,NaN,(i[0]-r)/a,(i[1]-o)/c],t),t+=24},x(ji,lf,8),x(ji,Zg,2),x(ji,em,l(ji,lf)+l(ji,Zg));let Dg=ji;var Wc,Ua,ar,cf,$n,uf,Ze,tm,$_;class z_ extends G{constructor(t,s,i,r,o,a){super();x(this,tm);x(this,Wc);x(this,Ua,new Float32Array(4));x(this,ar);x(this,cf);x(this,$n);x(this,uf);x(this,Ze);m(this,Ze,t),m(this,$n,s),m(this,Wc,i),m(this,uf,r),m(this,ar,o),m(this,cf,a),this.lastPoint=[NaN,NaN],S(this,tm,$_).call(this,a);const[c,u,d,h]=l(this,Ua);for(let f=0,p=t.length;f<p;f+=2)t[f]=(t[f]-c)/d,t[f+1]=(t[f+1]-u)/h;for(let f=0,p=s.length;f<p;f+=2)s[f]=(s[f]-c)/d,s[f+1]=(s[f+1]-u)/h}toSVGPath(){const t=[`M${l(this,Ze)[4]} ${l(this,Ze)[5]}`];for(let s=6,i=l(this,Ze).length;s<i;s+=6){if(isNaN(l(this,Ze)[s])){t.push(`L${l(this,Ze)[s+4]} ${l(this,Ze)[s+5]}`);continue}t.push(`C${l(this,Ze)[s]} ${l(this,Ze)[s+1]} ${l(this,Ze)[s+2]} ${l(this,Ze)[s+3]} ${l(this,Ze)[s+4]} ${l(this,Ze)[s+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,s,i,r],o){const a=i-t,c=r-s;let u,d;switch(o){case 0:u=G._rescale(l(this,Ze),t,r,a,-c),d=G._rescale(l(this,$n),t,r,a,-c);break;case 90:u=G._rescaleAndSwap(l(this,Ze),t,s,a,c),d=G._rescaleAndSwap(l(this,$n),t,s,a,c);break;case 180:u=G._rescale(l(this,Ze),i,s,-a,c),d=G._rescale(l(this,$n),i,s,-a,c);break;case 270:u=G._rescaleAndSwap(l(this,Ze),i,r,-a,-c),d=G._rescaleAndSwap(l(this,$n),i,r,-a,-c);break}return{outline:Array.from(u),points:[Array.from(d)]}}get box(){return l(this,Ua)}newOutliner(t,s,i,r,o,a=0){return new Dg(t,s,i,r,o,a)}getNewOutline(t,s){const[i,r,o,a]=l(this,Ua),[c,u,d,h]=l(this,Wc),f=o*d,p=a*h,y=i*d+c,g=r*h+u,A=this.newOutliner({x:l(this,$n)[0]*f+y,y:l(this,$n)[1]*p+g},l(this,Wc),l(this,uf),t,l(this,cf),s??l(this,ar));for(let v=2;v<l(this,$n).length;v+=2)A.add({x:l(this,$n)[v]*f+y,y:l(this,$n)[v+1]*p+g});return A.getOutlines()}}Wc=new WeakMap,Ua=new WeakMap,ar=new WeakMap,cf=new WeakMap,$n=new WeakMap,uf=new WeakMap,Ze=new WeakMap,tm=new WeakSet,$_=function(t){const s=l(this,Ze);let i=s[4],r=s[5];const o=[i,r,i,r];let a=i,c=r;const u=t?Math.max:Math.min;for(let h=6,f=s.length;h<f;h+=6){const p=s[h+4],y=s[h+5];if(isNaN(s[h]))Q.pointBoundingBox(p,y,o),c<y?(a=p,c=y):c===y&&(a=u(a,p));else{const g=[1/0,1/0,-1/0,-1/0];Q.bezierBoundingBox(i,r,...s.slice(h,h+6),g),Q.rectBoundingBox(...g,o),c<g[3]?(a=g[2],c=g[3]):c===g[3]&&(a=u(a,g[2]))}i=p,r=y}const d=l(this,Ua);d[0]=o[0]-l(this,ar),d[1]=o[1]-l(this,ar),d[2]=o[2]-o[0]+2*l(this,ar),d[3]=o[3]-o[1]+2*l(this,ar),this.lastPoint=[a,c]};var df,hf,co,Os,un,B_,Wp,H_,U_,f0;class h0{constructor(e,t=0,s=0,i=!0){x(this,un);x(this,df);x(this,hf);x(this,co,[]);x(this,Os,[]);const r=[1/0,1/0,-1/0,-1/0],o=10**-4;for(const{x:p,y,width:g,height:A}of e){const v=Math.floor((p-t)/o)*o,w=Math.ceil((p+g+t)/o)*o,b=Math.floor((y-t)/o)*o,E=Math.ceil((y+A+t)/o)*o,C=[v,b,E,!0],T=[w,b,E,!1];l(this,co).push(C,T),Q.rectBoundingBox(v,b,w,E,r)}const a=r[2]-r[0]+2*s,c=r[3]-r[1]+2*s,u=r[0]-s,d=r[1]-s,h=l(this,co).at(i?-1:-2),f=[h[0],h[2]];for(const p of l(this,co)){const[y,g,A]=p;p[0]=(y-u)/a,p[1]=(g-d)/c,p[2]=(A-d)/c}m(this,df,new Float32Array([u,d,a,c])),m(this,hf,f)}getOutlines(){l(this,co).sort((t,s)=>t[0]-s[0]||t[1]-s[1]||t[2]-s[2]);const e=[];for(const t of l(this,co))t[3]?(e.push(...S(this,un,f0).call(this,t)),S(this,un,H_).call(this,t)):(S(this,un,U_).call(this,t),e.push(...S(this,un,f0).call(this,t)));return S(this,un,B_).call(this,e)}}df=new WeakMap,hf=new WeakMap,co=new WeakMap,Os=new WeakMap,un=new WeakSet,B_=function(e){const t=[],s=new Set;for(const o of e){const[a,c,u]=o;t.push([a,c,o],[a,u,o])}t.sort((o,a)=>o[1]-a[1]||o[0]-a[0]);for(let o=0,a=t.length;o<a;o+=2){const c=t[o][2],u=t[o+1][2];c.push(u),u.push(c),s.add(c),s.add(u)}const i=[];let r;for(;s.size>0;){const o=s.values().next().value;let[a,c,u,d,h]=o;s.delete(o);let f=a,p=c;for(r=[a,u],i.push(r);;){let y;if(s.has(d))y=d;else if(s.has(h))y=h;else break;s.delete(y),[a,c,u,d,h]=y,f!==a&&(r.push(f,p,a,p===c?c:u),f=a),p=p===c?u:c}r.push(f,p)}return new UN(i,l(this,df),l(this,hf))},Wp=function(e){const t=l(this,Os);let s=0,i=t.length-1;for(;s<=i;){const r=s+i>>1,o=t[r][0];if(o===e)return r;o<e?s=r+1:i=r-1}return i+1},H_=function([,e,t]){const s=S(this,un,Wp).call(this,e);l(this,Os).splice(s,0,[e,t])},U_=function([,e,t]){const s=S(this,un,Wp).call(this,e);for(let i=s;i<l(this,Os).length;i++){const[r,o]=l(this,Os)[i];if(r!==e)break;if(r===e&&o===t){l(this,Os).splice(i,1);return}}for(let i=s-1;i>=0;i--){const[r,o]=l(this,Os)[i];if(r!==e)break;if(r===e&&o===t){l(this,Os).splice(i,1);return}}},f0=function(e){const[t,s,i]=e,r=[[t,s,i]],o=S(this,un,Wp).call(this,i);for(let a=0;a<o;a++){const[c,u]=l(this,Os)[a];for(let d=0,h=r.length;d<h;d++){const[,f,p]=r[d];if(!(u<=f||p<=c)){if(f>=c){if(p>u)r[d][1]=u;else{if(h===1)return[];r.splice(d,1),d--,h--}continue}r[d][2]=c,p>u&&r.push([t,u,p])}}}return r};var ff,Xc;class UN extends G{constructor(t,s,i){super();x(this,ff);x(this,Xc);m(this,Xc,t),m(this,ff,s),this.lastPoint=i}toSVGPath(){const t=[];for(const s of l(this,Xc)){let[i,r]=s;t.push(`M${i} ${r}`);for(let o=2;o<s.length;o+=2){const a=s[o],c=s[o+1];a===i?(t.push(`V${c}`),r=c):c===r&&(t.push(`H${a}`),i=a)}t.push("Z")}return t.join(" ")}serialize([t,s,i,r],o){const a=[],c=i-t,u=r-s;for(const d of l(this,Xc)){const h=new Array(d.length);for(let f=0;f<d.length;f+=2)h[f]=t+d[f]*c,h[f+1]=r-d[f+1]*u;a.push(h)}return a}get box(){return l(this,ff)}get classNamesForOutlining(){return["highlightOutline"]}}ff=new WeakMap,Xc=new WeakMap;class p0 extends Dg{newFreeDrawOutline(e,t,s,i,r,o){return new VN(e,t,s,i,r,o)}}class VN extends z_{newOutliner(e,t,s,i,r,o=0){return new p0(e,t,s,i,r,o)}}var Fs,Va,qc,ut,pf,Yc,gf,mf,uo,js,Kc,yf,_e,g0,m0,y0,qo,V_,Mr;const pn=class pn{constructor({editor:e=null,uiManager:t=null}){x(this,_e);x(this,Fs,null);x(this,Va,null);x(this,qc);x(this,ut,null);x(this,pf,!1);x(this,Yc,!1);x(this,gf,null);x(this,mf);x(this,uo,null);x(this,js,null);x(this,Kc);var s;e?(m(this,Yc,!1),m(this,Kc,he.HIGHLIGHT_COLOR),m(this,gf,e)):(m(this,Yc,!0),m(this,Kc,he.HIGHLIGHT_DEFAULT_COLOR)),m(this,js,(e==null?void 0:e._uiManager)||t),m(this,mf,l(this,js)._eventBus),m(this,qc,(e==null?void 0:e.color)||((s=l(this,js))==null?void 0:s.highlightColors.values().next().value)||"#FFFF98"),l(pn,yf)||m(pn,yf,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return le(this,"_keyboardManager",new Ff([[["Escape","mac+Escape"],pn.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],pn.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],pn.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],pn.prototype._moveToPrevious],[["Home","mac+Home"],pn.prototype._moveToBeginning],[["End","mac+End"],pn.prototype._moveToEnd]]))}renderButton(){const e=m(this,Fs,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.setAttribute("aria-haspopup",!0);const t=l(this,js)._signal;e.addEventListener("click",S(this,_e,qo).bind(this),{signal:t}),e.addEventListener("keydown",S(this,_e,y0).bind(this),{signal:t});const s=m(this,Va,document.createElement("span"));return s.className="swatch",s.setAttribute("aria-hidden",!0),s.style.backgroundColor=l(this,qc),e.append(s),e}renderMainDropdown(){const e=m(this,ut,S(this,_e,g0).call(this));return e.setAttribute("aria-orientation","horizontal"),e.setAttribute("aria-labelledby","highlightColorPickerLabel"),e}_colorSelectFromKeyboard(e){if(e.target===l(this,Fs)){S(this,_e,qo).call(this,e);return}const t=e.target.getAttribute("data-color");t&&S(this,_e,m0).call(this,t,e)}_moveToNext(e){var t,s;if(!l(this,_e,Mr)){S(this,_e,qo).call(this,e);return}if(e.target===l(this,Fs)){(t=l(this,ut).firstChild)==null||t.focus();return}(s=e.target.nextSibling)==null||s.focus()}_moveToPrevious(e){var t,s;if(e.target===((t=l(this,ut))==null?void 0:t.firstChild)||e.target===l(this,Fs)){l(this,_e,Mr)&&this._hideDropdownFromKeyboard();return}l(this,_e,Mr)||S(this,_e,qo).call(this,e),(s=e.target.previousSibling)==null||s.focus()}_moveToBeginning(e){var t;if(!l(this,_e,Mr)){S(this,_e,qo).call(this,e);return}(t=l(this,ut).firstChild)==null||t.focus()}_moveToEnd(e){var t;if(!l(this,_e,Mr)){S(this,_e,qo).call(this,e);return}(t=l(this,ut).lastChild)==null||t.focus()}hideDropdown(){var e,t;(e=l(this,ut))==null||e.classList.add("hidden"),(t=l(this,uo))==null||t.abort(),m(this,uo,null)}_hideDropdownFromKeyboard(){var e;if(!l(this,Yc)){if(!l(this,_e,Mr)){(e=l(this,gf))==null||e.unselect();return}this.hideDropdown(),l(this,Fs).focus({preventScroll:!0,focusVisible:l(this,pf)})}}updateColor(e){if(l(this,Va)&&(l(this,Va).style.backgroundColor=e),!l(this,ut))return;const t=l(this,js).highlightColors.values();for(const s of l(this,ut).children)s.setAttribute("aria-selected",t.next().value===e)}destroy(){var e,t;(e=l(this,Fs))==null||e.remove(),m(this,Fs,null),m(this,Va,null),(t=l(this,ut))==null||t.remove(),m(this,ut,null)}};Fs=new WeakMap,Va=new WeakMap,qc=new WeakMap,ut=new WeakMap,pf=new WeakMap,Yc=new WeakMap,gf=new WeakMap,mf=new WeakMap,uo=new WeakMap,js=new WeakMap,Kc=new WeakMap,yf=new WeakMap,_e=new WeakSet,g0=function(){const e=document.createElement("div"),t=l(this,js)._signal;e.addEventListener("contextmenu",Ss,{signal:t}),e.className="dropdown",e.role="listbox",e.setAttribute("aria-multiselectable",!1),e.setAttribute("aria-orientation","vertical"),e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[s,i]of l(this,js).highlightColors){const r=document.createElement("button");r.tabIndex="0",r.role="option",r.setAttribute("data-color",i),r.title=s,r.setAttribute("data-l10n-id",l(pn,yf)[s]);const o=document.createElement("span");r.append(o),o.className="swatch",o.style.backgroundColor=i,r.setAttribute("aria-selected",i===l(this,qc)),r.addEventListener("click",S(this,_e,m0).bind(this,i),{signal:t}),e.append(r)}return e.addEventListener("keydown",S(this,_e,y0).bind(this),{signal:t}),e},m0=function(e,t){t.stopPropagation(),l(this,mf).dispatch("switchannotationeditorparams",{source:this,type:l(this,Kc),value:e})},y0=function(e){pn._keyboardManager.exec(this,e)},qo=function(e){if(l(this,_e,Mr)){this.hideDropdown();return}if(m(this,pf,e.detail===0),l(this,uo)||(m(this,uo,new AbortController),window.addEventListener("pointerdown",S(this,_e,V_).bind(this),{signal:l(this,js).combinedSignal(l(this,uo))})),l(this,ut)){l(this,ut).classList.remove("hidden");return}const t=m(this,ut,S(this,_e,g0).call(this));l(this,Fs).append(t)},V_=function(e){var t;(t=l(this,ut))!=null&&t.contains(e.target)||this.hideDropdown()},Mr=function(){return l(this,ut)&&!l(this,ut).classList.contains("hidden")},x(pn,yf,null);let Kd=pn;var Qc,vf,lr,Ga,Jc,yn,wf,bf,Wa,ls,Bn,Lt,Zc,cr,Wt,eu,cs,xf,se,v0,Xp,G_,W_,X_,w0,Yo,ms,Pl,q_,qp,od,Y_,K_,Q_,J_,Z_;const we=class we extends Me{constructor(t){super({...t,name:"highlightEditor"});x(this,se);x(this,Qc,null);x(this,vf,0);x(this,lr);x(this,Ga,null);x(this,Jc,null);x(this,yn,null);x(this,wf,null);x(this,bf,0);x(this,Wa,null);x(this,ls,null);x(this,Bn,null);x(this,Lt,!1);x(this,Zc,null);x(this,cr);x(this,Wt,null);x(this,eu,"");x(this,cs);x(this,xf,"");this.color=t.color||we._defaultColor,m(this,cs,t.thickness||we._defaultThickness),m(this,cr,t.opacity||we._defaultOpacity),m(this,lr,t.boxes||null),m(this,xf,t.methodOfCreation||""),m(this,eu,t.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(m(this,Lt,!0),S(this,se,Xp).call(this,t),S(this,se,Yo).call(this)):l(this,lr)&&(m(this,Qc,t.anchorNode),m(this,vf,t.anchorOffset),m(this,wf,t.focusNode),m(this,bf,t.focusOffset),S(this,se,v0).call(this),S(this,se,Yo).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const t=we.prototype;return le(this,"_keyboardManager",new Ff([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:l(this,Lt)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:l(this,cs),methodOfCreation:l(this,xf)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,s){var i;Me.initialize(t,s),we._defaultColor||(we._defaultColor=((i=s.highlightColors)==null?void 0:i.values().next().value)||"#fff066")}static updateDefaultParams(t,s){switch(t){case he.HIGHLIGHT_DEFAULT_COLOR:we._defaultColor=s;break;case he.HIGHLIGHT_THICKNESS:we._defaultThickness=s;break}}translateInPage(t,s){}get toolbarPosition(){return l(this,Zc)}updateParams(t,s){switch(t){case he.HIGHLIGHT_COLOR:S(this,se,G_).call(this,s);break;case he.HIGHLIGHT_THICKNESS:S(this,se,W_).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[he.HIGHLIGHT_DEFAULT_COLOR,we._defaultColor],[he.HIGHLIGHT_THICKNESS,we._defaultThickness]]}get propertiesToUpdate(){return[[he.HIGHLIGHT_COLOR,this.color||we._defaultColor],[he.HIGHLIGHT_THICKNESS,l(this,cs)||we._defaultThickness],[he.HIGHLIGHT_FREE,l(this,Lt)]]}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.highlightColors&&(m(this,Jc,new Kd({editor:this})),t.addColorPicker(l(this,Jc))),t):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(S(this,se,od).call(this))}getBaseTranslation(){return[0,0]}getRect(t,s){return super.getRect(t,s,S(this,se,od).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){S(this,se,w0).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(S(this,se,Yo).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var i;let s=!1;this.parent&&!t?S(this,se,w0).call(this):t&&(S(this,se,Yo).call(this,t),s=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),s&&this.select()}rotate(t){var r,o,a;const{drawLayer:s}=this.parent;let i;l(this,Lt)?(t=(t-this.rotation+360)%360,i=S(r=we,ms,Pl).call(r,l(this,ls).box,t)):i=S(o=we,ms,Pl).call(o,[this.x,this.y,this.width,this.height],t),s.updateProperties(l(this,Bn),{bbox:i,root:{"data-main-rotation":t}}),s.updateProperties(l(this,Wt),{bbox:S(a=we,ms,Pl).call(a,l(this,yn).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();l(this,eu)&&(t.setAttribute("aria-label",l(this,eu)),t.setAttribute("role","mark")),l(this,Lt)?t.classList.add("free"):this.div.addEventListener("keydown",S(this,se,q_).bind(this),{signal:this._uiManager._signal});const s=m(this,Wa,document.createElement("div"));t.append(s),s.setAttribute("aria-hidden","true"),s.className="internal",s.style.clipPath=l(this,Ga);const[i,r]=this.parentDimensions;return this.setDims(this.width*i,this.height*r),vE(this,l(this,Wa),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(l(this,Wt),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(l(this,Wt),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:S(this,se,qp).call(this,!0);break;case 1:case 3:S(this,se,qp).call(this,!1);break}}select(){var t;super.select(),l(this,Wt)&&((t=this.parent)==null||t.drawLayer.updateProperties(l(this,Wt),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),l(this,Wt)&&((t=this.parent)==null||t.drawLayer.updateProperties(l(this,Wt),{rootClass:{selected:!1}}),l(this,Lt)||S(this,se,qp).call(this,!1))}get _mustFixPosition(){return!l(this,Lt)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(l(this,Bn),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(l(this,Wt),{rootClass:{hidden:!t}}))}static startHighlighting(t,s,{target:i,x:r,y:o}){const{x:a,y:c,width:u,height:d}=i.getBoundingClientRect(),h=new AbortController,f=t.combinedSignal(h),p=y=>{h.abort(),S(this,ms,J_).call(this,t,y)};window.addEventListener("blur",p,{signal:f}),window.addEventListener("pointerup",p,{signal:f}),window.addEventListener("pointerdown",et,{capture:!0,passive:!1,signal:f}),window.addEventListener("contextmenu",Ss,{signal:f}),i.addEventListener("pointermove",S(this,ms,Q_).bind(this,t),{signal:f}),this._freeHighlight=new p0({x:r,y:o},[a,c,u,d],t.scale,this._defaultThickness/2,s,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,s,i){var g,A,v,w;let r=null;if(t instanceof C_){const{data:{quadPoints:b,rect:E,rotation:C,id:T,color:k,opacity:R,popupRef:M},parent:{page:{pageNumber:L}}}=t;r=t={annotationType:te.HIGHLIGHT,color:Array.from(k),opacity:R,quadPoints:b,boxes:null,pageIndex:L-1,rect:E.slice(0),rotation:C,id:T,deleted:!1,popupRef:M}}else if(t instanceof Zw){const{data:{inkLists:b,rect:E,rotation:C,id:T,color:k,borderStyle:{rawWidth:R},popupRef:M},parent:{page:{pageNumber:L}}}=t;r=t={annotationType:te.HIGHLIGHT,color:Array.from(k),thickness:R,inkLists:b,boxes:null,pageIndex:L-1,rect:E.slice(0),rotation:C,id:T,deleted:!1,popupRef:M}}const{color:o,quadPoints:a,inkLists:c,opacity:u}=t,d=await super.deserialize(t,s,i);d.color=Q.makeHexColor(...o),m(d,cr,u||1),c&&m(d,cs,t.thickness),d.annotationElementId=t.id||null,d._initialData=r;const[h,f]=d.pageDimensions,[p,y]=d.pageTranslation;if(a){const b=m(d,lr,[]);for(let E=0;E<a.length;E+=8)b.push({x:(a[E]-p)/h,y:1-(a[E+1]-y)/f,width:(a[E+2]-a[E])/h,height:(a[E+1]-a[E+5])/f});S(g=d,se,v0).call(g),S(A=d,se,Yo).call(A),d.rotate(d.rotation)}else if(c){m(d,Lt,!0);const b=c[0],E={x:b[0]-p,y:f-(b[1]-y)},C=new p0(E,[0,0,h,f],1,l(d,cs)/2,!0,.001);for(let R=0,M=b.length;R<M;R+=2)E.x=b[R]-p,E.y=f-(b[R+1]-y),C.add(E);const{id:T,clipPathId:k}=s.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:d.color,"fill-opacity":d._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:C.toSVGPath()}},!0,!0);S(v=d,se,Xp).call(v,{highlightOutlines:C.getOutlines(),highlightId:T,clipPathId:k}),S(w=d,se,Yo).call(w),d.rotate(d.parentRotation)}return d}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const s=this.getRect(0,0),i=Me._colorManager.convert(this.color),r={annotationType:te.HIGHLIGHT,color:i,opacity:l(this,cr),thickness:l(this,cs),quadPoints:S(this,se,Y_).call(this),outlines:S(this,se,K_).call(this,s),pageIndex:this.pageIndex,rect:s,rotation:S(this,se,od).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!S(this,se,Z_).call(this,r)?null:(r.id=this.annotationElementId,r)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};Qc=new WeakMap,vf=new WeakMap,lr=new WeakMap,Ga=new WeakMap,Jc=new WeakMap,yn=new WeakMap,wf=new WeakMap,bf=new WeakMap,Wa=new WeakMap,ls=new WeakMap,Bn=new WeakMap,Lt=new WeakMap,Zc=new WeakMap,cr=new WeakMap,Wt=new WeakMap,eu=new WeakMap,cs=new WeakMap,xf=new WeakMap,se=new WeakSet,v0=function(){const t=new h0(l(this,lr),.001);m(this,ls,t.getOutlines()),[this.x,this.y,this.width,this.height]=l(this,ls).box;const s=new h0(l(this,lr),.0025,.001,this._uiManager.direction==="ltr");m(this,yn,s.getOutlines());const{lastPoint:i}=l(this,yn);m(this,Zc,[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height])},Xp=function({highlightOutlines:t,highlightId:s,clipPathId:i}){var h,f;if(m(this,ls,t),m(this,yn,t.getNewOutline(l(this,cs)/2+1.5,.0025)),s>=0)m(this,Bn,s),m(this,Ga,i),this.parent.drawLayer.finalizeDraw(s,{bbox:t.box,path:{d:t.toSVGPath()}}),m(this,Wt,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:l(this,yn).box,path:{d:l(this,yn).toSVGPath()}},!0));else if(this.parent){const p=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(l(this,Bn),{bbox:S(h=we,ms,Pl).call(h,l(this,ls).box,(p-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(l(this,Wt),{bbox:S(f=we,ms,Pl).call(f,l(this,yn).box,p),path:{d:l(this,yn).toSVGPath()}})}const[o,a,c,u]=t.box;switch(this.rotation){case 0:this.x=o,this.y=a,this.width=c,this.height=u;break;case 90:{const[p,y]=this.parentDimensions;this.x=a,this.y=1-o,this.width=c*y/p,this.height=u*p/y;break}case 180:this.x=1-o,this.y=1-a,this.width=c,this.height=u;break;case 270:{const[p,y]=this.parentDimensions;this.x=1-a,this.y=o,this.width=c*y/p,this.height=u*p/y;break}}const{lastPoint:d}=l(this,yn);m(this,Zc,[(d[0]-o)/c,(d[1]-a)/u])},G_=function(t){const s=(o,a)=>{var c,u;this.color=o,m(this,cr,a),(c=this.parent)==null||c.drawLayer.updateProperties(l(this,Bn),{root:{fill:o,"fill-opacity":a}}),(u=l(this,Jc))==null||u.updateColor(o)},i=this.color,r=l(this,cr);this.addCommands({cmd:s.bind(this,t,we._defaultOpacity),undo:s.bind(this,i,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:he.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(t)},!0)},W_=function(t){const s=l(this,cs),i=r=>{m(this,cs,r),S(this,se,X_).call(this,r)};this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:he.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},X_=function(t){if(!l(this,Lt))return;S(this,se,Xp).call(this,{highlightOutlines:l(this,ls).getNewOutline(t/2)}),this.fixAndSetPosition();const[s,i]=this.parentDimensions;this.setDims(this.width*s,this.height*i)},w0=function(){l(this,Bn)===null||!this.parent||(this.parent.drawLayer.remove(l(this,Bn)),m(this,Bn,null),this.parent.drawLayer.remove(l(this,Wt)),m(this,Wt,null))},Yo=function(t=this.parent){l(this,Bn)===null&&({id:Jt(this,Bn)._,clipPathId:Jt(this,Ga)._}=t.drawLayer.draw({bbox:l(this,ls).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":l(this,cr)},rootClass:{highlight:!0,free:l(this,Lt)},path:{d:l(this,ls).toSVGPath()}},!1,!0),m(this,Wt,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:l(this,Lt)},bbox:l(this,yn).box,path:{d:l(this,yn).toSVGPath()}},l(this,Lt))),l(this,Wa)&&(l(this,Wa).style.clipPath=l(this,Ga)))},ms=new WeakSet,Pl=function([t,s,i,r],o){switch(o){case 90:return[1-s-r,t,r,i];case 180:return[1-t-i,1-s-r,i,r];case 270:return[s,1-t-i,r,i]}return[t,s,i,r]},q_=function(t){we._keyboardManager.exec(this,t)},qp=function(t){if(!l(this,Qc))return;const s=window.getSelection();t?s.setPosition(l(this,Qc),l(this,vf)):s.setPosition(l(this,wf),l(this,bf))},od=function(){return l(this,Lt)?this.rotation:0},Y_=function(){if(l(this,Lt))return null;const[t,s]=this.pageDimensions,[i,r]=this.pageTranslation,o=l(this,lr),a=new Float32Array(o.length*8);let c=0;for(const{x:u,y:d,width:h,height:f}of o){const p=u*t+i,y=(1-d)*s+r;a[c]=a[c+4]=p,a[c+1]=a[c+3]=y,a[c+2]=a[c+6]=p+h*t,a[c+5]=a[c+7]=y-f*s,c+=8}return a},K_=function(t){return l(this,ls).serialize(t,S(this,se,od).call(this))},Q_=function(t,s){this._freeHighlight.add(s)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},J_=function(t,s){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(s,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},Z_=function(t){const{color:s}=this._initialData;return t.color.some((i,r)=>i!==s[r])},x(we,ms),F(we,"_defaultColor",null),F(we,"_defaultOpacity",1),F(we,"_defaultThickness",12),F(we,"_type","highlight"),F(we,"_editorType",te.HIGHLIGHT),F(we,"_freeHighlightId",-1),F(we,"_freeHighlight",null),F(we,"_freeHighlightClipId","");let Ig=we;var Xa;class eC{constructor(){x(this,Xa,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,s]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,s)}updateSVGProperty(e,t){l(this,Xa)[e]=t}toSVGProperties(){const e=l(this,Xa);return m(this,Xa,Object.create(null)),{root:e}}reset(){m(this,Xa,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){Ce("Not implemented")}}Xa=new WeakMap;var Hn,tu,vt,qa,Ya,ho,fo,po,Ka,ye,b0,x0,S0,ad,tC,Yp,ld,Rl;const q=class q extends Me{constructor(t){super(t);x(this,ye);x(this,Hn,null);x(this,tu);F(this,"_drawId",null);m(this,tu,t.mustBeCommitted||!1),this._addOutlines(t)}_addOutlines(t){t.drawOutlines&&(S(this,ye,b0).call(this,t),S(this,ye,ad).call(this))}static _mergeSVGProperties(t,s){const i=new Set(Object.keys(t));for(const[r,o]of Object.entries(s))i.has(r)?Object.assign(t[r],o):t[r]=o;return t}static getDefaultDrawingOptions(t){Ce("Not implemented")}static get typesMap(){Ce("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,s){const i=this.typesMap.get(t);i&&this._defaultDrawingOptions.updateProperty(i,s),this._currentParent&&(l(q,vt).updateProperty(i,s),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,s){const i=this.constructor.typesMap.get(t);i&&this._updateProperty(t,i,s)}static get defaultPropertiesToUpdate(){const t=[],s=this._defaultDrawingOptions;for(const[i,r]of this.typesMap)t.push([i,s[r]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:s}=this;for(const[i,r]of this.constructor.typesMap)t.push([i,s[r]]);return t}_updateProperty(t,s,i){const r=this._drawingOptions,o=r[s],a=c=>{var d;r.updateProperty(s,c);const u=l(this,Hn).updateProperty(s,c);u&&S(this,ye,ld).call(this,u),(d=this.parent)==null||d.drawLayer.updateProperties(this._drawId,r.toSVGProperties())};this.addCommands({cmd:a.bind(this,i),undo:a.bind(this,o),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,q._mergeSVGProperties(l(this,Hn).getPathResizingSVGProperties(S(this,ye,Yp).call(this)),{bbox:S(this,ye,Rl).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,q._mergeSVGProperties(l(this,Hn).getPathResizedSVGProperties(S(this,ye,Yp).call(this)),{bbox:S(this,ye,Rl).call(this)}))}_onTranslating(t,s){var i;(i=this.parent)==null||i.drawLayer.updateProperties(this._drawId,{bbox:S(this,ye,Rl).call(this)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,q._mergeSVGProperties(l(this,Hn).getPathTranslatedSVGProperties(S(this,ye,Yp).call(this),this.parentDimensions),{bbox:S(this,ye,Rl).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,l(this,tu)&&(m(this,tu,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){S(this,ye,S0).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(S(this,ye,ad).call(this),S(this,ye,ld).call(this,l(this,Hn).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var i;let s=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),S(this,ye,S0).call(this)):t&&(this._uiManager.addShouldRescale(this),S(this,ye,ad).call(this,t),s=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(t),s&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,q._mergeSVGProperties({bbox:S(this,ye,Rl).call(this)},l(this,Hn).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&S(this,ye,ld).call(this,l(this,Hn).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,s;this._isCopy&&(t=this.x,s=this.y);const i=super.render();i.classList.add("draw");const r=document.createElement("div");i.append(r),r.setAttribute("aria-hidden","true"),r.className="internal";const[o,a]=this.parentDimensions;return this.setDims(this.width*o,this.height*a),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,s),i}static createDrawerInstance(t,s,i,r,o){Ce("Not implemented")}static startDrawing(t,s,i,r){var A;const{target:o,offsetX:a,offsetY:c,pointerId:u,pointerType:d}=r;if(l(q,fo)&&l(q,fo)!==d)return;const{viewport:{rotation:h}}=t,{width:f,height:p}=o.getBoundingClientRect(),y=m(q,qa,new AbortController),g=t.combinedSignal(y);if(l(q,ho)||m(q,ho,u),l(q,fo)??m(q,fo,d),window.addEventListener("pointerup",v=>{var w;l(q,ho)===v.pointerId?this._endDraw(v):(w=l(q,po))==null||w.delete(v.pointerId)},{signal:g}),window.addEventListener("pointercancel",v=>{var w;l(q,ho)===v.pointerId?this._currentParent.endDrawingSession():(w=l(q,po))==null||w.delete(v.pointerId)},{signal:g}),window.addEventListener("pointerdown",v=>{l(q,fo)===v.pointerType&&((l(q,po)||m(q,po,new Set)).add(v.pointerId),l(q,vt).isCancellable()&&(l(q,vt).removeLastElement(),l(q,vt).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:g}),window.addEventListener("contextmenu",Ss,{signal:g}),o.addEventListener("pointermove",this._drawMove.bind(this),{signal:g}),o.addEventListener("touchmove",v=>{v.timeStamp===l(q,Ka)&&et(v)},{signal:g}),t.toggleDrawing(),(A=s._editorUndoBar)==null||A.hide(),l(q,vt)){t.drawLayer.updateProperties(this._currentDrawId,l(q,vt).startNew(a,c,f,p,h));return}s.updateUIForDefaultProperties(this),m(q,vt,this.createDrawerInstance(a,c,f,p,h)),m(q,Ya,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(l(q,Ya).toSVGProperties(),l(q,vt).defaultSVGProperties),!0,!1)}static _drawMove(t){var o;if(m(q,Ka,-1),!l(q,vt))return;const{offsetX:s,offsetY:i,pointerId:r}=t;if(l(q,ho)===r){if(((o=l(q,po))==null?void 0:o.size)>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,l(q,vt).add(s,i)),m(q,Ka,t.timeStamp),et(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,m(q,vt,null),m(q,Ya,null),m(q,fo,null),m(q,Ka,NaN)),l(q,qa)&&(l(q,qa).abort(),m(q,qa,null),m(q,ho,NaN),m(q,po,null))}static _endDraw(t){const s=this._currentParent;if(s){if(s.toggleDrawing(!0),this._cleanup(!1),(t==null?void 0:t.target)===s.div&&s.drawLayer.updateProperties(this._currentDrawId,l(q,vt).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const i=l(q,vt),r=this._currentDrawId,o=i.getLastElement();s.addCommands({cmd:()=>{s.drawLayer.updateProperties(r,i.setLastElement(o))},undo:()=>{s.drawLayer.updateProperties(r,i.removeLastElement())},mustExec:!1,type:he.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const s=this._currentParent;if(!s)return null;if(s.toggleDrawing(!0),s.cleanUndoStack(he.DRAW_STEP),!l(q,vt).isEmpty()){const{pageDimensions:[i,r],scale:o}=s,a=s.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:l(q,vt).getOutlines(i*o,r*o,o,this._INNER_MARGIN),drawingOptions:l(q,Ya),mustBeCommitted:!t});return this._cleanup(!0),a}return s.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,s,i,r,o,a){Ce("Not implemented")}static async deserialize(t,s,i){var h,f;const{rawDims:{pageWidth:r,pageHeight:o,pageX:a,pageY:c}}=s.viewport,u=this.deserializeDraw(a,c,r,o,this._INNER_MARGIN,t),d=await super.deserialize(t,s,i);return d.createDrawingOptions(t),S(h=d,ye,b0).call(h,{drawOutlines:u}),S(f=d,ye,ad).call(f),d.onScaleChanging(),d.rotate(),d}serializeDraw(t){const[s,i]=this.pageTranslation,[r,o]=this.pageDimensions;return l(this,Hn).serialize([s,i,r,o],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};Hn=new WeakMap,tu=new WeakMap,vt=new WeakMap,qa=new WeakMap,Ya=new WeakMap,ho=new WeakMap,fo=new WeakMap,po=new WeakMap,Ka=new WeakMap,ye=new WeakSet,b0=function({drawOutlines:t,drawId:s,drawingOptions:i}){m(this,Hn,t),this._drawingOptions||(this._drawingOptions=i),s>=0?(this._drawId=s,this.parent.drawLayer.finalizeDraw(s,t.defaultProperties)):this._drawId=S(this,ye,x0).call(this,t,this.parent),S(this,ye,ld).call(this,t.box)},x0=function(t,s){const{id:i}=s.drawLayer.draw(q._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return i},S0=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},ad=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=S(this,ye,x0).call(this,l(this,Hn),t)}},tC=function([t,s,i,r]){const{parentDimensions:[o,a],rotation:c}=this;switch(c){case 90:return[s,1-t,i*(a/o),r*(o/a)];case 180:return[1-t,1-s,i,r];case 270:return[1-s,t,i*(a/o),r*(o/a)];default:return[t,s,i,r]}},Yp=function(){const{x:t,y:s,width:i,height:r,parentDimensions:[o,a],rotation:c}=this;switch(c){case 90:return[1-s,t,i*(o/a),r*(a/o)];case 180:return[1-t,1-s,i,r];case 270:return[s,1-t,i*(o/a),r*(a/o)];default:return[t,s,i,r]}},ld=function(t){if([this.x,this.y,this.width,this.height]=S(this,ye,tC).call(this,t),this.div){this.fixAndSetPosition();const[s,i]=this.parentDimensions;this.setDims(this.width*s,this.height*i)}this._onResized()},Rl=function(){const{x:t,y:s,width:i,height:r,rotation:o,parentRotation:a,parentDimensions:[c,u]}=this;switch((o*4+a)/90){case 1:return[1-s-r,t,r,i];case 2:return[1-t-i,1-s-r,i,r];case 3:return[s,1-t-i,r,i];case 4:return[t,s-i*(c/u),r*(u/c),i*(c/u)];case 5:return[1-s,t,i*(c/u),r*(u/c)];case 6:return[1-t-r*(u/c),1-s,r*(u/c),i*(c/u)];case 7:return[s-i*(c/u),1-t-r*(u/c),i*(c/u),r*(u/c)];case 8:return[t-i,s-r,i,r];case 9:return[1-s,t-i,r,i];case 10:return[1-t,1-s,i,r];case 11:return[s-r,1-t,r,i];case 12:return[t-r*(u/c),s,r*(u/c),i*(c/u)];case 13:return[1-s-i*(c/u),t-r*(u/c),i*(c/u),r*(u/c)];case 14:return[1-t,1-s-i*(c/u),r*(u/c),i*(c/u)];case 15:return[s,1-t,i*(c/u),r*(u/c)];default:return[t,s,i,r]}},F(q,"_currentDrawId",-1),F(q,"_currentParent",null),x(q,vt,null),x(q,qa,null),x(q,Ya,null),x(q,ho,NaN),x(q,fo,null),x(q,po,null),x(q,Ka,NaN),F(q,"_INNER_MARGIN",3);let Og=q;var yi,wt,bt,Qa,nu,tn,Nt,us,Ja,Za,el,su,Kp;class GN{constructor(e,t,s,i,r,o){x(this,su);x(this,yi,new Float64Array(6));x(this,wt);x(this,bt);x(this,Qa);x(this,nu);x(this,tn);x(this,Nt,"");x(this,us,0);x(this,Ja,new $f);x(this,Za);x(this,el);m(this,Za,s),m(this,el,i),m(this,Qa,r),m(this,nu,o),[e,t]=S(this,su,Kp).call(this,e,t);const a=m(this,wt,[NaN,NaN,NaN,NaN,e,t]);m(this,tn,[e,t]),m(this,bt,[{line:a,points:l(this,tn)}]),l(this,yi).set(a,0)}updateProperty(e,t){e==="stroke-width"&&m(this,nu,t)}isEmpty(){return!l(this,bt)||l(this,bt).length===0}isCancellable(){return l(this,tn).length<=10}add(e,t){[e,t]=S(this,su,Kp).call(this,e,t);const[s,i,r,o]=l(this,yi).subarray(2,6),a=e-r,c=t-o;return Math.hypot(l(this,Za)*a,l(this,el)*c)<=2?null:(l(this,tn).push(e,t),isNaN(s)?(l(this,yi).set([r,o,e,t],2),l(this,wt).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(l(this,yi)[0])&&l(this,wt).splice(6,6),l(this,yi).set([s,i,r,o,e,t],0),l(this,wt).push(...G.createBezierPoints(s,i,r,o,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const s=this.add(e,t);return s||(l(this,tn).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,s,i,r){m(this,Za,s),m(this,el,i),m(this,Qa,r),[e,t]=S(this,su,Kp).call(this,e,t);const o=m(this,wt,[NaN,NaN,NaN,NaN,e,t]);m(this,tn,[e,t]);const a=l(this,bt).at(-1);return a&&(a.line=new Float32Array(a.line),a.points=new Float32Array(a.points)),l(this,bt).push({line:o,points:l(this,tn)}),l(this,yi).set(o,0),m(this,us,0),this.toSVGPath(),null}getLastElement(){return l(this,bt).at(-1)}setLastElement(e){return l(this,bt)?(l(this,bt).push(e),m(this,wt,e.line),m(this,tn,e.points),m(this,us,0),{path:{d:this.toSVGPath()}}):l(this,Ja).setLastElement(e)}removeLastElement(){if(!l(this,bt))return l(this,Ja).removeLastElement();l(this,bt).pop(),m(this,Nt,"");for(let e=0,t=l(this,bt).length;e<t;e++){const{line:s,points:i}=l(this,bt)[e];m(this,wt,s),m(this,tn,i),m(this,us,0),this.toSVGPath()}return{path:{d:l(this,Nt)}}}toSVGPath(){const e=G.svgRound(l(this,wt)[4]),t=G.svgRound(l(this,wt)[5]);if(l(this,tn).length===2)return m(this,Nt,`${l(this,Nt)} M ${e} ${t} Z`),l(this,Nt);if(l(this,tn).length<=6){const i=l(this,Nt).lastIndexOf("M");m(this,Nt,`${l(this,Nt).slice(0,i)} M ${e} ${t}`),m(this,us,6)}if(l(this,tn).length===4){const i=G.svgRound(l(this,wt)[10]),r=G.svgRound(l(this,wt)[11]);return m(this,Nt,`${l(this,Nt)} L ${i} ${r}`),m(this,us,12),l(this,Nt)}const s=[];l(this,us)===0&&(s.push(`M ${e} ${t}`),m(this,us,6));for(let i=l(this,us),r=l(this,wt).length;i<r;i+=6){const[o,a,c,u,d,h]=l(this,wt).slice(i,i+6).map(G.svgRound);s.push(`C${o} ${a} ${c} ${u} ${d} ${h}`)}return m(this,Nt,l(this,Nt)+s.join(" ")),m(this,us,l(this,wt).length),l(this,Nt)}getOutlines(e,t,s,i){const r=l(this,bt).at(-1);return r.line=new Float32Array(r.line),r.points=new Float32Array(r.points),l(this,Ja).build(l(this,bt),e,t,s,l(this,Qa),l(this,nu),i),m(this,yi,null),m(this,wt,null),m(this,bt,null),m(this,Nt,null),l(this,Ja)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}yi=new WeakMap,wt=new WeakMap,bt=new WeakMap,Qa=new WeakMap,nu=new WeakMap,tn=new WeakMap,Nt=new WeakMap,us=new WeakMap,Ja=new WeakMap,Za=new WeakMap,el=new WeakMap,su=new WeakSet,Kp=function(e,t){return G._normalizePoint(e,t,l(this,Za),l(this,el),l(this,Qa))};var nn,Sf,Af,Un,vi,wi,iu,ru,tl,It,Ii,nC,sC,iC;class $f extends G{constructor(){super(...arguments);x(this,It);x(this,nn);x(this,Sf,0);x(this,Af);x(this,Un);x(this,vi);x(this,wi);x(this,iu);x(this,ru);x(this,tl)}build(t,s,i,r,o,a,c){m(this,vi,s),m(this,wi,i),m(this,iu,r),m(this,ru,o),m(this,tl,a),m(this,Af,c??0),m(this,Un,t),S(this,It,sC).call(this)}get thickness(){return l(this,tl)}setLastElement(t){return l(this,Un).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return l(this,Un).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:s}of l(this,Un)){if(t.push(`M${G.svgRound(s[4])} ${G.svgRound(s[5])}`),s.length===6){t.push("Z");continue}if(s.length===12&&isNaN(s[6])){t.push(`L${G.svgRound(s[10])} ${G.svgRound(s[11])}`);continue}for(let i=6,r=s.length;i<r;i+=6){const[o,a,c,u,d,h]=s.subarray(i,i+6).map(G.svgRound);t.push(`C${o} ${a} ${c} ${u} ${d} ${h}`)}}return t.join("")}serialize([t,s,i,r],o){const a=[],c=[],[u,d,h,f]=S(this,It,nC).call(this);let p,y,g,A,v,w,b,E,C;switch(l(this,ru)){case 0:C=G._rescale,p=t,y=s+r,g=i,A=-r,v=t+u*i,w=s+(1-d-f)*r,b=t+(u+h)*i,E=s+(1-d)*r;break;case 90:C=G._rescaleAndSwap,p=t,y=s,g=i,A=r,v=t+d*i,w=s+u*r,b=t+(d+f)*i,E=s+(u+h)*r;break;case 180:C=G._rescale,p=t+i,y=s,g=-i,A=r,v=t+(1-u-h)*i,w=s+d*r,b=t+(1-u)*i,E=s+(d+f)*r;break;case 270:C=G._rescaleAndSwap,p=t+i,y=s+r,g=-i,A=-r,v=t+(1-d-f)*i,w=s+(1-u-h)*r,b=t+(1-d)*i,E=s+(1-u)*r;break}for(const{line:T,points:k}of l(this,Un))a.push(C(T,p,y,g,A,o?new Array(T.length):null)),c.push(C(k,p,y,g,A,o?new Array(k.length):null));return{lines:a,points:c,rect:[v,w,b,E]}}static deserialize(t,s,i,r,o,{paths:{lines:a,points:c},rotation:u,thickness:d}){const h=[];let f,p,y,g,A;switch(u){case 0:A=G._rescale,f=-t/i,p=s/r+1,y=1/i,g=-1/r;break;case 90:A=G._rescaleAndSwap,f=-s/r,p=-t/i,y=1/r,g=1/i;break;case 180:A=G._rescale,f=t/i+1,p=-s/r,y=-1/i,g=1/r;break;case 270:A=G._rescaleAndSwap,f=s/r+1,p=t/i+1,y=-1/r,g=-1/i;break}if(!a){a=[];for(const w of c){const b=w.length;if(b===2){a.push(new Float32Array([NaN,NaN,NaN,NaN,w[0],w[1]]));continue}if(b===4){a.push(new Float32Array([NaN,NaN,NaN,NaN,w[0],w[1],NaN,NaN,NaN,NaN,w[2],w[3]]));continue}const E=new Float32Array(3*(b-2));a.push(E);let[C,T,k,R]=w.subarray(0,4);E.set([NaN,NaN,NaN,NaN,C,T],0);for(let M=4;M<b;M+=2){const L=w[M],N=w[M+1];E.set(G.createBezierPoints(C,T,k,R,L,N),(M-2)*3),[C,T,k,R]=[k,R,L,N]}}}for(let w=0,b=a.length;w<b;w++)h.push({line:A(a[w].map(E=>E??NaN),f,p,y,g),points:A(c[w].map(E=>E??NaN),f,p,y,g)});const v=new this.prototype.constructor;return v.build(h,i,r,1,u,d,o),v}get box(){return l(this,nn)}updateProperty(t,s){return t==="stroke-width"?S(this,It,iC).call(this,s):null}updateParentDimensions([t,s],i){const[r,o]=S(this,It,Ii).call(this);m(this,vi,t),m(this,wi,s),m(this,iu,i);const[a,c]=S(this,It,Ii).call(this),u=a-r,d=c-o,h=l(this,nn);return h[0]-=u,h[1]-=d,h[2]+=2*u,h[3]+=2*d,h}updateRotation(t){return m(this,Sf,t),{path:{transform:this.rotationTransform}}}get viewBox(){return l(this,nn).map(G.svgRound).join(" ")}get defaultProperties(){const[t,s]=l(this,nn);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${G.svgRound(t)} ${G.svgRound(s)}`}}}get rotationTransform(){const[,,t,s]=l(this,nn);let i=0,r=0,o=0,a=0,c=0,u=0;switch(l(this,Sf)){case 90:r=s/t,o=-t/s,c=t;break;case 180:i=-1,a=-1,c=t,u=s;break;case 270:r=-s/t,o=t/s,u=s;break;default:return""}return`matrix(${i} ${r} ${o} ${a} ${G.svgRound(c)} ${G.svgRound(u)})`}getPathResizingSVGProperties([t,s,i,r]){const[o,a]=S(this,It,Ii).call(this),[c,u,d,h]=l(this,nn);if(Math.abs(d-o)<=G.PRECISION||Math.abs(h-a)<=G.PRECISION){const A=t+i/2-(c+d/2),v=s+r/2-(u+h/2);return{path:{"transform-origin":`${G.svgRound(t)} ${G.svgRound(s)}`,transform:`${this.rotationTransform} translate(${A} ${v})`}}}const f=(i-2*o)/(d-2*o),p=(r-2*a)/(h-2*a),y=d/i,g=h/r;return{path:{"transform-origin":`${G.svgRound(c)} ${G.svgRound(u)}`,transform:`${this.rotationTransform} scale(${y} ${g}) translate(${G.svgRound(o)} ${G.svgRound(a)}) scale(${f} ${p}) translate(${G.svgRound(-o)} ${G.svgRound(-a)})`}}}getPathResizedSVGProperties([t,s,i,r]){const[o,a]=S(this,It,Ii).call(this),c=l(this,nn),[u,d,h,f]=c;if(c[0]=t,c[1]=s,c[2]=i,c[3]=r,Math.abs(h-o)<=G.PRECISION||Math.abs(f-a)<=G.PRECISION){const v=t+i/2-(u+h/2),w=s+r/2-(d+f/2);for(const{line:b,points:E}of l(this,Un))G._translate(b,v,w,b),G._translate(E,v,w,E);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${G.svgRound(t)} ${G.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const p=(i-2*o)/(h-2*o),y=(r-2*a)/(f-2*a),g=-p*(u+o)+t+o,A=-y*(d+a)+s+a;if(p!==1||y!==1||g!==0||A!==0)for(const{line:v,points:w}of l(this,Un))G._rescale(v,g,A,p,y,v),G._rescale(w,g,A,p,y,w);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${G.svgRound(t)} ${G.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,s],i){const[r,o]=i,a=l(this,nn),c=t-a[0],u=s-a[1];if(l(this,vi)===r&&l(this,wi)===o)for(const{line:d,points:h}of l(this,Un))G._translate(d,c,u,d),G._translate(h,c,u,h);else{const d=l(this,vi)/r,h=l(this,wi)/o;m(this,vi,r),m(this,wi,o);for(const{line:f,points:p}of l(this,Un))G._rescale(f,c,u,d,h,f),G._rescale(p,c,u,d,h,p);a[2]*=d,a[3]*=h}return a[0]=t,a[1]=s,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${G.svgRound(t)} ${G.svgRound(s)}`}}}get defaultSVGProperties(){const t=l(this,nn);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${G.svgRound(t[0])} ${G.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}nn=new WeakMap,Sf=new WeakMap,Af=new WeakMap,Un=new WeakMap,vi=new WeakMap,wi=new WeakMap,iu=new WeakMap,ru=new WeakMap,tl=new WeakMap,It=new WeakSet,Ii=function(t=l(this,tl)){const s=l(this,Af)+t/2*l(this,iu);return l(this,ru)%180===0?[s/l(this,vi),s/l(this,wi)]:[s/l(this,wi),s/l(this,vi)]},nC=function(){const[t,s,i,r]=l(this,nn),[o,a]=S(this,It,Ii).call(this,0);return[t+o,s+a,i-2*o,r-2*a]},sC=function(){const t=m(this,nn,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:r}of l(this,Un)){if(r.length<=12){for(let c=4,u=r.length;c<u;c+=6)Q.pointBoundingBox(r[c],r[c+1],t);continue}let o=r[4],a=r[5];for(let c=6,u=r.length;c<u;c+=6){const[d,h,f,p,y,g]=r.subarray(c,c+6);Q.bezierBoundingBox(o,a,d,h,f,p,y,g,t),o=y,a=g}}const[s,i]=S(this,It,Ii).call(this);t[0]=qt(t[0]-s,0,1),t[1]=qt(t[1]-i,0,1),t[2]=qt(t[2]+s,0,1),t[3]=qt(t[3]+i,0,1),t[2]-=t[0],t[3]-=t[1]},iC=function(t){const[s,i]=S(this,It,Ii).call(this);m(this,tl,t);const[r,o]=S(this,It,Ii).call(this),[a,c]=[r-s,o-i],u=l(this,nn);return u[0]-=a,u[1]-=c,u[2]+=2*a,u[3]+=2*c,u};class Lm extends eC{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:Me._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??(t=this["stroke-width"]),t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new Lm(this._viewParameters);return e.updateAll(this),e}}var nm,rC;const Wl=class Wl extends Og{constructor(t){super({...t,name:"inkEditor"});x(this,nm);this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,s){Me.initialize(t,s),this._defaultDrawingOptions=new Lm(s.viewParameters)}static getDefaultDrawingOptions(t){const s=this._defaultDrawingOptions.clone();return s.updateProperties(t),s}static get supportMultipleDrawings(){return!0}static get typesMap(){return le(this,"typesMap",new Map([[he.INK_THICKNESS,"stroke-width"],[he.INK_COLOR,"stroke"],[he.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,s,i,r,o){return new GN(t,s,i,r,o,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,s,i,r,o,a){return $f.deserialize(t,s,i,r,o,a)}static async deserialize(t,s,i){let r=null;if(t instanceof Zw){const{data:{inkLists:a,rect:c,rotation:u,id:d,color:h,opacity:f,borderStyle:{rawWidth:p},popupRef:y},parent:{page:{pageNumber:g}}}=t;r=t={annotationType:te.INK,color:Array.from(h),thickness:p,opacity:f,paths:{points:a},boxes:null,pageIndex:g-1,rect:c.slice(0),rotation:u,id:d,deleted:!1,popupRef:y}}const o=await super.deserialize(t,s,i);return o.annotationElementId=t.id||null,o._initialData=r,o}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:s,parent:i}=this;s.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(t,s.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:s,opacity:i}){this._drawingOptions=Wl.getDefaultDrawingOptions({stroke:Q.makeHexColor(...t),"stroke-width":s,"stroke-opacity":i})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:s,points:i,rect:r}=this.serializeDraw(t),{_drawingOptions:{stroke:o,"stroke-opacity":a,"stroke-width":c}}=this,u={annotationType:te.INK,color:Me._colorManager.convert(o),opacity:a,thickness:c,paths:{lines:s,points:i},pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?(u.isCopy=!0,u):this.annotationElementId&&!S(this,nm,rC).call(this,u)?null:(u.id=this.annotationElementId,u)}renderAnnotationElement(t){const{points:s,rect:i}=this.serializeDraw(!1);return t.updateEdited({rect:i,thickness:this._drawingOptions["stroke-width"],points:s}),null}};nm=new WeakSet,rC=function(t){const{color:s,thickness:i,opacity:r,pageIndex:o}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||t.color.some((a,c)=>a!==s[c])||t.thickness!==i||t.opacity!==r||t.pageIndex!==o},F(Wl,"_type","ink"),F(Wl,"_editorType",te.INK),F(Wl,"_defaultDrawingOptions",null);let A0=Wl;class E0 extends $f{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const fp=8,Bu=3;var nl,be,_0,zs,oC,aC,C0,Qp,lC,cC,uC,k0,T0,dC;class Ei{static extractContoursFromText(e,{fontFamily:t,fontStyle:s,fontWeight:i},r,o,a,c){let u=new OffscreenCanvas(1,1),d=u.getContext("2d",{alpha:!1});const h=200,f=d.font=`${s} ${i} ${h}px ${t}`,{actualBoundingBoxLeft:p,actualBoundingBoxRight:y,actualBoundingBoxAscent:g,actualBoundingBoxDescent:A,fontBoundingBoxAscent:v,fontBoundingBoxDescent:w,width:b}=d.measureText(e),E=1.5,C=Math.ceil(Math.max(Math.abs(p)+Math.abs(y)||0,b)*E),T=Math.ceil(Math.max(Math.abs(g)+Math.abs(A)||h,Math.abs(v)+Math.abs(w)||h)*E);u=new OffscreenCanvas(C,T),d=u.getContext("2d",{alpha:!0,willReadFrequently:!0}),d.font=f,d.filter="grayscale(1)",d.fillStyle="white",d.fillRect(0,0,C,T),d.fillStyle="black",d.fillText(e,C*(E-1)/2,T*(3-E)/2);const k=S(this,be,k0).call(this,d.getImageData(0,0,C,T).data),R=S(this,be,uC).call(this,k),M=S(this,be,T0).call(this,R),L=S(this,be,C0).call(this,k,C,T,M);return this.processDrawnLines({lines:{curves:L,width:C,height:T},pageWidth:r,pageHeight:o,rotation:a,innerMargin:c,mustSmooth:!0,areContours:!0})}static process(e,t,s,i,r){const[o,a,c]=S(this,be,dC).call(this,e),[u,d]=S(this,be,cC).call(this,o,a,c,Math.hypot(a,c)*l(this,nl).sigmaSFactor,l(this,nl).sigmaR,l(this,nl).kernelSize),h=S(this,be,T0).call(this,d),f=S(this,be,C0).call(this,u,a,c,h);return this.processDrawnLines({lines:{curves:f,width:a,height:c},pageWidth:t,pageHeight:s,rotation:i,innerMargin:r,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:s,rotation:i,innerMargin:r,mustSmooth:o,areContours:a}){i%180!==0&&([t,s]=[s,t]);const{curves:c,width:u,height:d}=e,h=e.thickness??0,f=[],p=Math.min(t/u,s/d),y=p/t,g=p/s,A=[];for(const{points:w}of c){const b=o?S(this,be,lC).call(this,w):w;if(!b)continue;A.push(b);const E=b.length,C=new Float32Array(E),T=new Float32Array(3*(E===2?2:E-2));if(f.push({line:T,points:C}),E===2){C[0]=b[0]*y,C[1]=b[1]*g,T.set([NaN,NaN,NaN,NaN,C[0],C[1]],0);continue}let[k,R,M,L]=b;k*=y,R*=g,M*=y,L*=g,C.set([k,R,M,L],0),T.set([NaN,NaN,NaN,NaN,k,R],0);for(let N=4;N<E;N+=2){const B=C[N]=b[N]*y,H=C[N+1]=b[N+1]*g;T.set(G.createBezierPoints(k,R,M,L,B,H),(N-2)*3),[k,R,M,L]=[M,L,B,H]}}if(f.length===0)return null;const v=a?new E0:new $f;return v.build(f,t,s,1,i,a?0:h,r),{outline:v,newCurves:A,areContours:a,thickness:h,width:u,height:d}}static async compressSignature({outlines:e,areContours:t,thickness:s,width:i,height:r}){let o=1/0,a=-1/0,c=0;for(const b of e){c+=b.length;for(let E=2,C=b.length;E<C;E++){const T=b[E]-b[E-2];o=Math.min(o,T),a=Math.max(a,T)}}let u;o>=-128&&a<=127?u=Int8Array:o>=-32768&&a<=32767?u=Int16Array:u=Int32Array;const d=e.length,h=fp+Bu*d,f=new Uint32Array(h);let p=0;f[p++]=h*Uint32Array.BYTES_PER_ELEMENT+(c-2*d)*u.BYTES_PER_ELEMENT,f[p++]=0,f[p++]=i,f[p++]=r,f[p++]=t?0:1,f[p++]=Math.max(0,Math.floor(s??0)),f[p++]=d,f[p++]=u.BYTES_PER_ELEMENT;for(const b of e)f[p++]=b.length-2,f[p++]=b[0],f[p++]=b[1];const y=new CompressionStream("deflate-raw"),g=y.writable.getWriter();await g.ready,g.write(f);const A=u.prototype.constructor;for(const b of e){const E=new A(b.length-2);for(let C=2,T=b.length;C<T;C++)E[C-2]=b[C]-b[C-2];g.write(E)}g.close();const v=await new Response(y.readable).arrayBuffer(),w=new Uint8Array(v);return aE(w)}static async decompressSignature(e){try{const t=xL(e),{readable:s,writable:i}=new DecompressionStream("deflate-raw"),r=i.getWriter();await r.ready,r.write(t).then(async()=>{await r.ready,await r.close()}).catch(()=>{});let o=null,a=0;for await(const b of s)o||(o=new Uint8Array(new Uint32Array(b.buffer,0,4)[0])),o.set(b,a),a+=b.length;const c=new Uint32Array(o.buffer,0,o.length>>2),u=c[1];if(u!==0)throw new Error(`Invalid version: ${u}`);const d=c[2],h=c[3],f=c[4]===0,p=c[5],y=c[6],g=c[7],A=[],v=(fp+Bu*y)*Uint32Array.BYTES_PER_ELEMENT;let w;switch(g){case Int8Array.BYTES_PER_ELEMENT:w=new Int8Array(o.buffer,v);break;case Int16Array.BYTES_PER_ELEMENT:w=new Int16Array(o.buffer,v);break;case Int32Array.BYTES_PER_ELEMENT:w=new Int32Array(o.buffer,v);break}a=0;for(let b=0;b<y;b++){const E=c[Bu*b+fp],C=new Float32Array(E+2);A.push(C);for(let T=0;T<Bu-1;T++)C[T]=c[Bu*b+fp+T+1];for(let T=0;T<E;T++)C[T+2]=C[T]+w[a++]}return{areContours:f,thickness:p,outlines:A,width:d,height:h}}catch(t){return ne(`decompressSignature: ${t}`),null}}}nl=new WeakMap,be=new WeakSet,_0=function(e,t,s,i){return s-=e,i-=t,s===0?i>0?0:4:s===1?i+6:2-i},zs=new WeakMap,oC=function(e,t,s,i,r,o,a){const c=S(this,be,_0).call(this,s,i,r,o);for(let u=0;u<8;u++){const d=(-u+c-a+16)%8,h=l(this,zs)[2*d],f=l(this,zs)[2*d+1];if(e[(s+h)*t+(i+f)]!==0)return d}return-1},aC=function(e,t,s,i,r,o,a){const c=S(this,be,_0).call(this,s,i,r,o);for(let u=0;u<8;u++){const d=(u+c+a+16)%8,h=l(this,zs)[2*d],f=l(this,zs)[2*d+1];if(e[(s+h)*t+(i+f)]!==0)return d}return-1},C0=function(e,t,s,i){const r=e.length,o=new Int32Array(r);for(let d=0;d<r;d++)o[d]=e[d]<=i?1:0;for(let d=1;d<s-1;d++)o[d*t]=o[d*t+t-1]=0;for(let d=0;d<t;d++)o[d]=o[t*s-1-d]=0;let a=1,c;const u=[];for(let d=1;d<s-1;d++){c=1;for(let h=1;h<t-1;h++){const f=d*t+h,p=o[f];if(p===0)continue;let y=d,g=h;if(p===1&&o[f-1]===0)a+=1,g-=1;else if(p>=1&&o[f+1]===0)a+=1,g+=1,p>1&&(c=p);else{p!==1&&(c=Math.abs(p));continue}const A=[h,d],v=g===h+1,w={isHole:v,points:A,id:a,parent:0};u.push(w);let b;for(const N of u)if(N.id===c){b=N;break}b?b.isHole?w.parent=v?b.parent:c:w.parent=v?c:b.parent:w.parent=v?c:0;const E=S(this,be,oC).call(this,o,t,d,h,y,g,0);if(E===-1){o[f]=-a,o[f]!==1&&(c=Math.abs(o[f]));continue}let C=l(this,zs)[2*E],T=l(this,zs)[2*E+1];const k=d+C,R=h+T;y=k,g=R;let M=d,L=h;for(;;){const N=S(this,be,aC).call(this,o,t,M,L,y,g,1);C=l(this,zs)[2*N],T=l(this,zs)[2*N+1];const B=M+C,H=L+T;A.push(H,B);const W=M*t+L;if(o[W+1]===0?o[W]=-a:o[W]===1&&(o[W]=a),B===d&&H===h&&M===k&&L===R){o[f]!==1&&(c=Math.abs(o[f]));break}else y=M,g=L,M=B,L=H}}}return u},Qp=function(e,t,s,i){if(s-t<=4){for(let k=t;k<s-2;k+=2)i.push(e[k],e[k+1]);return}const r=e[t],o=e[t+1],a=e[s-4]-r,c=e[s-3]-o,u=Math.hypot(a,c),d=a/u,h=c/u,f=d*o-h*r,p=c/a,y=1/u,g=Math.atan(p),A=Math.cos(g),v=Math.sin(g),w=y*(Math.abs(A)+Math.abs(v)),b=y*(1-w+w**2),E=Math.max(Math.atan(Math.abs(v+A)*b),Math.atan(Math.abs(v-A)*b));let C=0,T=t;for(let k=t+2;k<s-2;k+=2){const R=Math.abs(f-d*e[k+1]+h*e[k]);R>C&&(T=k,C=R)}C>(u*E)**2?(S(this,be,Qp).call(this,e,t,T+2,i),S(this,be,Qp).call(this,e,T,s,i)):i.push(r,o)},lC=function(e){const t=[],s=e.length;return S(this,be,Qp).call(this,e,0,s,t),t.push(e[s-2],e[s-1]),t.length<=4?null:t},cC=function(e,t,s,i,r,o){const a=new Float32Array(o**2),c=-2*i**2,u=o>>1;for(let g=0;g<o;g++){const A=(g-u)**2;for(let v=0;v<o;v++)a[g*o+v]=Math.exp((A+(v-u)**2)/c)}const d=new Float32Array(256),h=-2*r**2;for(let g=0;g<256;g++)d[g]=Math.exp(g**2/h);const f=e.length,p=new Uint8Array(f),y=new Uint32Array(256);for(let g=0;g<s;g++)for(let A=0;A<t;A++){const v=g*t+A,w=e[v];let b=0,E=0;for(let T=0;T<o;T++){const k=g+T-u;if(!(k<0||k>=s))for(let R=0;R<o;R++){const M=A+R-u;if(M<0||M>=t)continue;const L=e[k*t+M],N=a[T*o+R]*d[Math.abs(L-w)];b+=L*N,E+=N}}const C=p[v]=Math.round(b/E);y[C]++}return[p,y]},uC=function(e){const t=new Uint32Array(256);for(const s of e)t[s]++;return t},k0=function(e){const t=e.length,s=new Uint8ClampedArray(t>>2);let i=-1/0,r=1/0;for(let a=0,c=s.length;a<c;a++){if(e[(a<<2)+3]===0){i=s[a]=255;continue}const d=s[a]=e[a<<2];d>i&&(i=d),d<r&&(r=d)}const o=255/(i-r);for(let a=0;a<t;a++)s[a]=(s[a]-r)*o;return s},T0=function(e){let t,s=-1/0,i=-1/0;const r=e.findIndex(c=>c!==0);let o=r,a=r;for(t=r;t<256;t++){const c=e[t];c>s&&(t-o>i&&(i=t-o,a=t-1),s=c,o=t)}for(t=a-1;t>=0&&!(e[t]>e[t+1]);t--);return t},dC=function(e){const t=e,{width:s,height:i}=e,{maxDim:r}=l(this,nl);let o=s,a=i;if(s>r||i>r){let f=s,p=i,y=Math.log2(Math.max(s,i)/r);const g=Math.floor(y);y=y===g?g-1:g;for(let v=0;v<y;v++){o=Math.ceil(f/2),a=Math.ceil(p/2);const w=new OffscreenCanvas(o,a);w.getContext("2d").drawImage(e,0,0,f,p,0,0,o,a),f=o,p=a,e!==t&&e.close(),e=w.transferToImageBitmap()}const A=Math.min(r/o,r/a);o=Math.round(o*A),a=Math.round(a*A)}const u=new OffscreenCanvas(o,a).getContext("2d",{willReadFrequently:!0});u.filter="grayscale(1)",u.drawImage(e,0,0,e.width,e.height,0,0,o,a);const d=u.getImageData(0,0,o,a).data;return[S(this,be,k0).call(this,d),o,a]},x(Ei,be),x(Ei,nl,{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}),x(Ei,zs,new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]));class tb extends eC{constructor(){super(),super.updateProperties({fill:Me._defaultLineColor,"stroke-width":0})}clone(){const e=new tb;return e.updateAll(this),e}}class nb extends Lm{constructor(e){super(e),super.updateProperties({stroke:Me._defaultLineColor,"stroke-width":1})}clone(){const e=new nb(this._viewParameters);return e.updateAll(this),e}}var go,Vn,mo,yo;const Nn=class Nn extends Og{constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"});x(this,go,!1);x(this,Vn,null);x(this,mo,null);x(this,yo,null);this._willKeepAspectRatio=!0,m(this,mo,t.signatureData||null),m(this,Vn,null),this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,s){Me.initialize(t,s),this._defaultDrawingOptions=new tb,this._defaultDrawnSignatureOptions=new nb(s.viewParameters)}static getDefaultDrawingOptions(t){const s=this._defaultDrawingOptions.clone();return s.updateProperties(t),s}static get supportMultipleDrawings(){return!1}static get typesMap(){return le(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!l(this,Vn)}}static computeTelemetryFinalData(t){const s=t.get("hasDescription");return{hasAltText:s.get(!0)??0,hasNoAltText:s.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,s;const{_isCopy:i}=this;if(i&&(this._isCopy=!1,t=this.x,s=this.y),super.render(),this._drawId===null)if(l(this,mo)){const{lines:r,mustSmooth:o,areContours:a,description:c,uuid:u,heightInPage:d}=l(this,mo),{rawDims:{pageWidth:h,pageHeight:f},rotation:p}=this.parent.viewport,y=Ei.processDrawnLines({lines:r,pageWidth:h,pageHeight:f,rotation:p,innerMargin:Nn._INNER_MARGIN,mustSmooth:o,areContours:a});this.addSignature(y,d,c,u)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);return i&&(this._isCopy=!0,this._moveAfterPaste(t,s)),this.div}setUuid(t){m(this,yo,t),this.addEditToolbar()}getUuid(){return l(this,yo)}get description(){return l(this,Vn)}set description(t){m(this,Vn,t),super.addEditToolbar().then(s=>{s==null||s.updateEditSignatureButton(t)})}getSignaturePreview(){const{newCurves:t,areContours:s,thickness:i,width:r,height:o}=l(this,mo),a=Math.max(r,o),c=Ei.processDrawnLines({lines:{curves:t.map(u=>({points:u})),thickness:i,width:r,height:o},pageWidth:a,pageHeight:a,rotation:0,innerMargin:0,mustSmooth:!1,areContours:s});return{areContours:s,outline:c.outline}}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.signatureManager&&l(this,Vn)!==null&&(await t.addEditSignatureButton(this._uiManager.signatureManager,l(this,yo),l(this,Vn)),t.show()),t):null}addSignature(t,s,i,r){const{x:o,y:a}=this,{outline:c}=m(this,mo,t);m(this,go,c instanceof E0),m(this,Vn,i),this.div.setAttribute("data-l10n-args",JSON.stringify({description:i}));let u;l(this,go)?u=Nn.getDefaultDrawingOptions():(u=Nn._defaultDrawnSignatureOptions.clone(),u.updateProperties({"stroke-width":c.thickness})),this._addOutlines({drawOutlines:c,drawingOptions:u});const[d,h]=this.parentDimensions,[,f]=this.pageDimensions;let p=s/f;p=p>=1?.5:p,this.width*=p/this.height,this.width>=1&&(p*=.9/this.width,this.width=.9),this.height=p,this.setDims(d*this.width,h*this.height),this.x=o,this.y=a,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(r),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!r,hasDescription:!!i}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:s,pageHeight:i},rotation:r}=this.parent.viewport;return Ei.process(t,s,i,r,Nn._INNER_MARGIN)}getFromText(t,s){const{rawDims:{pageWidth:i,pageHeight:r},rotation:o}=this.parent.viewport;return Ei.extractContoursFromText(t,s,i,r,o,Nn._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:s,pageHeight:i},rotation:r}=this.parent.viewport;return Ei.processDrawnLines({lines:t,pageWidth:s,pageHeight:i,rotation:r,innerMargin:Nn._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:s}){t?this._drawingOptions=Nn.getDefaultDrawingOptions():(this._drawingOptions=Nn._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":s}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:s,points:i,rect:r}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":o}}=this,a={annotationType:te.SIGNATURE,isSignature:!0,areContours:l(this,go),color:[0,0,0],thickness:l(this,go)?0:o,pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?(a.paths={lines:s,points:i},a.uuid=l(this,yo),a.isCopy=!0):a.lines=s,l(this,Vn)&&(a.accessibilityData={type:"Figure",alt:l(this,Vn)}),a}static deserializeDraw(t,s,i,r,o,a){return a.areContours?E0.deserialize(t,s,i,r,o,a):$f.deserialize(t,s,i,r,o,a)}static async deserialize(t,s,i){var o;const r=await super.deserialize(t,s,i);return m(r,go,t.areContours),m(r,Vn,((o=t.accessibilityData)==null?void 0:o.alt)||""),m(r,yo,t.uuid),r}};go=new WeakMap,Vn=new WeakMap,mo=new WeakMap,yo=new WeakMap,F(Nn,"_type","signature"),F(Nn,"_editorType",te.SIGNATURE),F(Nn,"_defaultDrawingOptions",null);let P0=Nn;var je,xt,vo,ur,wo,ou,dr,sl,bi,Gn,au,ve,cd,ud,Jp,Zp,eg,L0,tg,hC;class R0 extends Me{constructor(t){super({...t,name:"stampEditor"});x(this,ve);x(this,je,null);x(this,xt,null);x(this,vo,null);x(this,ur,null);x(this,wo,null);x(this,ou,"");x(this,dr,null);x(this,sl,!1);x(this,bi,null);x(this,Gn,!1);x(this,au,!1);m(this,ur,t.bitmapUrl),m(this,wo,t.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,s){Me.initialize(t,s)}static isHandlingMimeForPasting(t){return Ng.includes(t)}static paste(t,s){s.pasteEditor({mode:te.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const s=t.get("hasAltText");return{hasAltText:s.get(!0)??0,hasNoAltText:s.get(!1)??0}}async mlGuessAltText(t=null,s=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:o,height:a}=t||this.copyCanvas(null,null,!0).imageData,c=await i.guess({name:"altText",request:{data:r,width:o,height:a,channels:r.length/(o*a)}});if(!c)throw new Error("No response from the AI service.");if(c.error)throw new Error("Error from the AI service.");if(c.cancel)return null;if(!c.output)throw new Error("No valid response from the AI service.");const u=c.output;return await this.setGuessedAltText(u),s&&!this.hasAltTextData()&&(this.altTextData={alt:u,decorative:!1}),u}remove(){var t;l(this,xt)&&(m(this,je,null),this._uiManager.imageManager.deleteId(l(this,xt)),(t=l(this,dr))==null||t.remove(),m(this,dr,null),l(this,bi)&&(clearTimeout(l(this,bi)),m(this,bi,null))),super.remove()}rebuild(){if(!this.parent){l(this,xt)&&S(this,ve,Jp).call(this);return}super.rebuild(),this.div!==null&&(l(this,xt)&&l(this,dr)===null&&S(this,ve,Jp).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(l(this,vo)||l(this,je)||l(this,ur)||l(this,wo)||l(this,xt)||l(this,sl))}get isResizable(){return!0}render(){if(this.div)return this.div;let t,s;return this._isCopy&&(t=this.x,s=this.y),super.render(),this.div.hidden=!0,this.addAltTextButton(),l(this,sl)||(l(this,je)?S(this,ve,Zp).call(this):S(this,ve,Jp).call(this)),this._isCopy&&this._moveAfterPaste(t,s),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,s){const{id:i,bitmap:r}=this._uiManager.imageManager.getFromCanvas(t,s);s.remove(),i&&this._uiManager.imageManager.isValidId(i)&&(m(this,xt,i),r&&m(this,je,r),m(this,sl,!1),S(this,ve,Zp).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;l(this,bi)!==null&&clearTimeout(l(this,bi)),m(this,bi,setTimeout(()=>{m(this,bi,null),S(this,ve,L0).call(this)},200))}copyCanvas(t,s,i=!1){var p;t||(t=224);const{width:r,height:o}=l(this,je),a=new Ys;let c=l(this,je),u=r,d=o,h=null;if(s){if(r>s||o>s){const R=Math.min(s/r,s/o);u=Math.floor(r*R),d=Math.floor(o*R)}h=document.createElement("canvas");const y=h.width=Math.ceil(u*a.sx),g=h.height=Math.ceil(d*a.sy);l(this,Gn)||(c=S(this,ve,eg).call(this,y,g));const A=h.getContext("2d");A.filter=this._uiManager.hcmFilter;let v="white",w="#cfcfd8";this._uiManager.hcmFilter!=="none"?w="black":(p=window.matchMedia)!=null&&p.call(window,"(prefers-color-scheme: dark)").matches&&(v="#8f8f9d",w="#42414d");const b=15,E=b*a.sx,C=b*a.sy,T=new OffscreenCanvas(E*2,C*2),k=T.getContext("2d");k.fillStyle=v,k.fillRect(0,0,E*2,C*2),k.fillStyle=w,k.fillRect(0,0,E,C),k.fillRect(E,C,E,C),A.fillStyle=A.createPattern(T,"repeat"),A.fillRect(0,0,y,g),A.drawImage(c,0,0,c.width,c.height,0,0,y,g)}let f=null;if(i){let y,g;if(a.symmetric&&c.width<t&&c.height<t)y=c.width,g=c.height;else if(c=l(this,je),r>t||o>t){const w=Math.min(t/r,t/o);y=Math.floor(r*w),g=Math.floor(o*w),l(this,Gn)||(c=S(this,ve,eg).call(this,y,g))}const v=new OffscreenCanvas(y,g).getContext("2d",{willReadFrequently:!0});v.drawImage(c,0,0,c.width,c.height,0,0,y,g),f={width:y,height:g,data:v.getImageData(0,0,y,g).data}}return{canvas:h,width:u,height:d,imageData:f}}static async deserialize(t,s,i){var A;let r=null,o=!1;if(t instanceof k_){const{data:{rect:v,rotation:w,id:b,structParent:E,popupRef:C},container:T,parent:{page:{pageNumber:k}},canvas:R}=t;let M,L;R?(delete t.canvas,{id:M,bitmap:L}=i.imageManager.getFromCanvas(T.id,R),R.remove()):(o=!0,t._hasNoCanvas=!0);const N=((A=await s._structTree.getAriaAttributes(`${Gw}${b}`))==null?void 0:A.get("aria-label"))||"";r=t={annotationType:te.STAMP,bitmapId:M,bitmap:L,pageIndex:k-1,rect:v.slice(0),rotation:w,id:b,deleted:!1,accessibilityData:{decorative:!1,altText:N},isSvg:!1,structParent:E,popupRef:C}}const a=await super.deserialize(t,s,i),{rect:c,bitmap:u,bitmapUrl:d,bitmapId:h,isSvg:f,accessibilityData:p}=t;o?(i.addMissingCanvas(t.id,a),m(a,sl,!0)):h&&i.imageManager.isValidId(h)?(m(a,xt,h),u&&m(a,je,u)):m(a,ur,d),m(a,Gn,f);const[y,g]=a.pageDimensions;return a.width=(c[2]-c[0])/y,a.height=(c[3]-c[1])/g,a.annotationElementId=t.id||null,p&&(a.altTextData=p),a._initialData=r,m(a,au,!!r),a}serialize(t=!1,s=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i={annotationType:te.STAMP,bitmapId:l(this,xt),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:l(this,Gn),structTreeParentId:this._structTreeParentId};if(t)return i.bitmapUrl=S(this,ve,tg).call(this,!0),i.accessibilityData=this.serializeAltText(!0),i.isCopy=!0,i;const{decorative:r,altText:o}=this.serializeAltText(!1);if(!r&&o&&(i.accessibilityData={type:"Figure",alt:o}),this.annotationElementId){const c=S(this,ve,hC).call(this,i);if(c.isSame)return null;c.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1}if(i.id=this.annotationElementId,s===null)return i;s.stamps||(s.stamps=new Map);const a=l(this,Gn)?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!s.stamps.has(l(this,xt)))s.stamps.set(l(this,xt),{area:a,serialized:i}),i.bitmap=S(this,ve,tg).call(this,!1);else if(l(this,Gn)){const c=s.stamps.get(l(this,xt));a>c.area&&(c.area=a,c.serialized.bitmap.close(),c.serialized.bitmap=S(this,ve,tg).call(this,!1))}return i}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}}je=new WeakMap,xt=new WeakMap,vo=new WeakMap,ur=new WeakMap,wo=new WeakMap,ou=new WeakMap,dr=new WeakMap,sl=new WeakMap,bi=new WeakMap,Gn=new WeakMap,au=new WeakMap,ve=new WeakSet,cd=function(t,s=!1){if(!t){this.remove();return}m(this,je,t.bitmap),s||(m(this,xt,t.id),m(this,Gn,t.isSvg)),t.file&&m(this,ou,t.file.name),S(this,ve,Zp).call(this)},ud=function(){if(m(this,vo,null),this._uiManager.enableWaiting(!1),!!l(this,dr)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&l(this,je)){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&l(this,je)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},Jp=function(){if(l(this,xt)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(l(this,xt)).then(i=>S(this,ve,cd).call(this,i,!0)).finally(()=>S(this,ve,ud).call(this));return}if(l(this,ur)){const i=l(this,ur);m(this,ur,null),this._uiManager.enableWaiting(!0),m(this,vo,this._uiManager.imageManager.getFromUrl(i).then(r=>S(this,ve,cd).call(this,r)).finally(()=>S(this,ve,ud).call(this)));return}if(l(this,wo)){const i=l(this,wo);m(this,wo,null),this._uiManager.enableWaiting(!0),m(this,vo,this._uiManager.imageManager.getFromFile(i).then(r=>S(this,ve,cd).call(this,r)).finally(()=>S(this,ve,ud).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=Ng.join(",");const s=this._uiManager._signal;m(this,vo,new Promise(i=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),S(this,ve,cd).call(this,r)}i()},{signal:s}),t.addEventListener("cancel",()=>{this.remove(),i()},{signal:s})}).finally(()=>S(this,ve,ud).call(this))),t.click()},Zp=function(){var h;const{div:t}=this;let{width:s,height:i}=l(this,je);const[r,o]=this.pageDimensions,a=.75;if(this.width)s=this.width*r,i=this.height*o;else if(s>a*r||i>a*o){const f=Math.min(a*r/s,a*o/i);s*=f,i*=f}const[c,u]=this.parentDimensions;this.setDims(s*c/r,i*u/o),this._uiManager.enableWaiting(!1);const d=m(this,dr,document.createElement("canvas"));d.setAttribute("role","img"),this.addContainer(d),this.width=s/r,this.height=i/o,(h=this._initialOptions)!=null&&h.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),S(this,ve,L0).call(this),l(this,au)||(this.parent.addUndoableEditor(this),m(this,au,!0)),this._reportTelemetry({action:"inserted_image"}),l(this,ou)&&this.div.setAttribute("aria-description",l(this,ou))},eg=function(t,s){const{width:i,height:r}=l(this,je);let o=i,a=r,c=l(this,je);for(;o>2*t||a>2*s;){const u=o,d=a;o>2*t&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2)),a>2*s&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2));const h=new OffscreenCanvas(o,a);h.getContext("2d").drawImage(c,0,0,u,d,0,0,o,a),c=h.transferToImageBitmap()}return c},L0=function(){const[t,s]=this.parentDimensions,{width:i,height:r}=this,o=new Ys,a=Math.ceil(i*t*o.sx),c=Math.ceil(r*s*o.sy),u=l(this,dr);if(!u||u.width===a&&u.height===c)return;u.width=a,u.height=c;const d=l(this,Gn)?l(this,je):S(this,ve,eg).call(this,a,c),h=u.getContext("2d");h.filter=this._uiManager.hcmFilter,h.drawImage(d,0,0,d.width,d.height,0,0,a,c)},tg=function(t){if(t){if(l(this,Gn)){const r=this._uiManager.imageManager.getSvgUrl(l(this,xt));if(r)return r}const s=document.createElement("canvas");return{width:s.width,height:s.height}=l(this,je),s.getContext("2d").drawImage(l(this,je),0,0),s.toDataURL()}if(l(this,Gn)){const[s,i]=this.pageDimensions,r=Math.round(this.width*s*_r.PDF_TO_CSS_UNITS),o=Math.round(this.height*i*_r.PDF_TO_CSS_UNITS),a=new OffscreenCanvas(r,o);return a.getContext("2d").drawImage(l(this,je),0,0,l(this,je).width,l(this,je).height,0,0,r,o),a.transferToImageBitmap()}return structuredClone(l(this,je))},hC=function(t){var a;const{pageIndex:s,accessibilityData:{altText:i}}=this._initialData,r=t.pageIndex===s,o=(((a=t.accessibilityData)==null?void 0:a.alt)||"")===i;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&r&&o,isSameAltText:o}},F(R0,"_type","stamp"),F(R0,"_editorType",te.STAMP);var il,lu,xi,bo,hr,ds,xo,cu,rl,$s,fr,Xt,pr,Y,So,ze,fC,ii,N0,M0,ng;const ks=class ks{constructor({uiManager:e,pageIndex:t,div:s,structTreeLayer:i,accessibilityManager:r,annotationLayer:o,drawLayer:a,textLayer:c,viewport:u,l10n:d}){x(this,ze);x(this,il);x(this,lu,!1);x(this,xi,null);x(this,bo,null);x(this,hr,null);x(this,ds,new Map);x(this,xo,!1);x(this,cu,!1);x(this,rl,!1);x(this,$s,null);x(this,fr,null);x(this,Xt,null);x(this,pr,null);x(this,Y);const h=[...l(ks,So).values()];if(!ks._initialized){ks._initialized=!0;for(const f of h)f.initialize(d,e)}e.registerEditorTypes(h),m(this,Y,e),this.pageIndex=t,this.div=s,m(this,il,r),m(this,xi,o),this.viewport=u,m(this,Xt,c),this.drawLayer=a,this._structTree=i,l(this,Y).addLayer(this)}get isEmpty(){return l(this,ds).size===0}get isInvisible(){return this.isEmpty&&l(this,Y).getMode()===te.NONE}updateToolbar(e){l(this,Y).updateToolbar(e)}updateMode(e=l(this,Y).getMode()){switch(S(this,ze,ng).call(this),e){case te.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case te.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case te.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const s of l(ks,So).values())t.toggle(`${s._type}Editing`,e===s._editorType);this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=l(this,Xt))==null?void 0:t.div)}setEditingState(e){l(this,Y).setEditingState(e)}addCommands(e){l(this,Y).addCommands(e)}cleanUndoStack(e){l(this,Y).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=l(this,xi))==null||t.div.classList.toggle("disabled",!e)}async enable(){m(this,rl,!0),this.div.tabIndex=0,this.togglePointerEvents(!0);const e=new Set;for(const s of l(this,ds).values())s.enableEditing(),s.show(!0),s.annotationElementId&&(l(this,Y).removeChangedExistingAnnotation(s),e.add(s.annotationElementId));if(!l(this,xi)){m(this,rl,!1);return}const t=l(this,xi).getEditableAnnotations();for(const s of t){if(s.hide(),l(this,Y).isDeletedAnnotationElement(s.data.id)||e.has(s.data.id))continue;const i=await this.deserialize(s);i&&(this.addOrRebuild(i),i.enableEditing())}m(this,rl,!1)}disable(){var i;m(this,cu,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const e=new Map,t=new Map;for(const r of l(this,ds).values())if(r.disableEditing(),!!r.annotationElementId){if(r.serialize()!==null){e.set(r.annotationElementId,r);continue}else t.set(r.annotationElementId,r);(i=this.getEditableAnnotation(r.annotationElementId))==null||i.show(),r.remove()}if(l(this,xi)){const r=l(this,xi).getEditableAnnotations();for(const o of r){const{id:a}=o.data;if(l(this,Y).isDeletedAnnotationElement(a))continue;let c=t.get(a);if(c){c.resetAnnotationElement(o),c.show(!1),o.show();continue}c=e.get(a),c&&(l(this,Y).addChangedExistingAnnotation(c),c.renderAnnotationElement(o)&&c.show(!1)),o.show()}}S(this,ze,ng).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:s}=this.div;for(const r of l(ks,So).values())s.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),m(this,cu,!1)}getEditableAnnotation(e){var t;return((t=l(this,xi))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){l(this,Y).getActive()!==e&&l(this,Y).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=l(this,Xt))!=null&&e.div&&!l(this,pr)){m(this,pr,new AbortController);const t=l(this,Y).combinedSignal(l(this,pr));l(this,Xt).div.addEventListener("pointerdown",S(this,ze,fC).bind(this),{signal:t}),l(this,Xt).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=l(this,Xt))!=null&&e.div&&l(this,pr)&&(l(this,pr).abort(),m(this,pr,null),l(this,Xt).div.classList.remove("highlighting"))}enableClick(){if(l(this,bo))return;m(this,bo,new AbortController);const e=l(this,Y).combinedSignal(l(this,bo));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;(e=l(this,bo))==null||e.abort(),m(this,bo,null)}attach(e){l(this,ds).set(e.id,e);const{annotationElementId:t}=e;t&&l(this,Y).isDeletedAnnotationElement(t)&&l(this,Y).removeDeletedAnnotationElement(e)}detach(e){var t;l(this,ds).delete(e.id),(t=l(this,il))==null||t.removePointerInTextLayer(e.contentDiv),!l(this,cu)&&e.annotationElementId&&l(this,Y).addDeletedAnnotationElement(e)}remove(e){this.detach(e),l(this,Y).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(l(this,Y).addDeletedAnnotationElement(e.annotationElementId),Me.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),l(this,Y).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!l(this,rl)),l(this,Y).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var s;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!l(this,hr)&&(e._focusEventsAllowed=!1,m(this,hr,setTimeout(()=>{m(this,hr,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:l(this,Y)._signal}),t.focus())},0))),e._structTreeParentId=(s=l(this,il))==null?void 0:s.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),s=()=>{e.remove()};this.addCommands({cmd:t,undo:s,mustExec:!1})}getNextId(){return l(this,Y).getId()}combinedSignal(e){return l(this,Y).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=l(this,ze,ii))==null?void 0:e.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await l(this,Y).updateMode(e.mode);const{offsetX:s,offsetY:i}=S(this,ze,M0).call(this),r=this.getNextId(),o=S(this,ze,N0).call(this,{parent:this,id:r,x:s,y:i,uiManager:l(this,Y),isCentered:!0,...t});o&&this.add(o)}async deserialize(e){var t;return await((t=l(ks,So).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,l(this,Y)))||null}createAndAddNewEditor(e,t,s={}){const i=this.getNextId(),r=S(this,ze,N0).call(this,{parent:this,id:i,x:e.offsetX,y:e.offsetY,uiManager:l(this,Y),isCentered:t,...s});return r&&this.add(r),r}addNewEditor(e={}){this.createAndAddNewEditor(S(this,ze,M0).call(this),!0,e)}setSelected(e){l(this,Y).setSelected(e)}toggleSelected(e){l(this,Y).toggleSelected(e)}unselect(e){l(this,Y).unselect(e)}pointerup(e){var i;const{isMac:t}=_t.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!l(this,xo)||(m(this,xo,!1),(i=l(this,ze,ii))!=null&&i.isDrawer&&l(this,ze,ii).supportMultipleDrawings))return;if(!l(this,lu)){m(this,lu,!0);return}const s=l(this,Y).getMode();if(s===te.STAMP||s===te.SIGNATURE){l(this,Y).unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){var i;if(l(this,Y).getMode()===te.HIGHLIGHT&&this.enableTextSelection(),l(this,xo)){m(this,xo,!1);return}const{isMac:t}=_t.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(m(this,xo,!0),(i=l(this,ze,ii))!=null&&i.isDrawer){this.startDrawingSession(e);return}const s=l(this,Y).getActive();m(this,lu,!s||s.isEmpty())}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),l(this,$s)){l(this,ze,ii).startDrawing(this,l(this,Y),!1,e);return}l(this,Y).setCurrentDrawingSession(this),m(this,$s,new AbortController);const t=l(this,Y).combinedSignal(l(this,$s));this.div.addEventListener("blur",({relatedTarget:s})=>{s&&!this.div.contains(s)&&(m(this,fr,null),this.commitOrRemove())},{signal:t}),l(this,ze,ii).startDrawing(this,l(this,Y),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&m(this,fr,t);return}l(this,fr)&&setTimeout(()=>{var t;(t=l(this,fr))==null||t.focus(),m(this,fr,null)},0)}endDrawingSession(e=!1){return l(this,$s)?(l(this,Y).setCurrentDrawingSession(null),l(this,$s).abort(),m(this,$s,null),m(this,fr,null),l(this,ze,ii).endDrawing(e)):null}findNewParent(e,t,s){const i=l(this,Y).findParent(t,s);return i===null||i===this?!1:(i.changeParent(e),!0)}commitOrRemove(){return l(this,$s)?(this.endDrawingSession(),!0):!1}onScaleChanging(){l(this,$s)&&l(this,ze,ii).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=l(this,Y).getActive())==null?void 0:e.parent)===this&&(l(this,Y).commitOrRemove(),l(this,Y).setActiveEditor(null)),l(this,hr)&&(clearTimeout(l(this,hr)),m(this,hr,null));for(const s of l(this,ds).values())(t=l(this,il))==null||t.removePointerInTextLayer(s.contentDiv),s.setParent(null),s.isAttachedToDOM=!1,s.div.remove();this.div=null,l(this,ds).clear(),l(this,Y).removeLayer(this)}render({viewport:e}){this.viewport=e,Oo(this.div,e);for(const t of l(this,Y).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){l(this,Y).commitOrRemove(),S(this,ze,ng).call(this);const t=this.viewport.rotation,s=e.rotation;if(this.viewport=e,Oo(this.div,{rotation:s}),t!==s)for(const i of l(this,ds).values())i.rotate(s)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return l(this,Y).viewParameters.realScale}};il=new WeakMap,lu=new WeakMap,xi=new WeakMap,bo=new WeakMap,hr=new WeakMap,ds=new WeakMap,xo=new WeakMap,cu=new WeakMap,rl=new WeakMap,$s=new WeakMap,fr=new WeakMap,Xt=new WeakMap,pr=new WeakMap,Y=new WeakMap,So=new WeakMap,ze=new WeakSet,fC=function(e){l(this,Y).unselectAll();const{target:t}=e;if(t===l(this,Xt).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&l(this,Xt).div.contains(t)){const{isMac:s}=_t.platform;if(e.button!==0||e.ctrlKey&&s)return;l(this,Y).showAllEditors("highlight",!0,!0),l(this,Xt).div.classList.add("free"),this.toggleDrawing(),Ig.startHighlighting(this,l(this,Y).direction==="ltr",{target:l(this,Xt).div,x:e.x,y:e.y}),l(this,Xt).div.addEventListener("pointerup",()=>{l(this,Xt).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:l(this,Y)._signal}),e.preventDefault()}},ii=function(){return l(ks,So).get(l(this,Y).getMode())},N0=function(e){const t=l(this,ze,ii);return t?new t.prototype.constructor(e):null},M0=function(){const{x:e,y:t,width:s,height:i}=this.div.getBoundingClientRect(),r=Math.max(0,e),o=Math.max(0,t),a=Math.min(window.innerWidth,e+s),c=Math.min(window.innerHeight,t+i),u=(r+a)/2-e,d=(o+c)/2-t,[h,f]=this.viewport.rotation%180===0?[u,d]:[d,u];return{offsetX:h,offsetY:f}},ng=function(){for(const e of l(this,ds).values())e.isEmpty()&&e.remove()},F(ks,"_initialized",!1),x(ks,So,new Map([u0,A0,R0,Ig,P0].map(e=>[e._editorType,e])));let Fg=ks;var Bs,sn,ol,Ef,sm,pC,Ti,D0,gC,I0;const lt=class lt{constructor({pageIndex:e}){x(this,Ti);x(this,Bs,null);x(this,sn,new Map);x(this,ol,new Map);this.pageIndex=e}setParent(e){if(!l(this,Bs)){m(this,Bs,e);return}if(l(this,Bs)!==e){if(l(this,sn).size>0)for(const t of l(this,sn).values())t.remove(),e.append(t);m(this,Bs,e)}}static get _svgFactory(){return le(this,"_svgFactory",new Yd)}draw(e,t=!1,s=!1){const i=Jt(lt,Ef)._++,r=S(this,Ti,D0).call(this),o=lt._svgFactory.createElement("defs");r.append(o);const a=lt._svgFactory.createElement("path");o.append(a);const c=`path_p${this.pageIndex}_${i}`;a.setAttribute("id",c),a.setAttribute("vector-effect","non-scaling-stroke"),t&&l(this,ol).set(i,a);const u=s?S(this,Ti,gC).call(this,o,c):null,d=lt._svgFactory.createElement("use");return r.append(d),d.setAttribute("href",`#${c}`),this.updateProperties(r,e),l(this,sn).set(i,r),{id:i,clipPathId:`url(#${u})`}}drawOutline(e,t){const s=Jt(lt,Ef)._++,i=S(this,Ti,D0).call(this),r=lt._svgFactory.createElement("defs");i.append(r);const o=lt._svgFactory.createElement("path");r.append(o);const a=`path_p${this.pageIndex}_${s}`;o.setAttribute("id",a),o.setAttribute("vector-effect","non-scaling-stroke");let c;if(t){const h=lt._svgFactory.createElement("mask");r.append(h),c=`mask_p${this.pageIndex}_${s}`,h.setAttribute("id",c),h.setAttribute("maskUnits","objectBoundingBox");const f=lt._svgFactory.createElement("rect");h.append(f),f.setAttribute("width","1"),f.setAttribute("height","1"),f.setAttribute("fill","white");const p=lt._svgFactory.createElement("use");h.append(p),p.setAttribute("href",`#${a}`),p.setAttribute("stroke","none"),p.setAttribute("fill","black"),p.setAttribute("fill-rule","nonzero"),p.classList.add("mask")}const u=lt._svgFactory.createElement("use");i.append(u),u.setAttribute("href",`#${a}`),c&&u.setAttribute("mask",`url(#${c})`);const d=u.cloneNode();return i.append(d),u.classList.add("mainOutline"),d.classList.add("secondaryOutline"),this.updateProperties(i,e),l(this,sn).set(s,i),s}finalizeDraw(e,t){l(this,ol).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var c;if(!t)return;const{root:s,bbox:i,rootClass:r,path:o}=t,a=typeof e=="number"?l(this,sn).get(e):e;if(a){if(s&&S(this,Ti,I0).call(this,a,s),i&&S(c=lt,sm,pC).call(c,a,i),r){const{classList:u}=a;for(const[d,h]of Object.entries(r))u.toggle(d,h)}if(o){const d=a.firstChild.firstChild;S(this,Ti,I0).call(this,d,o)}}}updateParent(e,t){if(t===this)return;const s=l(this,sn).get(e);s&&(l(t,Bs).append(s),l(this,sn).delete(e),l(t,sn).set(e,s))}remove(e){l(this,ol).delete(e),l(this,Bs)!==null&&(l(this,sn).get(e).remove(),l(this,sn).delete(e))}destroy(){m(this,Bs,null);for(const e of l(this,sn).values())e.remove();l(this,sn).clear(),l(this,ol).clear()}};Bs=new WeakMap,sn=new WeakMap,ol=new WeakMap,Ef=new WeakMap,sm=new WeakSet,pC=function(e,[t,s,i,r]){const{style:o}=e;o.top=`${100*s}%`,o.left=`${100*t}%`,o.width=`${100*i}%`,o.height=`${100*r}%`},Ti=new WeakSet,D0=function(){const e=lt._svgFactory.create(1,1,!0);return l(this,Bs).append(e),e.setAttribute("aria-hidden",!0),e},gC=function(e,t){const s=lt._svgFactory.createElement("clipPath");e.append(s);const i=`clip_${t}`;s.setAttribute("id",i),s.setAttribute("clipPathUnits","objectBoundingBox");const r=lt._svgFactory.createElement("use");return s.append(r),r.setAttribute("href",`#${t}`),r.classList.add("clip"),i},I0=function(e,t){for(const[s,i]of Object.entries(t))i===null?e.removeAttribute(s):e.setAttribute(s,i)},x(lt,sm),x(lt,Ef,0);let jg=lt;globalThis._pdfjsTestingUtils={HighlightOutliner:h0};globalThis.pdfjsLib={AbortException:Er,AnnotationEditorLayer:Fg,AnnotationEditorParamsType:he,AnnotationEditorType:te,AnnotationEditorUIManager:Fo,AnnotationLayer:eb,AnnotationMode:Ai,AnnotationType:Qe,build:g_,ColorPicker:Kd,createValidAbsoluteUrl:Hw,DOMSVGFactory:Yd,DrawLayer:jg,FeatureTest:_t,fetchData:_u,getDocument:Kw,getFilenameFromUrl:lE,getPdfFilenameFromUrl:cE,getUuid:Vw,getXfaPageViewport:uE,GlobalWorkerOptions:gs,ImageKind:Ad,InvalidPDFException:Lg,isDataScheme:Of,isPdfFile:Tm,isValidExplicitDest:GE,MathClamp:qt,noContextMenu:Ss,normalizeUnicode:oE,OPS:Vd,OutputScale:Ys,PasswordResponses:iE,PDFDataRangeTransport:Qw,PDFDateString:Pm,PDFWorker:vu,PermissionFlag:sE,PixelsPerInch:_r,RenderingCancelledException:km,ResponseException:Gd,setLayerDimensions:Oo,shadow:le,SignatureExtractor:Ei,stopEvent:et,SupportedImageMimeTypes:Ng,TextLayer:Xd,TouchManager:Wd,updateUrlHash:Uw,Util:Q,VerbosityLevel:Mf,version:p_,XfaLayer:Jw};const WN=Object.freeze(Object.defineProperty({__proto__:null,AbortException:Er,AnnotationEditorLayer:Fg,AnnotationEditorParamsType:he,AnnotationEditorType:te,AnnotationEditorUIManager:Fo,AnnotationLayer:eb,AnnotationMode:Ai,AnnotationType:Qe,ColorPicker:Kd,DOMSVGFactory:Yd,DrawLayer:jg,FeatureTest:_t,GlobalWorkerOptions:gs,ImageKind:Ad,InvalidPDFException:Lg,MathClamp:qt,OPS:Vd,OutputScale:Ys,PDFDataRangeTransport:Qw,PDFDateString:Pm,PDFWorker:vu,PasswordResponses:iE,PermissionFlag:sE,PixelsPerInch:_r,RenderingCancelledException:km,ResponseException:Gd,SignatureExtractor:Ei,SupportedImageMimeTypes:Ng,TextLayer:Xd,TouchManager:Wd,Util:Q,VerbosityLevel:Mf,XfaLayer:Jw,build:g_,createValidAbsoluteUrl:Hw,fetchData:_u,getDocument:Kw,getFilenameFromUrl:lE,getPdfFilenameFromUrl:cE,getUuid:Vw,getXfaPageViewport:uE,isDataScheme:Of,isPdfFile:Tm,isValidExplicitDest:GE,noContextMenu:Ss,normalizeUnicode:oE,setLayerDimensions:Oo,shadow:le,stopEvent:et,updateUrlHash:Uw,version:p_},Symbol.toStringTag,{value:"Module"})),XN=["onCopy","onCut","onPaste"],qN=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],YN=["onFocus","onBlur"],KN=["onInput","onInvalid","onReset","onSubmit"],QN=["onLoad","onError"],JN=["onKeyDown","onKeyPress","onKeyUp"],ZN=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],eM=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],tM=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],nM=["onSelect"],sM=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],iM=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],rM=["onScroll"],oM=["onWheel"],aM=["onAnimationStart","onAnimationEnd","onAnimationIteration"],lM=["onTransitionEnd"],cM=["onToggle"],uM=["onChange"],dM=[...XN,...qN,...YN,...KN,...QN,...JN,...ZN,...eM,...tM,...nM,...sM,...iM,...rM,...oM,...aM,...lM,...uM,...cM];function mC(n,e){const t={};for(const s of dM){const i=n[s];i&&(e?t[s]=r=>i(r,e(s)):t[s]=i)}return t}function Bf(n){let e=!1;return{promise:new Promise((s,i)=>{n.then(r=>!e&&s(r)).catch(r=>!e&&i(r))}),cancel(){e=!0}}}var hM="Invariant failed";function Pe(n,e){if(!n)throw new Error(hM)}var fM=function(){},pM=fM;const Kt=j0(pM);var rS=Object.prototype.hasOwnProperty;function oS(n,e,t){for(t of n.keys())if(tc(t,e))return t}function tc(n,e){var t,s,i;if(n===e)return!0;if(n&&e&&(t=n.constructor)===e.constructor){if(t===Date)return n.getTime()===e.getTime();if(t===RegExp)return n.toString()===e.toString();if(t===Array){if((s=n.length)===e.length)for(;s--&&tc(n[s],e[s]););return s===-1}if(t===Set){if(n.size!==e.size)return!1;for(s of n)if(i=s,i&&typeof i=="object"&&(i=oS(e,i),!i)||!e.has(i))return!1;return!0}if(t===Map){if(n.size!==e.size)return!1;for(s of n)if(i=s[0],i&&typeof i=="object"&&(i=oS(e,i),!i)||!tc(s[1],e.get(i)))return!1;return!0}if(t===ArrayBuffer)n=new Uint8Array(n),e=new Uint8Array(e);else if(t===DataView){if((s=n.byteLength)===e.byteLength)for(;s--&&n.getInt8(s)===e.getInt8(s););return s===-1}if(ArrayBuffer.isView(n)){if((s=n.byteLength)===e.byteLength)for(;s--&&n[s]===e[s];);return s===-1}if(!t||typeof n=="object"){s=0;for(t in n)if(rS.call(n,t)&&++s&&!rS.call(e,t)||!(t in e)||!tc(n[t],e[t]))return!1;return Object.keys(e).length===s}}return n!==n&&e!==e}const yC=P.createContext(null);function nc({children:n,type:e}){return _.jsx("div",{className:`react-pdf__message react-pdf__message--${e}`,children:n})}const gM="noopener noreferrer nofollow";class mM{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(e){this.pdfDocument=e}setViewer(e){this.pdfViewer=e}setExternalLinkRel(e){this.externalLinkRel=e}setExternalLinkTarget(e){this.externalLinkTarget=e}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return Pe(this.pdfViewer),this.pdfViewer.currentPageNumber||0}set page(e){Pe(this.pdfViewer),this.pdfViewer.currentPageNumber=e}get rotation(){return 0}set rotation(e){}goToDestination(e){return new Promise(t=>{Pe(this.pdfDocument),Pe(e),typeof e=="string"?this.pdfDocument.getDestination(e).then(t):Array.isArray(e)?t(e):e.then(t)}).then(t=>{Pe(Array.isArray(t));const s=t[0];new Promise(i=>{Pe(this.pdfDocument),s instanceof Object?this.pdfDocument.getPageIndex(s).then(r=>{i(r)}).catch(()=>{Pe(!1)}):typeof s=="number"?i(s):Pe(!1)}).then(i=>{const r=i+1;Pe(this.pdfViewer),Pe(r>=1&&r<=this.pagesCount),this.pdfViewer.scrollPageIntoView({dest:t,pageIndex:i,pageNumber:r})})})}navigateTo(e){this.goToDestination(e)}goToPage(e){const t=e-1;Pe(this.pdfViewer),Pe(e>=1&&e<=this.pagesCount),this.pdfViewer.scrollPageIntoView({pageIndex:t,pageNumber:e})}addLinkAttributes(e,t,s){e.href=t,e.rel=this.externalLinkRel||gM,e.target=s?"_blank":this.externalLinkTarget||""}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}setHash(){}executeNamedAction(){}cachePageRef(){}isPageVisible(){return!0}isPageCached(){return!0}executeSetOCGState(){}}const aS={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},Nm=typeof window<"u",vC=Nm&&window.location.protocol==="file:";function yM(n){return typeof n<"u"}function Vo(n){return yM(n)&&n!==null}function vM(n){return typeof n=="string"}function wM(n){return n instanceof ArrayBuffer}function bM(n){return Pe(Nm),n instanceof Blob}function O0(n){return vM(n)&&/^data:/.test(n)}function lS(n){Pe(O0(n));const[e="",t=""]=n.split(",");return e.split(";").indexOf("base64")!==-1?atob(t):unescape(t)}function xM(){return Nm&&window.devicePixelRatio||1}const wC="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function cS(){Kt(!vC,`Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ${wC}`)}function SM(){Kt(!vC,`Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ${wC}`)}function gl(n){n!=null&&n.cancel&&n.cancel()}function F0(n,e){return Object.defineProperty(n,"width",{get(){return this.view[2]*e},configurable:!0}),Object.defineProperty(n,"height",{get(){return this.view[3]*e},configurable:!0}),Object.defineProperty(n,"originalWidth",{get(){return this.view[2]},configurable:!0}),Object.defineProperty(n,"originalHeight",{get(){return this.view[3]},configurable:!0}),n}function AM(n){return n.name==="RenderingCancelledException"}function EM(n){return new Promise((e,t)=>{const s=new FileReader;s.onload=()=>{if(!s.result)return t(new Error("Error while reading a file."));e(s.result)},s.onerror=i=>{if(!i.target)return t(new Error("Error while reading a file."));const{error:r}=i.target;if(!r)return t(new Error("Error while reading a file."));switch(r.code){case r.NOT_FOUND_ERR:return t(new Error("Error while reading a file: File not found."));case r.SECURITY_ERR:return t(new Error("Error while reading a file: Security error."));case r.ABORT_ERR:return t(new Error("Error while reading a file: Aborted."));default:return t(new Error("Error while reading a file."))}},s.readAsArrayBuffer(n)})}function _M(n,e){switch(e.type){case"RESOLVE":return{value:e.value,error:void 0};case"REJECT":return{value:!1,error:e.error};case"RESET":return{value:void 0,error:void 0};default:return n}}function wu(){return P.useReducer(_M,{value:void 0,error:void 0})}var uS=function(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(n);i<s.length;i++)e.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(n,s[i])&&(t[s[i]]=n[s[i]]);return t};const{PDFDataRangeTransport:CM}=WN,kM=(n,e)=>{switch(e){case aS.NEED_PASSWORD:{const t=prompt("Enter the password to open this PDF file.");n(t);break}case aS.INCORRECT_PASSWORD:{const t=prompt("Invalid password. Please try again.");n(t);break}}};function dS(n){return typeof n=="object"&&n!==null&&("data"in n||"range"in n||"url"in n)}const TM=P.forwardRef(function(e,t){var{children:s,className:i,error:r="Failed to load PDF file.",externalLinkRel:o,externalLinkTarget:a,file:c,inputRef:u,imageResourcesPath:d,loading:h="Loading PDF",noData:f="No PDF file specified.",onItemClick:p,onLoadError:y,onLoadProgress:g,onLoadSuccess:A,onPassword:v=kM,onSourceError:w,onSourceSuccess:b,options:E,renderMode:C,rotate:T,scale:k}=e,R=uS(e,["children","className","error","externalLinkRel","externalLinkTarget","file","inputRef","imageResourcesPath","loading","noData","onItemClick","onLoadError","onLoadProgress","onLoadSuccess","onPassword","onSourceError","onSourceSuccess","options","renderMode","rotate","scale"]);const[M,L]=wu(),{value:N,error:B}=M,[H,W]=wu(),{value:ee,error:j}=H,O=P.useRef(new mM),I=P.useRef([]),V=P.useRef(void 0),K=P.useRef(void 0);c&&c!==V.current&&dS(c)&&(Kt(!tc(c,V.current),`File prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "file" prop.`),V.current=c),E&&E!==K.current&&(Kt(!tc(E,K.current),`Options prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "options" prop.`),K.current=E);const re=P.useRef({scrollPageIntoView:ge=>{const{dest:Be,pageNumber:Ae,pageIndex:As=Ae-1}=ge;if(p){p({dest:Be,pageIndex:As,pageNumber:Ae});return}const Pi=I.current[As];if(Pi){Pi.scrollIntoView();return}Kt(!1,`An internal link leading to page ${Ae} was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>.`)}});P.useImperativeHandle(t,()=>({linkService:O,pages:I,viewer:re}),[]);function J(){b&&b()}function oe(){B&&(Kt(!1,B.toString()),w&&w(B))}function Re(){L({type:"RESET"})}P.useEffect(Re,[c,L]);const Xe=P.useCallback(async()=>{if(!c)return null;if(typeof c=="string")return O0(c)?{data:lS(c)}:(cS(),{url:c});if(c instanceof CM)return{range:c};if(wM(c))return{data:c};if(Nm&&bM(c))return{data:await EM(c)};if(Pe(typeof c=="object"),Pe(dS(c)),"url"in c&&typeof c.url=="string"){if(O0(c.url)){const{url:ge}=c,Be=uS(c,["url"]),Ae=lS(ge);return Object.assign({data:Ae},Be)}cS()}return c},[c]);P.useEffect(()=>{const ge=Bf(Xe());return ge.promise.then(Be=>{L({type:"RESOLVE",value:Be})}).catch(Be=>{L({type:"REJECT",error:Be})}),()=>{gl(ge)}},[Xe,L]),P.useEffect(()=>{if(!(typeof N>"u")){if(N===!1){oe();return}J()}},[N]);function fe(){ee&&(A&&A(ee),I.current=new Array(ee.numPages),O.current.setDocument(ee))}function pe(){j&&(Kt(!1,j.toString()),y&&y(j))}P.useEffect(function(){W({type:"RESET"})},[W,N]),P.useEffect(function(){if(!N)return;const Be=E?Object.assign(Object.assign({},N),E):N,Ae=Kw(Be);g&&(Ae.onProgress=g),v&&(Ae.onPassword=v);const As=Ae,Pi=As.promise.then(Ri=>{W({type:"RESOLVE",value:Ri})}).catch(Ri=>{As.destroyed||W({type:"REJECT",error:Ri})});return()=>{Pi.finally(()=>As.destroy())}},[E,W,N]),P.useEffect(()=>{if(!(typeof ee>"u")){if(ee===!1){pe();return}fe()}},[ee]),P.useEffect(function(){O.current.setViewer(re.current),O.current.setExternalLinkRel(o),O.current.setExternalLinkTarget(a)},[o,a]);const _n=P.useCallback((ge,Be)=>{I.current[ge]=Be},[]),Cn=P.useCallback(ge=>{delete I.current[ge]},[]),ue=P.useMemo(()=>({imageResourcesPath:d,linkService:O.current,onItemClick:p,pdf:ee,registerPage:_n,renderMode:C,rotate:T,scale:k,unregisterPage:Cn}),[d,p,ee,_n,C,T,k,Cn]),kn=P.useMemo(()=>mC(R,()=>ee),[R,ee]);function Ct(){return _.jsx(yC.Provider,{value:ue,children:s})}function gt(){return c?ee==null?_.jsx(nc,{type:"loading",children:typeof h=="function"?h():h}):ee===!1?_.jsx(nc,{type:"error",children:typeof r=="function"?r():r}):Ct():_.jsx(nc,{type:"no-data",children:typeof f=="function"?f():f})}return _.jsx("div",Object.assign({className:ki("react-pdf__Document",i),ref:u},kn,{children:gt()}))});function bC(){return P.useContext(yC)}function xC(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=n.filter(Boolean);if(t.length<=1){var s=t[0];return s||null}return function(r){for(var o=0,a=t;o<a.length;o++){var c=a[o];typeof c=="function"?c(r):c&&(c.current=r)}}}const SC=P.createContext(null),AC={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},PM=/^H(\d+)$/;function RM(n){return n in AC}function Mm(n){return"children"in n}function EC(n){return Mm(n)?n.children.length===1&&0 in n.children&&"id"in n.children[0]:!1}function LM(n){const e={};if(Mm(n)){const{role:t}=n,s=t.match(PM);if(s)e.role="heading",e["aria-level"]=Number(s[1]);else if(RM(t)){const i=AC[t];i&&(e.role=i)}}return e}function _C(n){const e={};if(Mm(n)){if(n.alt!==void 0&&(e["aria-label"]=n.alt),n.lang!==void 0&&(e.lang=n.lang),EC(n)){const[t]=n.children;if(t){const s=_C(t);return Object.assign(Object.assign({},e),s)}}}else"id"in n&&(e["aria-owns"]=n.id);return e}function NM(n){return n?Object.assign(Object.assign({},LM(n)),_C(n)):null}function CC({className:n,node:e}){const t=P.useMemo(()=>NM(e),[e]),s=P.useMemo(()=>!Mm(e)||EC(e)?null:e.children.map((i,r)=>_.jsx(CC,{node:i},r)),[e]);return _.jsx("span",Object.assign({className:n},t,{children:s}))}function Dm(){return P.useContext(SC)}function MM(){const n=Dm();Pe(n);const{onGetStructTreeError:e,onGetStructTreeSuccess:t}=n,[s,i]=wu(),{value:r,error:o}=s,{customTextRenderer:a,page:c}=n;function u(){r&&t&&t(r)}function d(){o&&(Kt(!1,o.toString()),e&&e(o))}return P.useEffect(function(){i({type:"RESET"})},[i,c]),P.useEffect(function(){if(a||!c)return;const f=Bf(c.getStructTree()),p=f;return f.promise.then(y=>{i({type:"RESOLVE",value:y})}).catch(y=>{i({type:"REJECT",error:y})}),()=>gl(p)},[a,c,i]),P.useEffect(()=>{if(r!==void 0){if(r===!1){d();return}u()}},[r]),r?_.jsx(CC,{className:"react-pdf__Page__structTree structTree",node:r}):null}const hS=Ai;function DM(n){const e=Dm();Pe(e);const t=Object.assign(Object.assign({},e),n),{_className:s,canvasBackground:i,devicePixelRatio:r=xM(),onRenderError:o,onRenderSuccess:a,page:c,renderForms:u,renderTextLayer:d,rotate:h,scale:f}=t,{canvasRef:p}=n;Pe(c);const y=P.useRef(null);function g(){c&&a&&a(F0(c,f))}function A(E){AM(E)||(Kt(!1,E.toString()),o&&o(E))}const v=P.useMemo(()=>c.getViewport({scale:f*r,rotation:h}),[r,c,h,f]),w=P.useMemo(()=>c.getViewport({scale:f,rotation:h}),[c,h,f]);P.useEffect(function(){if(!c)return;c.cleanup();const{current:C}=y;if(!C)return;C.width=v.width,C.height=v.height,C.style.width=`${Math.floor(w.width)}px`,C.style.height=`${Math.floor(w.height)}px`,C.style.visibility="hidden";const T={annotationMode:u?hS.ENABLE_FORMS:hS.ENABLE,canvasContext:C.getContext("2d",{alpha:!1}),viewport:v};i&&(T.background=i);const k=c.render(T),R=k;return k.promise.then(()=>{C.style.visibility="",g()}).catch(A),()=>gl(R)},[i,c,u,v,w]);const b=P.useCallback(()=>{const{current:E}=y;E&&(E.width=0,E.height=0)},[]);return P.useEffect(()=>b,[b]),_.jsx("canvas",{className:`${s}__canvas`,dir:"ltr",ref:xC(p,y),style:{display:"block",userSelect:"none"},children:d?_.jsx(MM,{}):null})}function IM(n){return"str"in n}function OM(){const n=Dm();Pe(n);const{customTextRenderer:e,onGetTextError:t,onGetTextSuccess:s,onRenderTextLayerError:i,onRenderTextLayerSuccess:r,page:o,pageIndex:a,pageNumber:c,rotate:u,scale:d}=n;Pe(o);const[h,f]=wu(),{value:p,error:y}=h,g=P.useRef(null);Kt(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer");function A(){p&&s&&s(p)}function v(){y&&(Kt(!1,y.toString()),t&&t(y))}P.useEffect(function(){f({type:"RESET"})},[o,f]),P.useEffect(function(){if(!o)return;const R=Bf(o.getTextContent()),M=R;return R.promise.then(L=>{f({type:"RESOLVE",value:L})}).catch(L=>{f({type:"REJECT",error:L})}),()=>gl(M)},[o,f]),P.useEffect(()=>{if(p!==void 0){if(p===!1){v();return}A()}},[p]);const w=P.useCallback(()=>{r&&r()},[r]),b=P.useCallback(k=>{Kt(!1,k.toString()),i&&i(k)},[i]);function E(){const k=g.current;k&&k.classList.add("selecting")}function C(){const k=g.current;k&&k.classList.remove("selecting")}const T=P.useMemo(()=>o.getViewport({scale:d,rotation:u}),[o,u,d]);return P.useLayoutEffect(function(){if(!o||!p)return;const{current:R}=g;if(!R)return;R.innerHTML="";const M=o.streamTextContent({includeMarkedContent:!0}),L={container:R,textContentSource:M,viewport:T},N=new Xd(L),B=N;return N.render().then(()=>{const H=document.createElement("div");H.className="endOfContent",R.append(H);const W=R.querySelectorAll('[role="presentation"]');if(e){let ee=0;p.items.forEach((j,O)=>{if(!IM(j))return;const I=W[ee];if(!I)return;const V=e(Object.assign({pageIndex:a,pageNumber:c,itemIndex:O},j));I.innerHTML=V,ee+=j.str&&j.hasEOL?2:1})}w()}).catch(b),()=>gl(B)},[e,b,w,o,a,c,p,T]),_.jsx("div",{className:ki("react-pdf__Page__textContent","textLayer"),onMouseUp:C,onMouseDown:E,ref:g})}function FM(){const n=bC(),e=Dm();Pe(e);const t=Object.assign(Object.assign({},n),e),{imageResourcesPath:s,linkService:i,onGetAnnotationsError:r,onGetAnnotationsSuccess:o,onRenderAnnotationLayerError:a,onRenderAnnotationLayerSuccess:c,page:u,pdf:d,renderForms:h,rotate:f,scale:p=1}=t;Pe(d),Pe(u),Pe(i);const[y,g]=wu(),{value:A,error:v}=y,w=P.useRef(null);Kt(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations");function b(){A&&o&&o(A)}function E(){v&&(Kt(!1,v.toString()),r&&r(v))}P.useEffect(function(){g({type:"RESET"})},[g,u]),P.useEffect(function(){if(!u)return;const M=Bf(u.getAnnotations()),L=M;return M.promise.then(N=>{g({type:"RESOLVE",value:N})}).catch(N=>{g({type:"REJECT",error:N})}),()=>{gl(L)}},[g,u]),P.useEffect(()=>{if(A!==void 0){if(A===!1){E();return}b()}},[A]);function C(){c&&c()}function T(R){Kt(!1,`${R}`),a&&a(R)}const k=P.useMemo(()=>u.getViewport({scale:p,rotation:f}),[u,f,p]);return P.useEffect(function(){if(!d||!u||!i||!A)return;const{current:M}=w;if(!M)return;const L=k.clone({dontFlip:!0}),N={accessibilityManager:null,annotationCanvasMap:null,annotationEditorUIManager:null,div:M,l10n:null,page:u,structTreeLayer:null,viewport:L},B={annotations:A,annotationStorage:d.annotationStorage,div:M,imageResourcesPath:s,linkService:i,page:u,renderForms:h,viewport:L};M.innerHTML="";try{new eb(N).render(B),C()}catch(H){T(H)}return()=>{}},[A,s,i,u,d,h,k]),_.jsx("div",{className:ki("react-pdf__Page__annotations","annotationLayer"),ref:w})}var jM=function(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(n);i<s.length;i++)e.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(n,s[i])&&(t[s[i]]=n[s[i]]);return t};const fS=1;function zM(n){const e=bC(),t=Object.assign(Object.assign({},e),n),{_className:s="react-pdf__Page",_enableRegisterUnregisterPage:i=!0,canvasBackground:r,canvasRef:o,children:a,className:c,customRenderer:u,customTextRenderer:d,devicePixelRatio:h,error:f="Failed to load the page.",height:p,inputRef:y,loading:g="Loading page",noData:A="No page specified.",onGetAnnotationsError:v,onGetAnnotationsSuccess:w,onGetStructTreeError:b,onGetStructTreeSuccess:E,onGetTextError:C,onGetTextSuccess:T,onLoadError:k,onLoadSuccess:R,onRenderAnnotationLayerError:M,onRenderAnnotationLayerSuccess:L,onRenderError:N,onRenderSuccess:B,onRenderTextLayerError:H,onRenderTextLayerSuccess:W,pageIndex:ee,pageNumber:j,pdf:O,registerPage:I,renderAnnotationLayer:V=!0,renderForms:K=!1,renderMode:re="canvas",renderTextLayer:J=!0,rotate:oe,scale:Re=fS,unregisterPage:Xe,width:fe}=t,pe=jM(t,["_className","_enableRegisterUnregisterPage","canvasBackground","canvasRef","children","className","customRenderer","customTextRenderer","devicePixelRatio","error","height","inputRef","loading","noData","onGetAnnotationsError","onGetAnnotationsSuccess","onGetStructTreeError","onGetStructTreeSuccess","onGetTextError","onGetTextSuccess","onLoadError","onLoadSuccess","onRenderAnnotationLayerError","onRenderAnnotationLayerSuccess","onRenderError","onRenderSuccess","onRenderTextLayerError","onRenderTextLayerSuccess","pageIndex","pageNumber","pdf","registerPage","renderAnnotationLayer","renderForms","renderMode","renderTextLayer","rotate","scale","unregisterPage","width"]),[_n,Cn]=wu(),{value:ue,error:kn}=_n,Ct=P.useRef(null);Pe(O);const gt=Vo(j)?j-1:ee??null,ge=j??(Vo(ee)?ee+1:null),Be=oe??(ue?ue.rotate:null),Ae=P.useMemo(()=>{if(!ue)return null;let Tn=1;const Es=Re??fS;if(fe||p){const Js=ue.getViewport({scale:1,rotation:Be});fe?Tn=fe/Js.width:p&&(Tn=p/Js.height)}return Es*Tn},[p,ue,Be,Re,fe]);P.useEffect(function(){return()=>{Vo(gt)&&i&&Xe&&Xe(gt)}},[i,O,gt,Xe]);function As(){if(R){if(!ue||!Ae)return;R(F0(ue,Ae))}if(i&&I){if(!Vo(gt)||!Ct.current)return;I(gt,Ct.current)}}function Pi(){kn&&(Kt(!1,kn.toString()),k&&k(kn))}P.useEffect(function(){Cn({type:"RESET"})},[Cn,O,gt]),P.useEffect(function(){if(!O||!ge)return;const Es=Bf(O.getPage(ge)),Js=Es;return Es.promise.then(xl=>{Cn({type:"RESOLVE",value:xl})}).catch(xl=>{Cn({type:"REJECT",error:xl})}),()=>gl(Js)},[Cn,O,ge]),P.useEffect(()=>{if(ue!==void 0){if(ue===!1){Pi();return}As()}},[ue,Ae]);const Ri=P.useMemo(()=>ue&&Vo(gt)&&ge&&Vo(Be)&&Vo(Ae)?{_className:s,canvasBackground:r,customTextRenderer:d,devicePixelRatio:h,onGetAnnotationsError:v,onGetAnnotationsSuccess:w,onGetStructTreeError:b,onGetStructTreeSuccess:E,onGetTextError:C,onGetTextSuccess:T,onRenderAnnotationLayerError:M,onRenderAnnotationLayerSuccess:L,onRenderError:N,onRenderSuccess:B,onRenderTextLayerError:H,onRenderTextLayerSuccess:W,page:ue,pageIndex:gt,pageNumber:ge,renderForms:K,renderTextLayer:J,rotate:Be,scale:Ae}:null,[s,r,d,h,v,w,b,E,C,T,M,L,N,B,H,W,ue,gt,ge,K,J,Be,Ae]),Qs=P.useMemo(()=>mC(pe,()=>ue&&(Ae?F0(ue,Ae):void 0)),[pe,ue,Ae]),Li=`${gt}@${Ae}/${Be}`;function bl(){switch(re){case"custom":return Pe(u),_.jsx(u,{},`${Li}_custom`);case"none":return null;case"canvas":default:return _.jsx(DM,{canvasRef:o},`${Li}_canvas`)}}function Hf(){return J?_.jsx(OM,{},`${Li}_text`):null}function Uf(){return V?_.jsx(FM,{},`${Li}_annotations`):null}function Im(){return _.jsxs(SC.Provider,{value:Ri,children:[bl(),Hf(),Uf(),a]})}function Om(){return ge?O===null||ue===void 0||ue===null?_.jsx(nc,{type:"loading",children:typeof g=="function"?g():g}):O===!1||ue===!1?_.jsx(nc,{type:"error",children:typeof f=="function"?f():f}):Im():_.jsx(nc,{type:"no-data",children:typeof A=="function"?A():A})}return _.jsx("div",Object.assign({className:ki(s,c),"data-page-number":ge,ref:xC(y,Ct),style:{"--scale-round-x":"1px","--scale-round-y":"1px","--scale-factor":"1","--user-unit":`${Ae}`,"--total-scale-factor":"calc(var(--scale-factor) * var(--user-unit))",backgroundColor:r||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"}},Qs,{children:Om()}))}SM();gs.workerSrc="pdf.worker.mjs";async function sb(n){const e=await fetch(`${de}/components/${n}/attributes/view`);if(!e.ok)throw new Error(`Failed to load attributes: ${e.status}`);return e.json()}async function kC(n,e){const t=await fetch(`${de}/components/${n}/attributes`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw new Error(`Failed to save: ${t.status}`)}async function ib(n){const e=await fetch(`${de}/components/${n}/confirm-close`,{method:"POST"});if(!e.ok)throw new Error(`Failed to confirm & close: ${e.status}`)}async function TC(n){const e=await fetch(`${de}/components/${n}/reanalyze`,{method:"POST"});if(!e.ok)throw new Error(`Failed to reanalyze: ${e.status}`);return e.json()}const $M=Object.freeze(Object.defineProperty({__proto__:null,confirmClose:ib,getAttributesView:sb,patchAttributes:kC,reanalyze:TC},Symbol.toStringTag,{value:"Module"}));function PC(n,e=300){let t;return(...s)=>{clearTimeout(t),t=setTimeout(()=>n(...s),e)}}function BM({componentId:n,onDirtyChange:e}){const[t,s]=P.useState([]),[i,r]=P.useState({}),[o,a]=P.useState(!0);P.useEffect(()=>{let h=!0;return(async()=>{a(!0);const f=await sb(n);h&&(s(f),r({}),a(!1),e==null||e(!1))})(),()=>{h=!1}},[n]);const c=(h,f,p)=>{r(y=>{const g={...y,[h]:{value:f,unit:p}};return e==null||e(!0),g}),d(h,f,p)},u=async(h,f,p)=>{await kC(n,[{attribute_id:h,op:"upsert",value:f,unit:p}]),r(y=>{const g={...y};delete g[h];const A=Object.keys(g).length>0;return e==null||e(A),g})},d=P.useMemo(()=>PC(u,500),[n]);return o?_.jsx("div",{className:"p-4 text-sm text-gray-500",children:"Loading attributes"}):_.jsx("div",{className:"flex flex-col gap-4",children:t.map(h=>{var g,A,v,w,b,E;const f=((g=i[h.attribute_id])==null?void 0:g.value)??((A=h.current)==null?void 0:A.value)??"",p=((v=i[h.attribute_id])==null?void 0:v.unit)??((w=h.current)==null?void 0:w.unit)??h.unit_default??"",y=h.data_type!=="json";return _.jsxs("div",{className:"p-3 border-b last:border-0 hover:bg-gray-50",children:[_.jsxs("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:[h.display_label,h.category&&_.jsx("span",{className:"ml-2 text-xs text-gray-400",children:h.category})]}),y?_.jsx("input",{className:"w-full border rounded px-2 py-1 text-sm",value:f,onChange:C=>c(h.attribute_id,C.target.value,p)}):_.jsx("textarea",{className:"w-full border rounded px-2 py-1 text-sm",value:String(f??""),onChange:C=>c(h.attribute_id,C.target.value,p),rows:2}),_.jsx("div",{className:"mt-1 flex items-center justify-between text-xs text-gray-500",children:_.jsxs("div",{className:"flex gap-2 items-center",children:[p?_.jsx("span",{className:"px-1.5 py-0.5 rounded bg-gray-100",children:p}):null,((b=h.current)==null?void 0:b.confidence)!=null&&_.jsxs("span",{className:"px-1.5 py-0.5 rounded bg-gray-100",children:[Math.round((h.current.confidence||0)*100),"%"]})]})}),((E=h.candidates)==null?void 0:E.length)>0&&_.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:h.candidates.map((C,T)=>{var k;return _.jsxs("button",{className:"text-xs border rounded px-2 py-1 hover:bg-gray-100",onClick:()=>c(h.attribute_id,C.value,C.unit),title:`From page ${((k=C.source)==null?void 0:k.page)??"?"}`,children:[String(C.value)," ",C.unit??""]},T)})})]},h.attribute_id)})})}const HM=({assetId:n,pdfUrl:e,initialParsedData:t,onClose:s})=>{const[i,r]=P.useState(null),[o,a]=P.useState(1),[c,u]=P.useState(1),[d,h]=P.useState([]),f=$(L=>L.setDatasheetDirty),[p,y]=P.useState(null),[g,A]=P.useState(t||{});P.useEffect(()=>{A(t||{})},[n,t]);const v=an.useMemo(()=>PC(L=>{FP(n,L,!1).catch(N=>{console.error("Failed to save parsed data",N)})},500),[n]);P.useEffect(()=>{f(!1)},[n]),P.useEffect(()=>{async function L(){try{const N=await jP(n);h(N)}catch(N){console.error("Failed to load images",N)}}L()},[n]),P.useEffect(()=>{let L=!1;return(async()=>{try{const{getAttributesView:N}=await uL(async()=>{const{getAttributesView:H}=await Promise.resolve().then(()=>$M);return{getAttributesView:H}},[]),B=await N(n);L||y(B&&B.length>0)}catch(N){console.error("Failed to load attributes for preview",N),L||y(!1)}})(),()=>{L=!0}},[n]);const w=async L=>{const N=L.target.files;if(!N||N.length===0)return;const B=[];for(let H=0;H<N.length;H++)B.push(N[H]);try{const H=await zP(n,B);h(W=>[...W,...H]),f(!0)}catch(H){console.error("Image upload failed",H)}L.target.value=""},b=async L=>{if(window.confirm("Are you sure you want to delete this image?"))try{await $P(n,L),h(N=>N.filter(B=>B.id!==L)),f(!0)}catch(N){console.error("Failed to delete image",N)}},E=async L=>{try{await BP(n,L),h(N=>N.map(B=>({...B,is_primary:B.id===L}))),f(!0)}catch(N){console.error("Failed to set primary image",N)}};function C({numPages:L}){r(L),a(1)}const T=()=>a(L=>Math.max(L-1,1)),k=()=>a(L=>Math.min(L+1,i||1)),R=()=>u(L=>L+.1),M=()=>u(L=>Math.max(L-.1,.1));return _.jsxs("div",{className:"flex h-full min-h-0",children:[_.jsxs("div",{className:"w-1/2 border-r flex flex-col min-h-0",children:[_.jsxs("div",{className:"flex items-center justify-between p-2 border-b bg-white",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx("button",{onClick:T,className:"p-1 border rounded",children:_.jsx(eR,{className:"w-4 h-4"})}),_.jsxs("span",{className:"text-sm",children:["Page ",o," / ",i]}),_.jsx("button",{onClick:k,className:"p-1 border rounded",children:_.jsx(nR,{className:"w-4 h-4"})})]}),_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx("button",{onClick:M,className:"p-1 border rounded",children:_.jsx(NR,{className:"w-4 h-4"})}),_.jsx("button",{onClick:R,className:"p-1 border rounded",children:_.jsx(RR,{className:"w-4 h-4"})})]})]}),_.jsx("div",{className:"flex-1 overflow-auto scroll-container bg-gray-50 flex justify-center min-h-0",children:_.jsx(TM,{file:e,onLoadSuccess:C,className:"m-2",children:_.jsx(zM,{pageNumber:o,scale:c})})})]}),_.jsx("div",{className:"w-1/2 flex flex-col min-h-0",children:_.jsxs("div",{className:"flex-1 overflow-auto scroll-container p-4 flex flex-col gap-4 min-h-0",children:[p===null?_.jsx("div",{className:"text-sm text-gray-500",children:"Loading attributes"}):p?_.jsx(BM,{componentId:n,onDirtyChange:L=>{f(L)}}):t?_.jsxs("div",{className:"flex flex-col gap-0",children:[_.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Raw data"}),Object.entries(g).map(([L,N])=>_.jsxs("div",{className:"p-3 border-b last:border-0",children:[_.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1 capitalize",children:L.replace(/_/g," ")}),typeof N=="object"&&N!==null?_.jsx("textarea",{value:JSON.stringify(N,null,2),onChange:B=>{let H=B.target.value;try{H=JSON.parse(B.target.value)}catch{}A(W=>{const ee={...W,[L]:H};return f(!0),v(ee),ee})},rows:3,className:"w-full border rounded px-2 py-1 text-sm font-mono resize-y"}):_.jsx("input",{type:"text",value:String(N??""),onChange:B=>{const H=B.target.value;A(W=>{const ee={...W,[L]:H};return f(!0),v(ee),ee})},className:"w-full border rounded px-2 py-1 text-sm"})]},L))]}):_.jsx("div",{className:"text-sm text-gray-500",children:"No attributes or parsed data available."}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Images"}),_.jsxs("div",{className:"flex flex-wrap gap-3",children:[d.map(L=>_.jsxs("div",{className:"relative border rounded",children:[_.jsx("img",{src:`${de.replace(/\/api\/v1$/,"")}${L.url}`,alt:L.filename,className:"w-24 h-24 object-cover rounded"}),L.is_primary&&_.jsx("span",{className:"absolute top-1 left-1 bg-blue-500 text-white text-xs px-1 rounded",children:"Primary"}),_.jsx("button",{onClick:()=>E(L.id),className:"absolute top-1 right-6 text-white",title:"Make primary",children:_.jsx(ER,{className:L.is_primary?"w-4 h-4 text-yellow-400 fill-yellow-400":"w-4 h-4 text-white drop-shadow"})}),_.jsx("button",{onClick:()=>b(L.id),className:"absolute top-1 right-1 text-white",title:"Delete",children:_.jsx(CR,{className:"w-4 h-4 text-red-500"})})]},L.id)),_.jsxs("label",{className:"flex items-center justify-center w-24 h-24 border-2 border-dashed rounded cursor-pointer text-gray-500",children:[_.jsx("span",{className:"text-sm",children:"+ Add"}),_.jsx("input",{type:"file",multiple:!0,accept:"image/*",onChange:w,className:"hidden"})]})]})]})]})})]})},UM=()=>{const n=$(h=>h.activeDatasheet),e=$(h=>h.setActiveDatasheet),{addUpload:t,updateUpload:s,setRoute:i,addStatusMessage:r}=$(),{setNodeRef:o}=tE({id:"component-canvas-area"}),a=P.useCallback(async h=>{const f=`temp-${Date.now()}`;t({id:f,name:h.name,size:h.size,mime:h.type,progress:0,assetType:"component",parsed_at:null,parsing_status:null,parsing_error:null,is_human_verified:!1});try{const p=await I1(h,g=>s(f,{progress:g}));s(p.id,{...p,parsing_status:"processing"}),i("components"),Mw(p.id).catch(g=>{s(p.id,{parsing_status:"failed",parsing_error:g.message})});const y=setInterval(async()=>{try{const g=await Bd(p.id);if(g.parsing_status==="success"){clearInterval(y),s(p.id,{parsing_status:"success",parsing_error:null});const A=`${de}/files/${g.id}/file`;e({id:g.id,url:A,payload:g.parsed_payload})}else g.parsing_status==="failed"&&(clearInterval(y),s(p.id,{parsing_status:"failed",parsing_error:g.parsing_error}))}catch(g){clearInterval(y),s(p.id,{parsing_status:"failed",parsing_error:g.message||"Failed to fetch status"})}},2e3)}catch(p){console.error(p),s(f,{parsing_status:"failed",parsing_error:"Upload or parse failed"})}},[t,s,e,i]),c=P.useCallback(h=>{if(h.preventDefault(),h.dataTransfer.files&&h.dataTransfer.files[0]){const f=h.dataTransfer.files[0];f.type==="application/pdf"&&a(f)}},[a]),u=h=>h.preventDefault(),d=()=>e(null);return _.jsx("div",{ref:o,className:"w-full h-full flex flex-col",onDrop:c,onDragOver:u,children:n?_.jsx(HM,{assetId:n.id,pdfUrl:n.url,initialParsedData:n.payload,onClose:d}):_.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-400 border-2 border-dashed rounded-lg pointer-events-none",children:_.jsx("p",{children:"Drop a component from the library or a PDF from your computer to begin."})})})},VM=()=>{const[n,e]=P.useState([]),[t,s]=P.useState(null);return P.useEffect(()=>{(async()=>{try{const r=await fetch(`${de}/memory`);if(r.ok){const o=await r.json();e(o)}else s(`Failed to load memory: ${r.status}`)}catch(r){s(`Failed to load memory: ${r.message??r}`)}})()},[]),_.jsxs("div",{className:"space-y-4",children:[_.jsx("h3",{className:"text-lg font-semibold",children:"Memory Entries"}),t&&_.jsx("div",{className:"text-red-600 text-sm",children:t}),_.jsx("div",{className:"overflow-x-auto",children:_.jsxs("table",{className:"min-w-full border text-xs text-left",children:[_.jsx("thead",{className:"bg-gray-100",children:_.jsxs("tr",{children:[_.jsx("th",{className:"px-3 py-2 font-medium",children:"ID"}),_.jsx("th",{className:"px-3 py-2 font-medium",children:"Kind"}),_.jsx("th",{className:"px-3 py-2 font-medium",children:"Project"}),_.jsx("th",{className:"px-3 py-2 font-medium",children:"Created"})]})}),_.jsxs("tbody",{children:[n.map(i=>_.jsxs("tr",{className:"border-t",children:[_.jsx("td",{className:"px-3 py-1 font-mono",children:i.id}),_.jsx("td",{className:"px-3 py-1",children:i.kind}),_.jsx("td",{className:"px-3 py-1",children:i.project_id??"-"}),_.jsx("td",{className:"px-3 py-1",children:new Date(i.created_at).toLocaleString(void 0,{dateStyle:"short",timeStyle:"short"})})]},i.id)),n.length===0&&!t&&_.jsx("tr",{children:_.jsx("td",{colSpan:4,className:"px-3 py-4 text-center text-gray-500",children:"No memory entries found."})})]})]})})]})},GM=()=>{const[n,e]=P.useState([]),[t,s]=P.useState(null),[i,r]=P.useState([]),[o,a]=P.useState(null);return P.useEffect(()=>{(async()=>{try{const u=await fetch(`${de}/traces`);if(!u.ok){a(`Failed to load traces: ${u.status}`);return}const d=await u.json();e(d)}catch(u){a(`Failed to load traces: ${u.message??u}`)}})()},[]),P.useEffect(()=>{if(!t){r([]);return}(async()=>{try{const u=await fetch(`${de}/traces/${t}`);if(!u.ok){a(`Failed to load events: ${u.status}`);return}const d=await u.json();r(d)}catch(u){a(`Failed to load events: ${u.message??u}`)}})()},[t]),_.jsxs("div",{className:"space-y-4 h-full flex flex-col",children:[_.jsx("h3",{className:"text-lg font-semibold",children:"Traceability"}),o&&_.jsx("div",{className:"text-red-600 text-sm",children:o}),_.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[_.jsxs("div",{className:"w-1/3 pr-2 border-r overflow-y-auto",children:[_.jsx("h4",{className:"font-medium mb-2",children:"Traces"}),_.jsxs("ul",{className:"divide-y",children:[n.map(c=>_.jsxs("li",{className:`p-2 cursor-pointer ${t===c.trace_id?"bg-blue-50":"hover:bg-gray-100"}`,onClick:()=>s(c.trace_id),children:[_.jsx("div",{className:"font-mono text-xs truncate",children:c.trace_id}),_.jsxs("div",{className:"text-xs text-gray-500",children:[c.count," event",c.count===1?"":"s"]})]},c.trace_id)),n.length===0&&_.jsx("li",{className:"p-2 text-gray-500 text-sm",children:"No traces found."})]})]}),_.jsxs("div",{className:"w-2/3 pl-2 overflow-y-auto",children:[_.jsx("h4",{className:"font-medium mb-2",children:"Events"}),t&&i.length===0&&_.jsx("div",{className:"text-sm text-gray-500",children:"No events for this trace."}),i.map(c=>_.jsxs("div",{className:"border-b pb-2 mb-2",children:[_.jsxs("div",{className:"text-xs font-semibold",children:[new Date(c.ts).toLocaleString(void 0,{dateStyle:"short",timeStyle:"short"}),"-",c.event_type]}),_.jsx("pre",{className:"whitespace-pre-wrap bg-gray-50 p-2 rounded text-xs overflow-x-auto",children:JSON.stringify(c.payload,null,2)})]},c.id))]})]})]})},WM=()=>{const[n,e]=P.useState(null),[t,s]=P.useState("profile");P.useEffect(()=>{(async()=>{try{const a=await fetch(`${de}/me`);if(a.ok){const c=await a.json();e(c)}else e({id:"anonymous",org_id:"unknown",roles:[],permissions:[]})}catch(a){console.error("Failed to fetch user profile",a),e({id:"anonymous",org_id:"unknown",roles:[],permissions:[]})}})()},[]);const i=o=>{var a;return o?((a=n==null?void 0:n.permissions)==null?void 0:a.includes(o))??!1:!0},r=[{id:"profile",label:"Profile",content:_.jsx("div",{children:"Your profile settings go here."})},{id:"organization",label:"Organization",content:_.jsx("div",{children:"Organization settings (coming soon)."})},{id:"roles",label:"Roles & Permissions",content:_.jsx("div",{children:"Role management (coming soon)."}),perm:"policy:edit"},{id:"memory",label:"Memory",content:_.jsx(VM,{}),perm:"memory:read"},{id:"traceability",label:"Traceability",content:_.jsx(GM,{}),perm:"trace:read"},{id:"integrations",label:"Integrations",content:_.jsx("div",{children:"Integrations configuration (coming soon)."}),perm:"policy:edit"},{id:"models",label:"Models & Costs",content:_.jsx("div",{children:"Model settings (coming soon)."}),perm:"policy:edit"},{id:"automations",label:"Automations",content:_.jsx("div",{children:"Automation schedules (coming soon)."}),perm:"policy:edit"}];return _.jsxs("div",{className:"p-4 h-full overflow-auto bg-gray-50 text-black flex flex-col",children:[_.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Settings"}),_.jsx("div",{className:"flex space-x-4 border-b border-gray-200 mb-4",children:r.filter(o=>i(o.perm)).map(o=>_.jsx("button",{onClick:()=>s(o.id),className:`py-2 px-3 border-b-2 font-medium text-sm ${t===o.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:o.label},o.id))}),_.jsx("div",{className:"flex-1 overflow-auto",children:r.filter(o=>i(o.perm)).map(o=>_.jsx("div",{className:t===o.id?"block":"hidden",children:o.content},o.id))})]})},XM=()=>{const n=$(e=>e.route);return _.jsxs("main",{className:"grid-in-main flex flex-col bg-gray-50 text-black h-full w-full p-2 overflow-hidden",children:[n==="projects"&&_.jsx(aL,{}),n==="components"&&_.jsx(UM,{}),n==="settings"&&_.jsx(WM,{})]})},qM=({u:n})=>{const e=$(d=>d.setActiveDatasheet),t=$(d=>d.setRoute),s=$(d=>d.updateUpload),{attributes:i,listeners:r,setNodeRef:o,isDragging:a}=eE({id:`file-asset-${n.id}`,data:{type:"file-asset",asset:n}}),c=()=>n.parsing_status==="processing"?_.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"}):n.parsing_status==="failed"?_.jsx("span",{title:n.parsing_error||"An unknown error occurred.",className:"text-red-500",children:""}):n.parsing_status==="success"?_.jsx("span",{className:"text-green-500",children:""}):null,u=async()=>{try{s(n.id,{parsing_status:"processing"}),await Mw(n.id);const d=setInterval(async()=>{try{const h=await Bd(n.id);if(h.parsing_status==="success"){clearInterval(d),s(n.id,{parsing_status:"success",parsing_error:null});const f=`${de}/files/${h.id}/file`;e({id:h.id,url:f,payload:h.parsed_payload}),t("components")}else h.parsing_status==="failed"&&(clearInterval(d),s(n.id,{parsing_status:"failed",parsing_error:h.parsing_error}))}catch(h){clearInterval(d),s(n.id,{parsing_status:"failed",parsing_error:h.message||"Failed to fetch status"})}},2e3)}catch(d){console.error(d),s(n.id,{parsing_status:"failed",parsing_error:d.message||"Failed to parse datasheet"})}};return _.jsxs("div",{ref:o,...r,...i,onClick:async()=>{if(n.parsing_status==="success"){const d=await Bd(n.id),h=`${de}/files/${d.id}/file`;e({id:d.id,url:h,payload:d.parsed_payload}),t("components")}},className:ki("border rounded p-2 text-sm transition bg-white shadow-sm",a&&"opacity-50"),children:[_.jsxs("div",{className:"flex justify-between items-center gap-2",children:[_.jsx("div",{className:"font-medium truncate flex-1",children:n.name}),(!n.parsing_status||n.parsing_status==="failed")&&_.jsx("button",{onClick:d=>{d.stopPropagation(),u()},className:"text-xs text-blue-600 hover:underline",title:"Parse datasheet",children:"Parse"})]}),_.jsx("div",{className:"h-1 bg-gray-200 rounded mt-1",children:_.jsx("div",{className:ki("h-1 rounded bg-emerald-500 transition-all",n.progress>100?"w-full":void 0),style:{width:`${Math.min(n.progress,100)}%`}})}),_.jsx("div",{className:"text-xs text-right text-gray-500 flex items-center gap-1 mt-1",children:n.progress>100?_.jsx(c,{}):`${n.progress}%`})]})},YM=()=>{const n=$(c=>c.uploads.filter(u=>u.progress>100)),[e,t]=P.useState(!1),[s,i]=P.useState(""),[r,o]=P.useState(!1);if(!n.length)return null;const a=n.filter(c=>{if(!s)return!0;const u=s.toLowerCase();if(c.name&&c.name.toLowerCase().includes(u))return!0;try{if(c.parsed_payload&&JSON.stringify(c.parsed_payload).toLowerCase().includes(u))return!0}catch{}return!1});return _.jsxs("div",{className:"p-2 space-y-2",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[!e&&_.jsx("div",{className:"text-sm font-medium text-gray-500 px-2 whitespace-nowrap",children:"Component Library"}),e&&_.jsx("input",{type:"text",className:"flex-grow border rounded-full text-sm px-2 py-1 focus:outline-none focus:ring-1 focus:ring-blue-500 transition",placeholder:"Search",value:s,onChange:c=>i(c.target.value)}),_.jsx(wR,{className:"h-5 w-5 cursor-pointer text-gray-500 hover:text-gray-700",onClick:()=>t(c=>!c)}),_.jsx(lR,{className:"h-5 w-5 cursor-pointer text-gray-500 hover:text-gray-700",onClick:()=>o(c=>!c)})]}),r&&_.jsx("div",{className:"px-2 py-1 text-xs text-gray-400 italic bg-gray-50 rounded",children:"Advanced filtering options coming soon."}),a.map(c=>_.jsx(qM,{u:c},c.id))]})},KM=[{name:"projects",label:"Projects",icon:qP},{name:"components",label:"Components",icon:JP},{name:"settings",label:"Settings",icon:F1}],QM=({isCollapsed:n})=>{const e=$(s=>s.route),t=$(s=>s.setRoute);return _.jsx("div",{className:"grid-in-sidebar flex flex-col bg-white text-black border-r border-gray-200",children:_.jsxs("nav",{className:"flex-1 py-4 px-2 mt-2","aria-label":"Sidebar navigation",children:[_.jsx("ul",{className:"space-y-1",children:KM.map(s=>_.jsx("li",{children:_.jsxs("button",{onClick:()=>t(s.name),className:`flex w-full items-center gap-3 p-3 rounded-r-lg transition-colors ${n?"justify-center":""} ${e===s.name?"bg-blue-100 text-blue-600":"hover:bg-blue-50"}`,"aria-current":e===s.name?"page":void 0,title:n?s.label:void 0,children:[_.jsx(s.icon,{className:"h-5 w-5"}),!n&&_.jsx("span",{children:s.label})]})},s.name))}),!n&&_.jsx(YM,{})]})})},JM=({isCollapsed:n})=>_.jsx("div",{className:`grid-in-sidebar-header flex items-center p-4 h-16 border-b border-r border-gray-200 ${n?"justify-center":"justify-start"}`,children:_.jsxs("a",{href:"/",className:"flex items-center gap-2",children:[_.jsx("span",{className:"text-2xl",children:""}),!n&&_.jsx("h1",{className:"text-xl font-bold",children:"OriginFlow"})]})}),ZM=({isCollapsed:n})=>_.jsx("div",{className:"grid-in-sidebar-footer p-2 border-t border-r border-gray-200 bg-white flex items-center",children:_.jsxs("a",{href:"#",className:"flex items-center gap-3 px-4 py-2 text-sm font-medium rounded-md hover:bg-gray-100",children:[_.jsx(uR,{size:20}),!n&&_.jsx("span",{children:"Help & Support"})]})}),eD={info:"text-blue-600",success:"text-green-600",error:"text-red-600"},tD=()=>{const n=$(r=>r.statusMessages),e=n[n.length-1],t=e!=null&&e.icon?eD[e.icon]??"text-gray-600":"text-gray-600",s=$(r=>r.costTotal),i=$(r=>r.performanceMetrics.annualKwh);return _.jsxs("footer",{role:"status","aria-live":"polite",className:`grid-in-status flex items-center justify-between px-4 py-2 bg-white text-black border-t border-gray-200 text-sm ${t}`,children:[_.jsx("span",{className:"flex-1 truncate",children:(e==null?void 0:e.message)??"Ready"}),_.jsxs("span",{className:"flex-none ml-4 whitespace-nowrap",children:[s!==null&&_.jsxs("span",{className:"mr-4",children:["Cost: $",s.toFixed(0)]}),i!==null&&_.jsxs("span",{children:["Annual kWh: ",i.toLocaleString()]})]})]})};async function nD(n){var a,c;const e=await sb(n),t=[];t.push(["attribute_key","label","value","unit"]);for(const u of e){const d=u.key,h=u.display_label,f=((a=u.current)==null?void 0:a.value)??"",p=((c=u.current)==null?void 0:c.unit)??u.unit_default??"",y=String(f).replace(/"/g,'""');t.push([d,h,y,p])}const s=t.map(u=>u.map(d=>`"${d}"`).join(",")).join(`
`),i=new Blob([s],{type:"text/csv;charset=utf-8;"}),r=window.URL.createObjectURL(i),o=document.createElement("a");o.href=r,o.setAttribute("download",`component_${n}_attributes.csv`),document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(r)}const sD=()=>{const n=$(p=>p.analyzeAndExecute),e=$(p=>p.undo),t=$(p=>p.redo),s=$(p=>p.historyIndex),i=$(p=>p.history.length),r=$(p=>p.activeDatasheet),o=$(p=>p.addStatusMessage),a=$(p=>p.setActiveDatasheet),c=$(p=>p.setRoute),u=$(p=>p.datasheetDirty),d=$(p=>p.setDatasheetDirty),h=async()=>{if(r){if(!window.confirm("Re-analysing will discard extracted images and metadata. Continue?"))return;try{o("Re-analysing datasheet...","info"),await TC(r.id)}catch(y){console.error("Failed to reanalyze datasheet",y),o("Re-Analyze failed","error")}}else n("validate my design")},f=async()=>{if(r)try{await ib(r.id),o("Datasheet confirmed","success"),d(!1),a(null),c("components")}catch(p){console.error("Failed to confirm datasheet",p),o("Failed to confirm datasheet","error")}};return _.jsxs("section",{className:"grid-in-toolbar h-12 flex items-center justify-between px-6 border-b bg-white shadow-sm",role:"region","aria-label":"Sub Navigation",children:[_.jsxs("div",{className:"flex items-center gap-3",children:[_.jsx("button",{onClick:h,className:"px-3 py-1 text-sm rounded bg-gray-100 text-gray-700 hover:bg-blue-600 hover:text-white",children:"Analyze"}),_.jsx("button",{className:"px-3 py-1 text-sm rounded bg-gray-100 hover:bg-gray-200",children:"Filter"}),_.jsx("button",{onClick:async()=>{if(r)try{await nD(r.id)}catch(p){console.error("Export failed",p)}},className:"px-3 py-1 text-sm rounded bg-gray-100 hover:bg-gray-200",children:"Export"}),r&&_.jsx("button",{onClick:f,disabled:!u,className:`px-3 py-1 text-sm rounded border border-transparent shadow-sm focus:outline-none ${u?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-200 text-gray-400 cursor-not-allowed"}`,children:"Confirm & Close"}),_.jsx("button",{onClick:e,disabled:s<=0,className:"px-2 py-1 text-sm rounded bg-gray-100 hover:bg-gray-200 disabled:opacity-50",children:"Undo"}),_.jsx("button",{onClick:t,disabled:s<0||s>=i-1,className:"px-2 py-1 text-sm rounded bg-gray-100 hover:bg-gray-200 disabled:opacity-50",children:"Redo"})]}),_.jsx("div",{className:"text-xs text-gray-500 italic",children:"Sub-nav active"})]})},iD=({card:n})=>{const e=$(t=>t.analyzeAndExecute);return _.jsxs("div",{className:"w-full bg-white border border-gray-200 rounded-lg shadow p-4 space-y-3",children:[n.imageUrl&&_.jsx("img",{src:n.imageUrl,alt:n.title,className:"w-full h-32 object-cover rounded-md border"}),_.jsxs("div",{children:[_.jsx("h3",{className:"text-base font-semibold text-gray-900",children:n.title}),n.description&&_.jsx("p",{className:"mt-1 text-sm text-gray-600 whitespace-pre-wrap",children:n.description})]}),n.specs&&n.specs.length>0&&_.jsx("table",{className:"w-full text-sm border-collapse",children:_.jsx("tbody",{children:n.specs.map(t=>_.jsxs("tr",{className:"border-t border-gray-200",children:[_.jsx("td",{className:"py-1 pr-4 font-medium text-gray-700 whitespace-nowrap",children:t.label}),_.jsx("td",{className:"py-1 text-gray-900",children:t.value})]},t.label))})}),n.actions&&n.actions.length>0&&_.jsx("div",{className:"flex flex-wrap gap-2",children:n.actions.map(t=>_.jsx("button",{onClick:()=>e(t.command),className:"bg-blue-600 hover:bg-blue-700 text-white text-xs font-medium px-3 py-1 rounded-md transition-colors",children:t.label},t.label))})]})},rD=({message:n})=>{if(n.card)return _.jsx("div",{className:"w-full flex justify-start my-2",children:_.jsx(iD,{card:n.card})});if(n.type==="status")return _.jsx("div",{className:"w-full flex justify-center my-2",children:_.jsx("div",{className:"bg-yellow-100 text-yellow-800 px-3 py-1 rounded-md text-xs font-medium",children:n.text})});const e=n.author==="User";return _.jsx("div",{className:ki("w-full flex",e?"justify-end":"justify-start"),children:_.jsx("div",{className:ki("max-w-[80%] rounded-2xl px-4 py-2 text-sm whitespace-pre-wrap break-words",{"bg-blue-600 text-white":e,"bg-gray-200 text-gray-800":!e}),children:n.text})})},oD={pending:oR,in_progress:Dw,complete:iR,blocked:TR},aD={pending:"text-gray-400",in_progress:"text-blue-500",complete:"text-green-600",blocked:"text-yellow-500"},lD=()=>{const n=$(i=>i.planTasks),e=$(i=>i.performPlanTask),t=$(i=>i.updatePlanTaskStatus);if(!n||n.length===0)return null;const s=i=>i==="pending"?"in_progress":i==="in_progress"?"complete":"pending";return _.jsxs("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:[_.jsx("div",{className:"mb-2 text-xs font-semibold uppercase text-gray-600",children:"Plan"}),_.jsx("ol",{className:"space-y-2",children:n.map(i=>{const r=oD[i.status],o=aD[i.status],a=i.status==="in_progress";return _.jsx("li",{className:"flex items-start space-x-2",children:_.jsxs("button",{type:"button",onClick:()=>{const c=s(i.status);c==="in_progress"?e(i):t(i.id,c)},className:"flex items-start space-x-2 text-left group focus:outline-none","aria-label":`Toggle status for ${i.title}`,children:[_.jsx(r,{className:`h-4 w-4 mt-0.5 ${o} ${a?"animate-spin":""}`,"aria-hidden":"true"}),_.jsxs("div",{className:"flex-1",children:[_.jsx("div",{className:"text-sm font-medium text-gray-900 group-hover:underline",children:i.title}),i.description&&_.jsx("div",{className:"text-xs text-gray-500 leading-snug",children:i.description})]})]})},i.id)})})]})},cD=()=>{const n=$(t=>t.messages),e=$(t=>t.isAiProcessing);return _.jsxs("div",{className:"grid-in-chat-history flex flex-col h-full bg-white overflow-y-auto min-h-0",style:{borderLeft:"1px solid #e5e7eb"},children:[_.jsx(lD,{}),_.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[n.map((t,s)=>_.jsx(rD,{message:t},s)),e&&_.jsx("div",{className:"w-full flex justify-start mt-2","aria-live":"polite","aria-label":"AI processing indicator",children:_.jsxs("div",{className:"flex items-center space-x-2 bg-gray-200 text-gray-800 px-4 py-2 rounded-2xl text-sm",children:[_.jsx(Dw,{className:"animate-spin h-4 w-4"}),_.jsx("span",{children:"Echo is thinking"})]})})]})]})};function uD(n){return`${n}_${crypto.randomUUID()}`}const dD=()=>{const n=P.useRef(null),{addUpload:e,updateUpload:t,addMessage:s,addStatusMessage:i,uploads:r}=$(),o=()=>{var c;return(c=n.current)==null?void 0:c.click()},a=async c=>{var h;const u=(h=c.target.files)==null?void 0:h[0];if(!u)return;const d=uD("upload");e({id:d,name:u.name,size:u.size,mime:u.type,progress:0,assetType:"component",parsed_at:null,parsing_status:null,parsing_error:null,is_human_verified:!1}),i(`Uploading ${u.name}`,"info");try{const f=await I1(u,p=>t(d,{progress:p}));t(d,{...f,id:f.id,progress:101,parsing_status:null,parsing_error:null}),s({author:"User",text:`Uploaded ${u.name}`}),i("Upload complete","success")}catch(f){console.error("Upload failed",f),t(d,{progress:-1}),s({author:"User",text:` Upload failed for ${u.name}`}),i("Upload failed","error")}};return _.jsxs(_.Fragment,{children:[_.jsx("input",{type:"file",ref:n,onChange:a,className:"hidden"}),_.jsxs("button",{onClick:o,className:"relative p-2 text-gray-500 hover:text-blue-600 transition-colors","aria-label":"Upload file",children:[_.jsx(yR,{size:20}),r.some(c=>c.progress>=0&&c.progress<100)&&_.jsx(Dw,{size:14,className:"absolute top-0 right-0 text-blue-600 animate-spin"}),(()=>{const c=r.filter(u=>u.progress>=0&&u.progress<100).length;return c>0?_.jsx("span",{className:"absolute -top-1 -right-1 bg-red-600 text-white rounded-full text-xs w-4 h-4 flex items-center justify-center",children:c}):null})()]})]})},hD=()=>{const n=$(t=>t.quickActions),e=$(t=>t.analyzeAndExecute);return!n||n.length===0?null:_.jsx("div",{className:"grid-in-chat-actions border-t border-gray-200 bg-white px-3 py-2 flex flex-wrap gap-2",children:n.map(t=>_.jsx("button",{onClick:()=>e(t.command),className:"bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium px-3 py-1 rounded-md transition-colors",children:t.label},t.id))})},fD=()=>{const n=$(t=>t.currentMode),e=$(t=>t.setCurrentMode);return _.jsxs("div",{className:"flex items-center space-x-2",children:[_.jsx("label",{htmlFor:"mode-select",className:"text-sm text-gray-700 font-medium",children:"Mode:"}),_.jsxs("select",{id:"mode-select",value:n,onChange:t=>e(t.target.value),className:"border border-gray-300 text-sm rounded-md px-2 py-1 bg-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[_.jsx("option",{value:"design",children:"Design"}),_.jsx("option",{value:"analyze",children:"Analyze"}),_.jsx("option",{value:"manual",children:"Manual"}),_.jsx("option",{value:"business",children:"Business"})]})]})},pD=()=>{const n=$(A=>A.chatDraft),e=$(A=>A.setChatDraft),t=$(A=>A.analyzeAndExecute),s=$(A=>A.clearChatDraft),i=$(A=>A.voiceMode),r=$(A=>A.startListening),o=$(A=>A.stopListening),a=$(A=>A.voiceTranscript),c=$(A=>A.isAiProcessing),u=$(A=>A.activeDatasheet),d=$(A=>A.setActiveDatasheet),h=$(A=>A.addStatusMessage),f=$(A=>A.setDatasheetDirty),p=i==="listening",y=i==="speaking",g=async()=>{const A=n.trim();if(!A)return;const v=A.toLowerCase();if(u&&(v==="confirm and close"||v==="confirm & close")){try{await ib(u.id),d(null),f(!1),h("Datasheet confirmed","success")}catch(w){console.error("Confirm & Close failed",w),h("Failed to confirm datasheet","error")}s();return}t(A),s()};return _.jsxs("div",{className:"grid-in-chat-input p-3 bg-white border-t border-white",style:{borderLeft:"1px solid #e5e7eb"},children:[_.jsx(hD,{}),_.jsx("div",{className:"flex justify-between items-center mt-2 mb-2",children:_.jsx(fD,{})}),_.jsxs("div",{className:"relative",children:[_.jsx("textarea",{value:p?a:n,onChange:A=>e(A.target.value),onKeyDown:A=>{A.key==="Enter"&&!A.shiftKey&&(A.preventDefault(),g())},placeholder:p?"Listening...":y?"Echo is speaking...":"Ask Echo to do something...",className:"w-full h-full p-2 border border-gray-300 rounded bg-white text-black placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none pr-24",rows:2,readOnly:p||y}),_.jsxs("div",{className:"absolute right-2 bottom-2 flex gap-2",children:[_.jsx(dD,{}),_.jsx("button",{onClick:()=>{p?o():r()},className:`p-2 rounded-md ${p?"bg-red-600 text-white":"bg-gray-100"}`,"aria-label":"Record voice command",disabled:c||y,children:y?_.jsx(KP,{className:"h-5 w-5 animate-pulse"}):_.jsx(fR,{className:"h-5 w-5"})}),_.jsx("button",{onClick:()=>void g(),disabled:c||p||y,className:"p-2 bg-blue-600 rounded-md hover:bg-blue-700 disabled:opacity-50 text-white","aria-label":"Send message",children:_.jsx(xR,{className:"h-5 w-5"})})]})]})]})},gD=()=>{const{voiceOutputEnabled:n,toggleVoiceOutput:e,isContinuousConversation:t,toggleContinuousConversation:s}=$();return _.jsxs("div",{className:"p-4 border-t border-gray-200",children:[_.jsxs("div",{className:"flex justify-between items-center gap-4",children:[_.jsxs("div",{className:"flex items-center space-x-2",children:[_.jsx("input",{id:"voice-output",type:"checkbox",className:"form-checkbox",checked:n,onChange:e}),_.jsx("label",{htmlFor:"voice-output",className:"text-sm font-medium",children:"Voice Output"})]}),_.jsxs("div",{className:"flex items-center space-x-2",children:[_.jsx("input",{id:"continuous-conversation",type:"checkbox",className:"form-checkbox",checked:t,onChange:s}),_.jsx("label",{htmlFor:"continuous-conversation",className:"text-sm font-medium",children:"Continuous Conversation"})]})]}),_.jsx("p",{className:"mt-4 text-xs text-gray-500",children:"OriginFlow is a prototype. Responses may be inaccurate."})]})},mD=()=>{const n=$(s=>s.voiceMode),e=$(s=>s.stopListening),t=$(s=>s.updateVoiceTranscript);return P.useEffect(()=>{const s=window.SpeechRecognition||window.webkitSpeechRecognition;if(!s){console.warn("SpeechRecognition API not supported in this browser.");return}const i=new s;if(i.continuous=!0,i.interimResults=!0,i.lang="en-US",i.onresult=r=>{let o="",a="";for(let c=r.resultIndex;c<r.results.length;++c){const u=r.results[c][0].transcript;r.results[c].isFinal?o+=u:a+=u}if(a&&t(a),o){const c=o.trim().toLowerCase();if(c==="stop listening"||c==="stop"){e();return}e(c)}},i.onerror=()=>{n==="listening"&&e()},n==="listening")try{i.start()}catch{}else i.stop();return()=>{i.stop()}},[n,e,t]),null},yD=()=>{const n=$(a=>a.messages),e=$(a=>a.voiceOutputEnabled),t=$(a=>a.isContinuousConversation),s=$(a=>a.startListening),i=$(a=>a.stopListening),r=$(a=>a.setVoiceMode),o=P.useRef(null);return P.useEffect(()=>{if(!e||n.length===0)return;const a=n[n.length-1];if(a.author!=="AI"||o.current===a.id)return;const c=window.speechSynthesis;if(!c)return;i(),r("speaking");const u=a.summary||a.text,d=new SpeechSynthesisUtterance(u);d.onend=()=>{t?s():r("idle")},c.speak(d),o.current=a.id},[n,e,t,s,i,r]),null},vD=()=>{const[n,e]=P.useState(!1),t=$(i=>i.isSubNavVisible),s=$(i=>i.toggleSubNav);return _.jsxs(_.Fragment,{children:[_.jsx(mD,{}),_.jsx(yD,{}),_.jsxs("div",{className:"grid h-screen w-screen min-h-0 transition-all duration-300 ease-in-out",style:{gridTemplateColumns:`${n?"64px":"250px"} 1fr 350px`,gridTemplateRows:`64px ${t?"48px":"0px"} 1fr auto 48px`,gridTemplateAreas:`
          "sidebar-header header      chat-history"
          "sidebar        toolbar     chat-history"
          "sidebar        main        chat-history"
          "sidebar        main        chat-input"
          "sidebar-footer status      chat-footer"
        `},children:[_.jsx(JM,{isCollapsed:n}),_.jsx(MR,{toggleSidebar:()=>e(!n),toggleToolbar:s}),t&&_.jsx(sD,{}),_.jsx(QM,{isCollapsed:n}),_.jsx("div",{className:"grid-in-main relative min-h-0 overflow-auto bg-gray-50",children:_.jsx(XM,{})}),_.jsx(cD,{}),_.jsx(pD,{}),_.jsx(gD,{}),_.jsx(ZM,{isCollapsed:n}),_.jsx(tD,{})]})]})},wD=({items:n,onClose:e})=>_.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center",children:_.jsxs("div",{className:"bg-white p-4 rounded",children:[_.jsx("h2",{className:"font-bold mb-2",children:"Bill of Materials"}),_.jsx("ul",{className:"list-disc pl-6 max-h-60 overflow-auto",children:n.map(t=>_.jsx("li",{children:t},t))}),_.jsx("button",{className:"mt-4 btn",onClick:e,children:"Close"})]})}),bD=()=>{const{bomItems:n,setBom:e,loadUploads:t,addComponent:s,updateComponentPosition:i,updateUpload:r,setActiveDatasheet:o,setRoute:a,addStatusMessage:c}=$(),u=qR(XR(Bw)),d=h=>{var g,A,v;const{active:f,over:p,delta:y}=h;if(p){if(p.id==="canvas-area"&&((g=f.data.current)==null?void 0:g.type)==="file-asset"){const w=f.data.current.asset;s({name:w.name,type:w.mime,standard_code:w.id});return}if(p.id==="component-canvas-area"&&((A=f.data.current)==null?void 0:A.type)==="file-asset"){const w=f.data.current.asset;if(w.parsing_status==="success"){a("components"),(async()=>{try{const E=await Bd(w.id),C=`${de}/files/${E.id}/file`;o({id:E.id,url:C,payload:E.parsed_payload})}catch(E){console.error("Failed to load parsed datasheet:",E),r(w.id,{parsing_status:"failed",parsing_error:E.message||"Failed to fetch status"}),c("Failed to load datasheet","error")}})();return}r(w.id,{parsing_status:"processing"}),a("components"),c("Parsing datasheet...","info"),Mw(w.id).catch(E=>{r(w.id,{parsing_status:"failed",parsing_error:E.message}),c("Datasheet parsing failed","error")});const b=setInterval(async()=>{try{const E=await Bd(w.id);if(E.parsing_status==="success"){clearInterval(b),r(w.id,{parsing_status:"success",parsing_error:null});const C=`${de}/files/${E.id}/file`;o({id:E.id,url:C,payload:E.parsed_payload}),c("Datasheet parsed successfully","success")}else E.parsing_status==="failed"&&(clearInterval(b),r(w.id,{parsing_status:"failed",parsing_error:E.parsing_error}),c("Datasheet parsing failed","error"))}catch(E){clearInterval(b),r(w.id,{parsing_status:"failed",parsing_error:E.message||"Failed to fetch status"}),c("Datasheet parsing failed","error")}},2e3);return}((v=f.data.current)==null?void 0:v.type)==="canvas-card"&&i(f.id,{x:y.x,y:y.y})}};return P.useEffect(()=>{t()},[t]),_.jsx(K2,{sensors:u,onDragEnd:d,children:_.jsxs("div",{className:"App h-full",children:[_.jsx(vD,{}),n&&_.jsx(wD,{items:n,onClose:()=>e(null)})]})})},xD="/assets/pdf.worker.min-CsnNCGNt.mjs";gs.workerSrc=xD;const pS=document.getElementById("root"),gS=pS?_y.createRoot(pS):null;gS&&gS.render(_.jsx(an.StrictMode,{children:_.jsx(bD,{})}));

var CC=Object.defineProperty;var lb=n=>{throw TypeError(n)};var kC=(n,e,t)=>e in n?CC(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var F=(n,e,t)=>kC(n,typeof e!="symbol"?e+"":e,t),Im=(n,e,t)=>e.has(n)||lb("Cannot "+t);var l=(n,e,t)=>(Im(n,e,"read from private field"),t?t.call(n):e.get(n)),A=(n,e,t)=>e.has(n)?lb("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),y=(n,e,t,s)=>(Im(n,e,"write to private field"),s?s.call(n,t):e.set(n,t),t),S=(n,e,t)=>(Im(n,e,"access private method"),t);var Qt=(n,e,t,s)=>({set _(i){y(n,e,i,t)},get _(){return l(n,e,s)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=t(i);fetch(i.href,r)}})();function O0(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var fS={exports:{}},nm={},pS={exports:{}},ce={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sf=Symbol.for("react.element"),TC=Symbol.for("react.portal"),RC=Symbol.for("react.fragment"),PC=Symbol.for("react.strict_mode"),LC=Symbol.for("react.profiler"),MC=Symbol.for("react.provider"),DC=Symbol.for("react.context"),NC=Symbol.for("react.forward_ref"),IC=Symbol.for("react.suspense"),OC=Symbol.for("react.memo"),FC=Symbol.for("react.lazy"),cb=Symbol.iterator;function jC(n){return n===null||typeof n!="object"?null:(n=cb&&n[cb]||n["@@iterator"],typeof n=="function"?n:null)}var gS={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},mS=Object.assign,yS={};function bu(n,e,t){this.props=n,this.context=e,this.refs=yS,this.updater=t||gS}bu.prototype.isReactComponent={};bu.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};bu.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function vS(){}vS.prototype=bu.prototype;function F0(n,e,t){this.props=n,this.context=e,this.refs=yS,this.updater=t||gS}var j0=F0.prototype=new vS;j0.constructor=F0;mS(j0,bu.prototype);j0.isPureReactComponent=!0;var ub=Array.isArray,wS=Object.prototype.hasOwnProperty,z0={current:null},bS={key:!0,ref:!0,__self:!0,__source:!0};function AS(n,e,t){var s,i={},r=null,o=null;if(e!=null)for(s in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(r=""+e.key),e)wS.call(e,s)&&!bS.hasOwnProperty(s)&&(i[s]=e[s]);var a=arguments.length-2;if(a===1)i.children=t;else if(1<a){for(var c=Array(a),u=0;u<a;u++)c[u]=arguments[u+2];i.children=c}if(n&&n.defaultProps)for(s in a=n.defaultProps,a)i[s]===void 0&&(i[s]=a[s]);return{$$typeof:Sf,type:n,key:r,ref:o,props:i,_owner:z0.current}}function zC(n,e){return{$$typeof:Sf,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function B0(n){return typeof n=="object"&&n!==null&&n.$$typeof===Sf}function BC(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var db=/\/+/g;function Om(n,e){return typeof n=="object"&&n!==null&&n.key!=null?BC(""+n.key):e.toString(36)}function dp(n,e,t,s,i){var r=typeof n;(r==="undefined"||r==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(r){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case Sf:case TC:o=!0}}if(o)return o=n,i=i(o),n=s===""?"."+Om(o,0):s,ub(i)?(t="",n!=null&&(t=n.replace(db,"$&/")+"/"),dp(i,e,t,"",function(u){return u})):i!=null&&(B0(i)&&(i=zC(i,t+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(db,"$&/")+"/")+n)),e.push(i)),1;if(o=0,s=s===""?".":s+":",ub(n))for(var a=0;a<n.length;a++){r=n[a];var c=s+Om(r,a);o+=dp(r,e,t,c,i)}else if(c=jC(n),typeof c=="function")for(n=c.call(n),a=0;!(r=n.next()).done;)r=r.value,c=s+Om(r,a++),o+=dp(r,e,t,c,i);else if(r==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function $f(n,e,t){if(n==null)return n;var s=[],i=0;return dp(n,s,"","",function(r){return e.call(t,r,i++)}),s}function $C(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var un={current:null},hp={transition:null},HC={ReactCurrentDispatcher:un,ReactCurrentBatchConfig:hp,ReactCurrentOwner:z0};function SS(){throw Error("act(...) is not supported in production builds of React.")}ce.Children={map:$f,forEach:function(n,e,t){$f(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return $f(n,function(){e++}),e},toArray:function(n){return $f(n,function(e){return e})||[]},only:function(n){if(!B0(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};ce.Component=bu;ce.Fragment=RC;ce.Profiler=LC;ce.PureComponent=F0;ce.StrictMode=PC;ce.Suspense=IC;ce.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=HC;ce.act=SS;ce.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var s=mS({},n.props),i=n.key,r=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(r=e.ref,o=z0.current),e.key!==void 0&&(i=""+e.key),n.type&&n.type.defaultProps)var a=n.type.defaultProps;for(c in e)wS.call(e,c)&&!bS.hasOwnProperty(c)&&(s[c]=e[c]===void 0&&a!==void 0?a[c]:e[c])}var c=arguments.length-2;if(c===1)s.children=t;else if(1<c){a=Array(c);for(var u=0;u<c;u++)a[u]=arguments[u+2];s.children=a}return{$$typeof:Sf,type:n.type,key:i,ref:r,props:s,_owner:o}};ce.createContext=function(n){return n={$$typeof:DC,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:MC,_context:n},n.Consumer=n};ce.createElement=AS;ce.createFactory=function(n){var e=AS.bind(null,n);return e.type=n,e};ce.createRef=function(){return{current:null}};ce.forwardRef=function(n){return{$$typeof:NC,render:n}};ce.isValidElement=B0;ce.lazy=function(n){return{$$typeof:FC,_payload:{_status:-1,_result:n},_init:$C}};ce.memo=function(n,e){return{$$typeof:OC,type:n,compare:e===void 0?null:e}};ce.startTransition=function(n){var e=hp.transition;hp.transition={};try{n()}finally{hp.transition=e}};ce.unstable_act=SS;ce.useCallback=function(n,e){return un.current.useCallback(n,e)};ce.useContext=function(n){return un.current.useContext(n)};ce.useDebugValue=function(){};ce.useDeferredValue=function(n){return un.current.useDeferredValue(n)};ce.useEffect=function(n,e){return un.current.useEffect(n,e)};ce.useId=function(){return un.current.useId()};ce.useImperativeHandle=function(n,e,t){return un.current.useImperativeHandle(n,e,t)};ce.useInsertionEffect=function(n,e){return un.current.useInsertionEffect(n,e)};ce.useLayoutEffect=function(n,e){return un.current.useLayoutEffect(n,e)};ce.useMemo=function(n,e){return un.current.useMemo(n,e)};ce.useReducer=function(n,e,t){return un.current.useReducer(n,e,t)};ce.useRef=function(n){return un.current.useRef(n)};ce.useState=function(n){return un.current.useState(n)};ce.useSyncExternalStore=function(n,e,t){return un.current.useSyncExternalStore(n,e,t)};ce.useTransition=function(){return un.current.useTransition()};ce.version="18.3.1";pS.exports=ce;var R=pS.exports;const on=O0(R);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var UC=R,VC=Symbol.for("react.element"),GC=Symbol.for("react.fragment"),WC=Object.prototype.hasOwnProperty,XC=UC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,YC={key:!0,ref:!0,__self:!0,__source:!0};function ES(n,e,t){var s,i={},r=null,o=null;t!==void 0&&(r=""+t),e.key!==void 0&&(r=""+e.key),e.ref!==void 0&&(o=e.ref);for(s in e)WC.call(e,s)&&!YC.hasOwnProperty(s)&&(i[s]=e[s]);if(n&&n.defaultProps)for(s in e=n.defaultProps,e)i[s]===void 0&&(i[s]=e[s]);return{$$typeof:VC,type:n,key:r,ref:o,props:i,_owner:XC.current}}nm.Fragment=GC;nm.jsx=ES;nm.jsxs=ES;fS.exports=nm;var P=fS.exports,Sy={},xS={exports:{}},Zn={},_S={exports:{}},CS={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(I,$){var X=I.length;I.push($);e:for(;0<X;){var re=X-1>>>1,Q=I[re];if(0<i(Q,$))I[re]=$,I[X]=Q,X=re;else break e}}function t(I){return I.length===0?null:I[0]}function s(I){if(I.length===0)return null;var $=I[0],X=I.pop();if(X!==$){I[0]=X;e:for(var re=0,Q=I.length,oe=Q>>>1;re<oe;){var Re=2*(re+1)-1,We=I[Re],he=Re+1,fe=I[he];if(0>i(We,X))he<Q&&0>i(fe,We)?(I[re]=fe,I[he]=X,re=he):(I[re]=We,I[Re]=X,re=Re);else if(he<Q&&0>i(fe,X))I[re]=fe,I[he]=X,re=he;else break e}}return $}function i(I,$){var X=I.sortIndex-$.sortIndex;return X!==0?X:I.id-$.id}if(typeof performance=="object"&&typeof performance.now=="function"){var r=performance;n.unstable_now=function(){return r.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var c=[],u=[],d=1,h=null,f=3,p=!1,w=!1,g=!1,E=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(I){for(var $=t(u);$!==null;){if($.callback===null)s(u);else if($.startTime<=I)s(u),$.sortIndex=$.expirationTime,e(c,$);else break;$=t(u)}}function x(I){if(g=!1,b(I),!w)if(t(c)!==null)w=!0,j(_);else{var $=t(u);$!==null&&O(x,$.startTime-I)}}function _(I,$){w=!1,g&&(g=!1,m(T),T=-1),p=!0;var X=f;try{for(b($),h=t(c);h!==null&&(!(h.expirationTime>$)||I&&!D());){var re=h.callback;if(typeof re=="function"){h.callback=null,f=h.priorityLevel;var Q=re(h.expirationTime<=$);$=n.unstable_now(),typeof Q=="function"?h.callback=Q:h===t(c)&&s(c),b($)}else s(c);h=t(c)}if(h!==null)var oe=!0;else{var Re=t(u);Re!==null&&O(x,Re.startTime-$),oe=!1}return oe}finally{h=null,f=X,p=!1}}var k=!1,C=null,T=-1,L=5,M=-1;function D(){return!(n.unstable_now()-M<L)}function q(){if(C!==null){var I=n.unstable_now();M=I;var $=!0;try{$=C(!0,I)}finally{$?K():(k=!1,C=null)}}else k=!1}var K;if(typeof v=="function")K=function(){v(q)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,ee=G.port2;G.port1.onmessage=q,K=function(){ee.postMessage(null)}}else K=function(){E(q,0)};function j(I){C=I,k||(k=!0,K())}function O(I,$){T=E(function(){I(n.unstable_now())},$)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(I){I.callback=null},n.unstable_continueExecution=function(){w||p||(w=!0,j(_))},n.unstable_forceFrameRate=function(I){0>I||125<I?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<I?Math.floor(1e3/I):5},n.unstable_getCurrentPriorityLevel=function(){return f},n.unstable_getFirstCallbackNode=function(){return t(c)},n.unstable_next=function(I){switch(f){case 1:case 2:case 3:var $=3;break;default:$=f}var X=f;f=$;try{return I()}finally{f=X}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(I,$){switch(I){case 1:case 2:case 3:case 4:case 5:break;default:I=3}var X=f;f=I;try{return $()}finally{f=X}},n.unstable_scheduleCallback=function(I,$,X){var re=n.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?re+X:re):X=re,I){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=X+Q,I={id:d++,callback:$,priorityLevel:I,startTime:X,expirationTime:Q,sortIndex:-1},X>re?(I.sortIndex=X,e(u,I),t(c)===null&&I===t(u)&&(g?(m(T),T=-1):g=!0,O(x,X-re))):(I.sortIndex=Q,e(c,I),w||p||(w=!0,j(_))),I},n.unstable_shouldYield=D,n.unstable_wrapCallback=function(I){var $=f;return function(){var X=f;f=$;try{return I.apply(this,arguments)}finally{f=X}}}})(CS);_S.exports=CS;var qC=_S.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var KC=R,Jn=qC;function N(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var kS=new Set,Ed={};function ml(n,e){uu(n,e),uu(n+"Capture",e)}function uu(n,e){for(Ed[n]=e,n=0;n<e.length;n++)kS.add(e[n])}var wr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ey=Object.prototype.hasOwnProperty,QC=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,hb={},fb={};function JC(n){return Ey.call(fb,n)?!0:Ey.call(hb,n)?!1:QC.test(n)?fb[n]=!0:(hb[n]=!0,!1)}function ZC(n,e,t,s){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function ek(n,e,t,s){if(e===null||typeof e>"u"||ZC(n,e,t,s))return!0;if(s)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function dn(n,e,t,s,i,r,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=i,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=r,this.removeEmptyString=o}var Ft={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){Ft[n]=new dn(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];Ft[e]=new dn(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){Ft[n]=new dn(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){Ft[n]=new dn(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){Ft[n]=new dn(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){Ft[n]=new dn(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){Ft[n]=new dn(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){Ft[n]=new dn(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){Ft[n]=new dn(n,5,!1,n.toLowerCase(),null,!1,!1)});var $0=/[\-:]([a-z])/g;function H0(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace($0,H0);Ft[e]=new dn(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace($0,H0);Ft[e]=new dn(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace($0,H0);Ft[e]=new dn(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){Ft[n]=new dn(n,1,!1,n.toLowerCase(),null,!1,!1)});Ft.xlinkHref=new dn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){Ft[n]=new dn(n,1,!1,n.toLowerCase(),null,!0,!0)});function U0(n,e,t,s){var i=Ft.hasOwnProperty(e)?Ft[e]:null;(i!==null?i.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(ek(e,t,i,s)&&(t=null),s||i===null?JC(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):i.mustUseProperty?n[i.propertyName]=t===null?i.type===3?!1:"":t:(e=i.attributeName,s=i.attributeNamespace,t===null?n.removeAttribute(e):(i=i.type,t=i===3||i===4&&t===!0?"":""+t,s?n.setAttributeNS(s,e,t):n.setAttribute(e,t))))}var Cr=KC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Hf=Symbol.for("react.element"),Ll=Symbol.for("react.portal"),Ml=Symbol.for("react.fragment"),V0=Symbol.for("react.strict_mode"),xy=Symbol.for("react.profiler"),TS=Symbol.for("react.provider"),RS=Symbol.for("react.context"),G0=Symbol.for("react.forward_ref"),_y=Symbol.for("react.suspense"),Cy=Symbol.for("react.suspense_list"),W0=Symbol.for("react.memo"),Dr=Symbol.for("react.lazy"),PS=Symbol.for("react.offscreen"),pb=Symbol.iterator;function Ru(n){return n===null||typeof n!="object"?null:(n=pb&&n[pb]||n["@@iterator"],typeof n=="function"?n:null)}var Ge=Object.assign,Fm;function $u(n){if(Fm===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);Fm=e&&e[1]||""}return`
`+Fm+n}var jm=!1;function zm(n,e){if(!n||jm)return"";jm=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var s=u}Reflect.construct(n,[],e)}else{try{e.call()}catch(u){s=u}n.call(e.prototype)}else{try{throw Error()}catch(u){s=u}n()}}catch(u){if(u&&s&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),r=s.stack.split(`
`),o=i.length-1,a=r.length-1;1<=o&&0<=a&&i[o]!==r[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==r[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==r[a]){var c=`
`+i[o].replace(" at new "," at ");return n.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",n.displayName)),c}while(1<=o&&0<=a);break}}}finally{jm=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?$u(n):""}function tk(n){switch(n.tag){case 5:return $u(n.type);case 16:return $u("Lazy");case 13:return $u("Suspense");case 19:return $u("SuspenseList");case 0:case 2:case 15:return n=zm(n.type,!1),n;case 11:return n=zm(n.type.render,!1),n;case 1:return n=zm(n.type,!0),n;default:return""}}function ky(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Ml:return"Fragment";case Ll:return"Portal";case xy:return"Profiler";case V0:return"StrictMode";case _y:return"Suspense";case Cy:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case RS:return(n.displayName||"Context")+".Consumer";case TS:return(n._context.displayName||"Context")+".Provider";case G0:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case W0:return e=n.displayName||null,e!==null?e:ky(n.type)||"Memo";case Dr:e=n._payload,n=n._init;try{return ky(n(e))}catch{}}return null}function nk(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ky(e);case 8:return e===V0?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Mo(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function LS(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function sk(n){var e=LS(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),s=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var i=t.get,r=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){s=""+o,r.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return s},setValue:function(o){s=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function Uf(n){n._valueTracker||(n._valueTracker=sk(n))}function MS(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),s="";return n&&(s=LS(n)?n.checked?"true":"false":n.value),n=s,n!==t?(e.setValue(n),!0):!1}function eg(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function Ty(n,e){var t=e.checked;return Ge({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function gb(n,e){var t=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;t=Mo(e.value!=null?e.value:t),n._wrapperState={initialChecked:s,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function DS(n,e){e=e.checked,e!=null&&U0(n,"checked",e,!1)}function Ry(n,e){DS(n,e);var t=Mo(e.value),s=e.type;if(t!=null)s==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(s==="submit"||s==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?Py(n,e.type,t):e.hasOwnProperty("defaultValue")&&Py(n,e.type,Mo(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function mb(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function Py(n,e,t){(e!=="number"||eg(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var Hu=Array.isArray;function Xl(n,e,t,s){if(n=n.options,e){e={};for(var i=0;i<t.length;i++)e["$"+t[i]]=!0;for(t=0;t<n.length;t++)i=e.hasOwnProperty("$"+n[t].value),n[t].selected!==i&&(n[t].selected=i),i&&s&&(n[t].defaultSelected=!0)}else{for(t=""+Mo(t),e=null,i=0;i<n.length;i++){if(n[i].value===t){n[i].selected=!0,s&&(n[i].defaultSelected=!0);return}e!==null||n[i].disabled||(e=n[i])}e!==null&&(e.selected=!0)}}function Ly(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(N(91));return Ge({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function yb(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(N(92));if(Hu(t)){if(1<t.length)throw Error(N(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:Mo(t)}}function NS(n,e){var t=Mo(e.value),s=Mo(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),s!=null&&(n.defaultValue=""+s)}function vb(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function IS(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function My(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?IS(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Vf,OS=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,s,i){MSApp.execUnsafeLocalFunction(function(){return n(e,t,s,i)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(Vf=Vf||document.createElement("div"),Vf.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Vf.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function xd(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var ud={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ik=["Webkit","ms","Moz","O"];Object.keys(ud).forEach(function(n){ik.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),ud[e]=ud[n]})});function FS(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||ud.hasOwnProperty(n)&&ud[n]?(""+e).trim():e+"px"}function jS(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var s=t.indexOf("--")===0,i=FS(t,e[t],s);t==="float"&&(t="cssFloat"),s?n.setProperty(t,i):n[t]=i}}var rk=Ge({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Dy(n,e){if(e){if(rk[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(N(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(N(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(N(61))}if(e.style!=null&&typeof e.style!="object")throw Error(N(62))}}function Ny(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Iy=null;function X0(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Oy=null,Yl=null,ql=null;function wb(n){if(n=_f(n)){if(typeof Oy!="function")throw Error(N(280));var e=n.stateNode;e&&(e=am(e),Oy(n.stateNode,n.type,e))}}function zS(n){Yl?ql?ql.push(n):ql=[n]:Yl=n}function BS(){if(Yl){var n=Yl,e=ql;if(ql=Yl=null,wb(n),e)for(n=0;n<e.length;n++)wb(e[n])}}function $S(n,e){return n(e)}function HS(){}var Bm=!1;function US(n,e,t){if(Bm)return n(e,t);Bm=!0;try{return $S(n,e,t)}finally{Bm=!1,(Yl!==null||ql!==null)&&(HS(),BS())}}function _d(n,e){var t=n.stateNode;if(t===null)return null;var s=am(t);if(s===null)return null;t=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(n=n.type,s=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!s;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(N(231,e,typeof t));return t}var Fy=!1;if(wr)try{var Pu={};Object.defineProperty(Pu,"passive",{get:function(){Fy=!0}}),window.addEventListener("test",Pu,Pu),window.removeEventListener("test",Pu,Pu)}catch{Fy=!1}function ok(n,e,t,s,i,r,o,a,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(t,u)}catch(d){this.onError(d)}}var dd=!1,tg=null,ng=!1,jy=null,ak={onError:function(n){dd=!0,tg=n}};function lk(n,e,t,s,i,r,o,a,c){dd=!1,tg=null,ok.apply(ak,arguments)}function ck(n,e,t,s,i,r,o,a,c){if(lk.apply(this,arguments),dd){if(dd){var u=tg;dd=!1,tg=null}else throw Error(N(198));ng||(ng=!0,jy=u)}}function yl(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function VS(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function bb(n){if(yl(n)!==n)throw Error(N(188))}function uk(n){var e=n.alternate;if(!e){if(e=yl(n),e===null)throw Error(N(188));return e!==n?null:n}for(var t=n,s=e;;){var i=t.return;if(i===null)break;var r=i.alternate;if(r===null){if(s=i.return,s!==null){t=s;continue}break}if(i.child===r.child){for(r=i.child;r;){if(r===t)return bb(i),n;if(r===s)return bb(i),e;r=r.sibling}throw Error(N(188))}if(t.return!==s.return)t=i,s=r;else{for(var o=!1,a=i.child;a;){if(a===t){o=!0,t=i,s=r;break}if(a===s){o=!0,s=i,t=r;break}a=a.sibling}if(!o){for(a=r.child;a;){if(a===t){o=!0,t=r,s=i;break}if(a===s){o=!0,s=r,t=i;break}a=a.sibling}if(!o)throw Error(N(189))}}if(t.alternate!==s)throw Error(N(190))}if(t.tag!==3)throw Error(N(188));return t.stateNode.current===t?n:e}function GS(n){return n=uk(n),n!==null?WS(n):null}function WS(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=WS(n);if(e!==null)return e;n=n.sibling}return null}var XS=Jn.unstable_scheduleCallback,Ab=Jn.unstable_cancelCallback,dk=Jn.unstable_shouldYield,hk=Jn.unstable_requestPaint,et=Jn.unstable_now,fk=Jn.unstable_getCurrentPriorityLevel,Y0=Jn.unstable_ImmediatePriority,YS=Jn.unstable_UserBlockingPriority,sg=Jn.unstable_NormalPriority,pk=Jn.unstable_LowPriority,qS=Jn.unstable_IdlePriority,sm=null,Ei=null;function gk(n){if(Ei&&typeof Ei.onCommitFiberRoot=="function")try{Ei.onCommitFiberRoot(sm,n,void 0,(n.current.flags&128)===128)}catch{}}var Us=Math.clz32?Math.clz32:vk,mk=Math.log,yk=Math.LN2;function vk(n){return n>>>=0,n===0?32:31-(mk(n)/yk|0)|0}var Gf=64,Wf=4194304;function Uu(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function ig(n,e){var t=n.pendingLanes;if(t===0)return 0;var s=0,i=n.suspendedLanes,r=n.pingedLanes,o=t&268435455;if(o!==0){var a=o&~i;a!==0?s=Uu(a):(r&=o,r!==0&&(s=Uu(r)))}else o=t&~i,o!==0?s=Uu(o):r!==0&&(s=Uu(r));if(s===0)return 0;if(e!==0&&e!==s&&!(e&i)&&(i=s&-s,r=e&-e,i>=r||i===16&&(r&4194240)!==0))return e;if(s&4&&(s|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=s;0<e;)t=31-Us(e),i=1<<t,s|=n[t],e&=~i;return s}function wk(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function bk(n,e){for(var t=n.suspendedLanes,s=n.pingedLanes,i=n.expirationTimes,r=n.pendingLanes;0<r;){var o=31-Us(r),a=1<<o,c=i[o];c===-1?(!(a&t)||a&s)&&(i[o]=wk(a,e)):c<=e&&(n.expiredLanes|=a),r&=~a}}function zy(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function KS(){var n=Gf;return Gf<<=1,!(Gf&4194240)&&(Gf=64),n}function $m(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function Ef(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-Us(e),n[e]=t}function Ak(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var s=n.eventTimes;for(n=n.expirationTimes;0<t;){var i=31-Us(t),r=1<<i;e[i]=0,s[i]=-1,n[i]=-1,t&=~r}}function q0(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var s=31-Us(t),i=1<<s;i&e|n[s]&e&&(n[s]|=e),t&=~i}}var Ae=0;function QS(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var JS,K0,ZS,eE,tE,By=!1,Xf=[],xo=null,_o=null,Co=null,Cd=new Map,kd=new Map,Or=[],Sk="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sb(n,e){switch(n){case"focusin":case"focusout":xo=null;break;case"dragenter":case"dragleave":_o=null;break;case"mouseover":case"mouseout":Co=null;break;case"pointerover":case"pointerout":Cd.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":kd.delete(e.pointerId)}}function Lu(n,e,t,s,i,r){return n===null||n.nativeEvent!==r?(n={blockedOn:e,domEventName:t,eventSystemFlags:s,nativeEvent:r,targetContainers:[i]},e!==null&&(e=_f(e),e!==null&&K0(e)),n):(n.eventSystemFlags|=s,e=n.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),n)}function Ek(n,e,t,s,i){switch(e){case"focusin":return xo=Lu(xo,n,e,t,s,i),!0;case"dragenter":return _o=Lu(_o,n,e,t,s,i),!0;case"mouseover":return Co=Lu(Co,n,e,t,s,i),!0;case"pointerover":var r=i.pointerId;return Cd.set(r,Lu(Cd.get(r)||null,n,e,t,s,i)),!0;case"gotpointercapture":return r=i.pointerId,kd.set(r,Lu(kd.get(r)||null,n,e,t,s,i)),!0}return!1}function nE(n){var e=Qo(n.target);if(e!==null){var t=yl(e);if(t!==null){if(e=t.tag,e===13){if(e=VS(t),e!==null){n.blockedOn=e,tE(n.priority,function(){ZS(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function fp(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=$y(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var s=new t.constructor(t.type,t);Iy=s,t.target.dispatchEvent(s),Iy=null}else return e=_f(t),e!==null&&K0(e),n.blockedOn=t,!1;e.shift()}return!0}function Eb(n,e,t){fp(n)&&t.delete(e)}function xk(){By=!1,xo!==null&&fp(xo)&&(xo=null),_o!==null&&fp(_o)&&(_o=null),Co!==null&&fp(Co)&&(Co=null),Cd.forEach(Eb),kd.forEach(Eb)}function Mu(n,e){n.blockedOn===e&&(n.blockedOn=null,By||(By=!0,Jn.unstable_scheduleCallback(Jn.unstable_NormalPriority,xk)))}function Td(n){function e(i){return Mu(i,n)}if(0<Xf.length){Mu(Xf[0],n);for(var t=1;t<Xf.length;t++){var s=Xf[t];s.blockedOn===n&&(s.blockedOn=null)}}for(xo!==null&&Mu(xo,n),_o!==null&&Mu(_o,n),Co!==null&&Mu(Co,n),Cd.forEach(e),kd.forEach(e),t=0;t<Or.length;t++)s=Or[t],s.blockedOn===n&&(s.blockedOn=null);for(;0<Or.length&&(t=Or[0],t.blockedOn===null);)nE(t),t.blockedOn===null&&Or.shift()}var Kl=Cr.ReactCurrentBatchConfig,rg=!0;function _k(n,e,t,s){var i=Ae,r=Kl.transition;Kl.transition=null;try{Ae=1,Q0(n,e,t,s)}finally{Ae=i,Kl.transition=r}}function Ck(n,e,t,s){var i=Ae,r=Kl.transition;Kl.transition=null;try{Ae=4,Q0(n,e,t,s)}finally{Ae=i,Kl.transition=r}}function Q0(n,e,t,s){if(rg){var i=$y(n,e,t,s);if(i===null)Qm(n,e,s,og,t),Sb(n,s);else if(Ek(i,n,e,t,s))s.stopPropagation();else if(Sb(n,s),e&4&&-1<Sk.indexOf(n)){for(;i!==null;){var r=_f(i);if(r!==null&&JS(r),r=$y(n,e,t,s),r===null&&Qm(n,e,s,og,t),r===i)break;i=r}i!==null&&s.stopPropagation()}else Qm(n,e,s,null,t)}}var og=null;function $y(n,e,t,s){if(og=null,n=X0(s),n=Qo(n),n!==null)if(e=yl(n),e===null)n=null;else if(t=e.tag,t===13){if(n=VS(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return og=n,null}function sE(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(fk()){case Y0:return 1;case YS:return 4;case sg:case pk:return 16;case qS:return 536870912;default:return 16}default:return 16}}var So=null,J0=null,pp=null;function iE(){if(pp)return pp;var n,e=J0,t=e.length,s,i="value"in So?So.value:So.textContent,r=i.length;for(n=0;n<t&&e[n]===i[n];n++);var o=t-n;for(s=1;s<=o&&e[t-s]===i[r-s];s++);return pp=i.slice(n,1<s?1-s:void 0)}function gp(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function Yf(){return!0}function xb(){return!1}function es(n){function e(t,s,i,r,o){this._reactName=t,this._targetInst=i,this.type=s,this.nativeEvent=r,this.target=o,this.currentTarget=null;for(var a in n)n.hasOwnProperty(a)&&(t=n[a],this[a]=t?t(r):r[a]);return this.isDefaultPrevented=(r.defaultPrevented!=null?r.defaultPrevented:r.returnValue===!1)?Yf:xb,this.isPropagationStopped=xb,this}return Ge(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Yf)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Yf)},persist:function(){},isPersistent:Yf}),e}var Au={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Z0=es(Au),xf=Ge({},Au,{view:0,detail:0}),kk=es(xf),Hm,Um,Du,im=Ge({},xf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ew,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Du&&(Du&&n.type==="mousemove"?(Hm=n.screenX-Du.screenX,Um=n.screenY-Du.screenY):Um=Hm=0,Du=n),Hm)},movementY:function(n){return"movementY"in n?n.movementY:Um}}),_b=es(im),Tk=Ge({},im,{dataTransfer:0}),Rk=es(Tk),Pk=Ge({},xf,{relatedTarget:0}),Vm=es(Pk),Lk=Ge({},Au,{animationName:0,elapsedTime:0,pseudoElement:0}),Mk=es(Lk),Dk=Ge({},Au,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Nk=es(Dk),Ik=Ge({},Au,{data:0}),Cb=es(Ik),Ok={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Fk={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},jk={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function zk(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=jk[n])?!!e[n]:!1}function ew(){return zk}var Bk=Ge({},xf,{key:function(n){if(n.key){var e=Ok[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=gp(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Fk[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ew,charCode:function(n){return n.type==="keypress"?gp(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?gp(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),$k=es(Bk),Hk=Ge({},im,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),kb=es(Hk),Uk=Ge({},xf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ew}),Vk=es(Uk),Gk=Ge({},Au,{propertyName:0,elapsedTime:0,pseudoElement:0}),Wk=es(Gk),Xk=Ge({},im,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Yk=es(Xk),qk=[9,13,27,32],tw=wr&&"CompositionEvent"in window,hd=null;wr&&"documentMode"in document&&(hd=document.documentMode);var Kk=wr&&"TextEvent"in window&&!hd,rE=wr&&(!tw||hd&&8<hd&&11>=hd),Tb=" ",Rb=!1;function oE(n,e){switch(n){case"keyup":return qk.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function aE(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Dl=!1;function Qk(n,e){switch(n){case"compositionend":return aE(e);case"keypress":return e.which!==32?null:(Rb=!0,Tb);case"textInput":return n=e.data,n===Tb&&Rb?null:n;default:return null}}function Jk(n,e){if(Dl)return n==="compositionend"||!tw&&oE(n,e)?(n=iE(),pp=J0=So=null,Dl=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return rE&&e.locale!=="ko"?null:e.data;default:return null}}var Zk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Pb(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!Zk[n.type]:e==="textarea"}function lE(n,e,t,s){zS(s),e=ag(e,"onChange"),0<e.length&&(t=new Z0("onChange","change",null,t,s),n.push({event:t,listeners:e}))}var fd=null,Rd=null;function eT(n){wE(n,0)}function rm(n){var e=Ol(n);if(MS(e))return n}function tT(n,e){if(n==="change")return e}var cE=!1;if(wr){var Gm;if(wr){var Wm="oninput"in document;if(!Wm){var Lb=document.createElement("div");Lb.setAttribute("oninput","return;"),Wm=typeof Lb.oninput=="function"}Gm=Wm}else Gm=!1;cE=Gm&&(!document.documentMode||9<document.documentMode)}function Mb(){fd&&(fd.detachEvent("onpropertychange",uE),Rd=fd=null)}function uE(n){if(n.propertyName==="value"&&rm(Rd)){var e=[];lE(e,Rd,n,X0(n)),US(eT,e)}}function nT(n,e,t){n==="focusin"?(Mb(),fd=e,Rd=t,fd.attachEvent("onpropertychange",uE)):n==="focusout"&&Mb()}function sT(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return rm(Rd)}function iT(n,e){if(n==="click")return rm(e)}function rT(n,e){if(n==="input"||n==="change")return rm(e)}function oT(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var Gs=typeof Object.is=="function"?Object.is:oT;function Pd(n,e){if(Gs(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),s=Object.keys(e);if(t.length!==s.length)return!1;for(s=0;s<t.length;s++){var i=t[s];if(!Ey.call(e,i)||!Gs(n[i],e[i]))return!1}return!0}function Db(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Nb(n,e){var t=Db(n);n=0;for(var s;t;){if(t.nodeType===3){if(s=n+t.textContent.length,n<=e&&s>=e)return{node:t,offset:e-n};n=s}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=Db(t)}}function dE(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?dE(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function hE(){for(var n=window,e=eg();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=eg(n.document)}return e}function nw(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function aT(n){var e=hE(),t=n.focusedElem,s=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&dE(t.ownerDocument.documentElement,t)){if(s!==null&&nw(t)){if(e=s.start,n=s.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var i=t.textContent.length,r=Math.min(s.start,i);s=s.end===void 0?r:Math.min(s.end,i),!n.extend&&r>s&&(i=s,s=r,r=i),i=Nb(t,r);var o=Nb(t,s);i&&o&&(n.rangeCount!==1||n.anchorNode!==i.node||n.anchorOffset!==i.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),n.removeAllRanges(),r>s?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var lT=wr&&"documentMode"in document&&11>=document.documentMode,Nl=null,Hy=null,pd=null,Uy=!1;function Ib(n,e,t){var s=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;Uy||Nl==null||Nl!==eg(s)||(s=Nl,"selectionStart"in s&&nw(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),pd&&Pd(pd,s)||(pd=s,s=ag(Hy,"onSelect"),0<s.length&&(e=new Z0("onSelect","select",null,e,t),n.push({event:e,listeners:s}),e.target=Nl)))}function qf(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var Il={animationend:qf("Animation","AnimationEnd"),animationiteration:qf("Animation","AnimationIteration"),animationstart:qf("Animation","AnimationStart"),transitionend:qf("Transition","TransitionEnd")},Xm={},fE={};wr&&(fE=document.createElement("div").style,"AnimationEvent"in window||(delete Il.animationend.animation,delete Il.animationiteration.animation,delete Il.animationstart.animation),"TransitionEvent"in window||delete Il.transitionend.transition);function om(n){if(Xm[n])return Xm[n];if(!Il[n])return n;var e=Il[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in fE)return Xm[n]=e[t];return n}var pE=om("animationend"),gE=om("animationiteration"),mE=om("animationstart"),yE=om("transitionend"),vE=new Map,Ob="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Bo(n,e){vE.set(n,e),ml(e,[n])}for(var Ym=0;Ym<Ob.length;Ym++){var qm=Ob[Ym],cT=qm.toLowerCase(),uT=qm[0].toUpperCase()+qm.slice(1);Bo(cT,"on"+uT)}Bo(pE,"onAnimationEnd");Bo(gE,"onAnimationIteration");Bo(mE,"onAnimationStart");Bo("dblclick","onDoubleClick");Bo("focusin","onFocus");Bo("focusout","onBlur");Bo(yE,"onTransitionEnd");uu("onMouseEnter",["mouseout","mouseover"]);uu("onMouseLeave",["mouseout","mouseover"]);uu("onPointerEnter",["pointerout","pointerover"]);uu("onPointerLeave",["pointerout","pointerover"]);ml("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ml("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ml("onBeforeInput",["compositionend","keypress","textInput","paste"]);ml("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ml("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ml("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),dT=new Set("cancel close invalid load scroll toggle".split(" ").concat(Vu));function Fb(n,e,t){var s=n.type||"unknown-event";n.currentTarget=t,ck(s,e,void 0,n),n.currentTarget=null}function wE(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var s=n[t],i=s.event;s=s.listeners;e:{var r=void 0;if(e)for(var o=s.length-1;0<=o;o--){var a=s[o],c=a.instance,u=a.currentTarget;if(a=a.listener,c!==r&&i.isPropagationStopped())break e;Fb(i,a,u),r=c}else for(o=0;o<s.length;o++){if(a=s[o],c=a.instance,u=a.currentTarget,a=a.listener,c!==r&&i.isPropagationStopped())break e;Fb(i,a,u),r=c}}}if(ng)throw n=jy,ng=!1,jy=null,n}function De(n,e){var t=e[Yy];t===void 0&&(t=e[Yy]=new Set);var s=n+"__bubble";t.has(s)||(bE(e,n,2,!1),t.add(s))}function Km(n,e,t){var s=0;e&&(s|=4),bE(t,n,s,e)}var Kf="_reactListening"+Math.random().toString(36).slice(2);function Ld(n){if(!n[Kf]){n[Kf]=!0,kS.forEach(function(t){t!=="selectionchange"&&(dT.has(t)||Km(t,!1,n),Km(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[Kf]||(e[Kf]=!0,Km("selectionchange",!1,e))}}function bE(n,e,t,s){switch(sE(e)){case 1:var i=_k;break;case 4:i=Ck;break;default:i=Q0}t=i.bind(null,e,t,n),i=void 0,!Fy||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),s?i!==void 0?n.addEventListener(e,t,{capture:!0,passive:i}):n.addEventListener(e,t,!0):i!==void 0?n.addEventListener(e,t,{passive:i}):n.addEventListener(e,t,!1)}function Qm(n,e,t,s,i){var r=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var o=s.tag;if(o===3||o===4){var a=s.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=s.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Qo(a),o===null)return;if(c=o.tag,c===5||c===6){s=r=o;continue e}a=a.parentNode}}s=s.return}US(function(){var u=r,d=X0(t),h=[];e:{var f=vE.get(n);if(f!==void 0){var p=Z0,w=n;switch(n){case"keypress":if(gp(t)===0)break e;case"keydown":case"keyup":p=$k;break;case"focusin":w="focus",p=Vm;break;case"focusout":w="blur",p=Vm;break;case"beforeblur":case"afterblur":p=Vm;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=_b;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=Rk;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=Vk;break;case pE:case gE:case mE:p=Mk;break;case yE:p=Wk;break;case"scroll":p=kk;break;case"wheel":p=Yk;break;case"copy":case"cut":case"paste":p=Nk;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=kb}var g=(e&4)!==0,E=!g&&n==="scroll",m=g?f!==null?f+"Capture":null:f;g=[];for(var v=u,b;v!==null;){b=v;var x=b.stateNode;if(b.tag===5&&x!==null&&(b=x,m!==null&&(x=_d(v,m),x!=null&&g.push(Md(v,x,b)))),E)break;v=v.return}0<g.length&&(f=new p(f,w,null,t,d),h.push({event:f,listeners:g}))}}if(!(e&7)){e:{if(f=n==="mouseover"||n==="pointerover",p=n==="mouseout"||n==="pointerout",f&&t!==Iy&&(w=t.relatedTarget||t.fromElement)&&(Qo(w)||w[br]))break e;if((p||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,p?(w=t.relatedTarget||t.toElement,p=u,w=w?Qo(w):null,w!==null&&(E=yl(w),w!==E||w.tag!==5&&w.tag!==6)&&(w=null)):(p=null,w=u),p!==w)){if(g=_b,x="onMouseLeave",m="onMouseEnter",v="mouse",(n==="pointerout"||n==="pointerover")&&(g=kb,x="onPointerLeave",m="onPointerEnter",v="pointer"),E=p==null?f:Ol(p),b=w==null?f:Ol(w),f=new g(x,v+"leave",p,t,d),f.target=E,f.relatedTarget=b,x=null,Qo(d)===u&&(g=new g(m,v+"enter",w,t,d),g.target=b,g.relatedTarget=E,x=g),E=x,p&&w)t:{for(g=p,m=w,v=0,b=g;b;b=El(b))v++;for(b=0,x=m;x;x=El(x))b++;for(;0<v-b;)g=El(g),v--;for(;0<b-v;)m=El(m),b--;for(;v--;){if(g===m||m!==null&&g===m.alternate)break t;g=El(g),m=El(m)}g=null}else g=null;p!==null&&jb(h,f,p,g,!1),w!==null&&E!==null&&jb(h,E,w,g,!0)}}e:{if(f=u?Ol(u):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var _=tT;else if(Pb(f))if(cE)_=rT;else{_=sT;var k=nT}else(p=f.nodeName)&&p.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(_=iT);if(_&&(_=_(n,u))){lE(h,_,t,d);break e}k&&k(n,f,u),n==="focusout"&&(k=f._wrapperState)&&k.controlled&&f.type==="number"&&Py(f,"number",f.value)}switch(k=u?Ol(u):window,n){case"focusin":(Pb(k)||k.contentEditable==="true")&&(Nl=k,Hy=u,pd=null);break;case"focusout":pd=Hy=Nl=null;break;case"mousedown":Uy=!0;break;case"contextmenu":case"mouseup":case"dragend":Uy=!1,Ib(h,t,d);break;case"selectionchange":if(lT)break;case"keydown":case"keyup":Ib(h,t,d)}var C;if(tw)e:{switch(n){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else Dl?oE(n,t)&&(T="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(T="onCompositionStart");T&&(rE&&t.locale!=="ko"&&(Dl||T!=="onCompositionStart"?T==="onCompositionEnd"&&Dl&&(C=iE()):(So=d,J0="value"in So?So.value:So.textContent,Dl=!0)),k=ag(u,T),0<k.length&&(T=new Cb(T,n,null,t,d),h.push({event:T,listeners:k}),C?T.data=C:(C=aE(t),C!==null&&(T.data=C)))),(C=Kk?Qk(n,t):Jk(n,t))&&(u=ag(u,"onBeforeInput"),0<u.length&&(d=new Cb("onBeforeInput","beforeinput",null,t,d),h.push({event:d,listeners:u}),d.data=C))}wE(h,e)})}function Md(n,e,t){return{instance:n,listener:e,currentTarget:t}}function ag(n,e){for(var t=e+"Capture",s=[];n!==null;){var i=n,r=i.stateNode;i.tag===5&&r!==null&&(i=r,r=_d(n,t),r!=null&&s.unshift(Md(n,r,i)),r=_d(n,e),r!=null&&s.push(Md(n,r,i))),n=n.return}return s}function El(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function jb(n,e,t,s,i){for(var r=e._reactName,o=[];t!==null&&t!==s;){var a=t,c=a.alternate,u=a.stateNode;if(c!==null&&c===s)break;a.tag===5&&u!==null&&(a=u,i?(c=_d(t,r),c!=null&&o.unshift(Md(t,c,a))):i||(c=_d(t,r),c!=null&&o.push(Md(t,c,a)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var hT=/\r\n?/g,fT=/\u0000|\uFFFD/g;function zb(n){return(typeof n=="string"?n:""+n).replace(hT,`
`).replace(fT,"")}function Qf(n,e,t){if(e=zb(e),zb(n)!==e&&t)throw Error(N(425))}function lg(){}var Vy=null,Gy=null;function Wy(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Xy=typeof setTimeout=="function"?setTimeout:void 0,pT=typeof clearTimeout=="function"?clearTimeout:void 0,Bb=typeof Promise=="function"?Promise:void 0,gT=typeof queueMicrotask=="function"?queueMicrotask:typeof Bb<"u"?function(n){return Bb.resolve(null).then(n).catch(mT)}:Xy;function mT(n){setTimeout(function(){throw n})}function Jm(n,e){var t=e,s=0;do{var i=t.nextSibling;if(n.removeChild(t),i&&i.nodeType===8)if(t=i.data,t==="/$"){if(s===0){n.removeChild(i),Td(e);return}s--}else t!=="$"&&t!=="$?"&&t!=="$!"||s++;t=i}while(t);Td(e)}function ko(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function $b(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var Su=Math.random().toString(36).slice(2),bi="__reactFiber$"+Su,Dd="__reactProps$"+Su,br="__reactContainer$"+Su,Yy="__reactEvents$"+Su,yT="__reactListeners$"+Su,vT="__reactHandles$"+Su;function Qo(n){var e=n[bi];if(e)return e;for(var t=n.parentNode;t;){if(e=t[br]||t[bi]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=$b(n);n!==null;){if(t=n[bi])return t;n=$b(n)}return e}n=t,t=n.parentNode}return null}function _f(n){return n=n[bi]||n[br],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function Ol(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(N(33))}function am(n){return n[Dd]||null}var qy=[],Fl=-1;function $o(n){return{current:n}}function Ie(n){0>Fl||(n.current=qy[Fl],qy[Fl]=null,Fl--)}function Le(n,e){Fl++,qy[Fl]=n.current,n.current=e}var Do={},Kt=$o(Do),bn=$o(!1),ll=Do;function du(n,e){var t=n.type.contextTypes;if(!t)return Do;var s=n.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var i={},r;for(r in t)i[r]=e[r];return s&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=i),i}function An(n){return n=n.childContextTypes,n!=null}function cg(){Ie(bn),Ie(Kt)}function Hb(n,e,t){if(Kt.current!==Do)throw Error(N(168));Le(Kt,e),Le(bn,t)}function AE(n,e,t){var s=n.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return t;s=s.getChildContext();for(var i in s)if(!(i in e))throw Error(N(108,nk(n)||"Unknown",i));return Ge({},t,s)}function ug(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Do,ll=Kt.current,Le(Kt,n),Le(bn,bn.current),!0}function Ub(n,e,t){var s=n.stateNode;if(!s)throw Error(N(169));t?(n=AE(n,e,ll),s.__reactInternalMemoizedMergedChildContext=n,Ie(bn),Ie(Kt),Le(Kt,n)):Ie(bn),Le(bn,t)}var ji=null,lm=!1,Zm=!1;function SE(n){ji===null?ji=[n]:ji.push(n)}function wT(n){lm=!0,SE(n)}function Ho(){if(!Zm&&ji!==null){Zm=!0;var n=0,e=Ae;try{var t=ji;for(Ae=1;n<t.length;n++){var s=t[n];do s=s(!0);while(s!==null)}ji=null,lm=!1}catch(i){throw ji!==null&&(ji=ji.slice(n+1)),XS(Y0,Ho),i}finally{Ae=e,Zm=!1}}return null}var jl=[],zl=0,dg=null,hg=0,hs=[],fs=0,cl=null,pr=1,gr="";function Vo(n,e){jl[zl++]=hg,jl[zl++]=dg,dg=n,hg=e}function EE(n,e,t){hs[fs++]=pr,hs[fs++]=gr,hs[fs++]=cl,cl=n;var s=pr;n=gr;var i=32-Us(s)-1;s&=~(1<<i),t+=1;var r=32-Us(e)+i;if(30<r){var o=i-i%5;r=(s&(1<<o)-1).toString(32),s>>=o,i-=o,pr=1<<32-Us(e)+i|t<<i|s,gr=r+n}else pr=1<<r|t<<i|s,gr=n}function sw(n){n.return!==null&&(Vo(n,1),EE(n,1,0))}function iw(n){for(;n===dg;)dg=jl[--zl],jl[zl]=null,hg=jl[--zl],jl[zl]=null;for(;n===cl;)cl=hs[--fs],hs[fs]=null,gr=hs[--fs],hs[fs]=null,pr=hs[--fs],hs[fs]=null}var Kn=null,qn=null,ze=!1,$s=null;function xE(n,e){var t=ms(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function Vb(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,Kn=n,qn=ko(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,Kn=n,qn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=cl!==null?{id:pr,overflow:gr}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=ms(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,Kn=n,qn=null,!0):!1;default:return!1}}function Ky(n){return(n.mode&1)!==0&&(n.flags&128)===0}function Qy(n){if(ze){var e=qn;if(e){var t=e;if(!Vb(n,e)){if(Ky(n))throw Error(N(418));e=ko(t.nextSibling);var s=Kn;e&&Vb(n,e)?xE(s,t):(n.flags=n.flags&-4097|2,ze=!1,Kn=n)}}else{if(Ky(n))throw Error(N(418));n.flags=n.flags&-4097|2,ze=!1,Kn=n}}}function Gb(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Kn=n}function Jf(n){if(n!==Kn)return!1;if(!ze)return Gb(n),ze=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!Wy(n.type,n.memoizedProps)),e&&(e=qn)){if(Ky(n))throw _E(),Error(N(418));for(;e;)xE(n,e),e=ko(e.nextSibling)}if(Gb(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(N(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){qn=ko(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}qn=null}}else qn=Kn?ko(n.stateNode.nextSibling):null;return!0}function _E(){for(var n=qn;n;)n=ko(n.nextSibling)}function hu(){qn=Kn=null,ze=!1}function rw(n){$s===null?$s=[n]:$s.push(n)}var bT=Cr.ReactCurrentBatchConfig;function Nu(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(N(309));var s=t.stateNode}if(!s)throw Error(N(147,n));var i=s,r=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===r?e.ref:(e=function(o){var a=i.refs;o===null?delete a[r]:a[r]=o},e._stringRef=r,e)}if(typeof n!="string")throw Error(N(284));if(!t._owner)throw Error(N(290,n))}return n}function Zf(n,e){throw n=Object.prototype.toString.call(e),Error(N(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function Wb(n){var e=n._init;return e(n._payload)}function CE(n){function e(m,v){if(n){var b=m.deletions;b===null?(m.deletions=[v],m.flags|=16):b.push(v)}}function t(m,v){if(!n)return null;for(;v!==null;)e(m,v),v=v.sibling;return null}function s(m,v){for(m=new Map;v!==null;)v.key!==null?m.set(v.key,v):m.set(v.index,v),v=v.sibling;return m}function i(m,v){return m=Lo(m,v),m.index=0,m.sibling=null,m}function r(m,v,b){return m.index=b,n?(b=m.alternate,b!==null?(b=b.index,b<v?(m.flags|=2,v):b):(m.flags|=2,v)):(m.flags|=1048576,v)}function o(m){return n&&m.alternate===null&&(m.flags|=2),m}function a(m,v,b,x){return v===null||v.tag!==6?(v=oy(b,m.mode,x),v.return=m,v):(v=i(v,b),v.return=m,v)}function c(m,v,b,x){var _=b.type;return _===Ml?d(m,v,b.props.children,x,b.key):v!==null&&(v.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===Dr&&Wb(_)===v.type)?(x=i(v,b.props),x.ref=Nu(m,v,b),x.return=m,x):(x=Sp(b.type,b.key,b.props,null,m.mode,x),x.ref=Nu(m,v,b),x.return=m,x)}function u(m,v,b,x){return v===null||v.tag!==4||v.stateNode.containerInfo!==b.containerInfo||v.stateNode.implementation!==b.implementation?(v=ay(b,m.mode,x),v.return=m,v):(v=i(v,b.children||[]),v.return=m,v)}function d(m,v,b,x,_){return v===null||v.tag!==7?(v=al(b,m.mode,x,_),v.return=m,v):(v=i(v,b),v.return=m,v)}function h(m,v,b){if(typeof v=="string"&&v!==""||typeof v=="number")return v=oy(""+v,m.mode,b),v.return=m,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Hf:return b=Sp(v.type,v.key,v.props,null,m.mode,b),b.ref=Nu(m,null,v),b.return=m,b;case Ll:return v=ay(v,m.mode,b),v.return=m,v;case Dr:var x=v._init;return h(m,x(v._payload),b)}if(Hu(v)||Ru(v))return v=al(v,m.mode,b,null),v.return=m,v;Zf(m,v)}return null}function f(m,v,b,x){var _=v!==null?v.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return _!==null?null:a(m,v,""+b,x);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Hf:return b.key===_?c(m,v,b,x):null;case Ll:return b.key===_?u(m,v,b,x):null;case Dr:return _=b._init,f(m,v,_(b._payload),x)}if(Hu(b)||Ru(b))return _!==null?null:d(m,v,b,x,null);Zf(m,b)}return null}function p(m,v,b,x,_){if(typeof x=="string"&&x!==""||typeof x=="number")return m=m.get(b)||null,a(v,m,""+x,_);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Hf:return m=m.get(x.key===null?b:x.key)||null,c(v,m,x,_);case Ll:return m=m.get(x.key===null?b:x.key)||null,u(v,m,x,_);case Dr:var k=x._init;return p(m,v,b,k(x._payload),_)}if(Hu(x)||Ru(x))return m=m.get(b)||null,d(v,m,x,_,null);Zf(v,x)}return null}function w(m,v,b,x){for(var _=null,k=null,C=v,T=v=0,L=null;C!==null&&T<b.length;T++){C.index>T?(L=C,C=null):L=C.sibling;var M=f(m,C,b[T],x);if(M===null){C===null&&(C=L);break}n&&C&&M.alternate===null&&e(m,C),v=r(M,v,T),k===null?_=M:k.sibling=M,k=M,C=L}if(T===b.length)return t(m,C),ze&&Vo(m,T),_;if(C===null){for(;T<b.length;T++)C=h(m,b[T],x),C!==null&&(v=r(C,v,T),k===null?_=C:k.sibling=C,k=C);return ze&&Vo(m,T),_}for(C=s(m,C);T<b.length;T++)L=p(C,m,T,b[T],x),L!==null&&(n&&L.alternate!==null&&C.delete(L.key===null?T:L.key),v=r(L,v,T),k===null?_=L:k.sibling=L,k=L);return n&&C.forEach(function(D){return e(m,D)}),ze&&Vo(m,T),_}function g(m,v,b,x){var _=Ru(b);if(typeof _!="function")throw Error(N(150));if(b=_.call(b),b==null)throw Error(N(151));for(var k=_=null,C=v,T=v=0,L=null,M=b.next();C!==null&&!M.done;T++,M=b.next()){C.index>T?(L=C,C=null):L=C.sibling;var D=f(m,C,M.value,x);if(D===null){C===null&&(C=L);break}n&&C&&D.alternate===null&&e(m,C),v=r(D,v,T),k===null?_=D:k.sibling=D,k=D,C=L}if(M.done)return t(m,C),ze&&Vo(m,T),_;if(C===null){for(;!M.done;T++,M=b.next())M=h(m,M.value,x),M!==null&&(v=r(M,v,T),k===null?_=M:k.sibling=M,k=M);return ze&&Vo(m,T),_}for(C=s(m,C);!M.done;T++,M=b.next())M=p(C,m,T,M.value,x),M!==null&&(n&&M.alternate!==null&&C.delete(M.key===null?T:M.key),v=r(M,v,T),k===null?_=M:k.sibling=M,k=M);return n&&C.forEach(function(q){return e(m,q)}),ze&&Vo(m,T),_}function E(m,v,b,x){if(typeof b=="object"&&b!==null&&b.type===Ml&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case Hf:e:{for(var _=b.key,k=v;k!==null;){if(k.key===_){if(_=b.type,_===Ml){if(k.tag===7){t(m,k.sibling),v=i(k,b.props.children),v.return=m,m=v;break e}}else if(k.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===Dr&&Wb(_)===k.type){t(m,k.sibling),v=i(k,b.props),v.ref=Nu(m,k,b),v.return=m,m=v;break e}t(m,k);break}else e(m,k);k=k.sibling}b.type===Ml?(v=al(b.props.children,m.mode,x,b.key),v.return=m,m=v):(x=Sp(b.type,b.key,b.props,null,m.mode,x),x.ref=Nu(m,v,b),x.return=m,m=x)}return o(m);case Ll:e:{for(k=b.key;v!==null;){if(v.key===k)if(v.tag===4&&v.stateNode.containerInfo===b.containerInfo&&v.stateNode.implementation===b.implementation){t(m,v.sibling),v=i(v,b.children||[]),v.return=m,m=v;break e}else{t(m,v);break}else e(m,v);v=v.sibling}v=ay(b,m.mode,x),v.return=m,m=v}return o(m);case Dr:return k=b._init,E(m,v,k(b._payload),x)}if(Hu(b))return w(m,v,b,x);if(Ru(b))return g(m,v,b,x);Zf(m,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,v!==null&&v.tag===6?(t(m,v.sibling),v=i(v,b),v.return=m,m=v):(t(m,v),v=oy(b,m.mode,x),v.return=m,m=v),o(m)):t(m,v)}return E}var fu=CE(!0),kE=CE(!1),fg=$o(null),pg=null,Bl=null,ow=null;function aw(){ow=Bl=pg=null}function lw(n){var e=fg.current;Ie(fg),n._currentValue=e}function Jy(n,e,t){for(;n!==null;){var s=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),n===t)break;n=n.return}}function Ql(n,e){pg=n,ow=Bl=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(wn=!0),n.firstContext=null)}function ws(n){var e=n._currentValue;if(ow!==n)if(n={context:n,memoizedValue:e,next:null},Bl===null){if(pg===null)throw Error(N(308));Bl=n,pg.dependencies={lanes:0,firstContext:n}}else Bl=Bl.next=n;return e}var Jo=null;function cw(n){Jo===null?Jo=[n]:Jo.push(n)}function TE(n,e,t,s){var i=e.interleaved;return i===null?(t.next=t,cw(e)):(t.next=i.next,i.next=t),e.interleaved=t,Ar(n,s)}function Ar(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var Nr=!1;function uw(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function RE(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function mr(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function To(n,e,t){var s=n.updateQueue;if(s===null)return null;if(s=s.shared,ge&2){var i=s.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),s.pending=e,Ar(n,t)}return i=s.interleaved,i===null?(e.next=e,cw(s)):(e.next=i.next,i.next=e),s.interleaved=e,Ar(n,t)}function mp(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var s=e.lanes;s&=n.pendingLanes,t|=s,e.lanes=t,q0(n,t)}}function Xb(n,e){var t=n.updateQueue,s=n.alternate;if(s!==null&&(s=s.updateQueue,t===s)){var i=null,r=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};r===null?i=r=o:r=r.next=o,t=t.next}while(t!==null);r===null?i=r=e:r=r.next=e}else i=r=e;t={baseState:s.baseState,firstBaseUpdate:i,lastBaseUpdate:r,shared:s.shared,effects:s.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function gg(n,e,t,s){var i=n.updateQueue;Nr=!1;var r=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var c=a,u=c.next;c.next=null,o===null?r=u:o.next=u,o=c;var d=n.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=u:a.next=u,d.lastBaseUpdate=c))}if(r!==null){var h=i.baseState;o=0,d=u=c=null,a=r;do{var f=a.lane,p=a.eventTime;if((s&f)===f){d!==null&&(d=d.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var w=n,g=a;switch(f=e,p=t,g.tag){case 1:if(w=g.payload,typeof w=="function"){h=w.call(p,h,f);break e}h=w;break e;case 3:w.flags=w.flags&-65537|128;case 0:if(w=g.payload,f=typeof w=="function"?w.call(p,h,f):w,f==null)break e;h=Ge({},h,f);break e;case 2:Nr=!0}}a.callback!==null&&a.lane!==0&&(n.flags|=64,f=i.effects,f===null?i.effects=[a]:f.push(a))}else p={eventTime:p,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(u=d=p,c=h):d=d.next=p,o|=f;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;f=a,a=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(!0);if(d===null&&(c=h),i.baseState=c,i.firstBaseUpdate=u,i.lastBaseUpdate=d,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else r===null&&(i.shared.lanes=0);dl|=o,n.lanes=o,n.memoizedState=h}}function Yb(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var s=n[e],i=s.callback;if(i!==null){if(s.callback=null,s=t,typeof i!="function")throw Error(N(191,i));i.call(s)}}}var Cf={},xi=$o(Cf),Nd=$o(Cf),Id=$o(Cf);function Zo(n){if(n===Cf)throw Error(N(174));return n}function dw(n,e){switch(Le(Id,e),Le(Nd,n),Le(xi,Cf),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:My(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=My(e,n)}Ie(xi),Le(xi,e)}function pu(){Ie(xi),Ie(Nd),Ie(Id)}function PE(n){Zo(Id.current);var e=Zo(xi.current),t=My(e,n.type);e!==t&&(Le(Nd,n),Le(xi,t))}function hw(n){Nd.current===n&&(Ie(xi),Ie(Nd))}var Ue=$o(0);function mg(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var ey=[];function fw(){for(var n=0;n<ey.length;n++)ey[n]._workInProgressVersionPrimary=null;ey.length=0}var yp=Cr.ReactCurrentDispatcher,ty=Cr.ReactCurrentBatchConfig,ul=0,Ve=null,ct=null,At=null,yg=!1,gd=!1,Od=0,AT=0;function zt(){throw Error(N(321))}function pw(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!Gs(n[t],e[t]))return!1;return!0}function gw(n,e,t,s,i,r){if(ul=r,Ve=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,yp.current=n===null||n.memoizedState===null?_T:CT,n=t(s,i),gd){r=0;do{if(gd=!1,Od=0,25<=r)throw Error(N(301));r+=1,At=ct=null,e.updateQueue=null,yp.current=kT,n=t(s,i)}while(gd)}if(yp.current=vg,e=ct!==null&&ct.next!==null,ul=0,At=ct=Ve=null,yg=!1,e)throw Error(N(300));return n}function mw(){var n=Od!==0;return Od=0,n}function si(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return At===null?Ve.memoizedState=At=n:At=At.next=n,At}function bs(){if(ct===null){var n=Ve.alternate;n=n!==null?n.memoizedState:null}else n=ct.next;var e=At===null?Ve.memoizedState:At.next;if(e!==null)At=e,ct=n;else{if(n===null)throw Error(N(310));ct=n,n={memoizedState:ct.memoizedState,baseState:ct.baseState,baseQueue:ct.baseQueue,queue:ct.queue,next:null},At===null?Ve.memoizedState=At=n:At=At.next=n}return At}function Fd(n,e){return typeof e=="function"?e(n):e}function ny(n){var e=bs(),t=e.queue;if(t===null)throw Error(N(311));t.lastRenderedReducer=n;var s=ct,i=s.baseQueue,r=t.pending;if(r!==null){if(i!==null){var o=i.next;i.next=r.next,r.next=o}s.baseQueue=i=r,t.pending=null}if(i!==null){r=i.next,s=s.baseState;var a=o=null,c=null,u=r;do{var d=u.lane;if((ul&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),s=u.hasEagerState?u.eagerState:n(s,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(a=c=h,o=s):c=c.next=h,Ve.lanes|=d,dl|=d}u=u.next}while(u!==null&&u!==r);c===null?o=s:c.next=a,Gs(s,e.memoizedState)||(wn=!0),e.memoizedState=s,e.baseState=o,e.baseQueue=c,t.lastRenderedState=s}if(n=t.interleaved,n!==null){i=n;do r=i.lane,Ve.lanes|=r,dl|=r,i=i.next;while(i!==n)}else i===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function sy(n){var e=bs(),t=e.queue;if(t===null)throw Error(N(311));t.lastRenderedReducer=n;var s=t.dispatch,i=t.pending,r=e.memoizedState;if(i!==null){t.pending=null;var o=i=i.next;do r=n(r,o.action),o=o.next;while(o!==i);Gs(r,e.memoizedState)||(wn=!0),e.memoizedState=r,e.baseQueue===null&&(e.baseState=r),t.lastRenderedState=r}return[r,s]}function LE(){}function ME(n,e){var t=Ve,s=bs(),i=e(),r=!Gs(s.memoizedState,i);if(r&&(s.memoizedState=i,wn=!0),s=s.queue,yw(IE.bind(null,t,s,n),[n]),s.getSnapshot!==e||r||At!==null&&At.memoizedState.tag&1){if(t.flags|=2048,jd(9,NE.bind(null,t,s,i,e),void 0,null),Et===null)throw Error(N(349));ul&30||DE(t,e,i)}return i}function DE(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=Ve.updateQueue,e===null?(e={lastEffect:null,stores:null},Ve.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function NE(n,e,t,s){e.value=t,e.getSnapshot=s,OE(e)&&FE(n)}function IE(n,e,t){return t(function(){OE(e)&&FE(n)})}function OE(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!Gs(n,t)}catch{return!0}}function FE(n){var e=Ar(n,1);e!==null&&Vs(e,n,1,-1)}function qb(n){var e=si();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Fd,lastRenderedState:n},e.queue=n,n=n.dispatch=xT.bind(null,Ve,n),[e.memoizedState,n]}function jd(n,e,t,s){return n={tag:n,create:e,destroy:t,deps:s,next:null},e=Ve.updateQueue,e===null?(e={lastEffect:null,stores:null},Ve.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(s=t.next,t.next=n,n.next=s,e.lastEffect=n)),n}function jE(){return bs().memoizedState}function vp(n,e,t,s){var i=si();Ve.flags|=n,i.memoizedState=jd(1|e,t,void 0,s===void 0?null:s)}function cm(n,e,t,s){var i=bs();s=s===void 0?null:s;var r=void 0;if(ct!==null){var o=ct.memoizedState;if(r=o.destroy,s!==null&&pw(s,o.deps)){i.memoizedState=jd(e,t,r,s);return}}Ve.flags|=n,i.memoizedState=jd(1|e,t,r,s)}function Kb(n,e){return vp(8390656,8,n,e)}function yw(n,e){return cm(2048,8,n,e)}function zE(n,e){return cm(4,2,n,e)}function BE(n,e){return cm(4,4,n,e)}function $E(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function HE(n,e,t){return t=t!=null?t.concat([n]):null,cm(4,4,$E.bind(null,e,n),t)}function vw(){}function UE(n,e){var t=bs();e=e===void 0?null:e;var s=t.memoizedState;return s!==null&&e!==null&&pw(e,s[1])?s[0]:(t.memoizedState=[n,e],n)}function VE(n,e){var t=bs();e=e===void 0?null:e;var s=t.memoizedState;return s!==null&&e!==null&&pw(e,s[1])?s[0]:(n=n(),t.memoizedState=[n,e],n)}function GE(n,e,t){return ul&21?(Gs(t,e)||(t=KS(),Ve.lanes|=t,dl|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,wn=!0),n.memoizedState=t)}function ST(n,e){var t=Ae;Ae=t!==0&&4>t?t:4,n(!0);var s=ty.transition;ty.transition={};try{n(!1),e()}finally{Ae=t,ty.transition=s}}function WE(){return bs().memoizedState}function ET(n,e,t){var s=Po(n);if(t={lane:s,action:t,hasEagerState:!1,eagerState:null,next:null},XE(n))YE(e,t);else if(t=TE(n,e,t,s),t!==null){var i=ln();Vs(t,n,s,i),qE(t,e,s)}}function xT(n,e,t){var s=Po(n),i={lane:s,action:t,hasEagerState:!1,eagerState:null,next:null};if(XE(n))YE(e,i);else{var r=n.alternate;if(n.lanes===0&&(r===null||r.lanes===0)&&(r=e.lastRenderedReducer,r!==null))try{var o=e.lastRenderedState,a=r(o,t);if(i.hasEagerState=!0,i.eagerState=a,Gs(a,o)){var c=e.interleaved;c===null?(i.next=i,cw(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}t=TE(n,e,i,s),t!==null&&(i=ln(),Vs(t,n,s,i),qE(t,e,s))}}function XE(n){var e=n.alternate;return n===Ve||e!==null&&e===Ve}function YE(n,e){gd=yg=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function qE(n,e,t){if(t&4194240){var s=e.lanes;s&=n.pendingLanes,t|=s,e.lanes=t,q0(n,t)}}var vg={readContext:ws,useCallback:zt,useContext:zt,useEffect:zt,useImperativeHandle:zt,useInsertionEffect:zt,useLayoutEffect:zt,useMemo:zt,useReducer:zt,useRef:zt,useState:zt,useDebugValue:zt,useDeferredValue:zt,useTransition:zt,useMutableSource:zt,useSyncExternalStore:zt,useId:zt,unstable_isNewReconciler:!1},_T={readContext:ws,useCallback:function(n,e){return si().memoizedState=[n,e===void 0?null:e],n},useContext:ws,useEffect:Kb,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,vp(4194308,4,$E.bind(null,e,n),t)},useLayoutEffect:function(n,e){return vp(4194308,4,n,e)},useInsertionEffect:function(n,e){return vp(4,2,n,e)},useMemo:function(n,e){var t=si();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var s=si();return e=t!==void 0?t(e):e,s.memoizedState=s.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},s.queue=n,n=n.dispatch=ET.bind(null,Ve,n),[s.memoizedState,n]},useRef:function(n){var e=si();return n={current:n},e.memoizedState=n},useState:qb,useDebugValue:vw,useDeferredValue:function(n){return si().memoizedState=n},useTransition:function(){var n=qb(!1),e=n[0];return n=ST.bind(null,n[1]),si().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var s=Ve,i=si();if(ze){if(t===void 0)throw Error(N(407));t=t()}else{if(t=e(),Et===null)throw Error(N(349));ul&30||DE(s,e,t)}i.memoizedState=t;var r={value:t,getSnapshot:e};return i.queue=r,Kb(IE.bind(null,s,r,n),[n]),s.flags|=2048,jd(9,NE.bind(null,s,r,t,e),void 0,null),t},useId:function(){var n=si(),e=Et.identifierPrefix;if(ze){var t=gr,s=pr;t=(s&~(1<<32-Us(s)-1)).toString(32)+t,e=":"+e+"R"+t,t=Od++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=AT++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},CT={readContext:ws,useCallback:UE,useContext:ws,useEffect:yw,useImperativeHandle:HE,useInsertionEffect:zE,useLayoutEffect:BE,useMemo:VE,useReducer:ny,useRef:jE,useState:function(){return ny(Fd)},useDebugValue:vw,useDeferredValue:function(n){var e=bs();return GE(e,ct.memoizedState,n)},useTransition:function(){var n=ny(Fd)[0],e=bs().memoizedState;return[n,e]},useMutableSource:LE,useSyncExternalStore:ME,useId:WE,unstable_isNewReconciler:!1},kT={readContext:ws,useCallback:UE,useContext:ws,useEffect:yw,useImperativeHandle:HE,useInsertionEffect:zE,useLayoutEffect:BE,useMemo:VE,useReducer:sy,useRef:jE,useState:function(){return sy(Fd)},useDebugValue:vw,useDeferredValue:function(n){var e=bs();return ct===null?e.memoizedState=n:GE(e,ct.memoizedState,n)},useTransition:function(){var n=sy(Fd)[0],e=bs().memoizedState;return[n,e]},useMutableSource:LE,useSyncExternalStore:ME,useId:WE,unstable_isNewReconciler:!1};function Cs(n,e){if(n&&n.defaultProps){e=Ge({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function Zy(n,e,t,s){e=n.memoizedState,t=t(s,e),t=t==null?e:Ge({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var um={isMounted:function(n){return(n=n._reactInternals)?yl(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var s=ln(),i=Po(n),r=mr(s,i);r.payload=e,t!=null&&(r.callback=t),e=To(n,r,i),e!==null&&(Vs(e,n,i,s),mp(e,n,i))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var s=ln(),i=Po(n),r=mr(s,i);r.tag=1,r.payload=e,t!=null&&(r.callback=t),e=To(n,r,i),e!==null&&(Vs(e,n,i,s),mp(e,n,i))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=ln(),s=Po(n),i=mr(t,s);i.tag=2,e!=null&&(i.callback=e),e=To(n,i,s),e!==null&&(Vs(e,n,s,t),mp(e,n,s))}};function Qb(n,e,t,s,i,r,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(s,r,o):e.prototype&&e.prototype.isPureReactComponent?!Pd(t,s)||!Pd(i,r):!0}function KE(n,e,t){var s=!1,i=Do,r=e.contextType;return typeof r=="object"&&r!==null?r=ws(r):(i=An(e)?ll:Kt.current,s=e.contextTypes,r=(s=s!=null)?du(n,i):Do),e=new e(t,r),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=um,n.stateNode=e,e._reactInternals=n,s&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=i,n.__reactInternalMemoizedMaskedChildContext=r),e}function Jb(n,e,t,s){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,s),e.state!==n&&um.enqueueReplaceState(e,e.state,null)}function ev(n,e,t,s){var i=n.stateNode;i.props=t,i.state=n.memoizedState,i.refs={},uw(n);var r=e.contextType;typeof r=="object"&&r!==null?i.context=ws(r):(r=An(e)?ll:Kt.current,i.context=du(n,r)),i.state=n.memoizedState,r=e.getDerivedStateFromProps,typeof r=="function"&&(Zy(n,e,r,t),i.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&um.enqueueReplaceState(i,i.state,null),gg(n,t,i,s),i.state=n.memoizedState),typeof i.componentDidMount=="function"&&(n.flags|=4194308)}function gu(n,e){try{var t="",s=e;do t+=tk(s),s=s.return;while(s);var i=t}catch(r){i=`
Error generating stack: `+r.message+`
`+r.stack}return{value:n,source:e,stack:i,digest:null}}function iy(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function tv(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var TT=typeof WeakMap=="function"?WeakMap:Map;function QE(n,e,t){t=mr(-1,t),t.tag=3,t.payload={element:null};var s=e.value;return t.callback=function(){bg||(bg=!0,dv=s),tv(n,e)},t}function JE(n,e,t){t=mr(-1,t),t.tag=3;var s=n.type.getDerivedStateFromError;if(typeof s=="function"){var i=e.value;t.payload=function(){return s(i)},t.callback=function(){tv(n,e)}}var r=n.stateNode;return r!==null&&typeof r.componentDidCatch=="function"&&(t.callback=function(){tv(n,e),typeof s!="function"&&(Ro===null?Ro=new Set([this]):Ro.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function Zb(n,e,t){var s=n.pingCache;if(s===null){s=n.pingCache=new TT;var i=new Set;s.set(e,i)}else i=s.get(e),i===void 0&&(i=new Set,s.set(e,i));i.has(t)||(i.add(t),n=HT.bind(null,n,e,t),e.then(n,n))}function eA(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function tA(n,e,t,s,i){return n.mode&1?(n.flags|=65536,n.lanes=i,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=mr(-1,1),e.tag=2,To(t,e,1))),t.lanes|=1),n)}var RT=Cr.ReactCurrentOwner,wn=!1;function rn(n,e,t,s){e.child=n===null?kE(e,null,t,s):fu(e,n.child,t,s)}function nA(n,e,t,s,i){t=t.render;var r=e.ref;return Ql(e,i),s=gw(n,e,t,s,r,i),t=mw(),n!==null&&!wn?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Sr(n,e,i)):(ze&&t&&sw(e),e.flags|=1,rn(n,e,s,i),e.child)}function sA(n,e,t,s,i){if(n===null){var r=t.type;return typeof r=="function"&&!Cw(r)&&r.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=r,ZE(n,e,r,s,i)):(n=Sp(t.type,null,s,e,e.mode,i),n.ref=e.ref,n.return=e,e.child=n)}if(r=n.child,!(n.lanes&i)){var o=r.memoizedProps;if(t=t.compare,t=t!==null?t:Pd,t(o,s)&&n.ref===e.ref)return Sr(n,e,i)}return e.flags|=1,n=Lo(r,s),n.ref=e.ref,n.return=e,e.child=n}function ZE(n,e,t,s,i){if(n!==null){var r=n.memoizedProps;if(Pd(r,s)&&n.ref===e.ref)if(wn=!1,e.pendingProps=s=r,(n.lanes&i)!==0)n.flags&131072&&(wn=!0);else return e.lanes=n.lanes,Sr(n,e,i)}return nv(n,e,t,s,i)}function e1(n,e,t){var s=e.pendingProps,i=s.children,r=n!==null?n.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Le(Hl,Wn),Wn|=t;else{if(!(t&1073741824))return n=r!==null?r.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,Le(Hl,Wn),Wn|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=r!==null?r.baseLanes:t,Le(Hl,Wn),Wn|=s}else r!==null?(s=r.baseLanes|t,e.memoizedState=null):s=t,Le(Hl,Wn),Wn|=s;return rn(n,e,i,t),e.child}function t1(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function nv(n,e,t,s,i){var r=An(t)?ll:Kt.current;return r=du(e,r),Ql(e,i),t=gw(n,e,t,s,r,i),s=mw(),n!==null&&!wn?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Sr(n,e,i)):(ze&&s&&sw(e),e.flags|=1,rn(n,e,t,i),e.child)}function iA(n,e,t,s,i){if(An(t)){var r=!0;ug(e)}else r=!1;if(Ql(e,i),e.stateNode===null)wp(n,e),KE(e,t,s),ev(e,t,s,i),s=!0;else if(n===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var c=o.context,u=t.contextType;typeof u=="object"&&u!==null?u=ws(u):(u=An(t)?ll:Kt.current,u=du(e,u));var d=t.getDerivedStateFromProps,h=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==s||c!==u)&&Jb(e,o,s,u),Nr=!1;var f=e.memoizedState;o.state=f,gg(e,s,o,i),c=e.memoizedState,a!==s||f!==c||bn.current||Nr?(typeof d=="function"&&(Zy(e,t,d,s),c=e.memoizedState),(a=Nr||Qb(e,t,a,s,f,c,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=c),o.props=s,o.state=c,o.context=u,s=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{o=e.stateNode,RE(n,e),a=e.memoizedProps,u=e.type===e.elementType?a:Cs(e.type,a),o.props=u,h=e.pendingProps,f=o.context,c=t.contextType,typeof c=="object"&&c!==null?c=ws(c):(c=An(t)?ll:Kt.current,c=du(e,c));var p=t.getDerivedStateFromProps;(d=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||f!==c)&&Jb(e,o,s,c),Nr=!1,f=e.memoizedState,o.state=f,gg(e,s,o,i);var w=e.memoizedState;a!==h||f!==w||bn.current||Nr?(typeof p=="function"&&(Zy(e,t,p,s),w=e.memoizedState),(u=Nr||Qb(e,t,u,s,f,w,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(s,w,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(s,w,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&f===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&f===n.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=w),o.props=s,o.state=w,o.context=c,s=u):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&f===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&f===n.memoizedState||(e.flags|=1024),s=!1)}return sv(n,e,t,s,r,i)}function sv(n,e,t,s,i,r){t1(n,e);var o=(e.flags&128)!==0;if(!s&&!o)return i&&Ub(e,t,!1),Sr(n,e,r);s=e.stateNode,RT.current=e;var a=o&&typeof t.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,n!==null&&o?(e.child=fu(e,n.child,null,r),e.child=fu(e,null,a,r)):rn(n,e,a,r),e.memoizedState=s.state,i&&Ub(e,t,!0),e.child}function n1(n){var e=n.stateNode;e.pendingContext?Hb(n,e.pendingContext,e.pendingContext!==e.context):e.context&&Hb(n,e.context,!1),dw(n,e.containerInfo)}function rA(n,e,t,s,i){return hu(),rw(i),e.flags|=256,rn(n,e,t,s),e.child}var iv={dehydrated:null,treeContext:null,retryLane:0};function rv(n){return{baseLanes:n,cachePool:null,transitions:null}}function s1(n,e,t){var s=e.pendingProps,i=Ue.current,r=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=n!==null&&n.memoizedState===null?!1:(i&2)!==0),a?(r=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(i|=1),Le(Ue,i&1),n===null)return Qy(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=s.children,n=s.fallback,r?(s=e.mode,r=e.child,o={mode:"hidden",children:o},!(s&1)&&r!==null?(r.childLanes=0,r.pendingProps=o):r=fm(o,s,0,null),n=al(n,s,t,null),r.return=e,n.return=e,r.sibling=n,e.child=r,e.child.memoizedState=rv(t),e.memoizedState=iv,n):ww(e,o));if(i=n.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return PT(n,e,o,s,a,i,t);if(r){r=s.fallback,o=e.mode,i=n.child,a=i.sibling;var c={mode:"hidden",children:s.children};return!(o&1)&&e.child!==i?(s=e.child,s.childLanes=0,s.pendingProps=c,e.deletions=null):(s=Lo(i,c),s.subtreeFlags=i.subtreeFlags&14680064),a!==null?r=Lo(a,r):(r=al(r,o,t,null),r.flags|=2),r.return=e,s.return=e,s.sibling=r,e.child=s,s=r,r=e.child,o=n.child.memoizedState,o=o===null?rv(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},r.memoizedState=o,r.childLanes=n.childLanes&~t,e.memoizedState=iv,s}return r=n.child,n=r.sibling,s=Lo(r,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=t),s.return=e,s.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=s,e.memoizedState=null,s}function ww(n,e){return e=fm({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function ep(n,e,t,s){return s!==null&&rw(s),fu(e,n.child,null,t),n=ww(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function PT(n,e,t,s,i,r,o){if(t)return e.flags&256?(e.flags&=-257,s=iy(Error(N(422))),ep(n,e,o,s)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(r=s.fallback,i=e.mode,s=fm({mode:"visible",children:s.children},i,0,null),r=al(r,i,o,null),r.flags|=2,s.return=e,r.return=e,s.sibling=r,e.child=s,e.mode&1&&fu(e,n.child,null,o),e.child.memoizedState=rv(o),e.memoizedState=iv,r);if(!(e.mode&1))return ep(n,e,o,null);if(i.data==="$!"){if(s=i.nextSibling&&i.nextSibling.dataset,s)var a=s.dgst;return s=a,r=Error(N(419)),s=iy(r,s,void 0),ep(n,e,o,s)}if(a=(o&n.childLanes)!==0,wn||a){if(s=Et,s!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(s.suspendedLanes|o)?0:i,i!==0&&i!==r.retryLane&&(r.retryLane=i,Ar(n,i),Vs(s,n,i,-1))}return _w(),s=iy(Error(N(421))),ep(n,e,o,s)}return i.data==="$?"?(e.flags|=128,e.child=n.child,e=UT.bind(null,n),i._reactRetry=e,null):(n=r.treeContext,qn=ko(i.nextSibling),Kn=e,ze=!0,$s=null,n!==null&&(hs[fs++]=pr,hs[fs++]=gr,hs[fs++]=cl,pr=n.id,gr=n.overflow,cl=e),e=ww(e,s.children),e.flags|=4096,e)}function oA(n,e,t){n.lanes|=e;var s=n.alternate;s!==null&&(s.lanes|=e),Jy(n.return,e,t)}function ry(n,e,t,s,i){var r=n.memoizedState;r===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:t,tailMode:i}:(r.isBackwards=e,r.rendering=null,r.renderingStartTime=0,r.last=s,r.tail=t,r.tailMode=i)}function i1(n,e,t){var s=e.pendingProps,i=s.revealOrder,r=s.tail;if(rn(n,e,s.children,t),s=Ue.current,s&2)s=s&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&oA(n,t,e);else if(n.tag===19)oA(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}s&=1}if(Le(Ue,s),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(t=e.child,i=null;t!==null;)n=t.alternate,n!==null&&mg(n)===null&&(i=t),t=t.sibling;t=i,t===null?(i=e.child,e.child=null):(i=t.sibling,t.sibling=null),ry(e,!1,i,t,r);break;case"backwards":for(t=null,i=e.child,e.child=null;i!==null;){if(n=i.alternate,n!==null&&mg(n)===null){e.child=i;break}n=i.sibling,i.sibling=t,t=i,i=n}ry(e,!0,t,null,r);break;case"together":ry(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function wp(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Sr(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),dl|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(N(153));if(e.child!==null){for(n=e.child,t=Lo(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=Lo(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function LT(n,e,t){switch(e.tag){case 3:n1(e),hu();break;case 5:PE(e);break;case 1:An(e.type)&&ug(e);break;case 4:dw(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,i=e.memoizedProps.value;Le(fg,s._currentValue),s._currentValue=i;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(Le(Ue,Ue.current&1),e.flags|=128,null):t&e.child.childLanes?s1(n,e,t):(Le(Ue,Ue.current&1),n=Sr(n,e,t),n!==null?n.sibling:null);Le(Ue,Ue.current&1);break;case 19:if(s=(t&e.childLanes)!==0,n.flags&128){if(s)return i1(n,e,t);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Le(Ue,Ue.current),s)break;return null;case 22:case 23:return e.lanes=0,e1(n,e,t)}return Sr(n,e,t)}var r1,ov,o1,a1;r1=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};ov=function(){};o1=function(n,e,t,s){var i=n.memoizedProps;if(i!==s){n=e.stateNode,Zo(xi.current);var r=null;switch(t){case"input":i=Ty(n,i),s=Ty(n,s),r=[];break;case"select":i=Ge({},i,{value:void 0}),s=Ge({},s,{value:void 0}),r=[];break;case"textarea":i=Ly(n,i),s=Ly(n,s),r=[];break;default:typeof i.onClick!="function"&&typeof s.onClick=="function"&&(n.onclick=lg)}Dy(t,s);var o;t=null;for(u in i)if(!s.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(o in a)a.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Ed.hasOwnProperty(u)?r||(r=[]):(r=r||[]).push(u,null));for(u in s){var c=s[u];if(a=i!=null?i[u]:void 0,s.hasOwnProperty(u)&&c!==a&&(c!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in c)c.hasOwnProperty(o)&&a[o]!==c[o]&&(t||(t={}),t[o]=c[o])}else t||(r||(r=[]),r.push(u,t)),t=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(r=r||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(r=r||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Ed.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&De("scroll",n),r||a===c||(r=[])):(r=r||[]).push(u,c))}t&&(r=r||[]).push("style",t);var u=r;(e.updateQueue=u)&&(e.flags|=4)}};a1=function(n,e,t,s){t!==s&&(e.flags|=4)};function Iu(n,e){if(!ze)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var s=null;t!==null;)t.alternate!==null&&(s=t),t=t.sibling;s===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:s.sibling=null}}function Bt(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,s=0;if(e)for(var i=n.child;i!==null;)t|=i.lanes|i.childLanes,s|=i.subtreeFlags&14680064,s|=i.flags&14680064,i.return=n,i=i.sibling;else for(i=n.child;i!==null;)t|=i.lanes|i.childLanes,s|=i.subtreeFlags,s|=i.flags,i.return=n,i=i.sibling;return n.subtreeFlags|=s,n.childLanes=t,e}function MT(n,e,t){var s=e.pendingProps;switch(iw(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Bt(e),null;case 1:return An(e.type)&&cg(),Bt(e),null;case 3:return s=e.stateNode,pu(),Ie(bn),Ie(Kt),fw(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(n===null||n.child===null)&&(Jf(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,$s!==null&&(pv($s),$s=null))),ov(n,e),Bt(e),null;case 5:hw(e);var i=Zo(Id.current);if(t=e.type,n!==null&&e.stateNode!=null)o1(n,e,t,s,i),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(N(166));return Bt(e),null}if(n=Zo(xi.current),Jf(e)){s=e.stateNode,t=e.type;var r=e.memoizedProps;switch(s[bi]=e,s[Dd]=r,n=(e.mode&1)!==0,t){case"dialog":De("cancel",s),De("close",s);break;case"iframe":case"object":case"embed":De("load",s);break;case"video":case"audio":for(i=0;i<Vu.length;i++)De(Vu[i],s);break;case"source":De("error",s);break;case"img":case"image":case"link":De("error",s),De("load",s);break;case"details":De("toggle",s);break;case"input":gb(s,r),De("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!r.multiple},De("invalid",s);break;case"textarea":yb(s,r),De("invalid",s)}Dy(t,r),i=null;for(var o in r)if(r.hasOwnProperty(o)){var a=r[o];o==="children"?typeof a=="string"?s.textContent!==a&&(r.suppressHydrationWarning!==!0&&Qf(s.textContent,a,n),i=["children",a]):typeof a=="number"&&s.textContent!==""+a&&(r.suppressHydrationWarning!==!0&&Qf(s.textContent,a,n),i=["children",""+a]):Ed.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&De("scroll",s)}switch(t){case"input":Uf(s),mb(s,r,!0);break;case"textarea":Uf(s),vb(s);break;case"select":case"option":break;default:typeof r.onClick=="function"&&(s.onclick=lg)}s=i,e.updateQueue=s,s!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=IS(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof s.is=="string"?n=o.createElement(t,{is:s.is}):(n=o.createElement(t),t==="select"&&(o=n,s.multiple?o.multiple=!0:s.size&&(o.size=s.size))):n=o.createElementNS(n,t),n[bi]=e,n[Dd]=s,r1(n,e,!1,!1),e.stateNode=n;e:{switch(o=Ny(t,s),t){case"dialog":De("cancel",n),De("close",n),i=s;break;case"iframe":case"object":case"embed":De("load",n),i=s;break;case"video":case"audio":for(i=0;i<Vu.length;i++)De(Vu[i],n);i=s;break;case"source":De("error",n),i=s;break;case"img":case"image":case"link":De("error",n),De("load",n),i=s;break;case"details":De("toggle",n),i=s;break;case"input":gb(n,s),i=Ty(n,s),De("invalid",n);break;case"option":i=s;break;case"select":n._wrapperState={wasMultiple:!!s.multiple},i=Ge({},s,{value:void 0}),De("invalid",n);break;case"textarea":yb(n,s),i=Ly(n,s),De("invalid",n);break;default:i=s}Dy(t,i),a=i;for(r in a)if(a.hasOwnProperty(r)){var c=a[r];r==="style"?jS(n,c):r==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&OS(n,c)):r==="children"?typeof c=="string"?(t!=="textarea"||c!=="")&&xd(n,c):typeof c=="number"&&xd(n,""+c):r!=="suppressContentEditableWarning"&&r!=="suppressHydrationWarning"&&r!=="autoFocus"&&(Ed.hasOwnProperty(r)?c!=null&&r==="onScroll"&&De("scroll",n):c!=null&&U0(n,r,c,o))}switch(t){case"input":Uf(n),mb(n,s,!1);break;case"textarea":Uf(n),vb(n);break;case"option":s.value!=null&&n.setAttribute("value",""+Mo(s.value));break;case"select":n.multiple=!!s.multiple,r=s.value,r!=null?Xl(n,!!s.multiple,r,!1):s.defaultValue!=null&&Xl(n,!!s.multiple,s.defaultValue,!0);break;default:typeof i.onClick=="function"&&(n.onclick=lg)}switch(t){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Bt(e),null;case 6:if(n&&e.stateNode!=null)a1(n,e,n.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(N(166));if(t=Zo(Id.current),Zo(xi.current),Jf(e)){if(s=e.stateNode,t=e.memoizedProps,s[bi]=e,(r=s.nodeValue!==t)&&(n=Kn,n!==null))switch(n.tag){case 3:Qf(s.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Qf(s.nodeValue,t,(n.mode&1)!==0)}r&&(e.flags|=4)}else s=(t.nodeType===9?t:t.ownerDocument).createTextNode(s),s[bi]=e,e.stateNode=s}return Bt(e),null;case 13:if(Ie(Ue),s=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(ze&&qn!==null&&e.mode&1&&!(e.flags&128))_E(),hu(),e.flags|=98560,r=!1;else if(r=Jf(e),s!==null&&s.dehydrated!==null){if(n===null){if(!r)throw Error(N(318));if(r=e.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(N(317));r[bi]=e}else hu(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Bt(e),r=!1}else $s!==null&&(pv($s),$s=null),r=!0;if(!r)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(s=s!==null,s!==(n!==null&&n.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(n===null||Ue.current&1?ht===0&&(ht=3):_w())),e.updateQueue!==null&&(e.flags|=4),Bt(e),null);case 4:return pu(),ov(n,e),n===null&&Ld(e.stateNode.containerInfo),Bt(e),null;case 10:return lw(e.type._context),Bt(e),null;case 17:return An(e.type)&&cg(),Bt(e),null;case 19:if(Ie(Ue),r=e.memoizedState,r===null)return Bt(e),null;if(s=(e.flags&128)!==0,o=r.rendering,o===null)if(s)Iu(r,!1);else{if(ht!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(o=mg(n),o!==null){for(e.flags|=128,Iu(r,!1),s=o.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=t,t=e.child;t!==null;)r=t,n=s,r.flags&=14680066,o=r.alternate,o===null?(r.childLanes=0,r.lanes=n,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=o.childLanes,r.lanes=o.lanes,r.child=o.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=o.memoizedProps,r.memoizedState=o.memoizedState,r.updateQueue=o.updateQueue,r.type=o.type,n=o.dependencies,r.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return Le(Ue,Ue.current&1|2),e.child}n=n.sibling}r.tail!==null&&et()>mu&&(e.flags|=128,s=!0,Iu(r,!1),e.lanes=4194304)}else{if(!s)if(n=mg(o),n!==null){if(e.flags|=128,s=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),Iu(r,!0),r.tail===null&&r.tailMode==="hidden"&&!o.alternate&&!ze)return Bt(e),null}else 2*et()-r.renderingStartTime>mu&&t!==1073741824&&(e.flags|=128,s=!0,Iu(r,!1),e.lanes=4194304);r.isBackwards?(o.sibling=e.child,e.child=o):(t=r.last,t!==null?t.sibling=o:e.child=o,r.last=o)}return r.tail!==null?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=et(),e.sibling=null,t=Ue.current,Le(Ue,s?t&1|2:t&1),e):(Bt(e),null);case 22:case 23:return xw(),s=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?Wn&1073741824&&(Bt(e),e.subtreeFlags&6&&(e.flags|=8192)):Bt(e),null;case 24:return null;case 25:return null}throw Error(N(156,e.tag))}function DT(n,e){switch(iw(e),e.tag){case 1:return An(e.type)&&cg(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return pu(),Ie(bn),Ie(Kt),fw(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return hw(e),null;case 13:if(Ie(Ue),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(N(340));hu()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return Ie(Ue),null;case 4:return pu(),null;case 10:return lw(e.type._context),null;case 22:case 23:return xw(),null;case 24:return null;default:return null}}var tp=!1,Yt=!1,NT=typeof WeakSet=="function"?WeakSet:Set,U=null;function $l(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(s){qe(n,e,s)}else t.current=null}function av(n,e,t){try{t()}catch(s){qe(n,e,s)}}var aA=!1;function IT(n,e){if(Vy=rg,n=hE(),nw(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var s=t.getSelection&&t.getSelection();if(s&&s.rangeCount!==0){t=s.anchorNode;var i=s.anchorOffset,r=s.focusNode;s=s.focusOffset;try{t.nodeType,r.nodeType}catch{t=null;break e}var o=0,a=-1,c=-1,u=0,d=0,h=n,f=null;t:for(;;){for(var p;h!==t||i!==0&&h.nodeType!==3||(a=o+i),h!==r||s!==0&&h.nodeType!==3||(c=o+s),h.nodeType===3&&(o+=h.nodeValue.length),(p=h.firstChild)!==null;)f=h,h=p;for(;;){if(h===n)break t;if(f===t&&++u===i&&(a=o),f===r&&++d===s&&(c=o),(p=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=p}t=a===-1||c===-1?null:{start:a,end:c}}else t=null}t=t||{start:0,end:0}}else t=null;for(Gy={focusedElem:n,selectionRange:t},rg=!1,U=e;U!==null;)if(e=U,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,U=n;else for(;U!==null;){e=U;try{var w=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(w!==null){var g=w.memoizedProps,E=w.memoizedState,m=e.stateNode,v=m.getSnapshotBeforeUpdate(e.elementType===e.type?g:Cs(e.type,g),E);m.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(N(163))}}catch(x){qe(e,e.return,x)}if(n=e.sibling,n!==null){n.return=e.return,U=n;break}U=e.return}return w=aA,aA=!1,w}function md(n,e,t){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var i=s=s.next;do{if((i.tag&n)===n){var r=i.destroy;i.destroy=void 0,r!==void 0&&av(e,t,r)}i=i.next}while(i!==s)}}function dm(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var s=t.create;t.destroy=s()}t=t.next}while(t!==e)}}function lv(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function l1(n){var e=n.alternate;e!==null&&(n.alternate=null,l1(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[bi],delete e[Dd],delete e[Yy],delete e[yT],delete e[vT])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function c1(n){return n.tag===5||n.tag===3||n.tag===4}function lA(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||c1(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function cv(n,e,t){var s=n.tag;if(s===5||s===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=lg));else if(s!==4&&(n=n.child,n!==null))for(cv(n,e,t),n=n.sibling;n!==null;)cv(n,e,t),n=n.sibling}function uv(n,e,t){var s=n.tag;if(s===5||s===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(s!==4&&(n=n.child,n!==null))for(uv(n,e,t),n=n.sibling;n!==null;)uv(n,e,t),n=n.sibling}var Mt=null,Bs=!1;function Lr(n,e,t){for(t=t.child;t!==null;)u1(n,e,t),t=t.sibling}function u1(n,e,t){if(Ei&&typeof Ei.onCommitFiberUnmount=="function")try{Ei.onCommitFiberUnmount(sm,t)}catch{}switch(t.tag){case 5:Yt||$l(t,e);case 6:var s=Mt,i=Bs;Mt=null,Lr(n,e,t),Mt=s,Bs=i,Mt!==null&&(Bs?(n=Mt,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):Mt.removeChild(t.stateNode));break;case 18:Mt!==null&&(Bs?(n=Mt,t=t.stateNode,n.nodeType===8?Jm(n.parentNode,t):n.nodeType===1&&Jm(n,t),Td(n)):Jm(Mt,t.stateNode));break;case 4:s=Mt,i=Bs,Mt=t.stateNode.containerInfo,Bs=!0,Lr(n,e,t),Mt=s,Bs=i;break;case 0:case 11:case 14:case 15:if(!Yt&&(s=t.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){i=s=s.next;do{var r=i,o=r.destroy;r=r.tag,o!==void 0&&(r&2||r&4)&&av(t,e,o),i=i.next}while(i!==s)}Lr(n,e,t);break;case 1:if(!Yt&&($l(t,e),s=t.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=t.memoizedProps,s.state=t.memoizedState,s.componentWillUnmount()}catch(a){qe(t,e,a)}Lr(n,e,t);break;case 21:Lr(n,e,t);break;case 22:t.mode&1?(Yt=(s=Yt)||t.memoizedState!==null,Lr(n,e,t),Yt=s):Lr(n,e,t);break;default:Lr(n,e,t)}}function cA(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new NT),e.forEach(function(s){var i=VT.bind(null,n,s);t.has(s)||(t.add(s),s.then(i,i))})}}function xs(n,e){var t=e.deletions;if(t!==null)for(var s=0;s<t.length;s++){var i=t[s];try{var r=n,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Mt=a.stateNode,Bs=!1;break e;case 3:Mt=a.stateNode.containerInfo,Bs=!0;break e;case 4:Mt=a.stateNode.containerInfo,Bs=!0;break e}a=a.return}if(Mt===null)throw Error(N(160));u1(r,o,i),Mt=null,Bs=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(u){qe(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)d1(e,n),e=e.sibling}function d1(n,e){var t=n.alternate,s=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(xs(e,n),Zs(n),s&4){try{md(3,n,n.return),dm(3,n)}catch(g){qe(n,n.return,g)}try{md(5,n,n.return)}catch(g){qe(n,n.return,g)}}break;case 1:xs(e,n),Zs(n),s&512&&t!==null&&$l(t,t.return);break;case 5:if(xs(e,n),Zs(n),s&512&&t!==null&&$l(t,t.return),n.flags&32){var i=n.stateNode;try{xd(i,"")}catch(g){qe(n,n.return,g)}}if(s&4&&(i=n.stateNode,i!=null)){var r=n.memoizedProps,o=t!==null?t.memoizedProps:r,a=n.type,c=n.updateQueue;if(n.updateQueue=null,c!==null)try{a==="input"&&r.type==="radio"&&r.name!=null&&DS(i,r),Ny(a,o);var u=Ny(a,r);for(o=0;o<c.length;o+=2){var d=c[o],h=c[o+1];d==="style"?jS(i,h):d==="dangerouslySetInnerHTML"?OS(i,h):d==="children"?xd(i,h):U0(i,d,h,u)}switch(a){case"input":Ry(i,r);break;case"textarea":NS(i,r);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!r.multiple;var p=r.value;p!=null?Xl(i,!!r.multiple,p,!1):f!==!!r.multiple&&(r.defaultValue!=null?Xl(i,!!r.multiple,r.defaultValue,!0):Xl(i,!!r.multiple,r.multiple?[]:"",!1))}i[Dd]=r}catch(g){qe(n,n.return,g)}}break;case 6:if(xs(e,n),Zs(n),s&4){if(n.stateNode===null)throw Error(N(162));i=n.stateNode,r=n.memoizedProps;try{i.nodeValue=r}catch(g){qe(n,n.return,g)}}break;case 3:if(xs(e,n),Zs(n),s&4&&t!==null&&t.memoizedState.isDehydrated)try{Td(e.containerInfo)}catch(g){qe(n,n.return,g)}break;case 4:xs(e,n),Zs(n);break;case 13:xs(e,n),Zs(n),i=n.child,i.flags&8192&&(r=i.memoizedState!==null,i.stateNode.isHidden=r,!r||i.alternate!==null&&i.alternate.memoizedState!==null||(Sw=et())),s&4&&cA(n);break;case 22:if(d=t!==null&&t.memoizedState!==null,n.mode&1?(Yt=(u=Yt)||d,xs(e,n),Yt=u):xs(e,n),Zs(n),s&8192){if(u=n.memoizedState!==null,(n.stateNode.isHidden=u)&&!d&&n.mode&1)for(U=n,d=n.child;d!==null;){for(h=U=d;U!==null;){switch(f=U,p=f.child,f.tag){case 0:case 11:case 14:case 15:md(4,f,f.return);break;case 1:$l(f,f.return);var w=f.stateNode;if(typeof w.componentWillUnmount=="function"){s=f,t=f.return;try{e=s,w.props=e.memoizedProps,w.state=e.memoizedState,w.componentWillUnmount()}catch(g){qe(s,t,g)}}break;case 5:$l(f,f.return);break;case 22:if(f.memoizedState!==null){dA(h);continue}}p!==null?(p.return=f,U=p):dA(h)}d=d.sibling}e:for(d=null,h=n;;){if(h.tag===5){if(d===null){d=h;try{i=h.stateNode,u?(r=i.style,typeof r.setProperty=="function"?r.setProperty("display","none","important"):r.display="none"):(a=h.stateNode,c=h.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=FS("display",o))}catch(g){qe(n,n.return,g)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(g){qe(n,n.return,g)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===n)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===n)break e;for(;h.sibling===null;){if(h.return===null||h.return===n)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:xs(e,n),Zs(n),s&4&&cA(n);break;case 21:break;default:xs(e,n),Zs(n)}}function Zs(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(c1(t)){var s=t;break e}t=t.return}throw Error(N(160))}switch(s.tag){case 5:var i=s.stateNode;s.flags&32&&(xd(i,""),s.flags&=-33);var r=lA(n);uv(n,r,i);break;case 3:case 4:var o=s.stateNode.containerInfo,a=lA(n);cv(n,a,o);break;default:throw Error(N(161))}}catch(c){qe(n,n.return,c)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function OT(n,e,t){U=n,h1(n)}function h1(n,e,t){for(var s=(n.mode&1)!==0;U!==null;){var i=U,r=i.child;if(i.tag===22&&s){var o=i.memoizedState!==null||tp;if(!o){var a=i.alternate,c=a!==null&&a.memoizedState!==null||Yt;a=tp;var u=Yt;if(tp=o,(Yt=c)&&!u)for(U=i;U!==null;)o=U,c=o.child,o.tag===22&&o.memoizedState!==null?hA(i):c!==null?(c.return=o,U=c):hA(i);for(;r!==null;)U=r,h1(r),r=r.sibling;U=i,tp=a,Yt=u}uA(n)}else i.subtreeFlags&8772&&r!==null?(r.return=i,U=r):uA(n)}}function uA(n){for(;U!==null;){var e=U;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Yt||dm(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!Yt)if(t===null)s.componentDidMount();else{var i=e.elementType===e.type?t.memoizedProps:Cs(e.type,t.memoizedProps);s.componentDidUpdate(i,t.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var r=e.updateQueue;r!==null&&Yb(e,r,s);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}Yb(e,o,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&t.focus();break;case"img":c.src&&(t.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&Td(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(N(163))}Yt||e.flags&512&&lv(e)}catch(f){qe(e,e.return,f)}}if(e===n){U=null;break}if(t=e.sibling,t!==null){t.return=e.return,U=t;break}U=e.return}}function dA(n){for(;U!==null;){var e=U;if(e===n){U=null;break}var t=e.sibling;if(t!==null){t.return=e.return,U=t;break}U=e.return}}function hA(n){for(;U!==null;){var e=U;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{dm(4,e)}catch(c){qe(e,t,c)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var i=e.return;try{s.componentDidMount()}catch(c){qe(e,i,c)}}var r=e.return;try{lv(e)}catch(c){qe(e,r,c)}break;case 5:var o=e.return;try{lv(e)}catch(c){qe(e,o,c)}}}catch(c){qe(e,e.return,c)}if(e===n){U=null;break}var a=e.sibling;if(a!==null){a.return=e.return,U=a;break}U=e.return}}var FT=Math.ceil,wg=Cr.ReactCurrentDispatcher,bw=Cr.ReactCurrentOwner,ys=Cr.ReactCurrentBatchConfig,ge=0,Et=null,st=null,Ot=0,Wn=0,Hl=$o(0),ht=0,zd=null,dl=0,hm=0,Aw=0,yd=null,vn=null,Sw=0,mu=1/0,Ii=null,bg=!1,dv=null,Ro=null,np=!1,Eo=null,Ag=0,vd=0,hv=null,bp=-1,Ap=0;function ln(){return ge&6?et():bp!==-1?bp:bp=et()}function Po(n){return n.mode&1?ge&2&&Ot!==0?Ot&-Ot:bT.transition!==null?(Ap===0&&(Ap=KS()),Ap):(n=Ae,n!==0||(n=window.event,n=n===void 0?16:sE(n.type)),n):1}function Vs(n,e,t,s){if(50<vd)throw vd=0,hv=null,Error(N(185));Ef(n,t,s),(!(ge&2)||n!==Et)&&(n===Et&&(!(ge&2)&&(hm|=t),ht===4&&Fr(n,Ot)),Sn(n,s),t===1&&ge===0&&!(e.mode&1)&&(mu=et()+500,lm&&Ho()))}function Sn(n,e){var t=n.callbackNode;bk(n,e);var s=ig(n,n===Et?Ot:0);if(s===0)t!==null&&Ab(t),n.callbackNode=null,n.callbackPriority=0;else if(e=s&-s,n.callbackPriority!==e){if(t!=null&&Ab(t),e===1)n.tag===0?wT(fA.bind(null,n)):SE(fA.bind(null,n)),gT(function(){!(ge&6)&&Ho()}),t=null;else{switch(QS(s)){case 1:t=Y0;break;case 4:t=YS;break;case 16:t=sg;break;case 536870912:t=qS;break;default:t=sg}t=b1(t,f1.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function f1(n,e){if(bp=-1,Ap=0,ge&6)throw Error(N(327));var t=n.callbackNode;if(Jl()&&n.callbackNode!==t)return null;var s=ig(n,n===Et?Ot:0);if(s===0)return null;if(s&30||s&n.expiredLanes||e)e=Sg(n,s);else{e=s;var i=ge;ge|=2;var r=g1();(Et!==n||Ot!==e)&&(Ii=null,mu=et()+500,ol(n,e));do try{BT();break}catch(a){p1(n,a)}while(!0);aw(),wg.current=r,ge=i,st!==null?e=0:(Et=null,Ot=0,e=ht)}if(e!==0){if(e===2&&(i=zy(n),i!==0&&(s=i,e=fv(n,i))),e===1)throw t=zd,ol(n,0),Fr(n,s),Sn(n,et()),t;if(e===6)Fr(n,s);else{if(i=n.current.alternate,!(s&30)&&!jT(i)&&(e=Sg(n,s),e===2&&(r=zy(n),r!==0&&(s=r,e=fv(n,r))),e===1))throw t=zd,ol(n,0),Fr(n,s),Sn(n,et()),t;switch(n.finishedWork=i,n.finishedLanes=s,e){case 0:case 1:throw Error(N(345));case 2:Go(n,vn,Ii);break;case 3:if(Fr(n,s),(s&130023424)===s&&(e=Sw+500-et(),10<e)){if(ig(n,0)!==0)break;if(i=n.suspendedLanes,(i&s)!==s){ln(),n.pingedLanes|=n.suspendedLanes&i;break}n.timeoutHandle=Xy(Go.bind(null,n,vn,Ii),e);break}Go(n,vn,Ii);break;case 4:if(Fr(n,s),(s&4194240)===s)break;for(e=n.eventTimes,i=-1;0<s;){var o=31-Us(s);r=1<<o,o=e[o],o>i&&(i=o),s&=~r}if(s=i,s=et()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*FT(s/1960))-s,10<s){n.timeoutHandle=Xy(Go.bind(null,n,vn,Ii),s);break}Go(n,vn,Ii);break;case 5:Go(n,vn,Ii);break;default:throw Error(N(329))}}}return Sn(n,et()),n.callbackNode===t?f1.bind(null,n):null}function fv(n,e){var t=yd;return n.current.memoizedState.isDehydrated&&(ol(n,e).flags|=256),n=Sg(n,e),n!==2&&(e=vn,vn=t,e!==null&&pv(e)),n}function pv(n){vn===null?vn=n:vn.push.apply(vn,n)}function jT(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var s=0;s<t.length;s++){var i=t[s],r=i.getSnapshot;i=i.value;try{if(!Gs(r(),i))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Fr(n,e){for(e&=~Aw,e&=~hm,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-Us(e),s=1<<t;n[t]=-1,e&=~s}}function fA(n){if(ge&6)throw Error(N(327));Jl();var e=ig(n,0);if(!(e&1))return Sn(n,et()),null;var t=Sg(n,e);if(n.tag!==0&&t===2){var s=zy(n);s!==0&&(e=s,t=fv(n,s))}if(t===1)throw t=zd,ol(n,0),Fr(n,e),Sn(n,et()),t;if(t===6)throw Error(N(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,Go(n,vn,Ii),Sn(n,et()),null}function Ew(n,e){var t=ge;ge|=1;try{return n(e)}finally{ge=t,ge===0&&(mu=et()+500,lm&&Ho())}}function hl(n){Eo!==null&&Eo.tag===0&&!(ge&6)&&Jl();var e=ge;ge|=1;var t=ys.transition,s=Ae;try{if(ys.transition=null,Ae=1,n)return n()}finally{Ae=s,ys.transition=t,ge=e,!(ge&6)&&Ho()}}function xw(){Wn=Hl.current,Ie(Hl)}function ol(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,pT(t)),st!==null)for(t=st.return;t!==null;){var s=t;switch(iw(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&cg();break;case 3:pu(),Ie(bn),Ie(Kt),fw();break;case 5:hw(s);break;case 4:pu();break;case 13:Ie(Ue);break;case 19:Ie(Ue);break;case 10:lw(s.type._context);break;case 22:case 23:xw()}t=t.return}if(Et=n,st=n=Lo(n.current,null),Ot=Wn=e,ht=0,zd=null,Aw=hm=dl=0,vn=yd=null,Jo!==null){for(e=0;e<Jo.length;e++)if(t=Jo[e],s=t.interleaved,s!==null){t.interleaved=null;var i=s.next,r=t.pending;if(r!==null){var o=r.next;r.next=i,s.next=o}t.pending=s}Jo=null}return n}function p1(n,e){do{var t=st;try{if(aw(),yp.current=vg,yg){for(var s=Ve.memoizedState;s!==null;){var i=s.queue;i!==null&&(i.pending=null),s=s.next}yg=!1}if(ul=0,At=ct=Ve=null,gd=!1,Od=0,bw.current=null,t===null||t.return===null){ht=1,zd=e,st=null;break}e:{var r=n,o=t.return,a=t,c=e;if(e=Ot,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=a,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=eA(o);if(p!==null){p.flags&=-257,tA(p,o,a,r,e),p.mode&1&&Zb(r,u,e),e=p,c=u;var w=e.updateQueue;if(w===null){var g=new Set;g.add(c),e.updateQueue=g}else w.add(c);break e}else{if(!(e&1)){Zb(r,u,e),_w();break e}c=Error(N(426))}}else if(ze&&a.mode&1){var E=eA(o);if(E!==null){!(E.flags&65536)&&(E.flags|=256),tA(E,o,a,r,e),rw(gu(c,a));break e}}r=c=gu(c,a),ht!==4&&(ht=2),yd===null?yd=[r]:yd.push(r),r=o;do{switch(r.tag){case 3:r.flags|=65536,e&=-e,r.lanes|=e;var m=QE(r,c,e);Xb(r,m);break e;case 1:a=c;var v=r.type,b=r.stateNode;if(!(r.flags&128)&&(typeof v.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Ro===null||!Ro.has(b)))){r.flags|=65536,e&=-e,r.lanes|=e;var x=JE(r,a,e);Xb(r,x);break e}}r=r.return}while(r!==null)}y1(t)}catch(_){e=_,st===t&&t!==null&&(st=t=t.return);continue}break}while(!0)}function g1(){var n=wg.current;return wg.current=vg,n===null?vg:n}function _w(){(ht===0||ht===3||ht===2)&&(ht=4),Et===null||!(dl&268435455)&&!(hm&268435455)||Fr(Et,Ot)}function Sg(n,e){var t=ge;ge|=2;var s=g1();(Et!==n||Ot!==e)&&(Ii=null,ol(n,e));do try{zT();break}catch(i){p1(n,i)}while(!0);if(aw(),ge=t,wg.current=s,st!==null)throw Error(N(261));return Et=null,Ot=0,ht}function zT(){for(;st!==null;)m1(st)}function BT(){for(;st!==null&&!dk();)m1(st)}function m1(n){var e=w1(n.alternate,n,Wn);n.memoizedProps=n.pendingProps,e===null?y1(n):st=e,bw.current=null}function y1(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=DT(t,e),t!==null){t.flags&=32767,st=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{ht=6,st=null;return}}else if(t=MT(t,e,Wn),t!==null){st=t;return}if(e=e.sibling,e!==null){st=e;return}st=e=n}while(e!==null);ht===0&&(ht=5)}function Go(n,e,t){var s=Ae,i=ys.transition;try{ys.transition=null,Ae=1,$T(n,e,t,s)}finally{ys.transition=i,Ae=s}return null}function $T(n,e,t,s){do Jl();while(Eo!==null);if(ge&6)throw Error(N(327));t=n.finishedWork;var i=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(N(177));n.callbackNode=null,n.callbackPriority=0;var r=t.lanes|t.childLanes;if(Ak(n,r),n===Et&&(st=Et=null,Ot=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||np||(np=!0,b1(sg,function(){return Jl(),null})),r=(t.flags&15990)!==0,t.subtreeFlags&15990||r){r=ys.transition,ys.transition=null;var o=Ae;Ae=1;var a=ge;ge|=4,bw.current=null,IT(n,t),d1(t,n),aT(Gy),rg=!!Vy,Gy=Vy=null,n.current=t,OT(t),hk(),ge=a,Ae=o,ys.transition=r}else n.current=t;if(np&&(np=!1,Eo=n,Ag=i),r=n.pendingLanes,r===0&&(Ro=null),gk(t.stateNode),Sn(n,et()),e!==null)for(s=n.onRecoverableError,t=0;t<e.length;t++)i=e[t],s(i.value,{componentStack:i.stack,digest:i.digest});if(bg)throw bg=!1,n=dv,dv=null,n;return Ag&1&&n.tag!==0&&Jl(),r=n.pendingLanes,r&1?n===hv?vd++:(vd=0,hv=n):vd=0,Ho(),null}function Jl(){if(Eo!==null){var n=QS(Ag),e=ys.transition,t=Ae;try{if(ys.transition=null,Ae=16>n?16:n,Eo===null)var s=!1;else{if(n=Eo,Eo=null,Ag=0,ge&6)throw Error(N(331));var i=ge;for(ge|=4,U=n.current;U!==null;){var r=U,o=r.child;if(U.flags&16){var a=r.deletions;if(a!==null){for(var c=0;c<a.length;c++){var u=a[c];for(U=u;U!==null;){var d=U;switch(d.tag){case 0:case 11:case 15:md(8,d,r)}var h=d.child;if(h!==null)h.return=d,U=h;else for(;U!==null;){d=U;var f=d.sibling,p=d.return;if(l1(d),d===u){U=null;break}if(f!==null){f.return=p,U=f;break}U=p}}}var w=r.alternate;if(w!==null){var g=w.child;if(g!==null){w.child=null;do{var E=g.sibling;g.sibling=null,g=E}while(g!==null)}}U=r}}if(r.subtreeFlags&2064&&o!==null)o.return=r,U=o;else e:for(;U!==null;){if(r=U,r.flags&2048)switch(r.tag){case 0:case 11:case 15:md(9,r,r.return)}var m=r.sibling;if(m!==null){m.return=r.return,U=m;break e}U=r.return}}var v=n.current;for(U=v;U!==null;){o=U;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,U=b;else e:for(o=v;U!==null;){if(a=U,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:dm(9,a)}}catch(_){qe(a,a.return,_)}if(a===o){U=null;break e}var x=a.sibling;if(x!==null){x.return=a.return,U=x;break e}U=a.return}}if(ge=i,Ho(),Ei&&typeof Ei.onPostCommitFiberRoot=="function")try{Ei.onPostCommitFiberRoot(sm,n)}catch{}s=!0}return s}finally{Ae=t,ys.transition=e}}return!1}function pA(n,e,t){e=gu(t,e),e=QE(n,e,1),n=To(n,e,1),e=ln(),n!==null&&(Ef(n,1,e),Sn(n,e))}function qe(n,e,t){if(n.tag===3)pA(n,n,t);else for(;e!==null;){if(e.tag===3){pA(e,n,t);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(Ro===null||!Ro.has(s))){n=gu(t,n),n=JE(e,n,1),e=To(e,n,1),n=ln(),e!==null&&(Ef(e,1,n),Sn(e,n));break}}e=e.return}}function HT(n,e,t){var s=n.pingCache;s!==null&&s.delete(e),e=ln(),n.pingedLanes|=n.suspendedLanes&t,Et===n&&(Ot&t)===t&&(ht===4||ht===3&&(Ot&130023424)===Ot&&500>et()-Sw?ol(n,0):Aw|=t),Sn(n,e)}function v1(n,e){e===0&&(n.mode&1?(e=Wf,Wf<<=1,!(Wf&130023424)&&(Wf=4194304)):e=1);var t=ln();n=Ar(n,e),n!==null&&(Ef(n,e,t),Sn(n,t))}function UT(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),v1(n,t)}function VT(n,e){var t=0;switch(n.tag){case 13:var s=n.stateNode,i=n.memoizedState;i!==null&&(t=i.retryLane);break;case 19:s=n.stateNode;break;default:throw Error(N(314))}s!==null&&s.delete(e),v1(n,t)}var w1;w1=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||bn.current)wn=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return wn=!1,LT(n,e,t);wn=!!(n.flags&131072)}else wn=!1,ze&&e.flags&1048576&&EE(e,hg,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;wp(n,e),n=e.pendingProps;var i=du(e,Kt.current);Ql(e,t),i=gw(null,e,s,n,i,t);var r=mw();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,An(s)?(r=!0,ug(e)):r=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,uw(e),i.updater=um,e.stateNode=i,i._reactInternals=e,ev(e,s,n,t),e=sv(null,e,s,!0,r,t)):(e.tag=0,ze&&r&&sw(e),rn(null,e,i,t),e=e.child),e;case 16:s=e.elementType;e:{switch(wp(n,e),n=e.pendingProps,i=s._init,s=i(s._payload),e.type=s,i=e.tag=WT(s),n=Cs(s,n),i){case 0:e=nv(null,e,s,n,t);break e;case 1:e=iA(null,e,s,n,t);break e;case 11:e=nA(null,e,s,n,t);break e;case 14:e=sA(null,e,s,Cs(s.type,n),t);break e}throw Error(N(306,s,""))}return e;case 0:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:Cs(s,i),nv(n,e,s,i,t);case 1:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:Cs(s,i),iA(n,e,s,i,t);case 3:e:{if(n1(e),n===null)throw Error(N(387));s=e.pendingProps,r=e.memoizedState,i=r.element,RE(n,e),gg(e,s,null,t);var o=e.memoizedState;if(s=o.element,r.isDehydrated)if(r={element:s,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=r,e.memoizedState=r,e.flags&256){i=gu(Error(N(423)),e),e=rA(n,e,s,t,i);break e}else if(s!==i){i=gu(Error(N(424)),e),e=rA(n,e,s,t,i);break e}else for(qn=ko(e.stateNode.containerInfo.firstChild),Kn=e,ze=!0,$s=null,t=kE(e,null,s,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(hu(),s===i){e=Sr(n,e,t);break e}rn(n,e,s,t)}e=e.child}return e;case 5:return PE(e),n===null&&Qy(e),s=e.type,i=e.pendingProps,r=n!==null?n.memoizedProps:null,o=i.children,Wy(s,i)?o=null:r!==null&&Wy(s,r)&&(e.flags|=32),t1(n,e),rn(n,e,o,t),e.child;case 6:return n===null&&Qy(e),null;case 13:return s1(n,e,t);case 4:return dw(e,e.stateNode.containerInfo),s=e.pendingProps,n===null?e.child=fu(e,null,s,t):rn(n,e,s,t),e.child;case 11:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:Cs(s,i),nA(n,e,s,i,t);case 7:return rn(n,e,e.pendingProps,t),e.child;case 8:return rn(n,e,e.pendingProps.children,t),e.child;case 12:return rn(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(s=e.type._context,i=e.pendingProps,r=e.memoizedProps,o=i.value,Le(fg,s._currentValue),s._currentValue=o,r!==null)if(Gs(r.value,o)){if(r.children===i.children&&!bn.current){e=Sr(n,e,t);break e}}else for(r=e.child,r!==null&&(r.return=e);r!==null;){var a=r.dependencies;if(a!==null){o=r.child;for(var c=a.firstContext;c!==null;){if(c.context===s){if(r.tag===1){c=mr(-1,t&-t),c.tag=2;var u=r.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}r.lanes|=t,c=r.alternate,c!==null&&(c.lanes|=t),Jy(r.return,t,e),a.lanes|=t;break}c=c.next}}else if(r.tag===10)o=r.type===e.type?null:r.child;else if(r.tag===18){if(o=r.return,o===null)throw Error(N(341));o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),Jy(o,t,e),o=r.sibling}else o=r.child;if(o!==null)o.return=r;else for(o=r;o!==null;){if(o===e){o=null;break}if(r=o.sibling,r!==null){r.return=o.return,o=r;break}o=o.return}r=o}rn(n,e,i.children,t),e=e.child}return e;case 9:return i=e.type,s=e.pendingProps.children,Ql(e,t),i=ws(i),s=s(i),e.flags|=1,rn(n,e,s,t),e.child;case 14:return s=e.type,i=Cs(s,e.pendingProps),i=Cs(s.type,i),sA(n,e,s,i,t);case 15:return ZE(n,e,e.type,e.pendingProps,t);case 17:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:Cs(s,i),wp(n,e),e.tag=1,An(s)?(n=!0,ug(e)):n=!1,Ql(e,t),KE(e,s,i),ev(e,s,i,t),sv(null,e,s,!0,n,t);case 19:return i1(n,e,t);case 22:return e1(n,e,t)}throw Error(N(156,e.tag))};function b1(n,e){return XS(n,e)}function GT(n,e,t,s){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ms(n,e,t,s){return new GT(n,e,t,s)}function Cw(n){return n=n.prototype,!(!n||!n.isReactComponent)}function WT(n){if(typeof n=="function")return Cw(n)?1:0;if(n!=null){if(n=n.$$typeof,n===G0)return 11;if(n===W0)return 14}return 2}function Lo(n,e){var t=n.alternate;return t===null?(t=ms(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function Sp(n,e,t,s,i,r){var o=2;if(s=n,typeof n=="function")Cw(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case Ml:return al(t.children,i,r,e);case V0:o=8,i|=8;break;case xy:return n=ms(12,t,e,i|2),n.elementType=xy,n.lanes=r,n;case _y:return n=ms(13,t,e,i),n.elementType=_y,n.lanes=r,n;case Cy:return n=ms(19,t,e,i),n.elementType=Cy,n.lanes=r,n;case PS:return fm(t,i,r,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case TS:o=10;break e;case RS:o=9;break e;case G0:o=11;break e;case W0:o=14;break e;case Dr:o=16,s=null;break e}throw Error(N(130,n==null?n:typeof n,""))}return e=ms(o,t,e,i),e.elementType=n,e.type=s,e.lanes=r,e}function al(n,e,t,s){return n=ms(7,n,s,e),n.lanes=t,n}function fm(n,e,t,s){return n=ms(22,n,s,e),n.elementType=PS,n.lanes=t,n.stateNode={isHidden:!1},n}function oy(n,e,t){return n=ms(6,n,null,e),n.lanes=t,n}function ay(n,e,t){return e=ms(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function XT(n,e,t,s,i){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=$m(0),this.expirationTimes=$m(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=$m(0),this.identifierPrefix=s,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function kw(n,e,t,s,i,r,o,a,c){return n=new XT(n,e,t,a,c),e===1?(e=1,r===!0&&(e|=8)):e=0,r=ms(3,null,null,e),n.current=r,r.stateNode=n,r.memoizedState={element:s,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},uw(r),n}function YT(n,e,t){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ll,key:s==null?null:""+s,children:n,containerInfo:e,implementation:t}}function A1(n){if(!n)return Do;n=n._reactInternals;e:{if(yl(n)!==n||n.tag!==1)throw Error(N(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(An(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(N(171))}if(n.tag===1){var t=n.type;if(An(t))return AE(n,t,e)}return e}function S1(n,e,t,s,i,r,o,a,c){return n=kw(t,s,!0,n,i,r,o,a,c),n.context=A1(null),t=n.current,s=ln(),i=Po(t),r=mr(s,i),r.callback=e??null,To(t,r,i),n.current.lanes=i,Ef(n,i,s),Sn(n,s),n}function pm(n,e,t,s){var i=e.current,r=ln(),o=Po(i);return t=A1(t),e.context===null?e.context=t:e.pendingContext=t,e=mr(r,o),e.payload={element:n},s=s===void 0?null:s,s!==null&&(e.callback=s),n=To(i,e,o),n!==null&&(Vs(n,i,o,r),mp(n,i,o)),o}function Eg(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function gA(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function Tw(n,e){gA(n,e),(n=n.alternate)&&gA(n,e)}function qT(){return null}var E1=typeof reportError=="function"?reportError:function(n){console.error(n)};function Rw(n){this._internalRoot=n}gm.prototype.render=Rw.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(N(409));pm(n,e,null,null)};gm.prototype.unmount=Rw.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;hl(function(){pm(null,n,null,null)}),e[br]=null}};function gm(n){this._internalRoot=n}gm.prototype.unstable_scheduleHydration=function(n){if(n){var e=eE();n={blockedOn:null,target:n,priority:e};for(var t=0;t<Or.length&&e!==0&&e<Or[t].priority;t++);Or.splice(t,0,n),t===0&&nE(n)}};function Pw(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function mm(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function mA(){}function KT(n,e,t,s,i){if(i){if(typeof s=="function"){var r=s;s=function(){var u=Eg(o);r.call(u)}}var o=S1(e,s,n,0,null,!1,!1,"",mA);return n._reactRootContainer=o,n[br]=o.current,Ld(n.nodeType===8?n.parentNode:n),hl(),o}for(;i=n.lastChild;)n.removeChild(i);if(typeof s=="function"){var a=s;s=function(){var u=Eg(c);a.call(u)}}var c=kw(n,0,!1,null,null,!1,!1,"",mA);return n._reactRootContainer=c,n[br]=c.current,Ld(n.nodeType===8?n.parentNode:n),hl(function(){pm(e,c,t,s)}),c}function ym(n,e,t,s,i){var r=t._reactRootContainer;if(r){var o=r;if(typeof i=="function"){var a=i;i=function(){var c=Eg(o);a.call(c)}}pm(e,o,n,i)}else o=KT(t,e,n,i,s);return Eg(o)}JS=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=Uu(e.pendingLanes);t!==0&&(q0(e,t|1),Sn(e,et()),!(ge&6)&&(mu=et()+500,Ho()))}break;case 13:hl(function(){var s=Ar(n,1);if(s!==null){var i=ln();Vs(s,n,1,i)}}),Tw(n,1)}};K0=function(n){if(n.tag===13){var e=Ar(n,134217728);if(e!==null){var t=ln();Vs(e,n,134217728,t)}Tw(n,134217728)}};ZS=function(n){if(n.tag===13){var e=Po(n),t=Ar(n,e);if(t!==null){var s=ln();Vs(t,n,e,s)}Tw(n,e)}};eE=function(){return Ae};tE=function(n,e){var t=Ae;try{return Ae=n,e()}finally{Ae=t}};Oy=function(n,e,t){switch(e){case"input":if(Ry(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var s=t[e];if(s!==n&&s.form===n.form){var i=am(s);if(!i)throw Error(N(90));MS(s),Ry(s,i)}}}break;case"textarea":NS(n,t);break;case"select":e=t.value,e!=null&&Xl(n,!!t.multiple,e,!1)}};$S=Ew;HS=hl;var QT={usingClientEntryPoint:!1,Events:[_f,Ol,am,zS,BS,Ew]},Ou={findFiberByHostInstance:Qo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},JT={bundleType:Ou.bundleType,version:Ou.version,rendererPackageName:Ou.rendererPackageName,rendererConfig:Ou.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Cr.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=GS(n),n===null?null:n.stateNode},findFiberByHostInstance:Ou.findFiberByHostInstance||qT,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var sp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!sp.isDisabled&&sp.supportsFiber)try{sm=sp.inject(JT),Ei=sp}catch{}}Zn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=QT;Zn.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Pw(e))throw Error(N(200));return YT(n,e,null,t)};Zn.createRoot=function(n,e){if(!Pw(n))throw Error(N(299));var t=!1,s="",i=E1;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=kw(n,1,!1,null,null,t,!1,s,i),n[br]=e.current,Ld(n.nodeType===8?n.parentNode:n),new Rw(e)};Zn.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(N(188)):(n=Object.keys(n).join(","),Error(N(268,n)));return n=GS(e),n=n===null?null:n.stateNode,n};Zn.flushSync=function(n){return hl(n)};Zn.hydrate=function(n,e,t){if(!mm(e))throw Error(N(200));return ym(null,n,e,!0,t)};Zn.hydrateRoot=function(n,e,t){if(!Pw(n))throw Error(N(405));var s=t!=null&&t.hydratedSources||null,i=!1,r="",o=E1;if(t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=S1(e,null,n,1,t??null,i,!1,r,o),n[br]=e.current,Ld(n),s)for(n=0;n<s.length;n++)t=s[n],i=t._getVersion,i=i(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,i]:e.mutableSourceEagerHydrationData.push(t,i);return new gm(e)};Zn.render=function(n,e,t){if(!mm(e))throw Error(N(200));return ym(null,n,e,!1,t)};Zn.unmountComponentAtNode=function(n){if(!mm(n))throw Error(N(40));return n._reactRootContainer?(hl(function(){ym(null,null,n,!1,function(){n._reactRootContainer=null,n[br]=null})}),!0):!1};Zn.unstable_batchedUpdates=Ew;Zn.unstable_renderSubtreeIntoContainer=function(n,e,t,s){if(!mm(t))throw Error(N(200));if(n==null||n._reactInternals===void 0)throw Error(N(38));return ym(n,e,t,!1,s)};Zn.version="18.3.1-next-f1338f8080-20240426";function x1(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(x1)}catch(n){console.error(n)}}x1(),xS.exports=Zn;var Ul=xS.exports,yA=Ul;Sy.createRoot=yA.createRoot,Sy.hydrateRoot=yA.hydrateRoot;const ZT={},vA=n=>{let e;const t=new Set,s=(d,h)=>{const f=typeof d=="function"?d(e):d;if(!Object.is(f,e)){const p=e;e=h??(typeof f!="object"||f===null)?f:Object.assign({},e,f),t.forEach(w=>w(e,p))}},i=()=>e,c={setState:s,getState:i,getInitialState:()=>u,subscribe:d=>(t.add(d),()=>t.delete(d)),destroy:()=>{(ZT?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},u=e=n(s,i,c);return c},eR=n=>n?vA(n):vA;var _1={exports:{}},C1={},k1={exports:{}},T1={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yu=R;function tR(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var nR=typeof Object.is=="function"?Object.is:tR,sR=yu.useState,iR=yu.useEffect,rR=yu.useLayoutEffect,oR=yu.useDebugValue;function aR(n,e){var t=e(),s=sR({inst:{value:t,getSnapshot:e}}),i=s[0].inst,r=s[1];return rR(function(){i.value=t,i.getSnapshot=e,ly(i)&&r({inst:i})},[n,t,e]),iR(function(){return ly(i)&&r({inst:i}),n(function(){ly(i)&&r({inst:i})})},[n]),oR(t),t}function ly(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!nR(n,t)}catch{return!0}}function lR(n,e){return e()}var cR=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?lR:aR;T1.useSyncExternalStore=yu.useSyncExternalStore!==void 0?yu.useSyncExternalStore:cR;k1.exports=T1;var uR=k1.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vm=R,dR=uR;function hR(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var fR=typeof Object.is=="function"?Object.is:hR,pR=dR.useSyncExternalStore,gR=vm.useRef,mR=vm.useEffect,yR=vm.useMemo,vR=vm.useDebugValue;C1.useSyncExternalStoreWithSelector=function(n,e,t,s,i){var r=gR(null);if(r.current===null){var o={hasValue:!1,value:null};r.current=o}else o=r.current;r=yR(function(){function c(p){if(!u){if(u=!0,d=p,p=s(p),i!==void 0&&o.hasValue){var w=o.value;if(i(w,p))return h=w}return h=p}if(w=h,fR(d,p))return w;var g=s(p);return i!==void 0&&i(w,g)?(d=p,w):(d=p,h=g)}var u=!1,d,h,f=t===void 0?null:t;return[function(){return c(e())},f===null?void 0:function(){return c(f())}]},[e,t,s,i]);var a=pR(n,r[0],r[1]);return mR(function(){o.hasValue=!0,o.value=a},[a]),vR(a),a};_1.exports=C1;var wR=_1.exports;const bR=O0(wR),R1={},{useDebugValue:AR}=on,{useSyncExternalStoreWithSelector:SR}=bR;let wA=!1;const ER=n=>n;function xR(n,e=ER,t){(R1?"production":void 0)!=="production"&&t&&!wA&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),wA=!0);const s=SR(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return AR(s),s}const bA=n=>{(R1?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?eR(n):n,t=(s,i)=>xR(e,s,i);return Object.assign(t,e),t},_R=n=>n?bA(n):bA,ut="http://localhost:8000/api/v1",Li={async getComponents(){const n=await fetch(`${ut}/components/`);if(!n.ok)throw new Error("Failed to fetch components");return n.json()},async getLinks(){const n=await fetch(`${ut}/links/`);if(!n.ok)throw new Error("Failed to fetch links");return n.json()},async createComponent(n){const e=await fetch(`${ut}/components/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!e.ok)throw new Error("Failed to create component");return e.json()},async createLink(n){const e=await fetch(`${ut}/links/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!e.ok)throw new Error("Failed to create link");return e.json()},async updateComponent(n,e){const t=await fetch(`${ut}/components/${n}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw new Error("Failed to update component");return t.json()},async deleteComponent(n){if(!(await fetch(`${ut}/components/${n}`,{method:"DELETE"})).ok)throw new Error("Failed to delete component")},async analyzeDesign(n,e){const t=await fetch(`${ut}/ai/analyze-design`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({command:e,snapshot:n})});if(!t.ok)throw new Error(`Analyze failed: ${t.status}`);return t.json()},async sendCommandToAI(n){const e=await fetch(`${ut}/ai/command`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({command:n})});if(!e.ok){const t=await e.text();throw new Error(`AI endpoint error ${e.status}: ${t.slice(0,120)}`)}return e.json()}};async function CR(n,e){return new Promise((t,s)=>{const i=new XMLHttpRequest,r=new FormData;r.append("file",n),i.upload.onprogress=o=>{o.lengthComputable&&e(Math.round(o.loaded/o.total*100))},i.onload=()=>{i.status>=200&&i.status<300?t(JSON.parse(i.responseText)):s(i)},i.onerror=()=>s(i),i.open("POST",`${ut}/files/upload`),i.send(r)})}async function kR(){const n=await fetch(`${ut}/files/`);if(!n.ok)throw new Error("Failed to fetch files");return n.json()}async function gv(n){const e=await fetch(`${ut}/files/${n}/parse`,{method:"POST"});if(!e.ok){const t=await e.json();throw new Error(t.detail||"Failed to parse datasheet")}return e.json()}async function xg(n){const e=await fetch(`${ut}/files/${n}`);if(!e.ok){const t=await e.json();throw new Error(t.detail||"Failed to fetch status")}return e.json()}async function AA(n,e,t){const s={parsed_payload:e};typeof t=="boolean"&&(s.is_human_verified=t);const i=await fetch(`${ut}/files/${n}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!i.ok){const r=await i.json();throw new Error(r.detail||"Failed to save datasheet")}return i.json()}const se=_R((n,e)=>({canvasComponents:[],links:[],ghostLinks:[],bomItems:null,selectedComponentId:null,messages:[],status:"loading",statusMessages:[],chatMode:"default",isAiProcessing:!1,route:"projects",isSubNavVisible:!0,fileStagingAreaVisible:!1,stagedFiles:[],uploads:[],useRuleBased:!0,useTableExtraction:!0,useAiExtraction:!0,useOcrFallback:!1,voiceMode:"idle",isContinuousConversation:!1,voiceTranscript:"",voiceOutputEnabled:!1,chatDraft:"",activeDatasheet:null,setActiveDatasheet:t=>n({activeDatasheet:t}),setVoiceMode:t=>n({voiceMode:t}),toggleContinuousConversation:()=>n(t=>({isContinuousConversation:!t.isContinuousConversation})),startListening:()=>{n({voiceTranscript:"",voiceMode:"listening"})},stopListening:t=>{n({voiceMode:"idle",voiceTranscript:""}),t&&t.trim()&&e().analyzeAndExecute(t.trim())},updateVoiceTranscript:t=>n({voiceTranscript:t}),toggleVoiceOutput:()=>n(t=>({voiceOutputEnabled:!t.voiceOutputEnabled})),setChatDraft:t=>n({chatDraft:t}),clearChatDraft:()=>n({chatDraft:""}),toggleSubNav:()=>n(t=>({isSubNavVisible:!t.isSubNavVisible})),toggleFileStagingArea:()=>n(t=>({fileStagingAreaVisible:!t.fileStagingAreaVisible})),setFileStagingAreaVisible:t=>n({fileStagingAreaVisible:t}),addStagedFiles:t=>n(s=>({stagedFiles:[...s.stagedFiles,...t],fileStagingAreaVisible:!0})),setExtractionSetting:(t,s)=>n(i=>({...i,[t]:s})),addStatusMessage:(t,s)=>n(i=>({statusMessages:[...i.statusMessages,{id:crypto.randomUUID(),message:t,icon:s}]})),removeStatusMessage:t=>n(s=>({statusMessages:s.statusMessages.filter(i=>i.id!==t)})),addMessage:t=>n(s=>({messages:[...s.messages,t]})),selectComponent:t=>n({selectedComponentId:t}),async fetchProject(){n({status:"loading"}),e().addStatusMessage("Loading project...","info");try{const[t,s]=await Promise.all([Li.getComponents(),Li.getLinks()]),i=t.map(r=>({...r,ports:[{id:"input",type:"in"},{id:"output",type:"out"}]}));n({canvasComponents:i,links:s,status:"ready"}),e().addStatusMessage("Project loaded","success")}catch(t){console.error("Failed to load project:",t),n({status:"Error: Could not load project"}),e().addStatusMessage("Failed to load project","error")}},async addComponent(t){n({status:`Adding ${t.type}...`}),e().addStatusMessage(`Adding ${t.type}...`,"info");try{const s=await Li.createComponent(t),i={...s,ports:[{id:"input",type:"in"},{id:"output",type:"out"}]};n(r=>({canvasComponents:[...r.canvasComponents,i],status:`Component ${s.name} added`})),e().addStatusMessage(`Component ${s.name} added`,"success")}catch(s){console.error("Failed to add component:",s),n({status:"Error: Could not add component"}),e().addStatusMessage("Failed to add component","error")}},async updateComponentName(t,s){const i=e().canvasComponents,r=i.map(o=>o.id===t?{...o,name:s}:o);n({canvasComponents:r});try{await Li.updateComponent(t,{name:s})}catch(o){console.error("Failed to update component name:",o),n({canvasComponents:i})}},async updateComponentPosition(t,s){const i=e().canvasComponents,r=i.find(u=>u.id===t);if(!r)return;const o=Math.round(r.x+s.x),a=Math.round(r.y+s.y),c={...r,x:o,y:a};n({canvasComponents:i.map(u=>u.id===t?c:u)});try{await Li.updateComponent(t,{x:o,y:a})}catch(u){console.error("Failed to save new position:",u),n({canvasComponents:i})}},async deleteComponent(t){n(s=>({canvasComponents:s.canvasComponents.filter(i=>i.id!==t),links:s.links.filter(i=>i.source_id!==t&&i.target_id!==t),selectedComponentId:null}));try{await Li.deleteComponent(t)}catch(s){console.error("Failed to delete component:",s),e().fetchProject()}},async addLink({source_id:t,target_id:s}){if(!(e().links.some(r=>r.source_id===t&&r.target_id===s)||t===s)){n({status:"Creating link..."}),e().addStatusMessage("Creating link...","info");try{const r=await Li.createLink({source_id:t,target_id:s});n(o=>({links:[...o.links,r],status:"Link created"})),e().addStatusMessage("Link created","success")}catch(r){console.error("Failed to add link:",r),n({status:"Error: Could not create link"}),e().addStatusMessage("Failed to create link","error")}}},async executeAiActions(t){for(const s of t)switch(s.action){case"addComponent":await e().addComponent(s.payload);break;case"removeComponent":await e().deleteComponent(s.payload.id);break;case"addLink":await Li.createLink(s.payload);break;case"suggestLink":n(i=>({ghostLinks:[...i.ghostLinks,s.payload]}));break;case"updatePosition":n(i=>({canvasComponents:i.canvasComponents.map(r=>r.id===s.payload.id?{...r,x:s.payload.x,y:s.payload.y}:r)}));break;case"report":e().setBom(s.payload.items);break;default:console.warn("AI action not implemented",s)}},async analyzeAndExecute(t){const{addMessage:s,setIsAiProcessing:i,executeAiActions:r,canvasComponents:o,links:a}=e();s({id:crypto.randomUUID(),author:"User",text:t}),i(!0),e().addStatusMessage("Processing command","info");try{const c={components:o,links:a},u=await Li.analyzeDesign(c,t);await r(u);const d=`I have successfully executed ${u.length} action(s).`;s({id:crypto.randomUUID(),author:"AI",text:d}),e().addStatusMessage("AI actions executed","success")}catch(c){console.error("AI command failed:",c),s({id:crypto.randomUUID(),author:"AI",text:"Sorry, I ran into an error trying to do that."}),n({status:"Error: AI command failed"}),e().addStatusMessage("AI command failed","error")}finally{i(!1)}},setBom(t){n({bomItems:t})},setChatMode(t){n({chatMode:t})},setIsAiProcessing(t){n({isAiProcessing:t})},setRoute(t){n({route:t})},addUpload(t){n(s=>({uploads:[...s.uploads,t]}))},updateUpload(t,s){n(i=>({uploads:i.uploads.map(r=>r.id===t?{...r,...s}:r)}))},async loadUploads(){try{const t=await kR();n({uploads:t.map(s=>({id:s.id,name:s.filename,size:s.size,mime:s.mime,progress:101,assetType:"component",parsed_at:s.parsed_at,parsing_status:s.parsing_status??null,parsing_error:s.parsing_error??null,is_human_verified:s.is_human_verified??!1}))})}catch(t){console.error("Failed to load uploads",t)}}}));/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TR=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),RR=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase()),SA=n=>{const e=RR(n);return e.charAt(0).toUpperCase()+e.slice(1)},P1=(...n)=>n.filter((e,t,s)=>!!e&&e.trim()!==""&&s.indexOf(e)===t).join(" ").trim(),PR=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var LR={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MR=R.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:s,className:i="",children:r,iconNode:o,...a},c)=>R.createElement("svg",{ref:c,...LR,width:e,height:e,stroke:n,strokeWidth:s?Number(t)*24/Number(e):t,className:P1("lucide",i),...!r&&!PR(a)&&{"aria-hidden":"true"},...a},[...o.map(([u,d])=>R.createElement(u,d)),...Array.isArray(r)?r:[r]]));/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ci=(n,e)=>{const t=R.forwardRef(({className:s,...i},r)=>R.createElement(MR,{ref:r,iconNode:e,className:P1(`lucide-${TR(SA(n))}`,`lucide-${n}`,s),...i}));return t.displayName=SA(n),t};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DR=[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]],NR=Ci("book",DR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IR=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],OR=Ci("bot",IR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FR=[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]],jR=Ci("box",FR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zR=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],BR=Ci("file",zR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $R=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.93 4.93 4.24 4.24",key:"1ymg45"}],["path",{d:"m14.83 9.17 4.24-4.24",key:"1cb5xl"}],["path",{d:"m14.83 14.83 4.24 4.24",key:"q42g0n"}],["path",{d:"m9.17 14.83-4.24 4.24",key:"bqpfvv"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}]],HR=Ci("life-buoy",$R);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UR=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["rect",{x:"9",y:"2",width:"6",height:"13",rx:"3",key:"s6n7sd"}]],VR=Ci("mic",UR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GR=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"m16 15-3-3 3-3",key:"14y99z"}]],WR=Ci("panel-left-close",GR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XR=[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]],YR=Ci("paperclip",XR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qR=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],KR=Ci("send",qR);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QR=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],L1=Ci("settings",QR),JR=({toggleSidebar:n,toggleToolbar:e})=>P.jsxs("header",{className:"grid-in-header h-16 flex items-center justify-between px-4 bg-white text-black border-b border-gray-200",children:[P.jsx("div",{className:"flex items-center gap-2",children:P.jsx("button",{onClick:n,className:"p-2 rounded-md hover:bg-gray-100 focus:ring-2 focus:ring-blue-500","aria-label":"Toggle sidebar",children:P.jsx(WR,{size:24})})}),P.jsxs("div",{className:"flex items-center gap-4",children:[P.jsx("nav",{role:"tablist","aria-label":"Primary navigation",className:"flex gap-2",children:["GlobalNav_1","GlobalNav_2","GlobalNav_3"].map(t=>P.jsx("button",{role:"tab",className:"px-4 py-2 rounded-md hover:bg-gray-100 aria-selected:bg-blue-100","aria-selected":t==="GlobalNav_1",children:t},t))}),P.jsx("button",{onClick:e,className:"p-2 rounded-full hover:bg-gray-100","aria-label":"Toggle sub-navigation",title:"Toggle Sub-Nav",children:P.jsx(L1,{className:"h-5 w-5"})})]}),P.jsxs("div",{className:"flex gap-1",children:[P.jsx("span",{className:"h-6 w-6 rounded-full bg-blue-200 text-xs flex items-center justify-center",children:"AI_1"}),P.jsx("span",{className:"h-6 w-6 rounded-full bg-gray-300 text-xs flex items-center justify-center",children:"Eng_1"})]})]}),ZR=()=>{const n=se(s=>s.analyzeAndExecute),e=s=>{s.preventDefault();const i=s.dataTransfer.getData("application/json");if(i){const{type:r,name:o}=JSON.parse(i);if(r==="file"){const a=s.clientX,c=s.clientY;n(`Parse the file "${o}" and place the components at coordinates (${a}, ${c}).`)}}},t=s=>{s.preventDefault()};return P.jsx("div",{className:"flex-1 bg-white",onDrop:e,onDragOver:t,children:P.jsx("div",{className:"p-8 text-center text-gray-400",children:P.jsx("p",{children:"Drop files here to begin parsing"})})})},sn=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),mv=[.001,0,0,.001,0,0],cy=1.35,Gn={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Ai={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},eP="pdfjs_internal_editor_",Z={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,SIGNATURE:101},de={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},M1={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},$t={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},wd={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Ke={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},xl={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},kf={ERRORS:0,WARNINGS:1,INFOS:5},Bd={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},ip={moveTo:0,lineTo:1,curveTo:2,closePath:3},D1={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let wm=kf.WARNINGS;function tP(n){Number.isInteger(n)&&(wm=n)}function nP(){return wm}function bm(n){wm>=kf.INFOS&&console.log(`Info: ${n}`)}function te(n){wm>=kf.WARNINGS&&console.log(`Warning: ${n}`)}function _e(n){throw new Error(n)}function it(n,e){n||_e(e)}function sP(n){switch(n==null?void 0:n.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Lw(n,e=null,t=null){if(!n)return null;if(t&&typeof n=="string"){if(t.addDefaultProtocol&&n.startsWith("www.")){const i=n.match(/\./g);(i==null?void 0:i.length)>=2&&(n=`http://${n}`)}if(t.tryConvertEncoding)try{n=lP(n)}catch{}}const s=e?URL.parse(n,e):URL.parse(n);return sP(s)?s:null}function Mw(n,e,t=!1){const s=URL.parse(n);return s?(s.hash=e,s.href):t&&Lw(n,"http://example.com")?n.split("#",1)[0]+`${e?`#${e}`:""}`:""}function le(n,e,t,s=!1){return Object.defineProperty(n,e,{value:t,enumerable:!s,configurable:!0,writable:!1}),t}const vl=function(){function e(t,s){this.message=t,this.name=s}return e.prototype=new Error,e.constructor=e,e}();class EA extends vl{constructor(e,t){super(e,"PasswordException"),this.code=t}}class uy extends vl{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class _g extends vl{constructor(e){super(e,"InvalidPDFException")}}class $d extends vl{constructor(e,t,s){super(e,"ResponseException"),this.status=t,this.missing=s}}class iP extends vl{constructor(e){super(e,"FormatError")}}class Er extends vl{constructor(e){super(e,"AbortException")}}function N1(n){(typeof n!="object"||(n==null?void 0:n.length)===void 0)&&_e("Invalid argument for bytesToString");const e=n.length,t=8192;if(e<t)return String.fromCharCode.apply(null,n);const s=[];for(let i=0;i<e;i+=t){const r=Math.min(i+t,e),o=n.subarray(i,r);s.push(String.fromCharCode.apply(null,o))}return s.join("")}function Tf(n){typeof n!="string"&&_e("Invalid argument for stringToBytes");const e=n.length,t=new Uint8Array(e);for(let s=0;s<e;++s)t[s]=n.charCodeAt(s)&255;return t}function rP(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function oP(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function aP(){try{return new Function(""),!0}catch{return!1}}class xt{static get isLittleEndian(){return le(this,"isLittleEndian",oP())}static get isEvalSupported(){return le(this,"isEvalSupported",aP())}static get isOffscreenCanvasSupported(){return le(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return le(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return le(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){var e,t;return le(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const dy=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));var yr,Ep,yv;class Y{static makeHexColor(e,t,s){return`#${dy[e]}${dy[t]}${dy[s]}`}static scaleMinMax(e,t){let s;e[0]?(e[0]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[3],t[3]*=e[3]):(s=t[0],t[0]=t[1],t[1]=s,s=t[2],t[2]=t[3],t[3]=s,e[1]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t,s=0){const i=e[s],r=e[s+1];e[s]=i*t[0]+r*t[2]+t[4],e[s+1]=i*t[1]+r*t[3]+t[5]}static applyTransformToBezier(e,t,s=0){const i=t[0],r=t[1],o=t[2],a=t[3],c=t[4],u=t[5];for(let d=0;d<6;d+=2){const h=e[s+d],f=e[s+d+1];e[s+d]=h*i+f*o+c,e[s+d+1]=h*r+f*a+u}}static applyInverseTransform(e,t){const s=e[0],i=e[1],r=t[0]*t[3]-t[1]*t[2];e[0]=(s*t[3]-i*t[2]+t[2]*t[5]-t[4]*t[3])/r,e[1]=(-s*t[1]+i*t[0]+t[4]*t[1]-t[5]*t[0])/r}static axialAlignedBoundingBox(e,t,s){const i=t[0],r=t[1],o=t[2],a=t[3],c=t[4],u=t[5],d=e[0],h=e[1],f=e[2],p=e[3];let w=i*d+c,g=w,E=i*f+c,m=E,v=a*h+u,b=v,x=a*p+u,_=x;if(r!==0||o!==0){const k=r*d,C=r*f,T=o*h,L=o*p;w+=T,m+=T,E+=L,g+=L,v+=k,_+=k,x+=C,b+=C}s[0]=Math.min(s[0],w,E,g,m),s[1]=Math.min(s[1],v,x,b,_),s[2]=Math.max(s[2],w,E,g,m),s[3]=Math.max(s[3],v,x,b,_)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const s=e[0],i=e[1],r=e[2],o=e[3],a=s**2+i**2,c=s*r+i*o,u=r**2+o**2,d=(a+u)/2,h=Math.sqrt(d**2-(a*u-c**2));t[0]=Math.sqrt(d+h||1),t[1]=Math.sqrt(d-h||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const s=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),i=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(s>i)return null;const r=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),o=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return r>o?null:[s,r,i,o]}static pointBoundingBox(e,t,s){s[0]=Math.min(s[0],e),s[1]=Math.min(s[1],t),s[2]=Math.max(s[2],e),s[3]=Math.max(s[3],t)}static rectBoundingBox(e,t,s,i,r){r[0]=Math.min(r[0],e,s),r[1]=Math.min(r[1],t,i),r[2]=Math.max(r[2],e,s),r[3]=Math.max(r[3],t,i)}static bezierBoundingBox(e,t,s,i,r,o,a,c,u){u[0]=Math.min(u[0],e,a),u[1]=Math.min(u[1],t,c),u[2]=Math.max(u[2],e,a),u[3]=Math.max(u[3],t,c),S(this,yr,yv).call(this,e,s,r,a,t,i,o,c,3*(-e+3*(s-r)+a),6*(e-2*s+r),3*(s-e),u),S(this,yr,yv).call(this,e,s,r,a,t,i,o,c,3*(-t+3*(i-o)+c),6*(t-2*i+o),3*(i-t),u)}}yr=new WeakSet,Ep=function(e,t,s,i,r,o,a,c,u,d){if(u<=0||u>=1)return;const h=1-u,f=u*u,p=f*u,w=h*(h*(h*e+3*u*t)+3*f*s)+p*i,g=h*(h*(h*r+3*u*o)+3*f*a)+p*c;d[0]=Math.min(d[0],w),d[1]=Math.min(d[1],g),d[2]=Math.max(d[2],w),d[3]=Math.max(d[3],g)},yv=function(e,t,s,i,r,o,a,c,u,d,h,f){if(Math.abs(u)<1e-12){Math.abs(d)>=1e-12&&S(this,yr,Ep).call(this,e,t,s,i,r,o,a,c,-h/d,f);return}const p=d**2-4*h*u;if(p<0)return;const w=Math.sqrt(p),g=2*u;S(this,yr,Ep).call(this,e,t,s,i,r,o,a,c,(-d+w)/g,f),S(this,yr,Ep).call(this,e,t,s,i,r,o,a,c,(-d-w)/g,f)},A(Y,yr);function lP(n){return decodeURIComponent(escape(n))}let hy=null,xA=null;function I1(n){return hy||(hy=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,xA=new Map([["ﬅ","ſt"]])),n.replaceAll(hy,(e,t,s)=>t?t.normalize("NFKC"):xA.get(s))}function Dw(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),N1(n)}const Nw="pdfjs_internal_id_";function cP(n,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[s,i,...r]=t;if(!n(s)&&!Number.isInteger(s)||!e(i))return!1;const o=r.length;let a=!0;switch(i.name){case"XYZ":if(o<2||o>3)return!1;break;case"Fit":case"FitB":return o===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(o>1)return!1;break;case"FitR":if(o!==4)return!1;a=!1;break;default:return!1}for(const c of r)if(!(typeof c=="number"||a&&c===null))return!1;return!0}function Xt(n,e,t){return Math.min(Math.max(n,e),t)}function O1(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(N1(n))}function uP(n){return Uint8Array.fromBase64?Uint8Array.fromBase64(n):Tf(atob(n))}typeof Promise.try!="function"&&(Promise.try=function(n,...e){return new Promise(t=>{t(n(...e))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(n){return n.reduce((e,t)=>e+t,0)});const Mi="http://www.w3.org/2000/svg",qo=class qo{};F(qo,"CSS",96),F(qo,"PDF",72),F(qo,"PDF_TO_CSS_UNITS",qo.CSS/qo.PDF);let xr=qo;async function Eu(n,e="text"){if(Gu(n,document.baseURI)){const t=await fetch(n);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,s)=>{const i=new XMLHttpRequest;i.open("GET",n,!0),i.responseType=e,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){if(i.status===200||i.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(i.response);return}t(i.responseText);return}s(new Error(i.statusText))}},i.send(null)})}class Rf{constructor({viewBox:e,userUnit:t,scale:s,rotation:i,offsetX:r=0,offsetY:o=0,dontFlip:a=!1}){this.viewBox=e,this.userUnit=t,this.scale=s,this.rotation=i,this.offsetX=r,this.offsetY=o,s*=t;const c=(e[2]+e[0])/2,u=(e[3]+e[1])/2;let d,h,f,p;switch(i%=360,i<0&&(i+=360),i){case 180:d=-1,h=0,f=0,p=1;break;case 90:d=0,h=1,f=1,p=0;break;case 270:d=0,h=-1,f=-1,p=0;break;case 0:d=1,h=0,f=0,p=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}a&&(f=-f,p=-p);let w,g,E,m;d===0?(w=Math.abs(u-e[1])*s+r,g=Math.abs(c-e[0])*s+o,E=(e[3]-e[1])*s,m=(e[2]-e[0])*s):(w=Math.abs(c-e[0])*s+r,g=Math.abs(u-e[1])*s+o,E=(e[2]-e[0])*s,m=(e[3]-e[1])*s),this.transform=[d*s,h*s,f*s,p*s,w-d*s*c-f*s*u,g-h*s*c-p*s*u],this.width=E,this.height=m}get rawDims(){const e=this.viewBox;return le(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:s=this.offsetX,offsetY:i=this.offsetY,dontFlip:r=!1}={}){return new Rf({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:s,offsetY:i,dontFlip:r})}convertToViewportPoint(e,t){const s=[e,t];return Y.applyTransform(s,this.transform),s}convertToViewportRectangle(e){const t=[e[0],e[1]];Y.applyTransform(t,this.transform);const s=[e[2],e[3]];return Y.applyTransform(s,this.transform),[t[0],t[1],s[0],s[1]]}convertToPdfPoint(e,t){const s=[e,t];return Y.applyInverseTransform(s,this.transform),s}}class Am extends vl{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function Pf(n){const e=n.length;let t=0;for(;t<e&&n[t].trim()==="";)t++;return n.substring(t,t+5).toLowerCase()==="data:"}function Sm(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function F1(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function j1(n,e="document.pdf"){if(typeof n!="string")return e;if(Pf(n))return te('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const t=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,s=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,i=t.exec(n);let r=s.exec(i[1])||s.exec(i[2])||s.exec(i[3]);if(r&&(r=r[0],r.includes("%")))try{r=s.exec(decodeURIComponent(r))[0]}catch{}return r||e}class _A{constructor(){F(this,"started",Object.create(null));F(this,"times",[])}time(e){e in this.started&&te(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||te(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:s}of this.times)t=Math.max(s.length,t);for(const{name:s,start:i,end:r}of this.times)e.push(`${s.padEnd(t)} ${r-i}ms
`);return e.join("")}}function Gu(n,e){const t=e?URL.parse(n,e):URL.parse(n);return(t==null?void 0:t.protocol)==="http:"||(t==null?void 0:t.protocol)==="https:"}function As(n){n.preventDefault()}function Ze(n){n.preventDefault(),n.stopPropagation()}function dP(n){console.log("Deprecated API usage: "+n)}var Yd;class Em{static toDateObject(e){if(!e||typeof e!="string")return null;l(this,Yd)||y(this,Yd,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=l(this,Yd).exec(e);if(!t)return null;const s=parseInt(t[1],10);let i=parseInt(t[2],10);i=i>=1&&i<=12?i-1:0;let r=parseInt(t[3],10);r=r>=1&&r<=31?r:1;let o=parseInt(t[4],10);o=o>=0&&o<=23?o:0;let a=parseInt(t[5],10);a=a>=0&&a<=59?a:0;let c=parseInt(t[6],10);c=c>=0&&c<=59?c:0;const u=t[7]||"Z";let d=parseInt(t[8],10);d=d>=0&&d<=23?d:0;let h=parseInt(t[9],10)||0;return h=h>=0&&h<=59?h:0,u==="-"?(o+=d,a+=h):u==="+"&&(o-=d,a-=h),new Date(Date.UTC(s,i,r,o,a,c))}}Yd=new WeakMap,A(Em,Yd);function z1(n,{scale:e=1,rotation:t=0}){const{width:s,height:i}=n.attributes.style,r=[0,0,parseInt(s),parseInt(i)];return new Rf({viewBox:r,userUnit:1,scale:e,rotation:t})}function Iw(n){if(n.startsWith("#")){const e=parseInt(n.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(e=>parseInt(e)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(te(`Not a valid color format: "${n}"`),[0,0,0])}function hP(n){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of n.keys()){e.style.color=t;const s=window.getComputedStyle(e).color;n.set(t,Iw(s))}e.remove()}function He(n){const{a:e,b:t,c:s,d:i,e:r,f:o}=n.getTransform();return[e,t,s,i,r,o]}function ei(n){const{a:e,b:t,c:s,d:i,e:r,f:o}=n.getTransform().invertSelf();return[e,t,s,i,r,o]}function No(n,e,t=!1,s=!0){if(e instanceof Rf){const{pageWidth:i,pageHeight:r}=e.rawDims,{style:o}=n,a=xt.isCSSRoundSupported,c=`var(--total-scale-factor) * ${i}px`,u=`var(--total-scale-factor) * ${r}px`,d=a?`round(down, ${c}, var(--scale-round-x))`:`calc(${c})`,h=a?`round(down, ${u}, var(--scale-round-y))`:`calc(${u})`;!t||e.rotation%180===0?(o.width=d,o.height=h):(o.width=h,o.height=d)}s&&n.setAttribute("data-main-rotation",e.rotation)}class Ws{constructor(){const{pixelRatio:e}=Ws;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,s,i,r=-1){let o=1/0,a=1/0,c=1/0;s=Ws.capPixels(s,r),s>0&&(o=Math.sqrt(s/(e*t))),i!==-1&&(a=i/e,c=i/t);const u=Math.min(o,a,c);return this.sx>u||this.sy>u?(this.sx=u,this.sy=u,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const s=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,s):s}return e}}const Cg=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];var jr,ea,ss,zr,qd,sc,Kd,Fg,B1,It,$1,H1,Wu,U1,xp;const Oi=class Oi{constructor(e){A(this,It);A(this,jr,null);A(this,ea,null);A(this,ss);A(this,zr,null);A(this,qd,null);A(this,sc,null);y(this,ss,e),l(Oi,Kd)||y(Oi,Kd,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const e=y(this,jr,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=l(this,ss)._uiManager._signal;e.addEventListener("contextmenu",As,{signal:t}),e.addEventListener("pointerdown",S(Oi,Fg,B1),{signal:t});const s=y(this,zr,document.createElement("div"));s.className="buttons",e.append(s);const i=l(this,ss).toolbarPosition;if(i){const{style:r}=e,o=l(this,ss)._uiManager.direction==="ltr"?1-i[0]:i[0];r.insetInlineEnd=`${100*o}%`,r.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return S(this,It,U1).call(this),e}get div(){return l(this,jr)}hide(){var e;l(this,jr).classList.add("hidden"),(e=l(this,ea))==null||e.hideDropdown()}show(){var e;l(this,jr).classList.remove("hidden"),(e=l(this,qd))==null||e.shown()}async addAltText(e){const t=await e.render();S(this,It,Wu).call(this,t),l(this,zr).prepend(t,l(this,It,xp)),y(this,qd,e)}addColorPicker(e){y(this,ea,e);const t=e.renderButton();S(this,It,Wu).call(this,t),l(this,zr).prepend(t,l(this,It,xp))}async addEditSignatureButton(e){const t=y(this,sc,await e.renderEditButton(l(this,ss)));S(this,It,Wu).call(this,t),l(this,zr).prepend(t,l(this,It,xp))}updateEditSignatureButton(e){l(this,sc)&&(l(this,sc).title=e)}remove(){var e;l(this,jr).remove(),(e=l(this,ea))==null||e.destroy(),y(this,ea,null)}};jr=new WeakMap,ea=new WeakMap,ss=new WeakMap,zr=new WeakMap,qd=new WeakMap,sc=new WeakMap,Kd=new WeakMap,Fg=new WeakSet,B1=function(e){e.stopPropagation()},It=new WeakSet,$1=function(e){l(this,ss)._focusEventsAllowed=!1,Ze(e)},H1=function(e){l(this,ss)._focusEventsAllowed=!0,Ze(e)},Wu=function(e){const t=l(this,ss)._uiManager._signal;e.addEventListener("focusin",S(this,It,$1).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",S(this,It,H1).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",As,{signal:t})},U1=function(){const{editorType:e,_uiManager:t}=l(this,ss),s=document.createElement("button");s.className="delete",s.tabIndex=0,s.setAttribute("data-l10n-id",l(Oi,Kd)[e]),S(this,It,Wu).call(this,s),s.addEventListener("click",i=>{t.delete()},{signal:t._signal}),l(this,zr).append(s)},xp=function(){const e=document.createElement("div");return e.className="divider",e},A(Oi,Fg),A(Oi,Kd,null);let vv=Oi;var Qd,ta,na,Fo,V1,G1,W1;class fP{constructor(e){A(this,Fo);A(this,Qd,null);A(this,ta,null);A(this,na);y(this,na,e)}show(e,t,s){const[i,r]=S(this,Fo,G1).call(this,t,s),{style:o}=l(this,ta)||y(this,ta,S(this,Fo,V1).call(this));e.append(l(this,ta)),o.insetInlineEnd=`${100*i}%`,o.top=`calc(${100*r}% + var(--editor-toolbar-vert-offset))`}hide(){l(this,ta).remove()}}Qd=new WeakMap,ta=new WeakMap,na=new WeakMap,Fo=new WeakSet,V1=function(){const e=y(this,ta,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",As,{signal:l(this,na)._signal});const t=y(this,Qd,document.createElement("div"));return t.className="buttons",e.append(t),S(this,Fo,W1).call(this),e},G1=function(e,t){let s=0,i=0;for(const r of e){const o=r.y+r.height;if(o<s)continue;const a=r.x+(t?r.width:0);if(o>s){i=a,s=o;continue}t?a>i&&(i=a):a<i&&(i=a)}return[t?1-i:i,s]},W1=function(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const s=l(this,na)._signal;e.addEventListener("contextmenu",As,{signal:s}),e.addEventListener("click",()=>{l(this,na).highlightSelection("floating_button")},{signal:s}),l(this,Qd).append(e)};function X1(n,e,t){for(const s of t)e.addEventListener(s,n[s].bind(n))}var jg;class pP{constructor(){A(this,jg,0)}get id(){return`${eP}${Qt(this,jg)._++}`}}jg=new WeakMap;var ic,Jd,Ut,rc,_p;const tb=class tb{constructor(){A(this,rc);A(this,ic,Dw());A(this,Jd,0);A(this,Ut,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',s=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),i=new Image;i.src=e;const r=i.decode().then(()=>(s.drawImage(i,0,0,1,1,0,0,1,3),new Uint32Array(s.getImageData(0,0,1,1).data.buffer)[0]===0));return le(this,"_isSVGFittingCanvas",r)}async getFromFile(e){const{lastModified:t,name:s,size:i,type:r}=e;return S(this,rc,_p).call(this,`${t}_${s}_${i}_${r}`,e)}async getFromUrl(e){return S(this,rc,_p).call(this,e,e)}async getFromBlob(e,t){const s=await t;return S(this,rc,_p).call(this,e,s)}async getFromId(e){l(this,Ut)||y(this,Ut,new Map);const t=l(this,Ut).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:s}=t;return delete t.blobPromise,this.getFromBlob(t.id,s)}return this.getFromUrl(t.url)}getFromCanvas(e,t){l(this,Ut)||y(this,Ut,new Map);let s=l(this,Ut).get(e);if(s!=null&&s.bitmap)return s.refCounter+=1,s;const i=new OffscreenCanvas(t.width,t.height);return i.getContext("2d").drawImage(t,0,0),s={bitmap:i.transferToImageBitmap(),id:`image_${l(this,ic)}_${Qt(this,Jd)._++}`,refCounter:1,isSvg:!1},l(this,Ut).set(e,s),l(this,Ut).set(s.id,s),s}getSvgUrl(e){const t=l(this,Ut).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var i;l(this,Ut)||y(this,Ut,new Map);const t=l(this,Ut).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:s}=t;if(!t.url&&!t.file){const r=new OffscreenCanvas(s.width,s.height);r.getContext("bitmaprenderer").transferFromImageBitmap(s),t.blobPromise=r.convertToBlob()}(i=s.close)==null||i.call(s),t.bitmap=null}isValidId(e){return e.startsWith(`image_${l(this,ic)}_`)}};ic=new WeakMap,Jd=new WeakMap,Ut=new WeakMap,rc=new WeakSet,_p=async function(e,t){l(this,Ut)||y(this,Ut,new Map);let s=l(this,Ut).get(e);if(s===null)return null;if(s!=null&&s.bitmap)return s.refCounter+=1,s;try{s||(s={bitmap:null,id:`image_${l(this,ic)}_${Qt(this,Jd)._++}`,refCounter:0,isSvg:!1});let i;if(typeof t=="string"?(s.url=t,i=await Eu(t,"blob")):t instanceof File?i=s.file=t:t instanceof Blob&&(i=t),i.type==="image/svg+xml"){const r=tb._isSVGFittingCanvas,o=new FileReader,a=new Image,c=new Promise((u,d)=>{a.onload=()=>{s.bitmap=a,s.isSvg=!0,u()},o.onload=async()=>{const h=s.svgUrl=o.result;a.src=await r?`${h}#svgView(preserveAspectRatio(none))`:h},a.onerror=o.onerror=d});o.readAsDataURL(i),await c}else s.bitmap=await createImageBitmap(i);s.refCounter=1}catch(i){te(i),s=null}return l(this,Ut).set(e,s),s&&l(this,Ut).set(s.id,s),s};let wv=tb;var Qe,Br,Zd,$e;class gP{constructor(e=128){A(this,Qe,[]);A(this,Br,!1);A(this,Zd);A(this,$e,-1);y(this,Zd,e)}add({cmd:e,undo:t,post:s,mustExec:i,type:r=NaN,overwriteIfSameType:o=!1,keepUndo:a=!1}){if(i&&e(),l(this,Br))return;const c={cmd:e,undo:t,post:s,type:r};if(l(this,$e)===-1){l(this,Qe).length>0&&(l(this,Qe).length=0),y(this,$e,0),l(this,Qe).push(c);return}if(o&&l(this,Qe)[l(this,$e)].type===r){a&&(c.undo=l(this,Qe)[l(this,$e)].undo),l(this,Qe)[l(this,$e)]=c;return}const u=l(this,$e)+1;u===l(this,Zd)?l(this,Qe).splice(0,1):(y(this,$e,u),u<l(this,Qe).length&&l(this,Qe).splice(u)),l(this,Qe).push(c)}undo(){if(l(this,$e)===-1)return;y(this,Br,!0);const{undo:e,post:t}=l(this,Qe)[l(this,$e)];e(),t==null||t(),y(this,Br,!1),y(this,$e,l(this,$e)-1)}redo(){if(l(this,$e)<l(this,Qe).length-1){y(this,$e,l(this,$e)+1),y(this,Br,!0);const{cmd:e,post:t}=l(this,Qe)[l(this,$e)];e(),t==null||t(),y(this,Br,!1)}}hasSomethingToUndo(){return l(this,$e)!==-1}hasSomethingToRedo(){return l(this,$e)<l(this,Qe).length-1}cleanType(e){if(l(this,$e)!==-1){for(let t=l(this,$e);t>=0;t--)if(l(this,Qe)[t].type!==e){l(this,Qe).splice(t+1,l(this,$e)-t),y(this,$e,t);return}l(this,Qe).length=0,y(this,$e,-1)}}destroy(){y(this,Qe,null)}}Qe=new WeakMap,Br=new WeakMap,Zd=new WeakMap,$e=new WeakMap;var zg,Y1;class Lf{constructor(e){A(this,zg);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=xt.platform;for(const[s,i,r={}]of e)for(const o of s){const a=o.startsWith("mac+");t&&a?(this.callbacks.set(o.slice(4),{callback:i,options:r}),this.allKeys.add(o.split("+").at(-1))):!t&&!a&&(this.callbacks.set(o,{callback:i,options:r}),this.allKeys.add(o.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const s=this.callbacks.get(S(this,zg,Y1).call(this,t));if(!s)return;const{callback:i,options:{bubbles:r=!1,args:o=[],checker:a=null}}=s;a&&!a(e,t)||(i.bind(e,...o,t)(),r||Ze(t))}}zg=new WeakSet,Y1=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const Bg=class Bg{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return hP(e),le(this,"_colors",e)}convert(e){const t=Iw(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[s,i]of this._colors)if(i.every((r,o)=>r===t[o]))return Bg._colorsMapping.get(s);return t}getHexCode(e){const t=this._colors.get(e);return t?Y.makeHexColor(...t):e}};F(Bg,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let bv=Bg;var oc,Mn,at,kt,ac,zi,lc,is,$r,Hr,cc,sa,ii,ks,ia,eh,th,uc,nh,ri,Ur,dc,Vr,oi,$g,Gr,sh,Wr,ra,oa,Xr,ih,gt,be,Bi,Yr,aa,rh,oh,qr,ai,$i,ah,rs,z,Cp,Av,q1,K1,kp,Q1,J1,Z1,Sv,ex,Ev,xv,tx,Jt,Di,nx,sx,_v,ix,Xu,Cv;const Gl=class Gl{constructor(e,t,s,i,r,o,a,c,u,d,h,f,p,w){A(this,z);A(this,oc,new AbortController);A(this,Mn,null);A(this,at,new Map);A(this,kt,new Map);A(this,ac,null);A(this,zi,null);A(this,lc,null);A(this,is,new gP);A(this,$r,null);A(this,Hr,null);A(this,cc,0);A(this,sa,new Set);A(this,ii,null);A(this,ks,null);A(this,ia,new Set);F(this,"_editorUndoBar",null);A(this,eh,!1);A(this,th,!1);A(this,uc,!1);A(this,nh,null);A(this,ri,null);A(this,Ur,null);A(this,dc,null);A(this,Vr,!1);A(this,oi,null);A(this,$g,new pP);A(this,Gr,!1);A(this,sh,!1);A(this,Wr,null);A(this,ra,null);A(this,oa,null);A(this,Xr,null);A(this,ih,null);A(this,gt,Z.NONE);A(this,be,new Set);A(this,Bi,null);A(this,Yr,null);A(this,aa,null);A(this,rh,null);A(this,oh,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});A(this,qr,[0,0]);A(this,ai,null);A(this,$i,null);A(this,ah,null);A(this,rs,null);const g=this._signal=l(this,oc).signal;y(this,$i,e),y(this,ah,t),y(this,ac,s),y(this,Yr,i),this._eventBus=r,r._on("editingaction",this.onEditingAction.bind(this),{signal:g}),r._on("pagechanging",this.onPageChanging.bind(this),{signal:g}),r._on("scalechanging",this.onScaleChanging.bind(this),{signal:g}),r._on("rotationchanging",this.onRotationChanging.bind(this),{signal:g}),r._on("setpreference",this.onSetPreference.bind(this),{signal:g}),r._on("switchannotationeditorparams",E=>this.updateParams(E.type,E.value),{signal:g}),S(this,z,Q1).call(this),S(this,z,tx).call(this),S(this,z,Sv).call(this),y(this,zi,o.annotationStorage),y(this,nh,o.filterFactory),y(this,aa,a),y(this,dc,c||null),y(this,eh,u),y(this,th,d),y(this,uc,h),y(this,ih,f||null),this.viewParameters={realScale:xr.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=p||null,this._supportsPinchToZoom=w!==!1}static get _keyboardManager(){const e=Gl.prototype,t=o=>l(o,$i).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&o.hasSomethingToControl(),s=(o,{target:a})=>{if(a instanceof HTMLInputElement){const{type:c}=a;return c!=="text"&&c!=="number"}return!0},i=this.TRANSLATE_SMALL,r=this.TRANSLATE_BIG;return le(this,"_keyboardManager",new Lf([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],e.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:s}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(o,{target:a})=>!(a instanceof HTMLButtonElement)&&l(o,$i).contains(a)&&!o.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(o,{target:a})=>!(a instanceof HTMLButtonElement)&&l(o,$i).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-r,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[r,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-r],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,r],checker:t}]]))}destroy(){var e,t,s,i,r,o,a,c;(e=l(this,rs))==null||e.resolve(),y(this,rs,null),(t=l(this,oc))==null||t.abort(),y(this,oc,null),this._signal=null;for(const u of l(this,kt).values())u.destroy();l(this,kt).clear(),l(this,at).clear(),l(this,ia).clear(),(s=l(this,Xr))==null||s.clear(),y(this,Mn,null),l(this,be).clear(),l(this,is).destroy(),(i=l(this,ac))==null||i.destroy(),(r=l(this,Yr))==null||r.destroy(),(o=l(this,oi))==null||o.hide(),y(this,oi,null),(a=l(this,oa))==null||a.destroy(),y(this,oa,null),l(this,ri)&&(clearTimeout(l(this,ri)),y(this,ri,null)),l(this,ai)&&(clearTimeout(l(this,ai)),y(this,ai,null)),(c=this._editorUndoBar)==null||c.destroy()}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return l(this,ih)}get useNewAltTextFlow(){return l(this,th)}get useNewAltTextWhenAddingImage(){return l(this,uc)}get hcmFilter(){return le(this,"hcmFilter",l(this,aa)?l(this,nh).addHCMFilter(l(this,aa).foreground,l(this,aa).background):"none")}get direction(){return le(this,"direction",getComputedStyle(l(this,$i)).direction)}get highlightColors(){return le(this,"highlightColors",l(this,dc)?new Map(l(this,dc).split(",").map(e=>e.split("=").map(t=>t.trim()))):null)}get highlightColorNames(){return le(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),y(this,Hr,e)}setMainHighlightColorPicker(e){y(this,oa,e)}editAltText(e,t=!1){var s;(s=l(this,ac))==null||s.editAltText(this,e,t)}getSignature(e){var t;(t=l(this,Yr))==null||t.getSignature({uiManager:this,editor:e})}get signatureManager(){return l(this,Yr)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":y(this,uc,t);break}}onPageChanging({pageNumber:e}){y(this,cc,e-1)}focusMainContainer(){l(this,$i).focus()}findParent(e,t){for(const s of l(this,kt).values()){const{x:i,y:r,width:o,height:a}=s.div.getBoundingClientRect();if(e>=i&&e<=i+o&&t>=r&&t<=r+a)return s}return null}disableUserSelect(e=!1){l(this,ah).classList.toggle("noUserSelect",e)}addShouldRescale(e){l(this,ia).add(e)}removeShouldRescale(e){l(this,ia).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*xr.PDF_TO_CSS_UNITS;for(const s of l(this,ia))s.onScaleChanging();(t=l(this,Hr))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e=""){const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:s,anchorOffset:i,focusNode:r,focusOffset:o}=t,a=t.toString(),u=S(this,z,Cp).call(this,t).closest(".textLayer"),d=this.getSelectionBoxes(u);if(!d)return;t.empty();const h=S(this,z,Av).call(this,u),f=l(this,gt)===Z.NONE,p=()=>{h==null||h.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:d,anchorNode:s,anchorOffset:i,focusNode:r,focusOffset:o,text:a}),f&&this.showAllEditors("highlight",!0,!0)};if(f){this.switchToMode(Z.HIGHLIGHT,p);return}p()}addToAnnotationStorage(e){!e.isEmpty()&&l(this,zi)&&!l(this,zi).has(e.id)&&l(this,zi).setValue(e.id,e)}blur(){if(this.isShiftKeyDown=!1,l(this,Vr)&&(y(this,Vr,!1),S(this,z,kp).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of l(this,be))if(t.div.contains(e)){y(this,ra,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!l(this,ra))return;const[e,t]=l(this,ra);y(this,ra,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){S(this,z,Sv).call(this),S(this,z,Ev).call(this)}removeEditListeners(){S(this,z,ex).call(this),S(this,z,xv).call(this)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const s of l(this,ks))if(s.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const s of l(this,ks))if(s.isHandlingMimeForPasting(t.type)){s.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var s;if(e.preventDefault(),(s=l(this,Mn))==null||s.commitOrRemove(),!this.hasSelection)return;const t=[];for(const i of l(this,be)){const r=i.serialize(!0);r&&t.push(r)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const r of t.items)for(const o of l(this,ks))if(o.isHandlingMimeForPasting(r.type)){o.paste(r,this.currentLayer);return}let s=t.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(r){te(`paste: "${r.message}".`);return}if(!Array.isArray(s))return;this.unselectAll();const i=this.currentLayer;try{const r=[];for(const c of s){const u=await i.deserialize(c);if(!u)return;r.push(u)}const o=()=>{for(const c of r)S(this,z,_v).call(this,c);S(this,z,Cv).call(this,r)},a=()=>{for(const c of r)c.remove()};this.addCommands({cmd:o,undo:a,mustExec:!0})}catch(r){te(`paste: "${r.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),l(this,gt)!==Z.NONE&&!this.isEditorHandlingKeyboard&&Gl._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,l(this,Vr)&&(y(this,Vr,!1),S(this,z,kp).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(e){e?(S(this,z,J1).call(this),S(this,z,Ev).call(this),S(this,z,Jt).call(this,{isEditing:l(this,gt)!==Z.NONE,isEmpty:S(this,z,Xu).call(this),hasSomethingToUndo:l(this,is).hasSomethingToUndo(),hasSomethingToRedo:l(this,is).hasSomethingToRedo(),hasSelectedEditor:!1})):(S(this,z,Z1).call(this),S(this,z,xv).call(this),S(this,z,Jt).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!l(this,ks)){y(this,ks,e);for(const t of l(this,ks))S(this,z,Di).call(this,t.defaultPropertiesToUpdate)}}getId(){return l(this,$g).id}get currentLayer(){return l(this,kt).get(l(this,cc))}getLayer(e){return l(this,kt).get(e)}get currentPageIndex(){return l(this,cc)}addLayer(e){l(this,kt).set(e.pageIndex,e),l(this,Gr)?e.enable():e.disable()}removeLayer(e){l(this,kt).delete(e.pageIndex)}async updateMode(e,t=null,s=!1){var i,r,o;if(l(this,gt)!==e&&!(l(this,rs)&&(await l(this,rs).promise,!l(this,rs)))){if(y(this,rs,Promise.withResolvers()),(i=l(this,Hr))==null||i.commitOrRemove(),y(this,gt,e),e===Z.NONE){this.setEditingState(!1),S(this,z,sx).call(this),(r=this._editorUndoBar)==null||r.hide(),l(this,rs).resolve();return}e===Z.SIGNATURE&&await((o=l(this,Yr))==null?void 0:o.loadSignatures()),this.setEditingState(!0),await S(this,z,nx).call(this),this.unselectAll();for(const a of l(this,kt).values())a.updateMode(e);if(!t){s&&this.addNewEditorFromKeyboard(),l(this,rs).resolve();return}for(const a of l(this,at).values())a.annotationElementId===t||a.id===t?(this.setSelected(a),a.enterInEditMode()):a.unselect();l(this,rs).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==l(this,gt)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){var s;if(l(this,ks)){switch(e){case de.CREATE:this.currentLayer.addNewEditor(t);return;case de.HIGHLIGHT_DEFAULT_COLOR:(s=l(this,oa))==null||s.updateColor(t);break;case de.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(l(this,rh)||y(this,rh,new Map)).set(e,t),this.showAllEditors("highlight",t);break}for(const i of l(this,be))i.updateParams(e,t);for(const i of l(this,ks))i.updateDefaultParams(e,t)}}showAllEditors(e,t,s=!1){var r;for(const o of l(this,at).values())o.editorType===e&&o.show(t);(((r=l(this,rh))==null?void 0:r.get(de.HIGHLIGHT_SHOW_ALL))??!0)!==t&&S(this,z,Di).call(this,[[de.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(l(this,sh)!==e){y(this,sh,e);for(const t of l(this,kt).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}getEditors(e){const t=[];for(const s of l(this,at).values())s.pageIndex===e&&t.push(s);return t}getEditor(e){return l(this,at).get(e)}addEditor(e){l(this,at).set(e.id,e)}removeEditor(e){var t,s;e.div.contains(document.activeElement)&&(l(this,ri)&&clearTimeout(l(this,ri)),y(this,ri,setTimeout(()=>{this.focusMainContainer(),y(this,ri,null)},0))),l(this,at).delete(e.id),e.annotationElementId&&((t=l(this,Xr))==null||t.delete(e.annotationElementId)),this.unselect(e),(!e.annotationElementId||!l(this,sa).has(e.annotationElementId))&&((s=l(this,zi))==null||s.remove(e.id))}addDeletedAnnotationElement(e){l(this,sa).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return l(this,sa).has(e)}removeDeletedAnnotationElement(e){l(this,sa).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){l(this,Mn)!==e&&(y(this,Mn,e),e&&S(this,z,Di).call(this,e.propertiesToUpdate))}updateUI(e){l(this,z,ix)===e&&S(this,z,Di).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){S(this,z,Di).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(l(this,be).has(e)){l(this,be).delete(e),e.unselect(),S(this,z,Jt).call(this,{hasSelectedEditor:this.hasSelection});return}l(this,be).add(e),e.select(),S(this,z,Di).call(this,e.propertiesToUpdate),S(this,z,Jt).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;(t=l(this,Hr))==null||t.commitOrRemove();for(const s of l(this,be))s!==e&&s.unselect();l(this,be).clear(),l(this,be).add(e),e.select(),S(this,z,Di).call(this,e.propertiesToUpdate),S(this,z,Jt).call(this,{hasSelectedEditor:!0})}isSelected(e){return l(this,be).has(e)}get firstSelectedEditor(){return l(this,be).values().next().value}unselect(e){e.unselect(),l(this,be).delete(e),S(this,z,Jt).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return l(this,be).size!==0}get isEnterHandled(){return l(this,be).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;l(this,is).undo(),S(this,z,Jt).call(this,{hasSomethingToUndo:l(this,is).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:S(this,z,Xu).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){l(this,is).redo(),S(this,z,Jt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:l(this,is).hasSomethingToRedo(),isEmpty:S(this,z,Xu).call(this)})}addCommands(e){l(this,is).add(e),S(this,z,Jt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:S(this,z,Xu).call(this)})}cleanUndoStack(e){l(this,is).cleanType(e)}delete(){var r;this.commitOrRemove();const e=(r=this.currentLayer)==null?void 0:r.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...l(this,be)],s=()=>{var o;(o=this._editorUndoBar)==null||o.show(i,t.length===1?t[0].editorType:t.length);for(const a of t)a.remove()},i=()=>{for(const o of t)S(this,z,_v).call(this,o)};this.addCommands({cmd:s,undo:i,mustExec:!0})}commitOrRemove(){var e;(e=l(this,Mn))==null||e.commitOrRemove()}hasSomethingToControl(){return l(this,Mn)||this.hasSelection}selectAll(){for(const e of l(this,be))e.commit();S(this,z,Cv).call(this,l(this,at).values())}unselectAll(){var e;if(!(l(this,Mn)&&(l(this,Mn).commitOrRemove(),l(this,gt)!==Z.NONE))&&!((e=l(this,Hr))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of l(this,be))t.unselect();l(this,be).clear(),S(this,z,Jt).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,s=!1){if(s||this.commitOrRemove(),!this.hasSelection)return;l(this,qr)[0]+=e,l(this,qr)[1]+=t;const[i,r]=l(this,qr),o=[...l(this,be)],a=1e3;l(this,ai)&&clearTimeout(l(this,ai)),y(this,ai,setTimeout(()=>{y(this,ai,null),l(this,qr)[0]=l(this,qr)[1]=0,this.addCommands({cmd:()=>{for(const c of o)l(this,at).has(c.id)&&(c.translateInPage(i,r),c.translationDone())},undo:()=>{for(const c of o)l(this,at).has(c.id)&&(c.translateInPage(-i,-r),c.translationDone())},mustExec:!1})},a));for(const c of o)c.translateInPage(e,t),c.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),y(this,ii,new Map);for(const e of l(this,be))l(this,ii).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!l(this,ii))return!1;this.disableUserSelect(!1);const e=l(this,ii);y(this,ii,null);let t=!1;for(const[{x:i,y:r,pageIndex:o},a]of e)a.newX=i,a.newY=r,a.newPageIndex=o,t||(t=i!==a.savedX||r!==a.savedY||o!==a.savedPageIndex);if(!t)return!1;const s=(i,r,o,a)=>{if(l(this,at).has(i.id)){const c=l(this,kt).get(a);c?i._setParentAndPosition(c,r,o):(i.pageIndex=a,i.x=r,i.y=o)}};return this.addCommands({cmd:()=>{for(const[i,{newX:r,newY:o,newPageIndex:a}]of e)s(i,r,o,a)},undo:()=>{for(const[i,{savedX:r,savedY:o,savedPageIndex:a}]of e)s(i,r,o,a)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(l(this,ii))for(const s of l(this,ii).keys())s.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||l(this,be).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return l(this,Mn)===e}getActive(){return l(this,Mn)}getMode(){return l(this,gt)}get imageManager(){return le(this,"imageManager",new wv)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let u=0,d=t.rangeCount;u<d;u++)if(!e.contains(t.getRangeAt(u).commonAncestorContainer))return null;const{x:s,y:i,width:r,height:o}=e.getBoundingClientRect();let a;switch(e.getAttribute("data-main-rotation")){case"90":a=(u,d,h,f)=>({x:(d-i)/o,y:1-(u+h-s)/r,width:f/o,height:h/r});break;case"180":a=(u,d,h,f)=>({x:1-(u+h-s)/r,y:1-(d+f-i)/o,width:h/r,height:f/o});break;case"270":a=(u,d,h,f)=>({x:1-(d+f-i)/o,y:(u-s)/r,width:f/o,height:h/r});break;default:a=(u,d,h,f)=>({x:(u-s)/r,y:(d-i)/o,width:h/r,height:f/o});break}const c=[];for(let u=0,d=t.rangeCount;u<d;u++){const h=t.getRangeAt(u);if(!h.collapsed)for(const{x:f,y:p,width:w,height:g}of h.getClientRects())w===0||g===0||c.push(a(f,p,w,g))}return c.length===0?null:c}addChangedExistingAnnotation({annotationElementId:e,id:t}){(l(this,lc)||y(this,lc,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=l(this,lc))==null||t.delete(e)}renderAnnotationElement(e){var i;const t=(i=l(this,lc))==null?void 0:i.get(e.data.id);if(!t)return;const s=l(this,zi).getRawValue(t);s&&(l(this,gt)===Z.NONE&&!s.hasBeenModified||s.renderAnnotationElement(e))}setMissingCanvas(e,t,s){var r;const i=(r=l(this,Xr))==null?void 0:r.get(e);i&&(i.setCanvas(t,s),l(this,Xr).delete(e))}addMissingCanvas(e,t){(l(this,Xr)||y(this,Xr,new Map)).set(e,t)}};oc=new WeakMap,Mn=new WeakMap,at=new WeakMap,kt=new WeakMap,ac=new WeakMap,zi=new WeakMap,lc=new WeakMap,is=new WeakMap,$r=new WeakMap,Hr=new WeakMap,cc=new WeakMap,sa=new WeakMap,ii=new WeakMap,ks=new WeakMap,ia=new WeakMap,eh=new WeakMap,th=new WeakMap,uc=new WeakMap,nh=new WeakMap,ri=new WeakMap,Ur=new WeakMap,dc=new WeakMap,Vr=new WeakMap,oi=new WeakMap,$g=new WeakMap,Gr=new WeakMap,sh=new WeakMap,Wr=new WeakMap,ra=new WeakMap,oa=new WeakMap,Xr=new WeakMap,ih=new WeakMap,gt=new WeakMap,be=new WeakMap,Bi=new WeakMap,Yr=new WeakMap,aa=new WeakMap,rh=new WeakMap,oh=new WeakMap,qr=new WeakMap,ai=new WeakMap,$i=new WeakMap,ah=new WeakMap,rs=new WeakMap,z=new WeakSet,Cp=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},Av=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const s of l(this,kt).values())if(s.hasTextLayer(e))return s;return null},q1=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const s=S(this,z,Cp).call(this,e).closest(".textLayer"),i=this.getSelectionBoxes(s);i&&(l(this,oi)||y(this,oi,new fP(this)),l(this,oi).show(s,i,this.direction==="ltr"))},K1=function(){var r,o,a;const e=document.getSelection();if(!e||e.isCollapsed){l(this,Bi)&&((r=l(this,oi))==null||r.hide(),y(this,Bi,null),S(this,z,Jt).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===l(this,Bi))return;const i=S(this,z,Cp).call(this,e).closest(".textLayer");if(!i){l(this,Bi)&&((o=l(this,oi))==null||o.hide(),y(this,Bi,null),S(this,z,Jt).call(this,{hasSelectedText:!1}));return}if((a=l(this,oi))==null||a.hide(),y(this,Bi,t),S(this,z,Jt).call(this,{hasSelectedText:!0}),!(l(this,gt)!==Z.HIGHLIGHT&&l(this,gt)!==Z.NONE)&&(l(this,gt)===Z.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),y(this,Vr,this.isShiftKeyDown),!this.isShiftKeyDown)){const c=l(this,gt)===Z.HIGHLIGHT?S(this,z,Av).call(this,i):null;c==null||c.toggleDrawing();const u=new AbortController,d=this.combinedSignal(u),h=f=>{f.type==="pointerup"&&f.button!==0||(u.abort(),c==null||c.toggleDrawing(!0),f.type==="pointerup"&&S(this,z,kp).call(this,"main_toolbar"))};window.addEventListener("pointerup",h,{signal:d}),window.addEventListener("blur",h,{signal:d})}},kp=function(e=""){l(this,gt)===Z.HIGHLIGHT?this.highlightSelection(e):l(this,eh)&&S(this,z,q1).call(this)},Q1=function(){document.addEventListener("selectionchange",S(this,z,K1).bind(this),{signal:this._signal})},J1=function(){if(l(this,Ur))return;y(this,Ur,new AbortController);const e=this.combinedSignal(l(this,Ur));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},Z1=function(){var e;(e=l(this,Ur))==null||e.abort(),y(this,Ur,null)},Sv=function(){if(l(this,Wr))return;y(this,Wr,new AbortController);const e=this.combinedSignal(l(this,Wr));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},ex=function(){var e;(e=l(this,Wr))==null||e.abort(),y(this,Wr,null)},Ev=function(){if(l(this,$r))return;y(this,$r,new AbortController);const e=this.combinedSignal(l(this,$r));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},xv=function(){var e;(e=l(this,$r))==null||e.abort(),y(this,$r,null)},tx=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},Jt=function(e){Object.entries(e).some(([s,i])=>l(this,oh)[s]!==i)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(l(this,oh),e)}),l(this,gt)===Z.HIGHLIGHT&&e.hasSelectedEditor===!1&&S(this,z,Di).call(this,[[de.HIGHLIGHT_FREE,!0]]))},Di=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},nx=async function(){if(!l(this,Gr)){y(this,Gr,!0);const e=[];for(const t of l(this,kt).values())e.push(t.enable());await Promise.all(e);for(const t of l(this,at).values())t.enable()}},sx=function(){if(this.unselectAll(),l(this,Gr)){y(this,Gr,!1);for(const e of l(this,kt).values())e.disable();for(const e of l(this,at).values())e.disable()}},_v=function(e){const t=l(this,kt).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},ix=function(){let e=null;for(e of l(this,be));return e},Xu=function(){if(l(this,at).size===0)return!0;if(l(this,at).size===1)for(const e of l(this,at).values())return e.isEmpty();return!1},Cv=function(e){for(const t of l(this,be))t.unselect();l(this,be).clear();for(const t of e)t.isEmpty()||(l(this,be).add(t),t.select());S(this,z,Jt).call(this,{hasSelectedEditor:this.hasSelection})},F(Gl,"TRANSLATE_SMALL",1),F(Gl,"TRANSLATE_BIG",10);let Io=Gl;var mt,li,Ts,hc,ci,Dn,fc,ui,pn,Hi,la,di,Kr,Hs,Yu,Tp;const Zt=class Zt{constructor(e){A(this,Hs);A(this,mt,null);A(this,li,!1);A(this,Ts,null);A(this,hc,null);A(this,ci,null);A(this,Dn,null);A(this,fc,!1);A(this,ui,null);A(this,pn,null);A(this,Hi,null);A(this,la,null);A(this,di,!1);y(this,pn,e),y(this,di,e._uiManager.useNewAltTextFlow),l(Zt,Kr)||y(Zt,Kr,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){Zt._l10n??(Zt._l10n=e)}async render(){const e=y(this,Ts,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=y(this,hc,document.createElement("span"));e.append(t),l(this,di)?(e.classList.add("new"),e.setAttribute("data-l10n-id",l(Zt,Kr).missing),t.setAttribute("data-l10n-id",l(Zt,Kr)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const s=l(this,pn)._uiManager._signal;e.addEventListener("contextmenu",As,{signal:s}),e.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:s});const i=r=>{r.preventDefault(),l(this,pn)._uiManager.editAltText(l(this,pn)),l(this,di)&&l(this,pn)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:l(this,Hs,Yu)}})};return e.addEventListener("click",i,{capture:!0,signal:s}),e.addEventListener("keydown",r=>{r.target===e&&r.key==="Enter"&&(y(this,fc,!0),i(r))},{signal:s}),await S(this,Hs,Tp).call(this),e}finish(){l(this,Ts)&&(l(this,Ts).focus({focusVisible:l(this,fc)}),y(this,fc,!1))}isEmpty(){return l(this,di)?l(this,mt)===null:!l(this,mt)&&!l(this,li)}hasData(){return l(this,di)?l(this,mt)!==null||!!l(this,Hi):this.isEmpty()}get guessedText(){return l(this,Hi)}async setGuessedText(e){l(this,mt)===null&&(y(this,Hi,e),y(this,la,await Zt._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),S(this,Hs,Tp).call(this))}toggleAltTextBadge(e=!1){var t;if(!l(this,di)||l(this,mt)){(t=l(this,ui))==null||t.remove(),y(this,ui,null);return}if(!l(this,ui)){const s=y(this,ui,document.createElement("div"));s.className="noAltTextBadge",l(this,pn).div.append(s)}l(this,ui).classList.toggle("hidden",!e)}serialize(e){let t=l(this,mt);return!e&&l(this,Hi)===t&&(t=l(this,la)),{altText:t,decorative:l(this,li),guessedText:l(this,Hi),textWithDisclaimer:l(this,la)}}get data(){return{altText:l(this,mt),decorative:l(this,li)}}set data({altText:e,decorative:t,guessedText:s,textWithDisclaimer:i,cancel:r=!1}){s&&(y(this,Hi,s),y(this,la,i)),!(l(this,mt)===e&&l(this,li)===t)&&(r||(y(this,mt,e),y(this,li,t)),S(this,Hs,Tp).call(this))}toggle(e=!1){l(this,Ts)&&(!e&&l(this,Dn)&&(clearTimeout(l(this,Dn)),y(this,Dn,null)),l(this,Ts).disabled=!e)}shown(){l(this,pn)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:l(this,Hs,Yu)}})}destroy(){var e,t;(e=l(this,Ts))==null||e.remove(),y(this,Ts,null),y(this,hc,null),y(this,ci,null),(t=l(this,ui))==null||t.remove(),y(this,ui,null)}};mt=new WeakMap,li=new WeakMap,Ts=new WeakMap,hc=new WeakMap,ci=new WeakMap,Dn=new WeakMap,fc=new WeakMap,ui=new WeakMap,pn=new WeakMap,Hi=new WeakMap,la=new WeakMap,di=new WeakMap,Kr=new WeakMap,Hs=new WeakSet,Yu=function(){return l(this,mt)&&"added"||l(this,mt)===null&&this.guessedText&&"review"||"missing"},Tp=async function(){var i,r,o;const e=l(this,Ts);if(!e)return;if(l(this,di)){if(e.classList.toggle("done",!!l(this,mt)),e.setAttribute("data-l10n-id",l(Zt,Kr)[l(this,Hs,Yu)]),(i=l(this,hc))==null||i.setAttribute("data-l10n-id",l(Zt,Kr)[`${l(this,Hs,Yu)}-label`]),!l(this,mt)){(r=l(this,ci))==null||r.remove();return}}else{if(!l(this,mt)&&!l(this,li)){e.classList.remove("done"),(o=l(this,ci))==null||o.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=l(this,ci);if(!t){y(this,ci,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${l(this,pn).id}`;const a=100,c=l(this,pn)._uiManager._signal;c.addEventListener("abort",()=>{clearTimeout(l(this,Dn)),y(this,Dn,null)},{once:!0}),e.addEventListener("mouseenter",()=>{y(this,Dn,setTimeout(()=>{y(this,Dn,null),l(this,ci).classList.add("show"),l(this,pn)._reportTelemetry({action:"alt_text_tooltip"})},a))},{signal:c}),e.addEventListener("mouseleave",()=>{var u;l(this,Dn)&&(clearTimeout(l(this,Dn)),y(this,Dn,null)),(u=l(this,ci))==null||u.classList.remove("show")},{signal:c})}l(this,li)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=l(this,mt)),t.parentNode||e.append(t);const s=l(this,pn).getElementForAltText();s==null||s.setAttribute("aria-describedby",t.id)},A(Zt,Kr,null),F(Zt,"_l10n",null);let kg=Zt;var pc,ca,lh,ch,uh,dh,hh,Ui,ua,Vi,da,Gi,jo,rx,ox,ax;const nb=class nb{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:s=null,onPinchStart:i=null,onPinching:r=null,onPinchEnd:o=null,signal:a}){A(this,jo);A(this,pc);A(this,ca,!1);A(this,lh,null);A(this,ch);A(this,uh);A(this,dh);A(this,hh);A(this,Ui,null);A(this,ua);A(this,Vi,null);A(this,da);A(this,Gi,null);y(this,pc,e),y(this,lh,s),y(this,ch,t),y(this,uh,i),y(this,dh,r),y(this,hh,o),y(this,da,new AbortController),y(this,ua,AbortSignal.any([a,l(this,da).signal])),e.addEventListener("touchstart",S(this,jo,rx).bind(this),{passive:!1,signal:l(this,ua)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Ws.pixelRatio}destroy(){var e,t;(e=l(this,da))==null||e.abort(),y(this,da,null),(t=l(this,Ui))==null||t.abort(),y(this,Ui,null)}};pc=new WeakMap,ca=new WeakMap,lh=new WeakMap,ch=new WeakMap,uh=new WeakMap,dh=new WeakMap,hh=new WeakMap,Ui=new WeakMap,ua=new WeakMap,Vi=new WeakMap,da=new WeakMap,Gi=new WeakMap,jo=new WeakSet,rx=function(e){var i,r,o;if((i=l(this,ch))!=null&&i.call(this))return;if(e.touches.length===1){if(l(this,Ui))return;const a=y(this,Ui,new AbortController),c=AbortSignal.any([l(this,ua),a.signal]),u=l(this,pc),d={capture:!0,signal:c,passive:!1},h=f=>{var p;f.pointerType==="touch"&&((p=l(this,Ui))==null||p.abort(),y(this,Ui,null))};u.addEventListener("pointerdown",f=>{f.pointerType==="touch"&&(Ze(f),h(f))},d),u.addEventListener("pointerup",h,d),u.addEventListener("pointercancel",h,d);return}if(!l(this,Gi)){y(this,Gi,new AbortController);const a=AbortSignal.any([l(this,ua),l(this,Gi).signal]),c=l(this,pc),u={signal:a,capture:!1,passive:!1};c.addEventListener("touchmove",S(this,jo,ox).bind(this),u);const d=S(this,jo,ax).bind(this);c.addEventListener("touchend",d,u),c.addEventListener("touchcancel",d,u),u.capture=!0,c.addEventListener("pointerdown",Ze,u),c.addEventListener("pointermove",Ze,u),c.addEventListener("pointercancel",Ze,u),c.addEventListener("pointerup",Ze,u),(r=l(this,uh))==null||r.call(this)}if(Ze(e),e.touches.length!==2||(o=l(this,lh))!=null&&o.call(this)){y(this,Vi,null);return}let[t,s]=e.touches;t.identifier>s.identifier&&([t,s]=[s,t]),y(this,Vi,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:s.screenX,touch1Y:s.screenY})},ox=function(e){var x;if(!l(this,Vi)||e.touches.length!==2)return;Ze(e);let[t,s]=e.touches;t.identifier>s.identifier&&([t,s]=[s,t]);const{screenX:i,screenY:r}=t,{screenX:o,screenY:a}=s,c=l(this,Vi),{touch0X:u,touch0Y:d,touch1X:h,touch1Y:f}=c,p=h-u,w=f-d,g=o-i,E=a-r,m=Math.hypot(g,E)||1,v=Math.hypot(p,w)||1;if(!l(this,ca)&&Math.abs(v-m)<=nb.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(c.touch0X=i,c.touch0Y=r,c.touch1X=o,c.touch1Y=a,!l(this,ca)){y(this,ca,!0);return}const b=[(i+o)/2,(r+a)/2];(x=l(this,dh))==null||x.call(this,b,v,m)},ax=function(e){var t;e.touches.length>=2||(l(this,Gi)&&(l(this,Gi).abort(),y(this,Gi,null),(t=l(this,hh))==null||t.call(this)),l(this,Vi)&&(Ze(e),y(this,Vi,null),y(this,ca,!1)))};let Hd=nb;var ha,Rs,Ne,gc,Qr,fh,fa,Tt,pa,Wi,Jr,ph,ga,Nn,gh,ma,Xi,hi,mc,yc,os,ya,mh,Hg,J,kv,yh,Tv,Rp,lx,cx,Rv,Pp,Pv,ux,dx,hx,Lv,fx,Mv,px,gx,mx,Dv,qu;const ie=class ie{constructor(e){A(this,J);A(this,ha,null);A(this,Rs,null);A(this,Ne,null);A(this,gc,!1);A(this,Qr,null);A(this,fh,"");A(this,fa,!1);A(this,Tt,null);A(this,pa,null);A(this,Wi,null);A(this,Jr,null);A(this,ph,"");A(this,ga,!1);A(this,Nn,null);A(this,gh,!1);A(this,ma,!1);A(this,Xi,!1);A(this,hi,null);A(this,mc,0);A(this,yc,0);A(this,os,null);A(this,ya,null);F(this,"isSelected",!1);F(this,"_isCopy",!1);F(this,"_editToolbar",null);F(this,"_initialOptions",Object.create(null));F(this,"_initialData",null);F(this,"_isVisible",!0);F(this,"_uiManager",null);F(this,"_focusEventsAllowed",!0);A(this,mh,!1);A(this,Hg,ie._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null;const{rotation:t,rawDims:{pageWidth:s,pageHeight:i,pageX:r,pageY:o}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,i],this.pageTranslation=[r,o];const[a,c]=this.parentDimensions;this.x=e.x/a,this.y=e.y/c,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=ie.prototype._resizeWithKeyboard,t=Io.TRANSLATE_SMALL,s=Io.TRANSLATE_BIG;return le(this,"_resizerKeyboardManager",new Lf([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,s]}],[["Escape","mac+Escape"],ie.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return le(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new mP({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(ie._l10n??(ie._l10n=e),ie._l10nResizer||(ie._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),ie._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);ie._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){_e("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return l(this,mh)}set _isDraggable(e){var t;y(this,mh,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=l(this,Hg)}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):S(this,J,qu).call(this),this.parent=e}focusin(e){this._focusEventsAllowed&&(l(this,ga)?y(this,ga,!1):this.parent.setSelected(this))}focusout(e){var s;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(s=this.parent)!=null&&s.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,s,i){const[r,o]=this.parentDimensions;[s,i]=this.screenToPageTranslation(s,i),this.x=(e+s)/r,this.y=(t+i)/o,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[s,i]=this.parentDimensions;this.setAt(e*s,t*i,this.width*s,this.height*i),this._onTranslated()}translate(e,t){S(this,J,kv).call(this,this.parentDimensions,e,t)}translateInPage(e,t){l(this,Nn)||y(this,Nn,[this.x,this.y,this.width,this.height]),S(this,J,kv).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){l(this,Nn)||y(this,Nn,[this.x,this.y,this.width,this.height]);const{div:s,parentDimensions:[i,r]}=this;if(this.x+=e/i,this.y+=t/r,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:h,y:f}=this.div.getBoundingClientRect();this.parent.findNewParent(this,h,f)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:o,y:a}=this;const[c,u]=this.getBaseTranslation();o+=c,a+=u;const{style:d}=s;d.left=`${(100*o).toFixed(2)}%`,d.top=`${(100*a).toFixed(2)}%`,this._onTranslating(o,a),s.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!l(this,Nn)&&(l(this,Nn)[0]!==this.x||l(this,Nn)[1]!==this.y)}get _hasBeenResized(){return!!l(this,Nn)&&(l(this,Nn)[2]!==this.width||l(this,Nn)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:s}=ie,i=s/e,r=s/t;switch(this.rotation){case 90:return[-i,r];case 180:return[i,r];case 270:return[i,-r];default:return[-i,-r]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[s,i]}=this;let{x:r,y:o,width:a,height:c}=this;if(a*=s,c*=i,r*=s,o*=i,this._mustFixPosition)switch(e){case 0:r=Xt(r,0,s-a),o=Xt(o,0,i-c);break;case 90:r=Xt(r,0,s-c),o=Xt(o,a,i);break;case 180:r=Xt(r,a,s),o=Xt(o,c,i);break;case 270:r=Xt(r,c,s),o=Xt(o,0,i-a);break}this.x=r/=s,this.y=o/=i;const[u,d]=this.getBaseTranslation();r+=u,o+=d,t.left=`${(100*r).toFixed(2)}%`,t.top=`${(100*o).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var s;return S(s=ie,yh,Tv).call(s,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var s;return S(s=ie,yh,Tv).call(s,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,s]}=this;return[t*e,s*e]}setDims(e,t){const[s,i]=this.parentDimensions,{style:r}=this.div;r.width=`${(100*e/s).toFixed(2)}%`,l(this,fa)||(r.height=`${(100*t/i).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:s}=e,i=s.endsWith("%"),r=!l(this,fa)&&t.endsWith("%");if(i&&r)return;const[o,a]=this.parentDimensions;i||(e.width=`${(100*parseFloat(s)/o).toFixed(2)}%`),!l(this,fa)&&!r&&(e.height=`${(100*parseFloat(t)/a).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=l(this,Ne))==null||e.finish()}async addEditToolbar(){return this._editToolbar||l(this,ma)?this._editToolbar:(this._editToolbar=new vv(this),this.div.append(this._editToolbar.render()),l(this,Ne)&&await this._editToolbar.addAltText(l(this,Ne)),this._editToolbar)}removeEditToolbar(){var e;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(e=l(this,Ne))==null||e.destroy())}addContainer(e){var s;const t=(s=this._editToolbar)==null?void 0:s.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){l(this,Ne)||(kg.initialize(ie._l10n),y(this,Ne,new kg(this)),l(this,ha)&&(l(this,Ne).data=l(this,ha),y(this,ha,null)),await this.addEditToolbar())}get altTextData(){var e;return(e=l(this,Ne))==null?void 0:e.data}set altTextData(e){l(this,Ne)&&(l(this,Ne).data=e)}get guessedAltText(){var e;return(e=l(this,Ne))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=l(this,Ne))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=l(this,Ne))==null?void 0:t.serialize(e)}hasAltText(){return!!l(this,Ne)&&!l(this,Ne).isEmpty()}hasAltTextData(){var e;return((e=l(this,Ne))==null?void 0:e.hasData())??!1}render(){var o;const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=l(this,gc)?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),S(this,J,Mv).call(this);const[t,s]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*s/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/s).toFixed(2)}%`);const[i,r]=this.getInitialTranslation();return this.translate(i,r),X1(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(l(this,ya)||y(this,ya,new Hd({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:S(this,J,ux).bind(this),onPinching:S(this,J,dx).bind(this),onPinchEnd:S(this,J,hx).bind(this),signal:this._uiManager._signal}))),(o=this._uiManager._editorUndoBar)==null||o.hide(),e}pointerdown(e){const{isMac:t}=xt.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(y(this,ga,!0),this._isDraggable){S(this,J,fx).call(this,e);return}S(this,J,Lv).call(this,e)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){l(this,hi)&&clearTimeout(l(this,hi)),y(this,hi,setTimeout(()=>{var e;y(this,hi,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,s){e.changeParent(this),this.x=t,this.y=s,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,s=this.rotation){const i=this.parentScale,[r,o]=this.pageDimensions,[a,c]=this.pageTranslation,u=e/i,d=t/i,h=this.x*r,f=this.y*o,p=this.width*r,w=this.height*o;switch(s){case 0:return[h+u+a,o-f-d-w+c,h+u+p+a,o-f-d+c];case 90:return[h+d+a,o-f+u+c,h+d+w+a,o-f+u+p+c];case 180:return[h-u-p+a,o-f+d+c,h-u+a,o-f+d+w+c];case 270:return[h-d-w+a,o-f-u-p+c,h-d+a,o-f-u+c];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[s,i,r,o]=e,a=r-s,c=o-i;switch(this.rotation){case 0:return[s,t-o,a,c];case 90:return[s,t-i,c,a];case 180:return[r,t-i,a,c];case 270:return[r,t-o,c,a];default:throw new Error("Invalid rotation")}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),y(this,ma,!0),!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),y(this,ma,!1),!0):!1}isInEditMode(){return l(this,ma)}shouldGetKeyboardEvents(){return l(this,Xi)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:s,right:i}=this.getClientDimensions(),{innerHeight:r,innerWidth:o}=window;return t<o&&i>0&&e<r&&s>0}rebuild(){S(this,J,Mv).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){_e("An editor must be serializable")}static async deserialize(e,t,s){const i=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:s});i.rotation=e.rotation,y(i,ha,e.accessibilityData),i._isCopy=e.isCopy||!1;const[r,o]=i.pageDimensions,[a,c,u,d]=i.getRectInCurrentCoords(e.rect,o);return i.x=a/r,i.y=c/o,i.width=u/r,i.height=d/o,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,t;if((e=l(this,Jr))==null||e.abort(),y(this,Jr,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),l(this,hi)&&(clearTimeout(l(this,hi)),y(this,hi,null)),S(this,J,qu).call(this),this.removeEditToolbar(),l(this,os)){for(const s of l(this,os).values())clearTimeout(s);y(this,os,null)}this.parent=null,(t=l(this,ya))==null||t.destroy(),y(this,ya,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(S(this,J,lx).call(this),l(this,Tt).classList.remove("hidden"))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),y(this,Wi,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=l(this,Tt).children;if(!l(this,Rs)){y(this,Rs,Array.from(t));const o=S(this,J,px).bind(this),a=S(this,J,gx).bind(this),c=this._uiManager._signal;for(const u of l(this,Rs)){const d=u.getAttribute("data-resizer-name");u.setAttribute("role","spinbutton"),u.addEventListener("keydown",o,{signal:c}),u.addEventListener("blur",a,{signal:c}),u.addEventListener("focus",S(this,J,mx).bind(this,d),{signal:c}),u.setAttribute("data-l10n-id",ie._l10nResizer[d])}}const s=l(this,Rs)[0];let i=0;for(const o of t){if(o===s)break;i++}const r=(360-this.rotation+this.parentRotation)%360/90*(l(this,Rs).length/4);if(r!==i){if(r<i)for(let a=0;a<i-r;a++)l(this,Tt).append(l(this,Tt).firstChild);else if(r>i)for(let a=0;a<r-i;a++)l(this,Tt).firstChild.before(l(this,Tt).lastChild);let o=0;for(const a of t){const u=l(this,Rs)[o++].getAttribute("data-resizer-name");a.setAttribute("data-l10n-id",ie._l10nResizer[u])}}S(this,J,Dv).call(this,0),y(this,Xi,!0),l(this,Tt).firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){l(this,Xi)&&S(this,J,Pv).call(this,l(this,ph),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){S(this,J,qu).call(this),this.div.focus()}select(){var e,t,s;if(!(this.isSelected&&this._editToolbar)){if(this.isSelected=!0,this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var i,r;(i=this.div)!=null&&i.classList.contains("selectedEditor")&&((r=this._editToolbar)==null||r.show())});return}(t=this._editToolbar)==null||t.show(),(s=l(this,Ne))==null||s.toggleAltTextBadge(!1)}}unselect(){var e,t,s,i,r;this.isSelected&&(this.isSelected=!1,(e=l(this,Tt))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(s=this.div)!=null&&s.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(i=this._editToolbar)==null||i.hide(),(r=l(this,Ne))==null||r.toggleAltTextBadge(!0))}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id})}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return l(this,gh)}set isEditing(e){y(this,gh,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){y(this,fa,!0);const s=e/t,{style:i}=this.div;i.aspectRatio=s,i.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){l(this,os)||y(this,os,new Map);const{action:s}=e;let i=l(this,os).get(s);i&&clearTimeout(i),i=setTimeout(()=>{this._reportTelemetry(e),l(this,os).delete(s),l(this,os).size===0&&y(this,os,null)},ie._telemetryTimeout),l(this,os).set(s,i);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),y(this,gc,!1)}disable(){this.div&&(this.div.tabIndex=-1),y(this,gc,!0)}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const s=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),s.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};ha=new WeakMap,Rs=new WeakMap,Ne=new WeakMap,gc=new WeakMap,Qr=new WeakMap,fh=new WeakMap,fa=new WeakMap,Tt=new WeakMap,pa=new WeakMap,Wi=new WeakMap,Jr=new WeakMap,ph=new WeakMap,ga=new WeakMap,Nn=new WeakMap,gh=new WeakMap,ma=new WeakMap,Xi=new WeakMap,hi=new WeakMap,mc=new WeakMap,yc=new WeakMap,os=new WeakMap,ya=new WeakMap,mh=new WeakMap,Hg=new WeakMap,J=new WeakSet,kv=function([e,t],s,i){[s,i]=this.screenToPageTranslation(s,i),this.x+=s/e,this.y+=i/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},yh=new WeakSet,Tv=function(e,t,s){switch(s){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},Rp=function(e){switch(e){case 90:{const[t,s]=this.pageDimensions;return[0,-t/s,s/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,s]=this.pageDimensions;return[0,t/s,-s/t,0]}default:return[1,0,0,1]}},lx=function(){if(l(this,Tt))return;y(this,Tt,document.createElement("div")),l(this,Tt).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const s of e){const i=document.createElement("div");l(this,Tt).append(i),i.classList.add("resizer",s),i.setAttribute("data-resizer-name",s),i.addEventListener("pointerdown",S(this,J,cx).bind(this,s),{signal:t}),i.addEventListener("contextmenu",As,{signal:t}),i.tabIndex=-1}this.div.prepend(l(this,Tt))},cx=function(e,t){var d;t.preventDefault();const{isMac:s}=xt.platform;if(t.button!==0||t.ctrlKey&&s)return;(d=l(this,Ne))==null||d.toggle(!1);const i=this._isDraggable;this._isDraggable=!1,y(this,pa,[t.screenX,t.screenY]);const r=new AbortController,o=this._uiManager.combinedSignal(r);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",S(this,J,Pv).bind(this,e),{passive:!0,capture:!0,signal:o}),window.addEventListener("touchmove",Ze,{passive:!1,signal:o}),window.addEventListener("contextmenu",As,{signal:o}),y(this,Wi,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const a=this.parent.div.style.cursor,c=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const u=()=>{var h;r.abort(),this.parent.togglePointerEvents(!0),(h=l(this,Ne))==null||h.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=a,this.div.style.cursor=c,S(this,J,Pp).call(this)};window.addEventListener("pointerup",u,{signal:o}),window.addEventListener("blur",u,{signal:o})},Rv=function(e,t,s,i){this.width=s,this.height=i,this.x=e,this.y=t;const[r,o]=this.parentDimensions;this.setDims(r*s,o*i),this.fixAndSetPosition(),this._onResized()},Pp=function(){if(!l(this,Wi))return;const{savedX:e,savedY:t,savedWidth:s,savedHeight:i}=l(this,Wi);y(this,Wi,null);const r=this.x,o=this.y,a=this.width,c=this.height;r===e&&o===t&&a===s&&c===i||this.addCommands({cmd:S(this,J,Rv).bind(this,r,o,a,c),undo:S(this,J,Rv).bind(this,e,t,s,i),mustExec:!0})},Pv=function(e,t){const[s,i]=this.parentDimensions,r=this.x,o=this.y,a=this.width,c=this.height,u=ie.MIN_SIZE/s,d=ie.MIN_SIZE/i,h=S(this,J,Rp).call(this,this.rotation),f=(j,O)=>[h[0]*j+h[2]*O,h[1]*j+h[3]*O],p=S(this,J,Rp).call(this,360-this.rotation),w=(j,O)=>[p[0]*j+p[2]*O,p[1]*j+p[3]*O];let g,E,m=!1,v=!1;switch(e){case"topLeft":m=!0,g=(j,O)=>[0,0],E=(j,O)=>[j,O];break;case"topMiddle":g=(j,O)=>[j/2,0],E=(j,O)=>[j/2,O];break;case"topRight":m=!0,g=(j,O)=>[j,0],E=(j,O)=>[0,O];break;case"middleRight":v=!0,g=(j,O)=>[j,O/2],E=(j,O)=>[0,O/2];break;case"bottomRight":m=!0,g=(j,O)=>[j,O],E=(j,O)=>[0,0];break;case"bottomMiddle":g=(j,O)=>[j/2,O],E=(j,O)=>[j/2,0];break;case"bottomLeft":m=!0,g=(j,O)=>[0,O],E=(j,O)=>[j,0];break;case"middleLeft":v=!0,g=(j,O)=>[0,O/2],E=(j,O)=>[j,O/2];break}const b=g(a,c),x=E(a,c);let _=f(...x);const k=ie._round(r+_[0]),C=ie._round(o+_[1]);let T=1,L=1,M,D;if(t.fromKeyboard)({deltaX:M,deltaY:D}=t);else{const{screenX:j,screenY:O}=t,[I,$]=l(this,pa);[M,D]=this.screenToPageTranslation(j-I,O-$),l(this,pa)[0]=j,l(this,pa)[1]=O}if([M,D]=w(M/s,D/i),m){const j=Math.hypot(a,c);T=L=Math.max(Math.min(Math.hypot(x[0]-b[0]-M,x[1]-b[1]-D)/j,1/a,1/c),u/a,d/c)}else v?T=Xt(Math.abs(x[0]-b[0]-M),u,1)/a:L=Xt(Math.abs(x[1]-b[1]-D),d,1)/c;const q=ie._round(a*T),K=ie._round(c*L);_=f(...E(q,K));const G=k-_[0],ee=C-_[1];l(this,Nn)||y(this,Nn,[this.x,this.y,this.width,this.height]),this.width=q,this.height=K,this.x=G,this.y=ee,this.setDims(s*q,i*K),this.fixAndSetPosition(),this._onResizing()},ux=function(){var e;y(this,Wi,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=l(this,Ne))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},dx=function(e,t,s){let r=.7*(s/t)+1-.7;if(r===1)return;const o=S(this,J,Rp).call(this,this.rotation),a=(k,C)=>[o[0]*k+o[2]*C,o[1]*k+o[3]*C],[c,u]=this.parentDimensions,d=this.x,h=this.y,f=this.width,p=this.height,w=ie.MIN_SIZE/c,g=ie.MIN_SIZE/u;r=Math.max(Math.min(r,1/f,1/p),w/f,g/p);const E=ie._round(f*r),m=ie._round(p*r);if(E===f&&m===p)return;l(this,Nn)||y(this,Nn,[d,h,f,p]);const v=a(f/2,p/2),b=ie._round(d+v[0]),x=ie._round(h+v[1]),_=a(E/2,m/2);this.x=b-_[0],this.y=x-_[1],this.width=E,this.height=m,this.setDims(c*E,u*m),this.fixAndSetPosition(),this._onResizing()},hx=function(){var e;(e=l(this,Ne))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),S(this,J,Pp).call(this)},Lv=function(e){const{isMac:t}=xt.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},fx=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let s=!1;const i=new AbortController,r=this._uiManager.combinedSignal(i),o={capture:!0,passive:!1,signal:r},a=u=>{i.abort(),y(this,Qr,null),y(this,ga,!1),this._uiManager.endDragSession()||S(this,J,Lv).call(this,u),s&&this._onStopDragging()};t&&(y(this,mc,e.clientX),y(this,yc,e.clientY),y(this,Qr,e.pointerId),y(this,fh,e.pointerType),window.addEventListener("pointermove",u=>{s||(s=!0,this._onStartDragging());const{clientX:d,clientY:h,pointerId:f}=u;if(f!==l(this,Qr)){Ze(u);return}const[p,w]=this.screenToPageTranslation(d-l(this,mc),h-l(this,yc));y(this,mc,d),y(this,yc,h),this._uiManager.dragSelectedEditors(p,w)},o),window.addEventListener("touchmove",Ze,o),window.addEventListener("pointerdown",u=>{u.pointerType===l(this,fh)&&(l(this,ya)||u.isPrimary)&&a(u),Ze(u)},o));const c=u=>{if(!l(this,Qr)||l(this,Qr)===u.pointerId){a(u);return}Ze(u)};window.addEventListener("pointerup",c,{signal:r}),window.addEventListener("blur",c,{signal:r})},Mv=function(){if(l(this,Jr)||!this.div)return;y(this,Jr,new AbortController);const e=this._uiManager.combinedSignal(l(this,Jr));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},px=function(e){ie._resizerKeyboardManager.exec(this,e)},gx=function(e){var t;l(this,Xi)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==l(this,Tt)&&S(this,J,qu).call(this)},mx=function(e){y(this,ph,l(this,Xi)?e:"")},Dv=function(e){if(l(this,Rs))for(const t of l(this,Rs))t.tabIndex=e},qu=function(){y(this,Xi,!1),S(this,J,Dv).call(this,-1),S(this,J,Pp).call(this)},A(ie,yh),F(ie,"_l10n",null),F(ie,"_l10nResizer",null),F(ie,"_borderLineWidth",-1),F(ie,"_colorManager",new bv),F(ie,"_zIndex",1),F(ie,"_telemetryTimeout",1e3);let Me=ie;class mP extends Me{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const CA=3285377520,ns=4294901760,ti=65535;class yx{constructor(e){this.h1=e?e&4294967295:CA,this.h2=e?e&4294967295:CA}update(e){let t,s;if(typeof e=="string"){t=new Uint8Array(e.length*2),s=0;for(let g=0,E=e.length;g<E;g++){const m=e.charCodeAt(g);m<=255?t[s++]=m:(t[s++]=m>>>8,t[s++]=m&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),s=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const i=s>>2,r=s-i*4,o=new Uint32Array(t.buffer,0,i);let a=0,c=0,u=this.h1,d=this.h2;const h=3432918353,f=461845907,p=h&ti,w=f&ti;for(let g=0;g<i;g++)g&1?(a=o[g],a=a*h&ns|a*p&ti,a=a<<15|a>>>17,a=a*f&ns|a*w&ti,u^=a,u=u<<13|u>>>19,u=u*5+3864292196):(c=o[g],c=c*h&ns|c*p&ti,c=c<<15|c>>>17,c=c*f&ns|c*w&ti,d^=c,d=d<<13|d>>>19,d=d*5+3864292196);switch(a=0,r){case 3:a^=t[i*4+2]<<16;case 2:a^=t[i*4+1]<<8;case 1:a^=t[i*4],a=a*h&ns|a*p&ti,a=a<<15|a>>>17,a=a*f&ns|a*w&ti,i&1?u^=a:d^=a}this.h1=u,this.h2=d}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&ns|e*36045&ti,t=t*4283543511&ns|((t<<16|e>>>16)*2950163797&ns)>>>16,e^=t>>>1,e=e*444984403&ns|e*60499&ti,t=t*3301882366&ns|((t<<16|e>>>16)*3120437893&ns)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const Nv=Object.freeze({map:null,hash:"",transfer:void 0});var va,wa,Rt,Ug,vx;class Ow{constructor(){A(this,Ug);A(this,va,!1);A(this,wa,null);A(this,Rt,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const s=l(this,Rt).get(e);return s===void 0?t:Object.assign(t,s)}getRawValue(e){return l(this,Rt).get(e)}remove(e){if(l(this,Rt).delete(e),l(this,Rt).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of l(this,Rt).values())if(t instanceof Me)return;this.onAnnotationEditor(null)}}setValue(e,t){const s=l(this,Rt).get(e);let i=!1;if(s!==void 0)for(const[r,o]of Object.entries(t))s[r]!==o&&(i=!0,s[r]=o);else i=!0,l(this,Rt).set(e,t);i&&S(this,Ug,vx).call(this),t instanceof Me&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return l(this,Rt).has(e)}get size(){return l(this,Rt).size}resetModified(){l(this,va)&&(y(this,va,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new wx(this)}get serializable(){if(l(this,Rt).size===0)return Nv;const e=new Map,t=new yx,s=[],i=Object.create(null);let r=!1;for(const[o,a]of l(this,Rt)){const c=a instanceof Me?a.serialize(!1,i):a;c&&(e.set(o,c),t.update(`${o}:${JSON.stringify(c)}`),r||(r=!!c.bitmap))}if(r)for(const o of e.values())o.bitmap&&s.push(o.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:s}:Nv}get editorStats(){let e=null;const t=new Map;for(const s of l(this,Rt).values()){if(!(s instanceof Me))continue;const i=s.telemetryFinalData;if(!i)continue;const{type:r}=i;t.has(r)||t.set(r,Object.getPrototypeOf(s).constructor),e||(e=Object.create(null));const o=e[r]||(e[r]=new Map);for(const[a,c]of Object.entries(i)){if(a==="type")continue;let u=o.get(a);u||(u=new Map,o.set(a,u));const d=u.get(c)??0;u.set(c,d+1)}}for(const[s,i]of t)e[s]=i.computeTelemetryFinalData(e[s]);return e}resetModifiedIds(){y(this,wa,null)}get modifiedIds(){if(l(this,wa))return l(this,wa);const e=[];for(const t of l(this,Rt).values())!(t instanceof Me)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return y(this,wa,{ids:new Set(e),hash:e.join(",")})}[Symbol.iterator](){return l(this,Rt).entries()}}va=new WeakMap,wa=new WeakMap,Rt=new WeakMap,Ug=new WeakSet,vx=function(){l(this,va)||(y(this,va,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var vh;class wx extends Ow{constructor(t){super();A(this,vh);const{map:s,hash:i,transfer:r}=t.serializable,o=structuredClone(s,r?{transfer:r}:null);y(this,vh,{map:o,hash:i,transfer:r})}get print(){_e("Should not call PrintAnnotationStorage.print")}get serializable(){return l(this,vh)}get modifiedIds(){return le(this,"modifiedIds",{ids:new Set,hash:""})}}vh=new WeakMap;var vc;class yP{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){A(this,vc,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),l(this,vc).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:s}){if(!(!e||l(this,vc).has(e.loadedName))){if(it(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:i,src:r,style:o}=e,a=new FontFace(i,r,o);this.addNativeFontFace(a);try{await a.load(),l(this,vc).add(i),s==null||s(e)}catch{te(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(a)}return}_e("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const s=e.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(i){throw te(`Failed to load font '${s.family}': '${i}'.`),e.disableFontFace=!0,i}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const i=this._queueLoadingCallback(s);this._prepareFontLoadEvent(e,i)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return le(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return le(this,"isSyncFontLoadingSupported",sn||xt.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(it(!i.done,"completeRequest() cannot be called twice."),i.done=!0;s.length>0&&s[0].done;){const r=s.shift();setTimeout(r.callback,0)}}const{loadingRequests:s}=this,i={done:!1,complete:t,callback:e};return s.push(i),i}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return le(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function s(x,_){return x.charCodeAt(_)<<24|x.charCodeAt(_+1)<<16|x.charCodeAt(_+2)<<8|x.charCodeAt(_+3)&255}function i(x,_,k,C){const T=x.substring(0,_),L=x.substring(_+k);return T+C+L}let r,o;const a=this._document.createElement("canvas");a.width=1,a.height=1;const c=a.getContext("2d");let u=0;function d(x,_){if(++u>30){te("Load test font never loaded."),_();return}if(c.font="30px "+x,c.fillText(".",0,20),c.getImageData(0,0,1,1).data[3]>0){_();return}setTimeout(d.bind(null,x,_))}const h=`lt${Date.now()}${this.loadTestFontId++}`;let f=this._loadTestFont;f=i(f,976,h.length,h);const w=16,g=1482184792;let E=s(f,w);for(r=0,o=h.length-3;r<o;r+=4)E=E-g+s(h,r)|0;r<h.length&&(E=E-g+s(h+"XXX",r)|0),f=i(f,w,4,rP(E));const m=`url(data:font/opentype;base64,${btoa(f)});`,v=`@font-face {font-family:"${h}";src:${m}}`;this.insertRule(v);const b=this._document.createElement("div");b.style.visibility="hidden",b.style.width=b.style.height="10px",b.style.position="absolute",b.style.top=b.style.left="0px";for(const x of[e.loadedName,h]){const _=this._document.createElement("span");_.textContent="Hi",_.style.fontFamily=x,b.append(_)}this._document.body.append(b),d(h,()=>{b.remove(),t.complete()})}}vc=new WeakMap;class vP{constructor(e,t=null){this.compiledGlyphs=Object.create(null);for(const s in e)this[s]=e[s];this._inspectFont=t}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const s={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(s.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,s)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var s;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${O1(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${e}}`}return(s=this._inspectFont)==null||s.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const s=this.loadedName+"_path_"+t;let i;try{i=e.get(s)}catch(o){te(`getPathGenerator - ignoring character: "${o}".`)}const r=new Path2D(i||"");return this.fontExtraProperties||e.delete(s),this.compiledGlyphs[t]=r}}function wP(n){if(n instanceof URL)return n.href;if(typeof n=="string"){if(sn)return n;const e=URL.parse(n,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function bP(n){if(sn&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return Tf(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n==null?void 0:n.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function rp(n){if(typeof n!="string")return null;if(n.endsWith("/"))return n;throw new Error(`Invalid factory url: "${n}" must include trailing slash.`)}const Iv=n=>typeof n=="object"&&Number.isInteger(n==null?void 0:n.num)&&n.num>=0&&Number.isInteger(n==null?void 0:n.gen)&&n.gen>=0,AP=n=>typeof n=="object"&&typeof(n==null?void 0:n.name)=="string",bx=cP.bind(null,Iv,AP);var Yi,Vg;class SP{constructor(){A(this,Yi,new Map);A(this,Vg,Promise.resolve())}postMessage(e,t){const s={data:structuredClone(e,t?{transfer:t}:null)};l(this,Vg).then(()=>{for(const[i]of l(this,Yi))i.call(this,s)})}addEventListener(e,t,s=null){let i=null;if((s==null?void 0:s.signal)instanceof AbortSignal){const{signal:r}=s;if(r.aborted){te("LoopbackPort - cannot use an `aborted` signal.");return}const o=()=>this.removeEventListener(e,t);i=()=>r.removeEventListener("abort",o),r.addEventListener("abort",o)}l(this,Yi).set(t,i)}removeEventListener(e,t){const s=l(this,Yi).get(t);s==null||s(),l(this,Yi).delete(t)}terminate(){for(const[,e]of l(this,Yi))e==null||e();l(this,Yi).clear()}}Yi=new WeakMap,Vg=new WeakMap;const op={DATA:1,ERROR:2},nt={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function kA(){}function hn(n){if(n instanceof Er||n instanceof _g||n instanceof EA||n instanceof $d||n instanceof uy)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||_e('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new Er(n.message);case"InvalidPDFException":return new _g(n.message);case"PasswordException":return new EA(n.message,n.code);case"ResponseException":return new $d(n.message,n.status,n.missing);case"UnknownErrorException":return new uy(n.message,n.details)}return new uy(n.message,n.toString())}var wc,vs,Ax,Sx,Ex,Lp;class Ku{constructor(e,t,s){A(this,vs);A(this,wc,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),s.addEventListener("message",S(this,vs,Ax).bind(this),{signal:l(this,wc).signal})}on(e,t){const s=this.actionHandler;if(s[e])throw new Error(`There is already an actionName called "${e}"`);s[e]=t}send(e,t,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},s)}sendWithPromise(e,t,s){const i=this.callbackId++,r=Promise.withResolvers();this.callbackCapabilities[i]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:i,data:t},s)}catch(o){r.reject(o)}return r.promise}sendWithStream(e,t,s,i){const r=this.streamId++,o=this.sourceName,a=this.targetName,c=this.comObj;return new ReadableStream({start:u=>{const d=Promise.withResolvers();return this.streamControllers[r]={controller:u,startCall:d,pullCall:null,cancelCall:null,isClosed:!1},c.postMessage({sourceName:o,targetName:a,action:e,streamId:r,data:t,desiredSize:u.desiredSize},i),d.promise},pull:u=>{const d=Promise.withResolvers();return this.streamControllers[r].pullCall=d,c.postMessage({sourceName:o,targetName:a,stream:nt.PULL,streamId:r,desiredSize:u.desiredSize}),d.promise},cancel:u=>{it(u instanceof Error,"cancel must have a valid reason");const d=Promise.withResolvers();return this.streamControllers[r].cancelCall=d,this.streamControllers[r].isClosed=!0,c.postMessage({sourceName:o,targetName:a,stream:nt.CANCEL,streamId:r,reason:hn(u)}),d.promise}},s)}destroy(){var e;(e=l(this,wc))==null||e.abort(),y(this,wc,null)}}wc=new WeakMap,vs=new WeakSet,Ax=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){S(this,vs,Ex).call(this,e);return}if(e.callback){const s=e.callbackId,i=this.callbackCapabilities[s];if(!i)throw new Error(`Cannot resolve callback ${s}`);if(delete this.callbackCapabilities[s],e.callback===op.DATA)i.resolve(e.data);else if(e.callback===op.ERROR)i.reject(hn(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const s=this.sourceName,i=e.sourceName,r=this.comObj;Promise.try(t,e.data).then(function(o){r.postMessage({sourceName:s,targetName:i,callback:op.DATA,callbackId:e.callbackId,data:o})},function(o){r.postMessage({sourceName:s,targetName:i,callback:op.ERROR,callbackId:e.callbackId,reason:hn(o)})});return}if(e.streamId){S(this,vs,Sx).call(this,e);return}t(e.data)},Sx=function(e){const t=e.streamId,s=this.sourceName,i=e.sourceName,r=this.comObj,o=this,a=this.actionHandler[e.action],c={enqueue(u,d=1,h){if(this.isCancelled)return;const f=this.desiredSize;this.desiredSize-=d,f>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),r.postMessage({sourceName:s,targetName:i,stream:nt.ENQUEUE,streamId:t,chunk:u},h)},close(){this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:s,targetName:i,stream:nt.CLOSE,streamId:t}),delete o.streamSinks[t])},error(u){it(u instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,r.postMessage({sourceName:s,targetName:i,stream:nt.ERROR,streamId:t,reason:hn(u)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};c.sinkCapability.resolve(),c.ready=c.sinkCapability.promise,this.streamSinks[t]=c,Promise.try(a,e.data,c).then(function(){r.postMessage({sourceName:s,targetName:i,stream:nt.START_COMPLETE,streamId:t,success:!0})},function(u){r.postMessage({sourceName:s,targetName:i,stream:nt.START_COMPLETE,streamId:t,reason:hn(u)})})},Ex=function(e){const t=e.streamId,s=this.sourceName,i=e.sourceName,r=this.comObj,o=this.streamControllers[t],a=this.streamSinks[t];switch(e.stream){case nt.START_COMPLETE:e.success?o.startCall.resolve():o.startCall.reject(hn(e.reason));break;case nt.PULL_COMPLETE:e.success?o.pullCall.resolve():o.pullCall.reject(hn(e.reason));break;case nt.PULL:if(!a){r.postMessage({sourceName:s,targetName:i,stream:nt.PULL_COMPLETE,streamId:t,success:!0});break}a.desiredSize<=0&&e.desiredSize>0&&a.sinkCapability.resolve(),a.desiredSize=e.desiredSize,Promise.try(a.onPull||kA).then(function(){r.postMessage({sourceName:s,targetName:i,stream:nt.PULL_COMPLETE,streamId:t,success:!0})},function(u){r.postMessage({sourceName:s,targetName:i,stream:nt.PULL_COMPLETE,streamId:t,reason:hn(u)})});break;case nt.ENQUEUE:if(it(o,"enqueue should have stream controller"),o.isClosed)break;o.controller.enqueue(e.chunk);break;case nt.CLOSE:if(it(o,"close should have stream controller"),o.isClosed)break;o.isClosed=!0,o.controller.close(),S(this,vs,Lp).call(this,o,t);break;case nt.ERROR:it(o,"error should have stream controller"),o.controller.error(hn(e.reason)),S(this,vs,Lp).call(this,o,t);break;case nt.CANCEL_COMPLETE:e.success?o.cancelCall.resolve():o.cancelCall.reject(hn(e.reason)),S(this,vs,Lp).call(this,o,t);break;case nt.CANCEL:if(!a)break;const c=hn(e.reason);Promise.try(a.onCancel||kA,c).then(function(){r.postMessage({sourceName:s,targetName:i,stream:nt.CANCEL_COMPLETE,streamId:t,success:!0})},function(u){r.postMessage({sourceName:s,targetName:i,stream:nt.CANCEL_COMPLETE,streamId:t,reason:hn(u)})}),a.sinkCapability.reject(c),a.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},Lp=async function(e,t){var s,i,r;await Promise.allSettled([(s=e.startCall)==null?void 0:s.promise,(i=e.pullCall)==null?void 0:i.promise,(r=e.cancelCall)==null?void 0:r.promise]),delete this.streamControllers[t]};var wh;class xx{constructor({enableHWA:e=!1}){A(this,wh,!1);y(this,wh,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(e,t);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!l(this,wh)})}}reset(e,t,s){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||s<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=s}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){_e("Abstract method `_createCanvas` called.")}}wh=new WeakMap;class EP extends xx{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const s=this._document.createElement("canvas");return s.width=e,s.height=t,s}}class _x{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(s=>({cMapData:s,isCompressed:this.isCompressed})).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){_e("Abstract method `_fetch` called.")}}class TA extends _x{async _fetch(e){const t=await Eu(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):Tf(t)}}class Cx{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,s,i,r){return"none"}destroy(e=!1){}}var ba,bc,qi,Ki,Vt,Aa,Sa,B,Ht,Qu,_l,Mp,Cl,kx,Ov,kl,Ju,Zu,Fv,ed;class xP extends Cx{constructor({docId:t,ownerDocument:s=globalThis.document}){super();A(this,B);A(this,ba);A(this,bc);A(this,qi);A(this,Ki);A(this,Vt);A(this,Aa);A(this,Sa,0);y(this,Ki,t),y(this,Vt,s)}addFilter(t){if(!t)return"none";let s=l(this,B,Ht).get(t);if(s)return s;const[i,r,o]=S(this,B,Mp).call(this,t),a=t.length===1?i:`${i}${r}${o}`;if(s=l(this,B,Ht).get(a),s)return l(this,B,Ht).set(t,s),s;const c=`g_${l(this,Ki)}_transfer_map_${Qt(this,Sa)._++}`,u=S(this,B,Cl).call(this,c);l(this,B,Ht).set(t,u),l(this,B,Ht).set(a,u);const d=S(this,B,kl).call(this,c);return S(this,B,Zu).call(this,i,r,o,d),u}addHCMFilter(t,s){var w;const i=`${t}-${s}`,r="base";let o=l(this,B,Qu).get(r);if((o==null?void 0:o.key)===i||(o?((w=o.filter)==null||w.remove(),o.key=i,o.url="none",o.filter=null):(o={key:i,url:"none",filter:null},l(this,B,Qu).set(r,o)),!t||!s))return o.url;const a=S(this,B,ed).call(this,t);t=Y.makeHexColor(...a);const c=S(this,B,ed).call(this,s);if(s=Y.makeHexColor(...c),l(this,B,_l).style.color="",t==="#000000"&&s==="#ffffff"||t===s)return o.url;const u=new Array(256);for(let g=0;g<=255;g++){const E=g/255;u[g]=E<=.03928?E/12.92:((E+.055)/1.055)**2.4}const d=u.join(","),h=`g_${l(this,Ki)}_hcm_filter`,f=o.filter=S(this,B,kl).call(this,h);S(this,B,Zu).call(this,d,d,d,f),S(this,B,Ov).call(this,f);const p=(g,E)=>{const m=a[g]/255,v=c[g]/255,b=new Array(E+1);for(let x=0;x<=E;x++)b[x]=m+x/E*(v-m);return b.join(",")};return S(this,B,Zu).call(this,p(0,5),p(1,5),p(2,5),f),o.url=S(this,B,Cl).call(this,h),o.url}addAlphaFilter(t){let s=l(this,B,Ht).get(t);if(s)return s;const[i]=S(this,B,Mp).call(this,[t]),r=`alpha_${i}`;if(s=l(this,B,Ht).get(r),s)return l(this,B,Ht).set(t,s),s;const o=`g_${l(this,Ki)}_alpha_map_${Qt(this,Sa)._++}`,a=S(this,B,Cl).call(this,o);l(this,B,Ht).set(t,a),l(this,B,Ht).set(r,a);const c=S(this,B,kl).call(this,o);return S(this,B,Fv).call(this,i,c),a}addLuminosityFilter(t){let s=l(this,B,Ht).get(t||"luminosity");if(s)return s;let i,r;if(t?([i]=S(this,B,Mp).call(this,[t]),r=`luminosity_${i}`):r="luminosity",s=l(this,B,Ht).get(r),s)return l(this,B,Ht).set(t,s),s;const o=`g_${l(this,Ki)}_luminosity_map_${Qt(this,Sa)._++}`,a=S(this,B,Cl).call(this,o);l(this,B,Ht).set(t,a),l(this,B,Ht).set(r,a);const c=S(this,B,kl).call(this,o);return S(this,B,kx).call(this,c),t&&S(this,B,Fv).call(this,i,c),a}addHighlightHCMFilter(t,s,i,r,o){var v;const a=`${s}-${i}-${r}-${o}`;let c=l(this,B,Qu).get(t);if((c==null?void 0:c.key)===a||(c?((v=c.filter)==null||v.remove(),c.key=a,c.url="none",c.filter=null):(c={key:a,url:"none",filter:null},l(this,B,Qu).set(t,c)),!s||!i))return c.url;const[u,d]=[s,i].map(S(this,B,ed).bind(this));let h=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),f=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),[p,w]=[r,o].map(S(this,B,ed).bind(this));f<h&&([h,f,p,w]=[f,h,w,p]),l(this,B,_l).style.color="";const g=(b,x,_)=>{const k=new Array(256),C=(f-h)/_,T=b/255,L=(x-b)/(255*_);let M=0;for(let D=0;D<=_;D++){const q=Math.round(h+D*C),K=T+D*L;for(let G=M;G<=q;G++)k[G]=K;M=q+1}for(let D=M;D<256;D++)k[D]=k[M-1];return k.join(",")},E=`g_${l(this,Ki)}_hcm_${t}_filter`,m=c.filter=S(this,B,kl).call(this,E);return S(this,B,Ov).call(this,m),S(this,B,Zu).call(this,g(p[0],w[0],5),g(p[1],w[1],5),g(p[2],w[2],5),m),c.url=S(this,B,Cl).call(this,E),c.url}destroy(t=!1){var s,i,r,o;t&&((s=l(this,Aa))!=null&&s.size)||((i=l(this,qi))==null||i.parentNode.parentNode.remove(),y(this,qi,null),(r=l(this,bc))==null||r.clear(),y(this,bc,null),(o=l(this,Aa))==null||o.clear(),y(this,Aa,null),y(this,Sa,0))}}ba=new WeakMap,bc=new WeakMap,qi=new WeakMap,Ki=new WeakMap,Vt=new WeakMap,Aa=new WeakMap,Sa=new WeakMap,B=new WeakSet,Ht=function(){return l(this,bc)||y(this,bc,new Map)},Qu=function(){return l(this,Aa)||y(this,Aa,new Map)},_l=function(){if(!l(this,qi)){const t=l(this,Vt).createElement("div"),{style:s}=t;s.visibility="hidden",s.contain="strict",s.width=s.height=0,s.position="absolute",s.top=s.left=0,s.zIndex=-1;const i=l(this,Vt).createElementNS(Mi,"svg");i.setAttribute("width",0),i.setAttribute("height",0),y(this,qi,l(this,Vt).createElementNS(Mi,"defs")),t.append(i),i.append(l(this,qi)),l(this,Vt).body.append(t)}return l(this,qi)},Mp=function(t){if(t.length===1){const u=t[0],d=new Array(256);for(let f=0;f<256;f++)d[f]=u[f]/255;const h=d.join(",");return[h,h,h]}const[s,i,r]=t,o=new Array(256),a=new Array(256),c=new Array(256);for(let u=0;u<256;u++)o[u]=s[u]/255,a[u]=i[u]/255,c[u]=r[u]/255;return[o.join(","),a.join(","),c.join(",")]},Cl=function(t){if(l(this,ba)===void 0){y(this,ba,"");const s=l(this,Vt).URL;s!==l(this,Vt).baseURI&&(Pf(s)?te('#createUrl: ignore "data:"-URL for performance reasons.'):y(this,ba,Mw(s,"")))}return`url(${l(this,ba)}#${t})`},kx=function(t){const s=l(this,Vt).createElementNS(Mi,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(s)},Ov=function(t){const s=l(this,Vt).createElementNS(Mi,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(s)},kl=function(t){const s=l(this,Vt).createElementNS(Mi,"filter");return s.setAttribute("color-interpolation-filters","sRGB"),s.setAttribute("id",t),l(this,B,_l).append(s),s},Ju=function(t,s,i){const r=l(this,Vt).createElementNS(Mi,s);r.setAttribute("type","discrete"),r.setAttribute("tableValues",i),t.append(r)},Zu=function(t,s,i,r){const o=l(this,Vt).createElementNS(Mi,"feComponentTransfer");r.append(o),S(this,B,Ju).call(this,o,"feFuncR",t),S(this,B,Ju).call(this,o,"feFuncG",s),S(this,B,Ju).call(this,o,"feFuncB",i)},Fv=function(t,s){const i=l(this,Vt).createElementNS(Mi,"feComponentTransfer");s.append(i),S(this,B,Ju).call(this,i,"feFuncA",t)},ed=function(t){return l(this,B,_l).style.color=t,Iw(getComputedStyle(l(this,B,_l)).getPropertyValue("color"))};class Tx{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(s=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){_e("Abstract method `_fetch` called.")}}class RA extends Tx{async _fetch(e){const t=await Eu(e,"arraybuffer");return new Uint8Array(t)}}class Rx{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(s=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){_e("Abstract method `_fetch` called.")}}class PA extends Rx{async _fetch(e){const t=await Eu(e,"arraybuffer");return new Uint8Array(t)}}sn&&te("Please use the `legacy` build in Node.js environments.");async function Fw(n){const t=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(t)}class _P extends Cx{}class CP extends xx{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class kP extends _x{async _fetch(e){return Fw(e)}}class TP extends Tx{async _fetch(e){return Fw(e)}}class RP extends Rx{async _fetch(e){return Fw(e)}}const Dt={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function jv(n,e){if(!e)return;const t=e[2]-e[0],s=e[3]-e[1],i=new Path2D;i.rect(e[0],e[1],t,s),n.clip(i)}class jw{isModifyingCurrentTransform(){return!1}getPattern(){_e("Abstract method `getPattern` called.")}}class PP extends jw{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const s of this._colorStops)t.addColorStop(s[0],s[1]);return t}getPattern(e,t,s,i){let r;if(i===Dt.STROKE||i===Dt.FILL){const o=t.current.getClippedPathBoundingBox(i,He(e))||[0,0,0,0],a=Math.ceil(o[2]-o[0])||1,c=Math.ceil(o[3]-o[1])||1,u=t.cachedCanvases.getCanvas("pattern",a,c),d=u.context;d.clearRect(0,0,d.canvas.width,d.canvas.height),d.beginPath(),d.rect(0,0,d.canvas.width,d.canvas.height),d.translate(-o[0],-o[1]),s=Y.transform(s,[1,0,0,1,o[0],o[1]]),d.transform(...t.baseTransform),this.matrix&&d.transform(...this.matrix),jv(d,this._bbox),d.fillStyle=this._createGradient(d),d.fill(),r=e.createPattern(u.canvas,"no-repeat");const h=new DOMMatrix(s);r.setTransform(h)}else jv(e,this._bbox),r=this._createGradient(e);return r}}function fy(n,e,t,s,i,r,o,a){const c=e.coords,u=e.colors,d=n.data,h=n.width*4;let f;c[t+1]>c[s+1]&&(f=t,t=s,s=f,f=r,r=o,o=f),c[s+1]>c[i+1]&&(f=s,s=i,i=f,f=o,o=a,a=f),c[t+1]>c[s+1]&&(f=t,t=s,s=f,f=r,r=o,o=f);const p=(c[t]+e.offsetX)*e.scaleX,w=(c[t+1]+e.offsetY)*e.scaleY,g=(c[s]+e.offsetX)*e.scaleX,E=(c[s+1]+e.offsetY)*e.scaleY,m=(c[i]+e.offsetX)*e.scaleX,v=(c[i+1]+e.offsetY)*e.scaleY;if(w>=v)return;const b=u[r],x=u[r+1],_=u[r+2],k=u[o],C=u[o+1],T=u[o+2],L=u[a],M=u[a+1],D=u[a+2],q=Math.round(w),K=Math.round(v);let G,ee,j,O,I,$,X,re;for(let Q=q;Q<=K;Q++){if(Q<E){const fe=Q<w?0:(w-Q)/(w-E);G=p-(p-g)*fe,ee=b-(b-k)*fe,j=x-(x-C)*fe,O=_-(_-T)*fe}else{let fe;Q>v?fe=1:E===v?fe=0:fe=(E-Q)/(E-v),G=g-(g-m)*fe,ee=k-(k-L)*fe,j=C-(C-M)*fe,O=T-(T-D)*fe}let oe;Q<w?oe=0:Q>v?oe=1:oe=(w-Q)/(w-v),I=p-(p-m)*oe,$=b-(b-L)*oe,X=x-(x-M)*oe,re=_-(_-D)*oe;const Re=Math.round(Math.min(G,I)),We=Math.round(Math.max(G,I));let he=h*Q+Re*4;for(let fe=Re;fe<=We;fe++)oe=(G-fe)/(G-I),oe<0?oe=0:oe>1&&(oe=1),d[he++]=ee-(ee-$)*oe|0,d[he++]=j-(j-X)*oe|0,d[he++]=O-(O-re)*oe|0,d[he++]=255}}function LP(n,e,t){const s=e.coords,i=e.colors;let r,o;switch(e.type){case"lattice":const a=e.verticesPerRow,c=Math.floor(s.length/a)-1,u=a-1;for(r=0;r<c;r++){let d=r*a;for(let h=0;h<u;h++,d++)fy(n,t,s[d],s[d+1],s[d+a],i[d],i[d+1],i[d+a]),fy(n,t,s[d+a+1],s[d+1],s[d+a],i[d+a+1],i[d+1],i[d+a])}break;case"triangles":for(r=0,o=s.length;r<o;r+=3)fy(n,t,s[r],s[r+1],s[r+2],i[r],i[r+1],i[r+2]);break;default:throw new Error("illegal figure")}}class MP extends jw{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,s){const a=Math.floor(this._bounds[0]),c=Math.floor(this._bounds[1]),u=Math.ceil(this._bounds[2])-a,d=Math.ceil(this._bounds[3])-c,h=Math.min(Math.ceil(Math.abs(u*e[0]*1.1)),3e3),f=Math.min(Math.ceil(Math.abs(d*e[1]*1.1)),3e3),p=u/h,w=d/f,g={coords:this._coords,colors:this._colors,offsetX:-a,offsetY:-c,scaleX:1/p,scaleY:1/w},E=h+2*2,m=f+2*2,v=s.getCanvas("mesh",E,m),b=v.context,x=b.createImageData(h,f);if(t){const k=x.data;for(let C=0,T=k.length;C<T;C+=4)k[C]=t[0],k[C+1]=t[1],k[C+2]=t[2],k[C+3]=255}for(const k of this._figures)LP(x,k,g);return b.putImageData(x,2,2),{canvas:v.canvas,offsetX:a-2*p,offsetY:c-2*w,scaleX:p,scaleY:w}}isModifyingCurrentTransform(){return!0}getPattern(e,t,s,i){jv(e,this._bbox);const r=new Float32Array(2);if(i===Dt.SHADING)Y.singularValueDecompose2dScale(He(e),r);else if(this.matrix){Y.singularValueDecompose2dScale(this.matrix,r);const[a,c]=r;Y.singularValueDecompose2dScale(t.baseTransform,r),r[0]*=a,r[1]*=c}else Y.singularValueDecompose2dScale(t.baseTransform,r);const o=this._createMeshCanvas(r,i===Dt.SHADING?null:this._background,t.cachedCanvases);return i!==Dt.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(o.offsetX,o.offsetY),e.scale(o.scaleX,o.scaleY),e.createPattern(o.canvas,"no-repeat")}}class DP extends jw{getPattern(){return"hotpink"}}function NP(n){switch(n[0]){case"RadialAxial":return new PP(n);case"Mesh":return new MP(n);case"Dummy":return new DP}throw new Error(`Unknown IR type: ${n[0]}`)}const LA={COLORED:1,UNCOLORED:2},Gg=class Gg{constructor(e,t,s,i){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=s,this.baseTransform=i}createPatternCanvas(e){const{bbox:t,operatorList:s,paintType:i,tilingType:r,color:o,canvasGraphicsFactory:a}=this;let{xstep:c,ystep:u}=this;c=Math.abs(c),u=Math.abs(u),bm("TilingType: "+r);const d=t[0],h=t[1],f=t[2],p=t[3],w=f-d,g=p-h,E=new Float32Array(2);Y.singularValueDecompose2dScale(this.matrix,E);const[m,v]=E;Y.singularValueDecompose2dScale(this.baseTransform,E);const b=m*E[0],x=v*E[1];let _=w,k=g,C=!1,T=!1;const L=Math.ceil(c*b),M=Math.ceil(u*x),D=Math.ceil(w*b),q=Math.ceil(g*x);L>=D?_=c:C=!0,M>=q?k=u:T=!0;const K=this.getSizeAndScale(_,this.ctx.canvas.width,b),G=this.getSizeAndScale(k,this.ctx.canvas.height,x),ee=e.cachedCanvases.getCanvas("pattern",K.size,G.size),j=ee.context,O=a.createCanvasGraphics(j);if(O.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(O,i,o),j.translate(-K.scale*d,-G.scale*h),O.transform(K.scale,0,0,G.scale,0,0),j.save(),this.clipBbox(O,d,h,f,p),O.baseTransform=He(O.ctx),O.executeOperatorList(s),O.endDrawing(),j.restore(),C||T){const I=ee.canvas;C&&(_=c),T&&(k=u);const $=this.getSizeAndScale(_,this.ctx.canvas.width,b),X=this.getSizeAndScale(k,this.ctx.canvas.height,x),re=$.size,Q=X.size,oe=e.cachedCanvases.getCanvas("pattern-workaround",re,Q),Re=oe.context,We=C?Math.floor(w/c):0,he=T?Math.floor(g/u):0;for(let fe=0;fe<=We;fe++)for(let xn=0;xn<=he;xn++)Re.drawImage(I,re*fe,Q*xn,re,Q,0,0,re,Q);return{canvas:oe.canvas,scaleX:$.scale,scaleY:X.scale,offsetX:d,offsetY:h}}return{canvas:ee.canvas,scaleX:K.scale,scaleY:G.scale,offsetX:d,offsetY:h}}getSizeAndScale(e,t,s){const i=Math.max(Gg.MAX_PATTERN_SIZE,t);let r=Math.ceil(e*s);return r>=i?r=i:s=r/e,{scale:s,size:r}}clipBbox(e,t,s,i,r){const o=i-t,a=r-s;e.ctx.rect(t,s,o,a),Y.axialAlignedBoundingBox([t,s,i,r],He(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,s){const i=e.ctx,r=e.current;switch(t){case LA.COLORED:const{fillStyle:o,strokeStyle:a}=this.ctx;i.fillStyle=r.fillColor=o,i.strokeStyle=r.strokeColor=a;break;case LA.UNCOLORED:i.fillStyle=i.strokeStyle=s,r.fillColor=r.strokeColor=s;break;default:throw new iP(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,s,i){let r=s;i!==Dt.SHADING&&(r=Y.transform(r,t.baseTransform),this.matrix&&(r=Y.transform(r,this.matrix)));const o=this.createPatternCanvas(t);let a=new DOMMatrix(r);a=a.translate(o.offsetX,o.offsetY),a=a.scale(1/o.scaleX,1/o.scaleY);const c=e.createPattern(o.canvas,"repeat");return c.setTransform(a),c}};F(Gg,"MAX_PATTERN_SIZE",3e3);let zv=Gg;function IP({src:n,srcPos:e=0,dest:t,width:s,height:i,nonBlackColor:r=4294967295,inverseDecode:o=!1}){const a=xt.isLittleEndian?4278190080:255,[c,u]=o?[r,a]:[a,r],d=s>>3,h=s&7,f=n.length;t=new Uint32Array(t.buffer);let p=0;for(let w=0;w<i;w++){for(const E=e+d;e<E;e++){const m=e<f?n[e]:255;t[p++]=m&128?u:c,t[p++]=m&64?u:c,t[p++]=m&32?u:c,t[p++]=m&16?u:c,t[p++]=m&8?u:c,t[p++]=m&4?u:c,t[p++]=m&2?u:c,t[p++]=m&1?u:c}if(h===0)continue;const g=e<f?n[e++]:255;for(let E=0;E<h;E++)t[p++]=g&1<<7-E?u:c}return{srcPos:e,destPos:p}}const MA=16,DA=100,OP=15,NA=10,yn=16,py=new DOMMatrix,Xn=new Float32Array(2),Vl=new Float32Array([1/0,1/0,-1/0,-1/0]);function FP(n,e){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){e.save(),this.__originalSave()},n.restore=function(){e.restore(),this.__originalRestore()},n.translate=function(t,s){e.translate(t,s),this.__originalTranslate(t,s)},n.scale=function(t,s){e.scale(t,s),this.__originalScale(t,s)},n.transform=function(t,s,i,r,o,a){e.transform(t,s,i,r,o,a),this.__originalTransform(t,s,i,r,o,a)},n.setTransform=function(t,s,i,r,o,a){e.setTransform(t,s,i,r,o,a),this.__originalSetTransform(t,s,i,r,o,a)},n.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},n.rotate=function(t){e.rotate(t),this.__originalRotate(t)},n.clip=function(t){e.clip(t),this.__originalClip(t)},n.moveTo=function(t,s){e.moveTo(t,s),this.__originalMoveTo(t,s)},n.lineTo=function(t,s){e.lineTo(t,s),this.__originalLineTo(t,s)},n.bezierCurveTo=function(t,s,i,r,o,a){e.bezierCurveTo(t,s,i,r,o,a),this.__originalBezierCurveTo(t,s,i,r,o,a)},n.rect=function(t,s,i,r){e.rect(t,s,i,r),this.__originalRect(t,s,i,r)},n.closePath=function(){e.closePath(),this.__originalClosePath()},n.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class jP{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,s){let i;return this.cache[e]!==void 0?(i=this.cache[e],this.canvasFactory.reset(i,t,s)):(i=this.canvasFactory.create(t,s),this.cache[e]=i),i}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function ap(n,e,t,s,i,r,o,a,c,u){const[d,h,f,p,w,g]=He(n);if(h===0&&f===0){const v=o*d+w,b=Math.round(v),x=a*p+g,_=Math.round(x),k=(o+c)*d+w,C=Math.abs(Math.round(k)-b)||1,T=(a+u)*p+g,L=Math.abs(Math.round(T)-_)||1;return n.setTransform(Math.sign(d),0,0,Math.sign(p),b,_),n.drawImage(e,t,s,i,r,0,0,C,L),n.setTransform(d,h,f,p,w,g),[C,L]}if(d===0&&p===0){const v=a*f+w,b=Math.round(v),x=o*h+g,_=Math.round(x),k=(a+u)*f+w,C=Math.abs(Math.round(k)-b)||1,T=(o+c)*h+g,L=Math.abs(Math.round(T)-_)||1;return n.setTransform(0,Math.sign(h),Math.sign(f),0,b,_),n.drawImage(e,t,s,i,r,0,0,L,C),n.setTransform(d,h,f,p,w,g),[L,C]}n.drawImage(e,t,s,i,r,o,a,c,u);const E=Math.hypot(d,h),m=Math.hypot(f,p);return[E*c,m*u]}class IA{constructor(e,t){F(this,"alphaIsShape",!1);F(this,"fontSize",0);F(this,"fontSizeScale",1);F(this,"textMatrix",null);F(this,"textMatrixScale",1);F(this,"fontMatrix",mv);F(this,"leading",0);F(this,"x",0);F(this,"y",0);F(this,"lineX",0);F(this,"lineY",0);F(this,"charSpacing",0);F(this,"wordSpacing",0);F(this,"textHScale",1);F(this,"textRenderingMode",$t.FILL);F(this,"textRise",0);F(this,"fillColor","#000000");F(this,"strokeColor","#000000");F(this,"patternFill",!1);F(this,"patternStroke",!1);F(this,"fillAlpha",1);F(this,"strokeAlpha",1);F(this,"lineWidth",1);F(this,"activeSMask",null);F(this,"transferMaps","none");this.clipBox=new Float32Array([0,0,e,t]),this.minMax=Vl.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=Dt.FILL,t=null){const s=this.minMax.slice();if(e===Dt.STROKE){t||_e("Stroke bounding box must include transform."),Y.singularValueDecompose2dScale(t,Xn);const i=Xn[0]*this.lineWidth/2,r=Xn[1]*this.lineWidth/2;s[0]-=i,s[1]-=r,s[2]+=i,s[3]+=r}return s}updateClipFromPath(){const e=Y.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(Vl,0)}getClippedPathBoundingBox(e=Dt.FILL,t=null){return Y.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function OA(n,e){if(e instanceof ImageData){n.putImageData(e,0,0);return}const t=e.height,s=e.width,i=t%yn,r=(t-i)/yn,o=i===0?r:r+1,a=n.createImageData(s,yn);let c=0,u;const d=e.data,h=a.data;let f,p,w,g;if(e.kind===wd.GRAYSCALE_1BPP){const E=d.byteLength,m=new Uint32Array(h.buffer,0,h.byteLength>>2),v=m.length,b=s+7>>3,x=4294967295,_=xt.isLittleEndian?4278190080:255;for(f=0;f<o;f++){for(w=f<r?yn:i,u=0,p=0;p<w;p++){const k=E-c;let C=0;const T=k>b?s:k*8-7,L=T&-8;let M=0,D=0;for(;C<L;C+=8)D=d[c++],m[u++]=D&128?x:_,m[u++]=D&64?x:_,m[u++]=D&32?x:_,m[u++]=D&16?x:_,m[u++]=D&8?x:_,m[u++]=D&4?x:_,m[u++]=D&2?x:_,m[u++]=D&1?x:_;for(;C<T;C++)M===0&&(D=d[c++],M=128),m[u++]=D&M?x:_,M>>=1}for(;u<v;)m[u++]=0;n.putImageData(a,0,f*yn)}}else if(e.kind===wd.RGBA_32BPP){for(p=0,g=s*yn*4,f=0;f<r;f++)h.set(d.subarray(c,c+g)),c+=g,n.putImageData(a,0,p),p+=yn;f<o&&(g=s*i*4,h.set(d.subarray(c,c+g)),n.putImageData(a,0,p))}else if(e.kind===wd.RGB_24BPP)for(w=yn,g=s*w,f=0;f<o;f++){for(f>=r&&(w=i,g=s*w),u=0,p=g;p--;)h[u++]=d[c++],h[u++]=d[c++],h[u++]=d[c++],h[u++]=255;n.putImageData(a,0,f*yn)}else throw new Error(`bad image kind: ${e.kind}`)}function FA(n,e){if(e.bitmap){n.drawImage(e.bitmap,0,0);return}const t=e.height,s=e.width,i=t%yn,r=(t-i)/yn,o=i===0?r:r+1,a=n.createImageData(s,yn);let c=0;const u=e.data,d=a.data;for(let h=0;h<o;h++){const f=h<r?yn:i;({srcPos:c}=IP({src:u,srcPos:c,dest:d,width:s,height:f,nonBlackColor:0})),n.putImageData(a,0,h*yn)}}function Fu(n,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of t)n[s]!==void 0&&(e[s]=n[s]);n.setLineDash!==void 0&&(e.setLineDash(n.getLineDash()),e.lineDashOffset=n.lineDashOffset)}function lp(n){n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0);const{filter:e}=n;e!=="none"&&e!==""&&(n.filter="none")}function jA(n,e){if(e)return!0;Y.singularValueDecompose2dScale(n,Xn);const t=Math.fround(Ws.pixelRatio*xr.PDF_TO_CSS_UNITS);return Xn[0]<=t&&Xn[1]<=t}const zP=["butt","round","square"],BP=["miter","round","bevel"],$P={},zA={};var Ys,Bv,$v,Hv;const sb=class sb{constructor(e,t,s,i,r,{optionalContentConfig:o,markedContentStack:a=null},c,u){A(this,Ys);this.ctx=e,this.current=new IA(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=s,this.canvasFactory=i,this.filterFactory=r,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=a||[],this.optionalContentConfig=o,this.cachedCanvases=new jP(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=c,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=u,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:s=!1,background:i=null}){const r=this.ctx.canvas.width,o=this.ctx.canvas.height,a=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,r,o),this.ctx.fillStyle=a,s){const c=this.cachedCanvases.getCanvas("transparent",r,o);this.compositeCtx=this.ctx,this.transparentCanvas=c.canvas,this.ctx=c.context,this.ctx.save(),this.ctx.transform(...He(this.compositeCtx))}this.ctx.save(),lp(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=He(this.ctx)}executeOperatorList(e,t,s,i){const r=e.argsArray,o=e.fnArray;let a=t||0;const c=r.length;if(c===a)return a;const u=c-a>NA&&typeof s=="function",d=u?Date.now()+OP:0;let h=0;const f=this.commonObjs,p=this.objs;let w;for(;;){if(i!==void 0&&a===i.nextBreakPoint)return i.breakIt(a,s),a;if(w=o[a],w!==Bd.dependency)this[w].apply(this,r[a]);else for(const g of r[a]){const E=g.startsWith("g_")?f:p;if(!E.has(g))return E.get(g,s),a}if(a++,a===c)return a;if(u&&++h>NA){if(Date.now()>d)return s(),a;h=0}}}endDrawing(){S(this,Ys,Bv).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),S(this,Ys,$v).call(this)}_scaleImage(e,t){const s=e.width??e.displayWidth,i=e.height??e.displayHeight;let r=Math.max(Math.hypot(t[0],t[1]),1),o=Math.max(Math.hypot(t[2],t[3]),1),a=s,c=i,u="prescale1",d,h;for(;r>2&&a>1||o>2&&c>1;){let f=a,p=c;r>2&&a>1&&(f=a>=16384?Math.floor(a/2)-1||1:Math.ceil(a/2),r/=a/f),o>2&&c>1&&(p=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c)/2,o/=c/p),d=this.cachedCanvases.getCanvas(u,f,p),h=d.context,h.clearRect(0,0,f,p),h.drawImage(e,0,0,a,c,0,0,f,p),e=d.canvas,a=f,c=p,u=u==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:a,paintHeight:c}}_createMaskCanvas(e){const t=this.ctx,{width:s,height:i}=e,r=this.current.fillColor,o=this.current.patternFill,a=He(t);let c,u,d,h;if((e.bitmap||e.data)&&e.count>1){const L=e.bitmap||e.data.buffer;u=JSON.stringify(o?a:[a.slice(0,4),r]),c=this._cachedBitmapsMap.get(L),c||(c=new Map,this._cachedBitmapsMap.set(L,c));const M=c.get(u);if(M&&!o){const D=Math.round(Math.min(a[0],a[2])+a[4]),q=Math.round(Math.min(a[1],a[3])+a[5]);return{canvas:M,offsetX:D,offsetY:q}}d=M}d||(h=this.cachedCanvases.getCanvas("maskCanvas",s,i),FA(h.context,e));let f=Y.transform(a,[1/s,0,0,-1/i,0,0]);f=Y.transform(f,[1,0,0,1,0,-i]);const p=Vl.slice();Y.axialAlignedBoundingBox([0,0,s,i],f,p);const[w,g,E,m]=p,v=Math.round(E-w)||1,b=Math.round(m-g)||1,x=this.cachedCanvases.getCanvas("fillCanvas",v,b),_=x.context,k=w,C=g;_.translate(-k,-C),_.transform(...f),d||(d=this._scaleImage(h.canvas,ei(_)),d=d.img,c&&o&&c.set(u,d)),_.imageSmoothingEnabled=jA(He(_),e.interpolate),ap(_,d,0,0,d.width,d.height,0,0,s,i),_.globalCompositeOperation="source-in";const T=Y.transform(ei(_),[1,0,0,1,-k,-C]);return _.fillStyle=o?r.getPattern(t,this,T,Dt.FILL):r,_.fillRect(0,0,s,i),c&&!o&&(this.cachedCanvases.delete("fillCanvas"),c.set(u,x.canvas)),{canvas:x.canvas,offsetX:Math.round(k),offsetY:Math.round(C)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=zP[e]}setLineJoin(e){this.ctx.lineJoin=BP[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const s=this.ctx;s.setLineDash!==void 0&&(s.setLineDash(e),s.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,s]of e)switch(t){case"LW":this.setLineWidth(s);break;case"LC":this.setLineCap(s);break;case"LJ":this.setLineJoin(s);break;case"ML":this.setMiterLimit(s);break;case"D":this.setDash(s[0],s[1]);break;case"RI":this.setRenderingIntent(s);break;case"FL":this.setFlatness(s);break;case"Font":this.setFont(s[0],s[1]);break;case"CA":this.current.strokeAlpha=s;break;case"ca":this.ctx.globalAlpha=this.current.fillAlpha=s;break;case"BM":this.ctx.globalCompositeOperation=s;break;case"SMask":this.current.activeSMask=s?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(s);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(s,e,t);this.suspendedCtx=this.ctx;const r=this.ctx=i.context;r.setTransform(this.suspendedCtx.getTransform()),Fu(this.suspendedCtx,r),FP(r,this.suspendedCtx),this.setGState([["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Fu(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,s,i){const r=i[0],o=i[1],a=i[2]-r,c=i[3]-o;a===0||c===0||(this.genericComposeSMask(t.context,s,a,c,t.subtype,t.backdrop,t.transferMap,r,o,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(s.canvas,0,0),e.restore())}genericComposeSMask(e,t,s,i,r,o,a,c,u,d,h){let f=e.canvas,p=c-d,w=u-h;if(o)if(p<0||w<0||p+s>f.width||w+i>f.height){const E=this.cachedCanvases.getCanvas("maskExtension",s,i),m=E.context;m.drawImage(f,-p,-w),m.globalCompositeOperation="destination-atop",m.fillStyle=o,m.fillRect(0,0,s,i),m.globalCompositeOperation="source-over",f=E.canvas,p=w=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const E=new Path2D;E.rect(p,w,s,i),e.clip(E),e.globalCompositeOperation="destination-atop",e.fillStyle=o,e.fillRect(p,w,s,i),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),r==="Alpha"&&a?t.filter=this.filterFactory.addAlphaFilter(a):r==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(a));const g=new Path2D;g.rect(c,u,s,i),t.clip(g),t.globalCompositeOperation="destination-in",t.drawImage(f,p,w,s,i,c,u,s,i),t.restore()}save(){this.inSMaskMode&&Fu(this.ctx,this.suspendedCtx),this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){if(this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&Fu(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,s,i,r,o){this.ctx.transform(e,t,s,i,r,o),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,s){let[i]=t;if(!s){i||(i=t[0]=new Path2D),this[e](i);return}if(!(i instanceof Path2D)){const r=t[0]=new Path2D;for(let o=0,a=i.length;o<a;)switch(i[o++]){case ip.moveTo:r.moveTo(i[o++],i[o++]);break;case ip.lineTo:r.lineTo(i[o++],i[o++]);break;case ip.curveTo:r.bezierCurveTo(i[o++],i[o++],i[o++],i[o++],i[o++],i[o++]);break;case ip.closePath:r.closePath();break;default:te(`Unrecognized drawing path operator: ${i[o-1]}`);break}i=r}Y.axialAlignedBoundingBox(s,He(this.ctx),this.current.minMax),this[e](i)}closePath(){this.ctx.closePath()}stroke(e,t=!0){const s=this.ctx,i=this.current.strokeColor;if(s.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof i=="object"&&(i!=null&&i.getPattern)){const r=i.isModifyingCurrentTransform()?s.getTransform():null;if(s.save(),s.strokeStyle=i.getPattern(s,this,ei(s),Dt.STROKE),r){const o=new Path2D;o.addPath(e,s.getTransform().invertSelf().multiplySelf(r)),e=o}this.rescaleAndStroke(e,!1),s.restore()}else this.rescaleAndStroke(e,!0);t&&this.consumePath(e,this.current.getClippedPathBoundingBox(Dt.STROKE,He(this.ctx))),s.globalAlpha=this.current.fillAlpha}closeStroke(e){this.stroke(e)}fill(e,t=!0){const s=this.ctx,i=this.current.fillColor,r=this.current.patternFill;let o=!1;if(r){const c=i.isModifyingCurrentTransform()?s.getTransform():null;if(s.save(),s.fillStyle=i.getPattern(s,this,ei(s),Dt.FILL),c){const u=new Path2D;u.addPath(e,s.getTransform().invertSelf().multiplySelf(c)),e=u}o=!0}const a=this.current.getClippedPathBoundingBox();this.contentVisible&&a!==null&&(this.pendingEOFill?(s.fill(e,"evenodd"),this.pendingEOFill=!1):s.fill(e)),o&&s.restore(),t&&this.consumePath(e,a)}eoFill(e){this.pendingEOFill=!0,this.fill(e)}fillStroke(e){this.fill(e,!1),this.stroke(e,!1),this.consumePath(e)}eoFillStroke(e){this.pendingEOFill=!0,this.fillStroke(e)}closeFillStroke(e){this.fillStroke(e)}closeEOFillStroke(e){this.pendingEOFill=!0,this.fillStroke(e)}endPath(e){this.consumePath(e)}rawFillPath(e){this.ctx.fill(e)}clip(){this.pendingClip=$P}eoClip(){this.pendingClip=zA}beginText(){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(e===void 0)return;const s=new Path2D,i=t.getTransform().invertSelf();for(const{transform:r,x:o,y:a,fontSize:c,path:u}of e)s.addPath(u,new DOMMatrix(r).preMultiplySelf(i).translate(o,a).scale(c,-c));t.clip(s),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){var d;const s=this.commonObjs.get(e),i=this.current;if(!s)throw new Error(`Can't find font for ${e}`);if(i.fontMatrix=s.fontMatrix||mv,(i.fontMatrix[0]===0||i.fontMatrix[3]===0)&&te("Invalid font matrix for font "+e),t<0?(t=-t,i.fontDirection=-1):i.fontDirection=1,this.current.font=s,this.current.fontSize=t,s.isType3Font)return;const r=s.loadedName||"sans-serif",o=((d=s.systemFontInfo)==null?void 0:d.css)||`"${r}", ${s.fallbackName}`;let a="normal";s.black?a="900":s.bold&&(a="bold");const c=s.italic?"italic":"normal";let u=t;t<MA?u=MA:t>DA&&(u=DA),this.current.fontSizeScale=t/u,this.ctx.font=`${c} ${a} ${u}px ${o}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e){const{current:t}=this;t.textMatrix=e,t.textMatrixScale=Math.hypot(e[0],e[1]),t.x=t.lineX=0,t.y=t.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,t,s,i,r){const o=this.ctx,a=this.current,c=a.font,u=a.textRenderingMode,d=a.fontSize/a.fontSizeScale,h=u&$t.FILL_STROKE_MASK,f=!!(u&$t.ADD_TO_PATH_FLAG),p=a.patternFill&&!c.missingFile,w=a.patternStroke&&!c.missingFile;let g;if((c.disableFontFace||f||p||w)&&(g=c.getPathGenerator(this.commonObjs,e)),c.disableFontFace||p||w){o.save(),o.translate(t,s),o.scale(d,-d);let E;if((h===$t.FILL||h===$t.FILL_STROKE)&&(i?(E=o.getTransform(),o.setTransform(...i),o.fill(S(this,Ys,Hv).call(this,g,E,i))):o.fill(g)),h===$t.STROKE||h===$t.FILL_STROKE)if(r){E||(E=o.getTransform()),o.setTransform(...r);const{a:m,b:v,c:b,d:x}=E,_=Y.inverseTransform(r),k=Y.transform([m,v,b,x,0,0],_);Y.singularValueDecompose2dScale(k,Xn),o.lineWidth*=Math.max(Xn[0],Xn[1])/d,o.stroke(S(this,Ys,Hv).call(this,g,E,r))}else o.lineWidth/=d,o.stroke(g);o.restore()}else(h===$t.FILL||h===$t.FILL_STROKE)&&o.fillText(e,t,s),(h===$t.STROKE||h===$t.FILL_STROKE)&&o.strokeText(e,t,s);f&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:He(o),x:t,y:s,fontSize:d,path:g})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let s=!1;for(let i=3;i<t.length;i+=4)if(t[i]>0&&t[i]<255){s=!0;break}return le(this,"isFontSubpixelAAEnabled",s)}showText(e){const t=this.current,s=t.font;if(s.isType3Font)return this.showType3Text(e);const i=t.fontSize;if(i===0)return;const r=this.ctx,o=t.fontSizeScale,a=t.charSpacing,c=t.wordSpacing,u=t.fontDirection,d=t.textHScale*u,h=e.length,f=s.vertical,p=f?1:-1,w=s.defaultVMetrics,g=i*t.fontMatrix[0],E=t.textRenderingMode===$t.FILL&&!s.disableFontFace&&!t.patternFill;r.save(),t.textMatrix&&r.transform(...t.textMatrix),r.translate(t.x,t.y+t.textRise),u>0?r.scale(d,-1):r.scale(d,1);let m,v;if(t.patternFill){r.save();const C=t.fillColor.getPattern(r,this,ei(r),Dt.FILL);m=He(r),r.restore(),r.fillStyle=C}if(t.patternStroke){r.save();const C=t.strokeColor.getPattern(r,this,ei(r),Dt.STROKE);v=He(r),r.restore(),r.strokeStyle=C}let b=t.lineWidth;const x=t.textMatrixScale;if(x===0||b===0){const C=t.textRenderingMode&$t.FILL_STROKE_MASK;(C===$t.STROKE||C===$t.FILL_STROKE)&&(b=this.getSinglePixelWidth())}else b/=x;if(o!==1&&(r.scale(o,o),b/=o),r.lineWidth=b,s.isInvalidPDFjsFont){const C=[];let T=0;for(const L of e)C.push(L.unicode),T+=L.width;r.fillText(C.join(""),0,0),t.x+=T*g*d,r.restore(),this.compose();return}let _=0,k;for(k=0;k<h;++k){const C=e[k];if(typeof C=="number"){_+=p*C*i/1e3;continue}let T=!1;const L=(C.isSpace?c:0)+a,M=C.fontChar,D=C.accent;let q,K,G=C.width;if(f){const j=C.vmetric||w,O=-(C.vmetric?j[1]:G*.5)*g,I=j[2]*g;G=j?-j[0]:G,q=O/o,K=(_+I)/o}else q=_/o,K=0;if(s.remeasure&&G>0){const j=r.measureText(M).width*1e3/i*o;if(G<j&&this.isFontSubpixelAAEnabled){const O=G/j;T=!0,r.save(),r.scale(O,1),q/=O}else G!==j&&(q+=(G-j)/2e3*i/o)}if(this.contentVisible&&(C.isInFont||s.missingFile)){if(E&&!D)r.fillText(M,q,K);else if(this.paintChar(M,q,K,m,v),D){const j=q+i*D.offset.x/o,O=K-i*D.offset.y/o;this.paintChar(D.fontChar,j,O,m,v)}}const ee=f?G*g-L*u:G*g+L*u;_+=ee,T&&r.restore()}f?t.y-=_:t.x+=_*d,r.restore(),this.compose()}showType3Text(e){const t=this.ctx,s=this.current,i=s.font,r=s.fontSize,o=s.fontDirection,a=i.vertical?1:-1,c=s.charSpacing,u=s.wordSpacing,d=s.textHScale*o,h=s.fontMatrix||mv,f=e.length,p=s.textRenderingMode===$t.INVISIBLE;let w,g,E,m;if(!(p||r===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),s.textMatrix&&t.transform(...s.textMatrix),t.translate(s.x,s.y+s.textRise),t.scale(d,o),w=0;w<f;++w){if(g=e[w],typeof g=="number"){m=a*g*r/1e3,this.ctx.translate(m,0),s.x+=m*d;continue}const v=(g.isSpace?u:0)+c,b=i.charProcOperatorList[g.operatorListId];b?this.contentVisible&&(this.save(),t.scale(r,r),t.transform(...h),this.executeOperatorList(b),this.restore()):te(`Type3 character "${g.operatorListId}" is not available.`);const x=[g.width,0];Y.applyTransform(x,h),E=x[0]*r+v,t.translate(E,0),s.x+=E*d}t.restore()}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,s,i,r,o){const a=new Path2D;a.rect(s,i,r-s,o-i),this.ctx.clip(a),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){const s=this.baseTransform||He(this.ctx),i={createCanvasGraphics:r=>new sb(r,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new zv(e,this.ctx,i,s)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e){this.ctx.strokeStyle=this.current.strokeColor=e,this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e){this.ctx.fillStyle=this.current.fillColor=e,this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let s;return this.cachedPatterns.has(e)?s=this.cachedPatterns.get(e):(s=NP(this.getObject(e)),this.cachedPatterns.set(e,s)),t&&(s.matrix=t),s}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const s=this._getPattern(e);t.fillStyle=s.getPattern(t,this,ei(t),Dt.SHADING);const i=ei(t);if(i){const{width:r,height:o}=t.canvas,a=Vl.slice();Y.axialAlignedBoundingBox([0,0,r,o],i,a);const[c,u,d,h]=a;this.ctx.fillRect(c,u,d-c,h-u)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){_e("Should not call beginInlineImage")}beginImageData(){_e("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=He(this.ctx),t)){Y.axialAlignedBoundingBox(t,this.baseTransform,this.current.minMax);const[s,i,r,o]=t,a=new Path2D;a.rect(s,i,r-s,o-i),this.ctx.clip(a),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||bm("TODO: Support non-isolated groups."),e.knockout&&te("Knockout groups not supported.");const s=He(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let i=Vl.slice();Y.axialAlignedBoundingBox(e.bbox,He(t),i);const r=[0,0,t.canvas.width,t.canvas.height];i=Y.intersect(i,r)||[0,0,0,0];const o=Math.floor(i[0]),a=Math.floor(i[1]),c=Math.max(Math.ceil(i[2])-o,1),u=Math.max(Math.ceil(i[3])-a,1);this.current.startNewPathAndClipBox([0,0,c,u]);let d="groupAt"+this.groupLevel;e.smask&&(d+="_smask_"+this.smaskCounter++%2);const h=this.cachedCanvases.getCanvas(d,c,u),f=h.context;f.translate(-o,-a),f.transform(...s);let p=new Path2D;const[w,g,E,m]=e.bbox;if(p.rect(w,g,E-w,m-g),e.matrix){const v=new Path2D;v.addPath(p,new DOMMatrix(e.matrix)),p=v}f.clip(p),e.smask?this.smaskStack.push({canvas:h.canvas,context:f,offsetX:o,offsetY:a,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(o,a),t.save()),Fu(t,f),this.ctx=f,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const i=He(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...i);const r=Vl.slice();Y.axialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],i,r),this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(r)}}beginAnnotation(e,t,s,i,r){if(S(this,Ys,Bv).call(this),lp(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const o=t[2]-t[0],a=t[3]-t[1];if(r&&this.annotationCanvasMap){s=s.slice(),s[4]-=t[0],s[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=o,t[3]=a,Y.singularValueDecompose2dScale(He(this.ctx),Xn);const{viewportScale:c}=this,u=Math.ceil(o*this.outputScaleX*c),d=Math.ceil(a*this.outputScaleY*c);this.annotationCanvas=this.canvasFactory.create(u,d);const{canvas:h,context:f}=this.annotationCanvas;this.annotationCanvasMap.set(e,h),this.annotationCanvas.savedCtx=this.ctx,this.ctx=f,this.ctx.save(),this.ctx.setTransform(Xn[0],0,0,-Xn[1],0,a*Xn[1]),lp(this.ctx)}else{lp(this.ctx),this.endPath();const c=new Path2D;c.rect(t[0],t[1],o,a),this.ctx.clip(c)}}this.current=new IA(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...s),this.transform(...i)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),S(this,Ys,$v).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;e=this.getObject(e.data,e),e.count=t;const s=this.ctx,i=this._createMaskCanvas(e),r=i.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(r,i.offsetX,i.offsetY),s.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,s=0,i=0,r,o){if(!this.contentVisible)return;e=this.getObject(e.data,e);const a=this.ctx;a.save();const c=He(a);a.transform(t,s,i,r,0,0);const u=this._createMaskCanvas(e);a.setTransform(1,0,0,1,u.offsetX-c[4],u.offsetY-c[5]);for(let d=0,h=o.length;d<h;d+=2){const f=Y.transform(c,[t,s,i,r,o[d],o[d+1]]);a.drawImage(u.canvas,f[4],f[5])}a.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,s=this.current.fillColor,i=this.current.patternFill;for(const r of e){const{data:o,width:a,height:c,transform:u}=r,d=this.cachedCanvases.getCanvas("maskCanvas",a,c),h=d.context;h.save();const f=this.getObject(o,r);FA(h,f),h.globalCompositeOperation="source-in",h.fillStyle=i?s.getPattern(h,this,ei(t),Dt.FILL):s,h.fillRect(0,0,a,c),h.restore(),t.save(),t.transform(...u),t.scale(1,-1),ap(t,d.canvas,0,0,a,c,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);if(!t){te("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,s,i){if(!this.contentVisible)return;const r=this.getObject(e);if(!r){te("Dependent image isn't ready yet");return}const o=r.width,a=r.height,c=[];for(let u=0,d=i.length;u<d;u+=2)c.push({transform:[t,0,0,s,i[u],i[u+1]],x:0,y:0,w:o,h:a});this.paintInlineImageXObjectGroup(r,c)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:s,height:i}=e,r=this.cachedCanvases.getCanvas("inlineImage",s,i),o=r.context;return o.filter=this.current.transferMaps,o.drawImage(t,0,0),o.filter="none",r.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,s=e.height,i=this.ctx;this.save();const{filter:r}=i;r!=="none"&&r!==""&&(i.filter="none"),i.scale(1/t,-1/s);let o;if(e.bitmap)o=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)o=e;else{const u=this.cachedCanvases.getCanvas("inlineImage",t,s).context;OA(u,e),o=this.applyTransferMapsToCanvas(u)}const a=this._scaleImage(o,ei(i));i.imageSmoothingEnabled=jA(He(i),e.interpolate),ap(i,a.img,0,0,a.paintWidth,a.paintHeight,0,-s,t,s),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const s=this.ctx;let i;if(e.bitmap)i=e.bitmap;else{const r=e.width,o=e.height,c=this.cachedCanvases.getCanvas("inlineImage",r,o).context;OA(c,e),i=this.applyTransferMapsToCanvas(c)}for(const r of t)s.save(),s.transform(...r.transform),s.scale(1,-1),ap(s,i,r.x,r.y,r.w,r.h,0,-1,1,1),s.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e,t){const s=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(t);const i=this.ctx;this.pendingClip&&(s||(this.pendingClip===zA?i.clip(e,"evenodd"):i.clip(e)),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=He(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),s=Math.hypot(e[0],e[2]),i=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(s,i)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:s,c:i,d:r}=this.ctx.getTransform();let o,a;if(s===0&&i===0){const c=Math.abs(t),u=Math.abs(r);if(c===u)if(e===0)o=a=1/c;else{const d=c*e;o=a=d<1?1/d:1}else if(e===0)o=1/c,a=1/u;else{const d=c*e,h=u*e;o=d<1?1/d:1,a=h<1?1/h:1}}else{const c=Math.abs(t*r-s*i),u=Math.hypot(t,s),d=Math.hypot(i,r);if(e===0)o=d/c,a=u/c;else{const h=e*c;o=d>h?d/h:1,a=u>h?u/h:1}}this._cachedScaleForStroking[0]=o,this._cachedScaleForStroking[1]=a}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:s,current:{lineWidth:i}}=this,[r,o]=this.getScaleForStroking();if(r===o){s.lineWidth=(i||1)*r,s.stroke(e);return}const a=s.getLineDash();t&&s.save(),s.scale(r,o),py.a=1/r,py.d=1/o;const c=new Path2D;if(c.addPath(e,py),a.length>0){const u=Math.max(r,o);s.setLineDash(a.map(d=>d/u)),s.lineDashOffset/=u}s.lineWidth=i||1,s.stroke(c),t&&s.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};Ys=new WeakSet,Bv=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},$v=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},Hv=function(e,t,s){const i=new Path2D;return i.addPath(e,new DOMMatrix(s).invertSelf().multiplySelf(t)),i};let Zl=sb;for(const n in Bd)Zl.prototype[n]!==void 0&&(Zl.prototype[Bd[n]]=Zl.prototype[n]);var bh,Ah;class ps{static get workerPort(){return l(this,bh)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");y(this,bh,e)}static get workerSrc(){return l(this,Ah)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");y(this,Ah,e)}}bh=new WeakMap,Ah=new WeakMap,A(ps,bh,null),A(ps,Ah,"");var Ac,Sh;class HP{constructor({parsedData:e,rawData:t}){A(this,Ac);A(this,Sh);y(this,Ac,e),y(this,Sh,t)}getRaw(){return l(this,Sh)}get(e){return l(this,Ac).get(e)??null}[Symbol.iterator](){return l(this,Ac).entries()}}Ac=new WeakMap,Sh=new WeakMap;const Tl=Symbol("INTERNAL");var Eh,xh,_h,Sc;class UP{constructor(e,{name:t,intent:s,usage:i,rbGroups:r}){A(this,Eh,!1);A(this,xh,!1);A(this,_h,!1);A(this,Sc,!0);y(this,Eh,!!(e&Gn.DISPLAY)),y(this,xh,!!(e&Gn.PRINT)),this.name=t,this.intent=s,this.usage=i,this.rbGroups=r}get visible(){if(l(this,_h))return l(this,Sc);if(!l(this,Sc))return!1;const{print:e,view:t}=this.usage;return l(this,Eh)?(t==null?void 0:t.viewState)!=="OFF":l(this,xh)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,s=!1){e!==Tl&&_e("Internal method `_setVisible` called."),y(this,_h,s),y(this,Sc,t)}}Eh=new WeakMap,xh=new WeakMap,_h=new WeakMap,Sc=new WeakMap;var Zr,Ee,Ec,xc,Ch,Uv;class VP{constructor(e,t=Gn.DISPLAY){A(this,Ch);A(this,Zr,null);A(this,Ee,new Map);A(this,Ec,null);A(this,xc,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,y(this,xc,e.order);for(const s of e.groups)l(this,Ee).set(s.id,new UP(t,s));if(e.baseState==="OFF")for(const s of l(this,Ee).values())s._setVisible(Tl,!1);for(const s of e.on)l(this,Ee).get(s)._setVisible(Tl,!0);for(const s of e.off)l(this,Ee).get(s)._setVisible(Tl,!1);y(this,Ec,this.getHash())}}isVisible(e){if(l(this,Ee).size===0)return!0;if(!e)return bm("Optional content group not defined."),!0;if(e.type==="OCG")return l(this,Ee).has(e.id)?l(this,Ee).get(e.id).visible:(te(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return S(this,Ch,Uv).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!l(this,Ee).has(t))return te(`Optional content group not found: ${t}`),!0;if(l(this,Ee).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!l(this,Ee).has(t))return te(`Optional content group not found: ${t}`),!0;if(!l(this,Ee).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!l(this,Ee).has(t))return te(`Optional content group not found: ${t}`),!0;if(!l(this,Ee).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!l(this,Ee).has(t))return te(`Optional content group not found: ${t}`),!0;if(l(this,Ee).get(t).visible)return!1}return!0}return te(`Unknown optional content policy ${e.policy}.`),!0}return te(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,s=!0){var r;const i=l(this,Ee).get(e);if(!i){te(`Optional content group not found: ${e}`);return}if(s&&t&&i.rbGroups.length)for(const o of i.rbGroups)for(const a of o)a!==e&&((r=l(this,Ee).get(a))==null||r._setVisible(Tl,!1,!0));i._setVisible(Tl,!!t,!0),y(this,Zr,null)}setOCGState({state:e,preserveRB:t}){let s;for(const i of e){switch(i){case"ON":case"OFF":case"Toggle":s=i;continue}const r=l(this,Ee).get(i);if(r)switch(s){case"ON":this.setVisibility(i,!0,t);break;case"OFF":this.setVisibility(i,!1,t);break;case"Toggle":this.setVisibility(i,!r.visible,t);break}}y(this,Zr,null)}get hasInitialVisibility(){return l(this,Ec)===null||this.getHash()===l(this,Ec)}getOrder(){return l(this,Ee).size?l(this,xc)?l(this,xc).slice():[...l(this,Ee).keys()]:null}getGroup(e){return l(this,Ee).get(e)||null}getHash(){if(l(this,Zr)!==null)return l(this,Zr);const e=new yx;for(const[t,s]of l(this,Ee))e.update(`${t}:${s.visible}`);return y(this,Zr,e.hexdigest())}[Symbol.iterator](){return l(this,Ee).entries()}}Zr=new WeakMap,Ee=new WeakMap,Ec=new WeakMap,xc=new WeakMap,Ch=new WeakSet,Uv=function(e){const t=e.length;if(t<2)return!0;const s=e[0];for(let i=1;i<t;i++){const r=e[i];let o;if(Array.isArray(r))o=S(this,Ch,Uv).call(this,r);else if(l(this,Ee).has(r))o=l(this,Ee).get(r).visible;else return te(`Optional content group not found: ${r}`),!0;switch(s){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return s==="And"};class GP{constructor(e,{disableRange:t=!1,disableStream:s=!1}){it(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:i,initialData:r,progressiveDone:o,contentDispositionFilename:a}=e;if(this._queuedChunks=[],this._progressiveDone=o,this._contentDispositionFilename=a,(r==null?void 0:r.length)>0){const c=r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer;this._queuedChunks.push(c)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!s,this._isRangeSupported=!t,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((c,u)=>{this._onReceiveData({begin:c,chunk:u})}),e.addProgressListener((c,u)=>{this._onProgress({loaded:c,total:u})}),e.addProgressiveReadListener(c=>{this._onReceiveData({chunk:c})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const s=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(s):this._queuedChunks.push(s);else{const i=this._rangeReaders.some(function(r){return r._begin!==e?!1:(r._enqueue(s),!0)});it(i,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var t,s,i,r;e.total===void 0?(s=(t=this._rangeReaders[0])==null?void 0:t.onProgress)==null||s.call(t,{loaded:e.loaded}):(r=(i=this._fullRequestReader)==null?void 0:i.onProgress)==null||r.call(i,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){it(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new WP(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new XP(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeReaders.slice(0))s.cancel(e);this._pdfDataRangeTransport.abort()}}class WP{constructor(e,t,s=!1,i=null){this._stream=e,this._done=s||!1,this._filename=Sm(i)?i:null,this._queuedChunks=t||[],this._loaded=0;for(const r of this._queuedChunks)this._loaded+=r.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class XP{constructor(e,t,s){this._stream=e,this._begin=t,this._end=s,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function YP(n){let e=!0,t=s("filename\\*","i").exec(n);if(t){t=t[1];let d=a(t);return d=unescape(d),d=c(d),d=u(d),r(d)}if(t=o(n),t){const d=u(t);return r(d)}if(t=s("filename","i").exec(n),t){t=t[1];let d=a(t);return d=u(d),r(d)}function s(d,h){return new RegExp("(?:^|;)\\s*"+d+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',h)}function i(d,h){if(d){if(!/^[\x00-\xFF]+$/.test(h))return h;try{const f=new TextDecoder(d,{fatal:!0}),p=Tf(h);h=f.decode(p),e=!1}catch{}}return h}function r(d){return e&&/[\x80-\xff]/.test(d)&&(d=i("utf-8",d),e&&(d=i("iso-8859-1",d))),d}function o(d){const h=[];let f;const p=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(f=p.exec(d))!==null;){let[,g,E,m]=f;if(g=parseInt(g,10),g in h){if(g===0)break;continue}h[g]=[E,m]}const w=[];for(let g=0;g<h.length&&g in h;++g){let[E,m]=h[g];m=a(m),E&&(m=unescape(m),g===0&&(m=c(m))),w.push(m)}return w.join("")}function a(d){if(d.startsWith('"')){const h=d.slice(1).split('\\"');for(let f=0;f<h.length;++f){const p=h[f].indexOf('"');p!==-1&&(h[f]=h[f].slice(0,p),h.length=f+1),h[f]=h[f].replaceAll(/\\(.)/g,"$1")}d=h.join('"')}return d}function c(d){const h=d.indexOf("'");if(h===-1)return d;const f=d.slice(0,h),w=d.slice(h+1).replace(/^[^']*'/,"");return i(f,w)}function u(d){return!d.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(d)?d:d.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(h,f,p,w){if(p==="q"||p==="Q")return w=w.replaceAll("_"," "),w=w.replaceAll(/=([0-9a-fA-F]{2})/g,function(g,E){return String.fromCharCode(parseInt(E,16))}),i(f,w);try{w=atob(w)}catch{}return i(f,w)})}return""}function Px(n,e){const t=new Headers;if(!n||!e||typeof e!="object")return t;for(const s in e){const i=e[s];i!==void 0&&t.append(s,i)}return t}function xm(n){var e;return((e=URL.parse(n))==null?void 0:e.origin)??null}function Lx({responseHeaders:n,isHttp:e,rangeChunkSize:t,disableRange:s}){const i={allowRangeRequests:!1,suggestedLength:void 0},r=parseInt(n.get("Content-Length"),10);return!Number.isInteger(r)||(i.suggestedLength=r,r<=2*t)||s||!e||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(i.allowRangeRequests=!0),i}function Mx(n){const e=n.get("Content-Disposition");if(e){let t=YP(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(Sm(t))return t}return null}function Mf(n,e){return new $d(`Unexpected server response (${n}) while retrieving PDF "${e}".`,n,n===404||n===0&&e.startsWith("file:"))}function Dx(n){return n===200||n===206}function Nx(n,e,t){return{method:"GET",headers:n,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function Ix(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(te(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class qP{constructor(e){F(this,"_responseOrigin",null);this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=Px(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return it(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new KP(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new QP(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class KP{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const s=new Headers(e.headers),i=t.url;fetch(i,Nx(s,this._withCredentials,this._abortController)).then(r=>{if(e._responseOrigin=xm(r.url),!Dx(r.status))throw Mf(r.status,i);this._reader=r.body.getReader(),this._headersCapability.resolve();const o=r.headers,{allowRangeRequests:a,suggestedLength:c}=Lx({responseHeaders:o,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=a,this._contentLength=c||this._contentLength,this._filename=Mx(o),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Er("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:Ix(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class QP{constructor(e,t,s){this._stream=e,this._reader=null,this._loaded=0;const i=e.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const r=new Headers(e.headers);r.append("Range",`bytes=${t}-${s-1}`);const o=i.url;fetch(o,Nx(r,this._withCredentials,this._abortController)).then(a=>{const c=xm(a.url);if(c!==e._responseOrigin)throw new Error(`Expected range response-origin "${c}" to match "${e._responseOrigin}".`);if(!Dx(a.status))throw Mf(a.status,o);this._readCapability.resolve(),this._reader=a.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:Ix(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}const gy=200,my=206;function JP(n){const e=n.response;return typeof e!="string"?e:Tf(e).buffer}class ZP{constructor({url:e,httpHeaders:t,withCredentials:s}){F(this,"_responseOrigin",null);this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=Px(this.isHttp,t),this.withCredentials=s||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,s=this.currXhrId++,i=this.pendingRequests[s]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[r,o]of this.headers)t.setRequestHeader(r,o);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),i.expectedStatus=my):i.expectedStatus=gy,t.responseType="arraybuffer",it(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,s),t.onprogress=this.onProgress.bind(this,s),i.onHeadersReceived=e.onHeadersReceived,i.onDone=e.onDone,i.onError=e.onError,i.onProgress=e.onProgress,t.send(null),s}onProgress(e,t){var i;const s=this.pendingRequests[e];s&&((i=s.onProgress)==null||i.call(s,t))}onStateChange(e,t){const s=this.pendingRequests[e];if(!s)return;const i=s.xhr;if(i.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),i.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],i.status===0&&this.isHttp){s.onError(i.status);return}const r=i.status||gy;if(!(r===gy&&s.expectedStatus===my)&&r!==s.expectedStatus){s.onError(i.status);return}const a=JP(i);if(r===my){const c=i.getResponseHeader("Content-Range"),u=/bytes (\d+)-(\d+)\/(\d+)/.exec(c);u?s.onDone({begin:parseInt(u[1],10),chunk:a}):(te('Missing or invalid "Content-Range" header.'),s.onError(0))}else a?s.onDone({begin:0,chunk:a}):s.onError(i.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class eL{constructor(e){this._source=e,this._manager=new ZP(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return it(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new tL(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const s=new nL(this._manager,e,t);return s.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class tL{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=xm(t.responseURL);const s=t.getAllResponseHeaders(),i=new Headers(s?s.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(a=>{const[c,...u]=a.split(": ");return[c,u.join(": ")]}):[]),{allowRangeRequests:r,suggestedLength:o}=Lx({responseHeaders:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});r&&(this._isRangeSupported=!0),this._contentLength=o||this._contentLength,this._filename=Mx(i),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=Mf(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;(t=this.onProgress)==null||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class nL{constructor(e,t,s){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:s,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var t;const e=xm((t=this._manager.getRequestXhr(this._requestId))==null?void 0:t.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=Mf(e,this._url));for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(t=this.onProgress)==null||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const sL=/^[a-z][a-z0-9\-+.]+:/i;function iL(n){if(sL.test(n))return new URL(n);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(n))}class rL{constructor(e){this.source=e,this.url=iL(e.url),it(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return it(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new oL(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new aL(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class oL{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const s=process.getBuiltinModule("fs");s.promises.lstat(this._url).then(i=>{this._contentLength=i.size,this._setReadableStream(s.createReadStream(this._url)),this._headersCapability.resolve()},i=>{i.code==="ENOENT"&&(i=Mf(0,this._url.href)),this._storedError=i,this._headersCapability.reject(i)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Er("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class aL{constructor(e,t,s){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const i=e.source;this._isStreamingSupported=!i.disableStream;const r=process.getBuiltinModule("fs");this._setReadableStream(r.createReadStream(this._url,{start:t,end:s-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const ju=Symbol("INITIAL_DATA");var In,kh,Vv;class Ox{constructor(){A(this,kh);A(this,In,Object.create(null))}get(e,t=null){if(t){const i=S(this,kh,Vv).call(this,e);return i.promise.then(()=>t(i.data)),null}const s=l(this,In)[e];if(!s||s.data===ju)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return s.data}has(e){const t=l(this,In)[e];return!!t&&t.data!==ju}delete(e){const t=l(this,In)[e];return!t||t.data===ju?!1:(delete l(this,In)[e],!0)}resolve(e,t=null){const s=S(this,kh,Vv).call(this,e);s.data=t,s.resolve()}clear(){var e;for(const t in l(this,In)){const{data:s}=l(this,In)[t];(e=s==null?void 0:s.bitmap)==null||e.close()}y(this,In,Object.create(null))}*[Symbol.iterator](){for(const e in l(this,In)){const{data:t}=l(this,In)[e];t!==ju&&(yield[e,t])}}}In=new WeakMap,kh=new WeakSet,Vv=function(e){var t;return(t=l(this,In))[e]||(t[e]={...Promise.withResolvers(),data:ju})};const lL=1e5,BA=30;var dS,eo,gn,Th,Rh,Ea,Qi,Ph,Lh,xa,_c,Cc,to,kc,Mh,Tc,_a,Dh,Nh,Ye,Rc,Ca,Ih,no,Pc,_r,Fx,jx,Gv,Qn,Dp,Wv,zx,Bx;let Ud=(Ye=class{constructor({textContentSource:e,container:t,viewport:s}){A(this,_r);A(this,eo,Promise.withResolvers());A(this,gn,null);A(this,Th,!1);A(this,Rh,!!((dS=globalThis.FontInspector)!=null&&dS.enabled));A(this,Ea,null);A(this,Qi,null);A(this,Ph,0);A(this,Lh,0);A(this,xa,null);A(this,_c,null);A(this,Cc,0);A(this,to,0);A(this,kc,Object.create(null));A(this,Mh,[]);A(this,Tc,null);A(this,_a,[]);A(this,Dh,new WeakMap);A(this,Nh,null);var c;if(e instanceof ReadableStream)y(this,Tc,e);else if(typeof e=="object")y(this,Tc,new ReadableStream({start(u){u.enqueue(e),u.close()}}));else throw new Error('No "textContentSource" parameter specified.');y(this,gn,y(this,_c,t)),y(this,to,s.scale*Ws.pixelRatio),y(this,Cc,s.rotation),y(this,Qi,{div:null,properties:null,ctx:null});const{pageWidth:i,pageHeight:r,pageX:o,pageY:a}=s.rawDims;y(this,Nh,[1,0,0,-1,-o,a+r]),y(this,Lh,i),y(this,Ph,r),S(c=Ye,Qn,zx).call(c),No(t,s),l(this,eo).promise.finally(()=>{l(Ye,Pc).delete(this),y(this,Qi,null),y(this,kc,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=xt.platform;return le(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{l(this,xa).read().then(({value:t,done:s})=>{if(s){l(this,eo).resolve();return}l(this,Ea)??y(this,Ea,t.lang),Object.assign(l(this,kc),t.styles),S(this,_r,Fx).call(this,t.items),e()},l(this,eo).reject)};return y(this,xa,l(this,Tc).getReader()),l(Ye,Pc).add(this),e(),l(this,eo).promise}update({viewport:e,onBefore:t=null}){var r;const s=e.scale*Ws.pixelRatio,i=e.rotation;if(i!==l(this,Cc)&&(t==null||t(),y(this,Cc,i),No(l(this,_c),{rotation:i})),s!==l(this,to)){t==null||t(),y(this,to,s);const o={div:null,properties:null,ctx:S(r=Ye,Qn,Dp).call(r,l(this,Ea))};for(const a of l(this,_a))o.properties=l(this,Dh).get(a),o.div=a,S(this,_r,Gv).call(this,o)}}cancel(){var t;const e=new Er("TextLayer task cancelled.");(t=l(this,xa))==null||t.cancel(e).catch(()=>{}),y(this,xa,null),l(this,eo).reject(e)}get textDivs(){return l(this,_a)}get textContentItemsStr(){return l(this,Mh)}static cleanup(){if(!(l(this,Pc).size>0)){l(this,Rc).clear();for(const{canvas:e}of l(this,Ca).values())e.remove();l(this,Ca).clear()}}},eo=new WeakMap,gn=new WeakMap,Th=new WeakMap,Rh=new WeakMap,Ea=new WeakMap,Qi=new WeakMap,Ph=new WeakMap,Lh=new WeakMap,xa=new WeakMap,_c=new WeakMap,Cc=new WeakMap,to=new WeakMap,kc=new WeakMap,Mh=new WeakMap,Tc=new WeakMap,_a=new WeakMap,Dh=new WeakMap,Nh=new WeakMap,Rc=new WeakMap,Ca=new WeakMap,Ih=new WeakMap,no=new WeakMap,Pc=new WeakMap,_r=new WeakSet,Fx=function(e){var i,r;if(l(this,Th))return;(r=l(this,Qi)).ctx??(r.ctx=S(i=Ye,Qn,Dp).call(i,l(this,Ea)));const t=l(this,_a),s=l(this,Mh);for(const o of e){if(t.length>lL){te("Ignoring additional textDivs for performance reasons."),y(this,Th,!0);return}if(o.str===void 0){if(o.type==="beginMarkedContentProps"||o.type==="beginMarkedContent"){const a=l(this,gn);y(this,gn,document.createElement("span")),l(this,gn).classList.add("markedContent"),o.id!==null&&l(this,gn).setAttribute("id",`${o.id}`),a.append(l(this,gn))}else o.type==="endMarkedContent"&&y(this,gn,l(this,gn).parentNode);continue}s.push(o.str),S(this,_r,jx).call(this,o)}},jx=function(e){var g;const t=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};l(this,_a).push(t);const i=Y.transform(l(this,Nh),e.transform);let r=Math.atan2(i[1],i[0]);const o=l(this,kc)[e.fontName];o.vertical&&(r+=Math.PI/2);let a=l(this,Rh)&&o.fontSubstitution||o.fontFamily;a=Ye.fontFamilyMap.get(a)||a;const c=Math.hypot(i[2],i[3]),u=c*S(g=Ye,Qn,Bx).call(g,a,o,l(this,Ea));let d,h;r===0?(d=i[4],h=i[5]-u):(d=i[4]+u*Math.sin(r),h=i[5]-u*Math.cos(r));const f="calc(var(--total-scale-factor) *",p=t.style;l(this,gn)===l(this,_c)?(p.left=`${(100*d/l(this,Lh)).toFixed(2)}%`,p.top=`${(100*h/l(this,Ph)).toFixed(2)}%`):(p.left=`${f}${d.toFixed(2)}px)`,p.top=`${f}${h.toFixed(2)}px)`),p.fontSize=`${f}${(l(Ye,no)*c).toFixed(2)}px)`,p.fontFamily=a,s.fontSize=c,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,l(this,Rh)&&(t.dataset.fontName=o.fontSubstitutionLoadedName||e.fontName),r!==0&&(s.angle=r*(180/Math.PI));let w=!1;if(e.str.length>1)w=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const E=Math.abs(e.transform[0]),m=Math.abs(e.transform[3]);E!==m&&Math.max(E,m)/Math.min(E,m)>1.5&&(w=!0)}if(w&&(s.canvasWidth=o.vertical?e.height:e.width),l(this,Dh).set(t,s),l(this,Qi).div=t,l(this,Qi).properties=s,S(this,_r,Gv).call(this,l(this,Qi)),s.hasText&&l(this,gn).append(t),s.hasEOL){const E=document.createElement("br");E.setAttribute("role","presentation"),l(this,gn).append(E)}},Gv=function(e){var a;const{div:t,properties:s,ctx:i}=e,{style:r}=t;let o="";if(l(Ye,no)>1&&(o=`scale(${1/l(Ye,no)})`),s.canvasWidth!==0&&s.hasText){const{fontFamily:c}=r,{canvasWidth:u,fontSize:d}=s;S(a=Ye,Qn,Wv).call(a,i,d*l(this,to),c);const{width:h}=i.measureText(t.textContent);h>0&&(o=`scaleX(${u*l(this,to)/h}) ${o}`)}s.angle!==0&&(o=`rotate(${s.angle}deg) ${o}`),o.length>0&&(r.transform=o)},Qn=new WeakSet,Dp=function(e=null){let t=l(this,Ca).get(e||(e=""));if(!t){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=e,document.body.append(s),t=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),l(this,Ca).set(e,t),l(this,Ih).set(t,{size:0,family:""})}return t},Wv=function(e,t,s){const i=l(this,Ih).get(e);t===i.size&&s===i.family||(e.font=`${t}px ${s}`,i.size=t,i.family=s)},zx=function(){if(l(this,no)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),y(this,no,e.getBoundingClientRect().height),e.remove()},Bx=function(e,t,s){const i=l(this,Rc).get(e);if(i)return i;const r=S(this,Qn,Dp).call(this,s);r.canvas.width=r.canvas.height=BA,S(this,Qn,Wv).call(this,r,BA,e);const o=r.measureText(""),a=o.fontBoundingBoxAscent,c=Math.abs(o.fontBoundingBoxDescent);r.canvas.width=r.canvas.height=0;let u=.8;return a?u=a/(a+c):(xt.platform.isFirefox&&te("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?u=t.ascent:t.descent&&(u=1+t.descent)),l(this,Rc).set(e,u),u},A(Ye,Qn),A(Ye,Rc,new Map),A(Ye,Ca,new Map),A(Ye,Ih,new WeakMap),A(Ye,no,null),A(Ye,Pc,new Set),Ye);class Vd{static textContent(e){const t=[],s={items:t,styles:Object.create(null)};function i(r){var c;if(!r)return;let o=null;const a=r.name;if(a==="#text")o=r.value;else if(Vd.shouldBuildText(a))(c=r==null?void 0:r.attributes)!=null&&c.textContent?o=r.attributes.textContent:r.value&&(o=r.value);else return;if(o!==null&&t.push({str:o}),!!r.children)for(const u of r.children)i(u)}return i(e),s}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}const cL=100;function zw(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const e=new Xv,{docId:t}=e,s=n.url?wP(n.url):null,i=n.data?bP(n.data):null,r=n.httpHeaders||null,o=n.withCredentials===!0,a=n.password??null,c=n.range instanceof Bw?n.range:null,u=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:2**16;let d=n.worker instanceof vu?n.worker:null;const h=n.verbosity,f=typeof n.docBaseUrl=="string"&&!Pf(n.docBaseUrl)?n.docBaseUrl:null,p=rp(n.cMapUrl),w=n.cMapPacked!==!1,g=n.CMapReaderFactory||(sn?kP:TA),E=rp(n.iccUrl),m=rp(n.standardFontDataUrl),v=n.StandardFontDataFactory||(sn?TP:RA),b=rp(n.wasmUrl),x=n.WasmFactory||(sn?RP:PA),_=n.stopAtErrors!==!0,k=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,C=n.isEvalSupported!==!1,T=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!sn,L=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!sn&&(xt.platform.isFirefox||!globalThis.chrome),M=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,D=typeof n.disableFontFace=="boolean"?n.disableFontFace:sn,q=n.fontExtraProperties===!0,K=n.enableXfa===!0,G=n.ownerDocument||globalThis.document,ee=n.disableRange===!0,j=n.disableStream===!0,O=n.disableAutoFetch===!0,I=n.pdfBug===!0,$=n.CanvasFactory||(sn?CP:EP),X=n.FilterFactory||(sn?_P:xP),re=n.enableHWA===!0,Q=n.useWasm!==!1,oe=c?c.length:n.length??NaN,Re=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!sn&&!D,We=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:!!(g===TA&&v===RA&&x===PA&&p&&m&&b&&Gu(p,document.baseURI)&&Gu(m,document.baseURI)&&Gu(b,document.baseURI)),he=null;tP(h);const fe={canvasFactory:new $({ownerDocument:G,enableHWA:re}),filterFactory:new X({docId:t,ownerDocument:G}),cMapReaderFactory:We?null:new g({baseUrl:p,isCompressed:w}),standardFontDataFactory:We?null:new v({baseUrl:m}),wasmFactory:We?null:new x({baseUrl:b})};d||(d=vu.create({verbosity:h,port:ps.workerPort}),e._worker=d);const xn={docId:t,apiVersion:"5.3.31",data:i,password:a,disableAutoFetch:O,rangeChunkSize:u,length:oe,docBaseUrl:f,enableXfa:K,evaluatorOptions:{maxImageSize:k,disableFontFace:D,ignoreErrors:_,isEvalSupported:C,isOffscreenCanvasSupported:T,isImageDecoderSupported:L,canvasMaxAreaInBytes:M,fontExtraProperties:q,useSystemFonts:Re,useWasm:Q,useWorkerFetch:We,cMapUrl:p,iccUrl:E,standardFontDataUrl:m,wasmUrl:b}},_n={ownerDocument:G,pdfBug:I,styleElement:he,loadingParams:{disableAutoFetch:O,enableXfa:K}};return d.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const ue=d.messageHandler.sendWithPromise("GetDocRequest",xn,i?[i.buffer]:null);let Cn;if(c)Cn=new GP(c,{disableRange:ee,disableStream:j});else if(!i){if(!s)throw new Error("getDocument - no `url` parameter provided.");const _t=Gu(s)?qP:sn?rL:eL;Cn=new _t({url:s,length:oe,httpHeaders:r,withCredentials:o,rangeChunkSize:u,disableRange:ee,disableStream:j})}return ue.then(_t=>{if(e.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const pt=new Ku(t,_t,d.port),pe=new hL(pt,e,Cn,_n,fe);e._transport=pe,pt.send("Ready",null)})}).catch(e._capability.reject),e}var Wg;const Xg=class Xg{constructor(){F(this,"_capability",Promise.withResolvers());F(this,"_transport",null);F(this,"_worker",null);F(this,"docId",`d${Qt(Xg,Wg)._++}`);F(this,"destroyed",!1);F(this,"onPassword",null);F(this,"onProgress",null)}get promise(){return this._capability.promise}async destroy(){var e,t,s,i;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(r){throw(s=this._worker)!=null&&s.port&&delete this._worker._pendingDestroy,r}this._transport=null,(i=this._worker)==null||i.destroy(),this._worker=null}async getData(){return this._transport.getData()}};Wg=new WeakMap,A(Xg,Wg,0);let Xv=Xg;var ka,Oh,Fh,jh,zh,hS;let Bw=(hS=class{constructor(e,t,s=!1,i=null){A(this,ka,Promise.withResolvers());A(this,Oh,[]);A(this,Fh,[]);A(this,jh,[]);A(this,zh,[]);this.length=e,this.initialData=t,this.progressiveDone=s,this.contentDispositionFilename=i}addRangeListener(e){l(this,zh).push(e)}addProgressListener(e){l(this,jh).push(e)}addProgressiveReadListener(e){l(this,Fh).push(e)}addProgressiveDoneListener(e){l(this,Oh).push(e)}onDataRange(e,t){for(const s of l(this,zh))s(e,t)}onDataProgress(e,t){l(this,ka).promise.then(()=>{for(const s of l(this,jh))s(e,t)})}onDataProgressiveRead(e){l(this,ka).promise.then(()=>{for(const t of l(this,Fh))t(e)})}onDataProgressiveDone(){l(this,ka).promise.then(()=>{for(const e of l(this,Oh))e()})}transportReady(){l(this,ka).resolve()}requestDataRange(e,t){_e("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}},ka=new WeakMap,Oh=new WeakMap,Fh=new WeakMap,jh=new WeakMap,zh=new WeakMap,hS);class uL{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return le(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var Ji,Ta,td;class dL{constructor(e,t,s,i=!1){A(this,Ta);A(this,Ji,!1);this._pageIndex=e,this._pageInfo=t,this._transport=s,this._stats=i?new _A:null,this._pdfBug=i,this.commonObjs=s.commonObjs,this.objs=new Ox,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:s=0,offsetY:i=0,dontFlip:r=!1}={}){return new Rf({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:s,offsetY:i,dontFlip:r})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return le(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,viewport:t,intent:s="display",annotationMode:i=Ai.ENABLE,transform:r=null,background:o=null,optionalContentConfigPromise:a=null,annotationCanvasMap:c=null,pageColors:u=null,printAnnotationStorage:d=null,isEditing:h=!1}){var x,_;(x=this._stats)==null||x.time("Overall");const f=this._transport.getRenderingIntent(s,i,d,h),{renderingIntent:p,cacheKey:w}=f;y(this,Ji,!1),a||(a=this._transport.getOptionalContentConfig(p));let g=this._intentStates.get(w);g||(g=Object.create(null),this._intentStates.set(w,g)),g.streamReaderCancelTimeout&&(clearTimeout(g.streamReaderCancelTimeout),g.streamReaderCancelTimeout=null);const E=!!(p&Gn.PRINT);g.displayReadyCapability||(g.displayReadyCapability=Promise.withResolvers(),g.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(_=this._stats)==null||_.time("Page Request"),this._pumpOperatorList(f));const m=k=>{var C;g.renderTasks.delete(v),E&&y(this,Ji,!0),S(this,Ta,td).call(this),k?(v.capability.reject(k),this._abortOperatorList({intentState:g,reason:k instanceof Error?k:new Error(k)})):v.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(C=globalThis.Stats)!=null&&C.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},v=new Yv({callback:m,params:{canvasContext:e,viewport:t,transform:r,background:o},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:c,operatorList:g.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!E,pdfBug:this._pdfBug,pageColors:u});(g.renderTasks||(g.renderTasks=new Set)).add(v);const b=v.task;return Promise.all([g.displayReadyCapability.promise,a]).then(([k,C])=>{var T;if(this.destroyed){m();return}if((T=this._stats)==null||T.time("Rendering"),!(C.renderingIntent&p))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");v.initializeGraphics({transparency:k,optionalContentConfig:C}),v.operatorListChanged()}).catch(m),b}getOperatorList({intent:e="display",annotationMode:t=Ai.ENABLE,printAnnotationStorage:s=null,isEditing:i=!1}={}){var u;function r(){a.operatorList.lastChunk&&(a.opListReadCapability.resolve(a.operatorList),a.renderTasks.delete(c))}const o=this._transport.getRenderingIntent(e,t,s,i,!0);let a=this._intentStates.get(o.cacheKey);a||(a=Object.create(null),this._intentStates.set(o.cacheKey,a));let c;return a.opListReadCapability||(c=Object.create(null),c.operatorListChanged=r,a.opListReadCapability=Promise.withResolvers(),(a.renderTasks||(a.renderTasks=new Set)).add(c),a.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(u=this._stats)==null||u.time("Page Request"),this._pumpOperatorList(o)),a.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(s=>Vd.textContent(s));const t=this.streamTextContent(e);return new Promise(function(s,i){function r(){o.read().then(function({value:c,done:u}){if(u){s(a);return}a.lang??(a.lang=c.lang),Object.assign(a.styles,c.styles),a.items.push(...c.items),r()},i)}const o=t.getReader(),a={items:[],styles:Object.create(null),lang:null};r()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const s of t.renderTasks)e.push(s.completed),s.cancel();return this.objs.clear(),y(this,Ji,!1),Promise.all(e)}cleanup(e=!1){y(this,Ji,!0);const t=S(this,Ta,td).call(this);return e&&t&&this._stats&&(this._stats=new _A),t}_startRenderPage(e,t){var i,r;const s=this._intentStates.get(t);s&&((i=this._stats)==null||i.timeEnd("Page Request"),(r=s.displayReadyCapability)==null||r.resolve(e))}_renderPageChunk(e,t){for(let s=0,i=e.length;s<i;s++)t.operatorList.fnArray.push(e.fnArray[s]),t.operatorList.argsArray.push(e.argsArray[s]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const s of t.renderTasks)s.operatorListChanged();e.lastChunk&&S(this,Ta,td).call(this)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:s,modifiedIds:i}){const{map:r,transfer:o}=s,c=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:r,modifiedIds:i},o).getReader(),u=this._intentStates.get(t);u.streamReader=c;const d=()=>{c.read().then(({value:h,done:f})=>{if(f){u.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(h,u),d())},h=>{if(u.streamReader=null,!this._transport.destroyed){if(u.operatorList){u.operatorList.lastChunk=!0;for(const f of u.renderTasks)f.operatorListChanged();S(this,Ta,td).call(this)}if(u.displayReadyCapability)u.displayReadyCapability.reject(h);else if(u.opListReadCapability)u.opListReadCapability.reject(h);else throw h}})};d()}_abortOperatorList({intentState:e,reason:t,force:s=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!s){if(e.renderTasks.size>0)return;if(t instanceof Am){let i=cL;t.extraDelay>0&&t.extraDelay<1e3&&(i+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},i);return}}if(e.streamReader.cancel(new Er(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[i,r]of this._intentStates)if(r===e){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}Ji=new WeakMap,Ta=new WeakSet,td=function(){if(!l(this,Ji)||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),y(this,Ji,!1),!0};var so,Ps,Zi,Ra,Yg,Pa,La,an,Np,$x,Hx,nd,Lc,Ip;const Oe=class Oe{constructor({name:e=null,port:t=null,verbosity:s=nP()}={}){A(this,an);A(this,so,Promise.withResolvers());A(this,Ps,null);A(this,Zi,null);A(this,Ra,null);if(this.name=e,this.destroyed=!1,this.verbosity=s,t){if(l(Oe,La).has(t))throw new Error("Cannot use more than one PDFWorker per port.");l(Oe,La).set(t,this),S(this,an,$x).call(this,t)}else S(this,an,Hx).call(this)}get promise(){return l(this,so).promise}get port(){return l(this,Zi)}get messageHandler(){return l(this,Ps)}destroy(){var e,t;this.destroyed=!0,(e=l(this,Ra))==null||e.terminate(),y(this,Ra,null),l(Oe,La).delete(l(this,Zi)),y(this,Zi,null),(t=l(this,Ps))==null||t.destroy(),y(this,Ps,null)}static create(e){const t=l(this,La).get(e==null?void 0:e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new Oe(e)}static get workerSrc(){if(ps.workerSrc)return ps.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return le(this,"_setupFakeWorkerGlobal",(async()=>l(this,Lc,Ip)?l(this,Lc,Ip):(await import(this.workerSrc)).WorkerMessageHandler)())}};so=new WeakMap,Ps=new WeakMap,Zi=new WeakMap,Ra=new WeakMap,Yg=new WeakMap,Pa=new WeakMap,La=new WeakMap,an=new WeakSet,Np=function(){l(this,so).resolve(),l(this,Ps).send("configure",{verbosity:this.verbosity})},$x=function(e){y(this,Zi,e),y(this,Ps,new Ku("main","worker",e)),l(this,Ps).on("ready",()=>{}),S(this,an,Np).call(this)},Hx=function(){if(l(Oe,Pa)||l(Oe,Lc,Ip)){S(this,an,nd).call(this);return}let{workerSrc:e}=Oe;try{Oe._isSameOrigin(window.location,e)||(e=Oe._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),s=new Ku("main","worker",t),i=()=>{r.abort(),s.destroy(),t.terminate(),this.destroyed?l(this,so).reject(new Error("Worker was destroyed")):S(this,an,nd).call(this)},r=new AbortController;t.addEventListener("error",()=>{l(this,Ra)||i()},{signal:r.signal}),s.on("test",a=>{if(r.abort(),this.destroyed||!a){i();return}y(this,Ps,s),y(this,Zi,t),y(this,Ra,t),S(this,an,Np).call(this)}),s.on("ready",a=>{if(r.abort(),this.destroyed){i();return}try{o()}catch{S(this,an,nd).call(this)}});const o=()=>{const a=new Uint8Array;s.send("test",a,[a.buffer])};o();return}catch{bm("The worker has been disabled.")}S(this,an,nd).call(this)},nd=function(){l(Oe,Pa)||(te("Setting up fake worker."),y(Oe,Pa,!0)),Oe._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){l(this,so).reject(new Error("Worker was destroyed"));return}const t=new SP;y(this,Zi,t);const s=`fake${Qt(Oe,Yg)._++}`,i=new Ku(s+"_worker",s,t);e.setup(i,t),y(this,Ps,new Ku(s,s+"_worker",t)),S(this,an,Np).call(this)}).catch(e=>{l(this,so).reject(new Error(`Setting up fake worker failed: "${e.message}".`))})},Lc=new WeakSet,Ip=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},A(Oe,Lc),A(Oe,Yg,0),A(Oe,Pa,!1),A(Oe,La,new WeakMap),sn&&(y(Oe,Pa,!0),ps.workerSrc||(ps.workerSrc="./pdf.worker.mjs")),Oe._isSameOrigin=(e,t)=>{const s=URL.parse(e);if(!(s!=null&&s.origin)||s.origin==="null")return!1;const i=new URL(t,s);return s.origin===i.origin},Oe._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},Oe.fromPort=e=>{if(dP("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return Oe.create(e)};let vu=Oe;var er,fi,Mc,Dc,tr,Ma,sd;class hL{constructor(e,t,s,i,r){A(this,Ma);A(this,er,new Map);A(this,fi,new Map);A(this,Mc,new Map);A(this,Dc,new Map);A(this,tr,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new Ox,this.fontLoader=new yP({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=r.canvasFactory,this.filterFactory=r.filterFactory,this.cMapReaderFactory=r.cMapReaderFactory,this.standardFontDataFactory=r.standardFontDataFactory,this.wasmFactory=r.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=s,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return le(this,"annotationStorage",new Ow)}getRenderingIntent(e,t=Ai.ENABLE,s=null,i=!1,r=!1){let o=Gn.DISPLAY,a=Nv;switch(e){case"any":o=Gn.ANY;break;case"display":break;case"print":o=Gn.PRINT;break;default:te(`getRenderingIntent - invalid intent: ${e}`)}const c=o&Gn.PRINT&&s instanceof wx?s:this.annotationStorage;switch(t){case Ai.DISABLE:o+=Gn.ANNOTATIONS_DISABLE;break;case Ai.ENABLE:break;case Ai.ENABLE_FORMS:o+=Gn.ANNOTATIONS_FORMS;break;case Ai.ENABLE_STORAGE:o+=Gn.ANNOTATIONS_STORAGE,a=c.serializable;break;default:te(`getRenderingIntent - invalid annotationMode: ${t}`)}i&&(o+=Gn.IS_EDITING),r&&(o+=Gn.OPLIST);const{ids:u,hash:d}=c.modifiedIds,h=[o,a.hash,d];return{renderingIntent:o,cacheKey:h.join("_"),annotationStorageSerializable:a,modifiedIds:u}}destroy(){var s;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(s=l(this,tr))==null||s.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const i of l(this,fi).values())e.push(i._destroy());l(this,fi).clear(),l(this,Mc).clear(),l(this,Dc).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var i,r;this.commonObjs.clear(),this.fontLoader.clear(),l(this,er).clear(),this.filterFactory.destroy(),Ud.cleanup(),(i=this._networkStream)==null||i.cancelAllRequests(new Er("Worker was terminated.")),(r=this.messageHandler)==null||r.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(s,i)=>{it(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=r=>{this._lastProgress={loaded:r.loaded,total:r.total}},i.onPull=()=>{this._fullReader.read().then(function({value:r,done:o}){if(o){i.close();return}it(r instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(r),1,[r])}).catch(r=>{i.error(r)})},i.onCancel=r=>{this._fullReader.cancel(r),i.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("ReaderHeadersReady",async s=>{var a;await this._fullReader.headersReady;const{isStreamingSupported:i,isRangeSupported:r,contentLength:o}=this._fullReader;return(!i||!r)&&(this._lastProgress&&((a=t.onProgress)==null||a.call(t,this._lastProgress)),this._fullReader.onProgress=c=>{var u;(u=t.onProgress)==null||u.call(t,{loaded:c.loaded,total:c.total})}),{isStreamingSupported:i,isRangeSupported:r,contentLength:o}}),e.on("GetRangeReader",(s,i)=>{it(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const r=this._networkStream.getRangeReader(s.begin,s.end);if(!r){i.close();return}i.onPull=()=>{r.read().then(function({value:o,done:a}){if(a){i.close();return}it(o instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{i.error(o)})},i.onCancel=o=>{r.cancel(o),i.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("GetDoc",({pdfInfo:s})=>{this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,t._capability.resolve(new uL(s,this))}),e.on("DocException",s=>{t._capability.reject(hn(s))}),e.on("PasswordRequest",s=>{y(this,tr,Promise.withResolvers());try{if(!t.onPassword)throw hn(s);const i=r=>{r instanceof Error?l(this,tr).reject(r):l(this,tr).resolve({password:r})};t.onPassword(i,s.code)}catch(i){l(this,tr).reject(i)}return l(this,tr).promise}),e.on("DataLoaded",s=>{var i;(i=t.onProgress)==null||i.call(t,{loaded:s.length,total:s.length}),this.downloadInfoCapability.resolve(s)}),e.on("StartRenderPage",s=>{if(this.destroyed)return;l(this,fi).get(s.pageIndex)._startRenderPage(s.transparency,s.cacheKey)}),e.on("commonobj",([s,i,r])=>{var o;if(this.destroyed||this.commonObjs.has(s))return null;switch(i){case"Font":if("error"in r){const d=r.error;te(`Error during font loading: ${d}`),this.commonObjs.resolve(s,d);break}const a=this._params.pdfBug&&((o=globalThis.FontInspector)!=null&&o.enabled)?(d,h)=>globalThis.FontInspector.fontAdded(d,h):null,c=new vP(r,a);this.fontLoader.bind(c).catch(()=>e.sendWithPromise("FontFallback",{id:s})).finally(()=>{!c.fontExtraProperties&&c.data&&(c.data=null),this.commonObjs.resolve(s,c)});break;case"CopyLocalImage":const{imageRef:u}=r;it(u,"The imageRef must be defined.");for(const d of l(this,fi).values())for(const[,h]of d.objs)if((h==null?void 0:h.ref)===u)return h.dataLen?(this.commonObjs.resolve(s,structuredClone(h)),h.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(s,r);break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),e.on("obj",([s,i,r,o])=>{var c;if(this.destroyed)return;const a=l(this,fi).get(i);if(!a.objs.has(s)){if(a._intentStates.size===0){(c=o==null?void 0:o.bitmap)==null||c.close();return}switch(r){case"Image":case"Pattern":a.objs.resolve(s,o);break;default:throw new Error(`Got unknown object type ${r}`)}}}),e.on("DocProgress",s=>{var i;this.destroyed||(i=t.onProgress)==null||i.call(t,{loaded:s.loaded,total:s.total})}),e.on("FetchBinaryData",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");const i=this[s.type];if(!i)throw new Error(`${s.type} not initialized, see the \`useWorkerFetch\` parameter.`);return i.fetch(s)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var s;this.annotationStorage.size<=0&&te("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((s=this._fullReader)==null?void 0:s.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,s=l(this,Mc).get(t);if(s)return s;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(r=>{if(this.destroyed)throw new Error("Transport destroyed");r.refStr&&l(this,Dc).set(r.refStr,e);const o=new dL(t,r,this,this._params.pdfBug);return l(this,fi).set(t,o),o});return l(this,Mc).set(t,i),i}getPageIndex(e){return Iv(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return S(this,Ma,sd).call(this,"GetFieldObjects")}hasJSActions(){return S(this,Ma,sd).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return S(this,Ma,sd).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return S(this,Ma,sd).call(this,"GetOptionalContentConfig").then(t=>new VP(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=l(this,er).get(e);if(t)return t;const s=this.messageHandler.sendWithPromise(e,null).then(i=>{var r,o;return{info:i[0],metadata:i[1]?new HP(i[1]):null,contentDispositionFilename:((r=this._fullReader)==null?void 0:r.filename)??null,contentLength:((o=this._fullReader)==null?void 0:o.contentLength)??null}});return l(this,er).set(e,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of l(this,fi).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),l(this,er).clear(),this.filterFactory.destroy(!0),Ud.cleanup()}}cachedPageNumber(e){if(!Iv(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return l(this,Dc).get(t)??null}}er=new WeakMap,fi=new WeakMap,Mc=new WeakMap,Dc=new WeakMap,tr=new WeakMap,Ma=new WeakSet,sd=function(e,t=null){const s=l(this,er).get(e);if(s)return s;const i=this.messageHandler.sendWithPromise(e,t);return l(this,er).set(e,i),i};var io;class fL{constructor(e){A(this,io,null);F(this,"onContinue",null);F(this,"onError",null);y(this,io,e)}get promise(){return l(this,io).capability.promise}cancel(e=0){l(this,io).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=l(this,io).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=l(this,io);return e.form||e.canvas&&(t==null?void 0:t.size)>0}}io=new WeakMap;var ro,Da;const Ko=class Ko{constructor({callback:e,params:t,objs:s,commonObjs:i,annotationCanvasMap:r,operatorList:o,pageIndex:a,canvasFactory:c,filterFactory:u,useRequestAnimationFrame:d=!1,pdfBug:h=!1,pageColors:f=null}){A(this,ro,null);this.callback=e,this.params=t,this.objs=s,this.commonObjs=i,this.annotationCanvasMap=r,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=a,this.canvasFactory=c,this.filterFactory=u,this._pdfBug=h,this.pageColors=f,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=d===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new fL(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var a,c;if(this.cancelled)return;if(this._canvas){if(l(Ko,Da).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");l(Ko,Da).add(this._canvas)}this._pdfBug&&((a=globalThis.StepperManager)!=null&&a.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:s,viewport:i,transform:r,background:o}=this.params;this.gfx=new Zl(s,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:r,viewport:i,transparency:e,background:o}),this.operatorListIdx=0,this.graphicsReady=!0,(c=this.graphicsReadyCallback)==null||c.call(this)}cancel(e=null,t=0){var s,i,r;this.running=!1,this.cancelled=!0,(s=this.gfx)==null||s.endDrawing(),l(this,ro)&&(window.cancelAnimationFrame(l(this,ro)),y(this,ro,null)),l(Ko,Da).delete(this._canvas),e||(e=new Am(`Rendering cancelled, page ${this._pageIndex+1}`,t)),this.callback(e),(r=(i=this.task).onError)==null||r.call(i,e)}operatorListChanged(){var e;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.stepper)==null||e.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?y(this,ro,window.requestAnimationFrame(()=>{y(this,ro,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),l(Ko,Da).delete(this._canvas),this.callback())))}};ro=new WeakMap,Da=new WeakMap,A(Ko,Da,new WeakSet);let Yv=Ko;const Ux="5.3.31",Vx="47ad820d9";function $A(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function zu(n){return Math.max(0,Math.min(255,255*n))}class HA{static CMYK_G([e,t,s,i]){return["G",1-Math.min(1,.3*e+.59*s+.11*t+i)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=zu(e),[e,e,e]}static G_HTML([e]){const t=$A(e);return`#${t}${t}${t}`}static RGB_G([e,t,s]){return["G",.3*e+.59*t+.11*s]}static RGB_rgb(e){return e.map(zu)}static RGB_HTML(e){return`#${e.map($A).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,s,i]){return["RGB",1-Math.min(1,e+i),1-Math.min(1,s+i),1-Math.min(1,t+i)]}static CMYK_rgb([e,t,s,i]){return[zu(1-Math.min(1,e+i)),zu(1-Math.min(1,s+i)),zu(1-Math.min(1,t+i))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,s]){const i=1-e,r=1-t,o=1-s,a=Math.min(i,r,o);return["CMYK",i,r,o,a]}}class pL{create(e,t,s=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),s||(i.setAttribute("width",`${e}px`),i.setAttribute("height",`${t}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${e} ${t}`),i}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){_e("Abstract method `_createSVG` called.")}}class Gd extends pL{_createSVG(e){return document.createElementNS(Mi,e)}}class $w{static setupStorage(e,t,s,i,r){const o=i.getValue(t,{value:null});switch(s.name){case"textarea":if(o.value!==null&&(e.textContent=o.value),r==="print")break;e.addEventListener("input",a=>{i.setValue(t,{value:a.target.value})});break;case"input":if(s.attributes.type==="radio"||s.attributes.type==="checkbox"){if(o.value===s.attributes.xfaOn?e.setAttribute("checked",!0):o.value===s.attributes.xfaOff&&e.removeAttribute("checked"),r==="print")break;e.addEventListener("change",a=>{i.setValue(t,{value:a.target.checked?a.target.getAttribute("xfaOn"):a.target.getAttribute("xfaOff")})})}else{if(o.value!==null&&e.setAttribute("value",o.value),r==="print")break;e.addEventListener("input",a=>{i.setValue(t,{value:a.target.value})})}break;case"select":if(o.value!==null){e.setAttribute("value",o.value);for(const a of s.children)a.attributes.value===o.value?a.attributes.selected=!0:a.attributes.hasOwnProperty("selected")&&delete a.attributes.selected}e.addEventListener("input",a=>{const c=a.target.options,u=c.selectedIndex===-1?"":c[c.selectedIndex].value;i.setValue(t,{value:u})});break}}static setAttributes({html:e,element:t,storage:s=null,intent:i,linkService:r}){const{attributes:o}=t,a=e instanceof HTMLAnchorElement;o.type==="radio"&&(o.name=`${o.name}-${i}`);for(const[c,u]of Object.entries(o))if(u!=null)switch(c){case"class":u.length&&e.setAttribute(c,u.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",u);break;case"style":Object.assign(e.style,u);break;case"textContent":e.textContent=u;break;default:(!a||c!=="href"&&c!=="newWindow")&&e.setAttribute(c,u)}a&&r.addLinkAttributes(e,o.href,o.newWindow),s&&o.dataId&&this.setupStorage(e,o.dataId,t,s)}static render(e){var h,f;const t=e.annotationStorage,s=e.linkService,i=e.xfaHtml,r=e.intent||"display",o=document.createElement(i.name);i.attributes&&this.setAttributes({html:o,element:i,intent:r,linkService:s});const a=r!=="richText",c=e.div;if(c.append(o),e.viewport){const p=`matrix(${e.viewport.transform.join(",")})`;c.style.transform=p}a&&c.setAttribute("class","xfaLayer xfaFont");const u=[];if(i.children.length===0){if(i.value){const p=document.createTextNode(i.value);o.append(p),a&&Vd.shouldBuildText(i.name)&&u.push(p)}return{textDivs:u}}const d=[[i,-1,o]];for(;d.length>0;){const[p,w,g]=d.at(-1);if(w+1===p.children.length){d.pop();continue}const E=p.children[++d.at(-1)[1]];if(E===null)continue;const{name:m}=E;if(m==="#text"){const b=document.createTextNode(E.value);u.push(b),g.append(b);continue}const v=(h=E==null?void 0:E.attributes)!=null&&h.xmlns?document.createElementNS(E.attributes.xmlns,m):document.createElement(m);if(g.append(v),E.attributes&&this.setAttributes({html:v,element:E,storage:t,intent:r,linkService:s}),((f=E.children)==null?void 0:f.length)>0)d.push([E,-1,v]);else if(E.value){const b=document.createTextNode(E.value);a&&Vd.shouldBuildText(m)&&u.push(b),v.append(b)}}for(const p of c.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))p.setAttribute("readOnly",!0);return{textDivs:u}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const Df=1e3,gL=9,fl=new WeakSet;class UA{static create(e){switch(e.data.annotationType){case Ke.LINK:return new Gx(e);case Ke.TEXT:return new mL(e);case Ke.WIDGET:switch(e.data.fieldType){case"Tx":return new yL(e);case"Btn":return e.data.radioButton?new Yx(e):e.data.checkBox?new wL(e):new bL(e);case"Ch":return new AL(e);case"Sig":return new vL(e)}return new wl(e);case Ke.POPUP:return new Kv(e);case Ke.FREETEXT:return new Zx(e);case Ke.LINE:return new EL(e);case Ke.SQUARE:return new xL(e);case Ke.CIRCLE:return new _L(e);case Ke.POLYLINE:return new e_(e);case Ke.CARET:return new kL(e);case Ke.INK:return new Hw(e);case Ke.POLYGON:return new CL(e);case Ke.HIGHLIGHT:return new t_(e);case Ke.UNDERLINE:return new TL(e);case Ke.SQUIGGLY:return new RL(e);case Ke.STRIKEOUT:return new PL(e);case Ke.STAMP:return new n_(e);case Ke.FILEATTACHMENT:return new LL(e);default:return new tt(e)}}}var Na,Nc,Ic,Bh,qv;const ib=class ib{constructor(e,{isRenderable:t=!1,ignoreBorder:s=!1,createQuadrilaterals:i=!1}={}){A(this,Bh);A(this,Na,null);A(this,Nc,!1);A(this,Ic,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(s)),i&&this._createQuadrilaterals()}static _hasPopupData({titleObj:e,contentsObj:t,richText:s}){return!!(e!=null&&e.str||t!=null&&t.str||s!=null&&s.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return ib._hasPopupData(this.data)}updateEdited(e){var s;if(!this.container)return;l(this,Na)||y(this,Na,{rect:this.data.rect.slice(0)});const{rect:t}=e;t&&S(this,Bh,qv).call(this,t),(s=l(this,Ic))==null||s.popup.updateEdited(e)}resetEdited(){var e;l(this,Na)&&(S(this,Bh,qv).call(this,l(this,Na).rect),(e=l(this,Ic))==null||e.popup.resetEdited(),y(this,Na,null))}_createContainer(e){const{data:t,parent:{page:s,viewport:i}}=this,r=document.createElement("section");r.setAttribute("data-annotation-id",t.id),this instanceof wl||(r.tabIndex=Df);const{style:o}=r;if(o.zIndex=this.parent.zIndex++,t.alternativeText&&(r.title=t.alternativeText),t.noRotate&&r.classList.add("norotate"),!t.rect||this instanceof Kv){const{rotation:g}=t;return!t.hasOwnCanvas&&g!==0&&this.setRotation(g,r),r}const{width:a,height:c}=this;if(!e&&t.borderStyle.width>0){o.borderWidth=`${t.borderStyle.width}px`;const g=t.borderStyle.horizontalCornerRadius,E=t.borderStyle.verticalCornerRadius;if(g>0||E>0){const v=`calc(${g}px * var(--total-scale-factor)) / calc(${E}px * var(--total-scale-factor))`;o.borderRadius=v}else if(this instanceof Yx){const v=`calc(${a}px * var(--total-scale-factor)) / calc(${c}px * var(--total-scale-factor))`;o.borderRadius=v}switch(t.borderStyle.style){case xl.SOLID:o.borderStyle="solid";break;case xl.DASHED:o.borderStyle="dashed";break;case xl.BEVELED:te("Unimplemented border style: beveled");break;case xl.INSET:te("Unimplemented border style: inset");break;case xl.UNDERLINE:o.borderBottomStyle="solid";break}const m=t.borderColor||null;m?(y(this,Nc,!0),o.borderColor=Y.makeHexColor(m[0]|0,m[1]|0,m[2]|0)):o.borderWidth=0}const u=Y.normalizeRect([t.rect[0],s.view[3]-t.rect[1]+s.view[1],t.rect[2],s.view[3]-t.rect[3]+s.view[1]]),{pageWidth:d,pageHeight:h,pageX:f,pageY:p}=i.rawDims;o.left=`${100*(u[0]-f)/d}%`,o.top=`${100*(u[1]-p)/h}%`;const{rotation:w}=t;return t.hasOwnCanvas||w===0?(o.width=`${100*a/d}%`,o.height=`${100*c/h}%`):this.setRotation(w,r),r}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:s,pageHeight:i}=this.parent.viewport.rawDims;let{width:r,height:o}=this;e%180!==0&&([r,o]=[o,r]),t.style.width=`${100*r/s}%`,t.style.height=`${100*o/i}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,s,i)=>{const r=i.detail[t],o=r[0],a=r.slice(1);i.target.style[s]=HA[`${o}_HTML`](a),this.annotationStorage.setValue(this.data.id,{[s]:HA[`${o}_rgb`](a)})};return le(this,"_commonActions",{display:t=>{const{display:s}=t.detail,i=s%2===1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:s===1||s===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:s}=t.detail;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:s,noView:s})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const s=t.detail.rotation;this.setRotation(s),this.annotationStorage.setValue(this.data.id,{rotation:s})}})}_dispatchEventFromSandbox(e,t){const s=this._commonActions;for(const i of Object.keys(t.detail)){const r=e[i]||s[i];r==null||r(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const s=this._commonActions;for(const[i,r]of Object.entries(t)){const o=s[i];if(o){const a={detail:{[i]:r},target:e};o(a),delete t[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,s,i,r]=this.data.rect.map(g=>Math.fround(g));if(e.length===8){const[g,E,m,v]=e.subarray(2,6);if(i===g&&r===E&&t===m&&s===v)return}const{style:o}=this.container;let a;if(l(this,Nc)){const{borderColor:g,borderWidth:E}=o;o.borderWidth=0,a=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${g}" stroke-width="${E}">`],this.container.classList.add("hasBorder")}const c=i-t,u=r-s,{svgFactory:d}=this,h=d.createElement("svg");h.classList.add("quadrilateralsContainer"),h.setAttribute("width",0),h.setAttribute("height",0);const f=d.createElement("defs");h.append(f);const p=d.createElement("clipPath"),w=`clippath_${this.data.id}`;p.setAttribute("id",w),p.setAttribute("clipPathUnits","objectBoundingBox"),f.append(p);for(let g=2,E=e.length;g<E;g+=8){const m=e[g],v=e[g+1],b=e[g+2],x=e[g+3],_=d.createElement("rect"),k=(b-t)/c,C=(r-v)/u,T=(m-b)/c,L=(v-x)/u;_.setAttribute("x",k),_.setAttribute("y",C),_.setAttribute("width",T),_.setAttribute("height",L),p.append(_),a==null||a.push(`<rect vector-effect="non-scaling-stroke" x="${k}" y="${C}" width="${T}" height="${L}"/>`)}l(this,Nc)&&(a.push("</g></svg>')"),o.backgroundImage=a.join("")),this.container.append(h),this.container.style.clipPath=`url(#${w})`}_createPopup(){const{data:e}=this,t=y(this,Ic,new Kv({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]}));this.parent.div.append(t.render())}render(){_e("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const s=[];if(this._fieldObjects){const i=this._fieldObjects[e];if(i)for(const{page:r,id:o,exportValues:a}of i){if(r===-1||o===t)continue;const c=typeof a=="string"?a:null,u=document.querySelector(`[data-element-id="${o}"]`);if(u&&!fl.has(u)){te(`_getElementsByName - element not allowed: ${o}`);continue}s.push({id:o,exportValue:c,domElement:u})}return s}for(const i of document.getElementsByName(e)){const{exportValue:r}=i,o=i.getAttribute("data-element-id");o!==t&&fl.has(i)&&s.push({id:o,exportValue:r,domElement:i})}return s}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var s;(s=this.linkService.eventBus)==null||s.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}};Na=new WeakMap,Nc=new WeakMap,Ic=new WeakMap,Bh=new WeakSet,qv=function(e){const{container:{style:t},data:{rect:s,rotation:i},parent:{viewport:{rawDims:{pageWidth:r,pageHeight:o,pageX:a,pageY:c}}}}=this;s==null||s.splice(0,4,...e),t.left=`${100*(e[0]-a)/r}%`,t.top=`${100*(o-e[3]+c)/o}%`,i===0?(t.width=`${100*(e[2]-e[0])/r}%`,t.height=`${100*(e[3]-e[1])/o}%`):this.setRotation(i)};let tt=ib;var Yn,Wo,Wx,Xx;class Gx extends tt{constructor(t,s=null){super(t,{isRenderable:!0,ignoreBorder:!!(s!=null&&s.ignoreBorder),createQuadrilaterals:!0});A(this,Yn);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:s}=this,i=document.createElement("a");i.setAttribute("data-element-id",t.id);let r=!1;return t.url?(s.addLinkAttributes(i,t.url,t.newWindow),r=!0):t.action?(this._bindNamedAction(i,t.action),r=!0):t.attachment?(S(this,Yn,Wx).call(this,i,t.attachment,t.attachmentDest),r=!0):t.setOCGState?(S(this,Yn,Xx).call(this,i,t.setOCGState),r=!0):t.dest?(this._bindLink(i,t.dest),r=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,t),r=!0),t.resetForm?(this._bindResetFormAction(i,t.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(i,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&this.container.append(i),this.container}_bindLink(t,s){t.href=this.linkService.getDestinationHash(s),t.onclick=()=>(s&&this.linkService.goToDestination(s),!1),(s||s==="")&&S(this,Yn,Wo).call(this)}_bindNamedAction(t,s){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(s),!1),S(this,Yn,Wo).call(this)}_bindJSAction(t,s){t.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(s.actions)){const o=i.get(r);o&&(t[o]=()=>{var a;return(a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s.id,name:r}}),!1})}t.onclick||(t.onclick=()=>!1),S(this,Yn,Wo).call(this)}_bindResetFormAction(t,s){const i=t.onclick;if(i||(t.href=this.linkService.getAnchorUrl("")),S(this,Yn,Wo).call(this),!this._fieldObjects){te('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(t.onclick=()=>!1);return}t.onclick=()=>{var h;i==null||i();const{fields:r,refs:o,include:a}=s,c=[];if(r.length!==0||o.length!==0){const f=new Set(o);for(const p of r){const w=this._fieldObjects[p]||[];for(const{id:g}of w)f.add(g)}for(const p of Object.values(this._fieldObjects))for(const w of p)f.has(w.id)===a&&c.push(w)}else for(const f of Object.values(this._fieldObjects))c.push(...f);const u=this.annotationStorage,d=[];for(const f of c){const{id:p}=f;switch(d.push(p),f.type){case"text":{const g=f.defaultValue||"";u.setValue(p,{value:g});break}case"checkbox":case"radiobutton":{const g=f.defaultValue===f.exportValues;u.setValue(p,{value:g});break}case"combobox":case"listbox":{const g=f.defaultValue||"";u.setValue(p,{value:g});break}default:continue}const w=document.querySelector(`[data-element-id="${p}"]`);if(w){if(!fl.has(w)){te(`_bindResetFormAction - element not allowed: ${p}`);continue}}else continue;w.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((h=this.linkService.eventBus)==null||h.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:d,name:"ResetForm"}})),!1}}}Yn=new WeakSet,Wo=function(){this.container.setAttribute("data-internal-link","")},Wx=function(t,s,i=null){t.href=this.linkService.getAnchorUrl(""),s.description&&(t.title=s.description),t.onclick=()=>{var r;return(r=this.downloadManager)==null||r.openOrDownloadData(s.content,s.filename,i),!1},S(this,Yn,Wo).call(this)},Xx=function(t,s){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(s),!1),S(this,Yn,Wo).call(this)};class mL extends tt{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class wl extends tt{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return xt.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,s,i,r){s.includes("mouse")?e.addEventListener(s,o=>{var a;(a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:r(o),shift:o.shiftKey,modifier:this._getKeyModifier(o)}})}):e.addEventListener(s,o=>{var a;if(s==="blur"){if(!t.focused||!o.relatedTarget)return;t.focused=!1}else if(s==="focus"){if(t.focused)return;t.focused=!0}r&&((a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:r(o)}}))})}_setEventListeners(e,t,s,i){var r,o,a;for(const[c,u]of s)(u==="Action"||(r=this.data.actions)!=null&&r[u])&&((u==="Focus"||u==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,c,u,i),u==="Focus"&&!((o=this.data.actions)!=null&&o.Blur)?this._setEventListener(e,t,"blur","Blur",null):u==="Blur"&&!((a=this.data.actions)!=null&&a.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":Y.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||gL,r=e.style;let o;const a=2,c=u=>Math.round(10*u)/10;if(this.data.multiLine){const u=Math.abs(this.data.rect[3]-this.data.rect[1]-a),d=Math.round(u/(cy*i))||1,h=u/d;o=Math.min(i,c(h/cy))}else{const u=Math.abs(this.data.rect[3]-this.data.rect[1]-a);o=Math.min(i,c(u/cy))}r.fontSize=`calc(${o}px * var(--total-scale-factor))`,r.color=Y.makeHexColor(s[0],s[1],s[2]),this.data.textAlignment!==null&&(r.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class yL extends wl{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,s,i){const r=this.annotationStorage;for(const o of this._getElementsByName(e.name,e.id))o.domElement&&(o.domElement[t]=s),r.setValue(o.id,{[i]:s})}render(){var i,r;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const o=e.getValue(t,{value:this.data.fieldValue});let a=o.value||"";const c=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;c&&a.length>c&&(a=a.slice(0,c));let u=o.formattedValue||((i=this.data.textContent)==null?void 0:i.join(`
`))||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const d={userValue:a,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=u??a,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type=this.data.password?"password":"text",s.setAttribute("value",u??a),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),fl.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=Df,this._setRequired(s,this.data.required),c&&(s.maxLength=c),s.addEventListener("input",f=>{e.setValue(t,{value:f.target.value}),this.setPropertyOnSiblings(s,"value",f.target.value,"value"),d.formattedValue=null}),s.addEventListener("resetform",f=>{const p=this.data.defaultFieldValue??"";s.value=d.userValue=p,d.formattedValue=null});let h=f=>{const{formattedValue:p}=d;p!=null&&(f.target.value=p),f.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",p=>{var g;if(d.focused)return;const{target:w}=p;d.userValue&&(w.value=d.userValue),d.lastCommittedValue=w.value,d.commitKey=1,(g=this.data.actions)!=null&&g.Focus||(d.focused=!0)}),s.addEventListener("updatefromsandbox",p=>{this.showElementAndHideCanvas(p.target);const w={value(g){d.userValue=g.detail.value??"",e.setValue(t,{value:d.userValue.toString()}),g.target.value=d.userValue},formattedValue(g){const{formattedValue:E}=g.detail;d.formattedValue=E,E!=null&&g.target!==document.activeElement&&(g.target.value=E),e.setValue(t,{formattedValue:E})},selRange(g){g.target.setSelectionRange(...g.detail.selRange)},charLimit:g=>{var b;const{charLimit:E}=g.detail,{target:m}=g;if(E===0){m.removeAttribute("maxLength");return}m.setAttribute("maxLength",E);let v=d.userValue;!v||v.length<=E||(v=v.slice(0,E),m.value=d.userValue=v,e.setValue(t,{value:v}),(b=this.linkService.eventBus)==null||b.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:v,willCommit:!0,commitKey:1,selStart:m.selectionStart,selEnd:m.selectionEnd}}))}};this._dispatchEventFromSandbox(w,p)}),s.addEventListener("keydown",p=>{var E;d.commitKey=1;let w=-1;if(p.key==="Escape"?w=0:p.key==="Enter"&&!this.data.multiLine?w=2:p.key==="Tab"&&(d.commitKey=3),w===-1)return;const{value:g}=p.target;d.lastCommittedValue!==g&&(d.lastCommittedValue=g,d.userValue=g,(E=this.linkService.eventBus)==null||E.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:g,willCommit:!0,commitKey:w,selStart:p.target.selectionStart,selEnd:p.target.selectionEnd}}))});const f=h;h=null,s.addEventListener("blur",p=>{var g,E;if(!d.focused||!p.relatedTarget)return;(g=this.data.actions)!=null&&g.Blur||(d.focused=!1);const{value:w}=p.target;d.userValue=w,d.lastCommittedValue!==w&&((E=this.linkService.eventBus)==null||E.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:w,willCommit:!0,commitKey:d.commitKey,selStart:p.target.selectionStart,selEnd:p.target.selectionEnd}})),f(p)}),(r=this.data.actions)!=null&&r.Keystroke&&s.addEventListener("beforeinput",p=>{var _;d.lastCommittedValue=null;const{data:w,target:g}=p,{value:E,selectionStart:m,selectionEnd:v}=g;let b=m,x=v;switch(p.inputType){case"deleteWordBackward":{const k=E.substring(0,m).match(/\w*[^\w]*$/);k&&(b-=k[0].length);break}case"deleteWordForward":{const k=E.substring(m).match(/^[^\w]*\w*/);k&&(x+=k[0].length);break}case"deleteContentBackward":m===v&&(b-=1);break;case"deleteContentForward":m===v&&(x+=1);break}p.preventDefault(),(_=this.linkService.eventBus)==null||_.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:E,change:w||"",willCommit:!1,selStart:b,selEnd:x}})}),this._setEventListeners(s,d,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],p=>p.target.value)}if(h&&s.addEventListener("blur",h),this.data.comb){const p=(this.data.rect[2]-this.data.rect[0])/c;s.classList.add("comb"),s.style.letterSpacing=`calc(${p}px * var(--total-scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class vL extends wl{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class wL extends wl{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,s=t.id;let i=e.getValue(s,{value:t.exportValue===t.fieldValue}).value;typeof i=="string"&&(i=i!=="Off",e.setValue(s,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const r=document.createElement("input");return fl.add(r),r.setAttribute("data-element-id",s),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="checkbox",r.name=t.fieldName,i&&r.setAttribute("checked",!0),r.setAttribute("exportValue",t.exportValue),r.tabIndex=Df,r.addEventListener("change",o=>{const{name:a,checked:c}=o.target;for(const u of this._getElementsByName(a,s)){const d=c&&u.exportValue===t.exportValue;u.domElement&&(u.domElement.checked=d),e.setValue(u.id,{value:d})}e.setValue(s,{value:c})}),r.addEventListener("resetform",o=>{const a=t.defaultFieldValue||"Off";o.target.checked=a===t.exportValue}),this.enableScripting&&this.hasJSActions&&(r.addEventListener("updatefromsandbox",o=>{const a={value(c){c.target.checked=c.detail.value!=="Off",e.setValue(s,{value:c.target.checked})}};this._dispatchEventFromSandbox(a,o)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class Yx extends wl{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,s=t.id;let i=e.getValue(s,{value:t.fieldValue===t.buttonValue}).value;if(typeof i=="string"&&(i=i!==t.buttonValue,e.setValue(s,{value:i})),i)for(const o of this._getElementsByName(t.fieldName,s))e.setValue(o.id,{value:!1});const r=document.createElement("input");if(fl.add(r),r.setAttribute("data-element-id",s),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="radio",r.name=t.fieldName,i&&r.setAttribute("checked",!0),r.tabIndex=Df,r.addEventListener("change",o=>{const{name:a,checked:c}=o.target;for(const u of this._getElementsByName(a,s))e.setValue(u.id,{value:!1});e.setValue(s,{value:c})}),r.addEventListener("resetform",o=>{const a=t.defaultFieldValue;o.target.checked=a!=null&&a===t.buttonValue}),this.enableScripting&&this.hasJSActions){const o=t.buttonValue;r.addEventListener("updatefromsandbox",a=>{const c={value:u=>{const d=o===u.detail.value;for(const h of this._getElementsByName(u.target.name)){const f=d&&h.id===s;h.domElement&&(h.domElement.checked=f),e.setValue(h.id,{value:f})}}};this._dispatchEventFromSandbox(c,a)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)}return this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class bL extends Gx{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",s=>{this._dispatchEventFromSandbox({},s)})),e}}class AL extends wl{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,s=e.getValue(t,{value:this.data.fieldValue}),i=document.createElement("select");fl.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=Df;let r=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",d=>{const h=this.data.defaultFieldValue;for(const f of i.options)f.selected=f.value===h});for(const d of this.data.options){const h=document.createElement("option");h.textContent=d.displayValue,h.value=d.exportValue,s.value.includes(d.exportValue)&&(h.setAttribute("selected",!0),r=!1),i.append(h)}let o=null;if(r){const d=document.createElement("option");d.value=" ",d.setAttribute("hidden",!0),d.setAttribute("selected",!0),i.prepend(d),o=()=>{d.remove(),i.removeEventListener("input",o),o=null},i.addEventListener("input",o)}const a=d=>{const h=d?"value":"textContent",{options:f,multiple:p}=i;return p?Array.prototype.filter.call(f,w=>w.selected).map(w=>w[h]):f.selectedIndex===-1?null:f[f.selectedIndex][h]};let c=a(!1);const u=d=>{const h=d.target.options;return Array.prototype.map.call(h,f=>({displayValue:f.textContent,exportValue:f.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",d=>{const h={value(f){o==null||o();const p=f.detail.value,w=new Set(Array.isArray(p)?p:[p]);for(const g of i.options)g.selected=w.has(g.value);e.setValue(t,{value:a(!0)}),c=a(!1)},multipleSelection(f){i.multiple=!0},remove(f){const p=i.options,w=f.detail.remove;p[w].selected=!1,i.remove(w),p.length>0&&Array.prototype.findIndex.call(p,E=>E.selected)===-1&&(p[0].selected=!0),e.setValue(t,{value:a(!0),items:u(f)}),c=a(!1)},clear(f){for(;i.length!==0;)i.remove(0);e.setValue(t,{value:null,items:[]}),c=a(!1)},insert(f){const{index:p,displayValue:w,exportValue:g}=f.detail.insert,E=i.children[p],m=document.createElement("option");m.textContent=w,m.value=g,E?E.before(m):i.append(m),e.setValue(t,{value:a(!0),items:u(f)}),c=a(!1)},items(f){const{items:p}=f.detail;for(;i.length!==0;)i.remove(0);for(const w of p){const{displayValue:g,exportValue:E}=w,m=document.createElement("option");m.textContent=g,m.value=E,i.append(m)}i.options.length>0&&(i.options[0].selected=!0),e.setValue(t,{value:a(!0),items:u(f)}),c=a(!1)},indices(f){const p=new Set(f.detail.indices);for(const w of f.target.options)w.selected=p.has(w.index);e.setValue(t,{value:a(!0)}),c=a(!1)},editable(f){f.target.disabled=!f.detail.editable}};this._dispatchEventFromSandbox(h,d)}),i.addEventListener("input",d=>{var p;const h=a(!0),f=a(!1);e.setValue(t,{value:h}),d.preventDefault(),(p=this.linkService.eventBus)==null||p.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:c,change:f,changeEx:h,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],d=>d.target.value)):i.addEventListener("input",function(d){e.setValue(t,{value:a(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class Kv extends tt{constructor(e){const{data:t,elements:s}=e;super(e,{isRenderable:tt._hasPopupData(t)}),this.elements=s,this.popup=null}render(){this.container.classList.add("popupAnnotation");const e=this.popup=new SL({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),t=[];for(const s of this.elements)s.popup=e,s.container.ariaHasPopup="dialog",t.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",t.map(s=>`${Nw}${s}`).join(",")),this.container}}var Oc,qg,Kg,Fc,jc,Xe,nr,zc,$h,Hh,Bc,sr,Ls,ir,Uh,rr,Vh,Ia,Oa,Ce,Op,Qv,qx,Kx,Qx,Jx,Fp,jp,Jv;class SL{constructor({container:e,color:t,elements:s,titleObj:i,modificationDate:r,contentsObj:o,richText:a,parent:c,rect:u,parentRect:d,open:h}){A(this,Ce);A(this,Oc,S(this,Ce,Qx).bind(this));A(this,qg,S(this,Ce,Jv).bind(this));A(this,Kg,S(this,Ce,jp).bind(this));A(this,Fc,S(this,Ce,Fp).bind(this));A(this,jc,null);A(this,Xe,null);A(this,nr,null);A(this,zc,null);A(this,$h,null);A(this,Hh,null);A(this,Bc,null);A(this,sr,!1);A(this,Ls,null);A(this,ir,null);A(this,Uh,null);A(this,rr,null);A(this,Vh,null);A(this,Ia,null);A(this,Oa,!1);var f;y(this,Xe,e),y(this,Vh,i),y(this,nr,o),y(this,rr,a),y(this,Hh,c),y(this,jc,t),y(this,Uh,u),y(this,Bc,d),y(this,$h,s),y(this,zc,Em.toDateObject(r)),this.trigger=s.flatMap(p=>p.getElementsToTriggerPopup());for(const p of this.trigger)p.addEventListener("click",l(this,Fc)),p.addEventListener("mouseenter",l(this,Kg)),p.addEventListener("mouseleave",l(this,qg)),p.classList.add("popupTriggerArea");for(const p of s)(f=p.container)==null||f.addEventListener("keydown",l(this,Oc));l(this,Xe).hidden=!0,h&&S(this,Ce,Fp).call(this)}render(){if(l(this,Ls))return;const e=y(this,Ls,document.createElement("div"));if(e.className="popup",l(this,jc)){const r=e.style.outlineColor=Y.makeHexColor(...l(this,jc));e.style.backgroundColor=`color-mix(in srgb, ${r} 30%, white)`}const t=document.createElement("span");t.className="header";const s=document.createElement("h1");if(t.append(s),{dir:s.dir,str:s.textContent}=l(this,Vh),e.append(t),l(this,zc)){const r=document.createElement("span");r.classList.add("popupDate"),r.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),r.setAttribute("data-l10n-args",JSON.stringify({dateObj:l(this,zc).valueOf()})),t.append(r)}const i=l(this,Ce,Op);if(i)$w.render({xfaHtml:i,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const r=this._formatContents(l(this,nr));e.append(r)}l(this,Xe).append(e)}_formatContents({str:e,dir:t}){const s=document.createElement("p");s.classList.add("popupContent"),s.dir=t;const i=e.split(/(?:\r\n?|\n)/);for(let r=0,o=i.length;r<o;++r){const a=i[r];s.append(document.createTextNode(a)),r<o-1&&s.append(document.createElement("br"))}return s}updateEdited({rect:e,popupContent:t}){var s;l(this,Ia)||y(this,Ia,{contentsObj:l(this,nr),richText:l(this,rr)}),e&&y(this,ir,null),t&&(y(this,rr,S(this,Ce,Kx).call(this,t)),y(this,nr,null)),(s=l(this,Ls))==null||s.remove(),y(this,Ls,null)}resetEdited(){var e;l(this,Ia)&&({contentsObj:Qt(this,nr)._,richText:Qt(this,rr)._}=l(this,Ia),y(this,Ia,null),(e=l(this,Ls))==null||e.remove(),y(this,Ls,null),y(this,ir,null))}forceHide(){y(this,Oa,this.isVisible),l(this,Oa)&&(l(this,Xe).hidden=!0)}maybeShow(){l(this,Oa)&&(l(this,Ls)||S(this,Ce,jp).call(this),y(this,Oa,!1),l(this,Xe).hidden=!1)}get isVisible(){return l(this,Xe).hidden===!1}}Oc=new WeakMap,qg=new WeakMap,Kg=new WeakMap,Fc=new WeakMap,jc=new WeakMap,Xe=new WeakMap,nr=new WeakMap,zc=new WeakMap,$h=new WeakMap,Hh=new WeakMap,Bc=new WeakMap,sr=new WeakMap,Ls=new WeakMap,ir=new WeakMap,Uh=new WeakMap,rr=new WeakMap,Vh=new WeakMap,Ia=new WeakMap,Oa=new WeakMap,Ce=new WeakSet,Op=function(){const e=l(this,rr),t=l(this,nr);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&l(this,rr).html||null},Qv=function(){var e,t,s;return((s=(t=(e=l(this,Ce,Op))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:s.fontSize)||0},qx=function(){var e,t,s;return((s=(t=(e=l(this,Ce,Op))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:s.color)||null},Kx=function(e){const t=[],s={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},i={style:{color:l(this,Ce,qx),fontSize:l(this,Ce,Qv)?`calc(${l(this,Ce,Qv)}px * var(--total-scale-factor))`:""}};for(const r of e.split(`
`))t.push({name:"span",value:r,attributes:i});return s},Qx=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&l(this,sr))&&S(this,Ce,Fp).call(this)},Jx=function(){if(l(this,ir)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:s,pageX:i,pageY:r}}}=l(this,Hh);let o=!!l(this,Bc),a=o?l(this,Bc):l(this,Uh);for(const w of l(this,$h))if(!a||Y.intersect(w.data.rect,a)!==null){a=w.data.rect,o=!0;break}const c=Y.normalizeRect([a[0],e[3]-a[1]+e[1],a[2],e[3]-a[3]+e[1]]),d=o?a[2]-a[0]+5:0,h=c[0]+d,f=c[1];y(this,ir,[100*(h-i)/t,100*(f-r)/s]);const{style:p}=l(this,Xe);p.left=`${l(this,ir)[0]}%`,p.top=`${l(this,ir)[1]}%`},Fp=function(){y(this,sr,!l(this,sr)),l(this,sr)?(S(this,Ce,jp).call(this),l(this,Xe).addEventListener("click",l(this,Fc)),l(this,Xe).addEventListener("keydown",l(this,Oc))):(S(this,Ce,Jv).call(this),l(this,Xe).removeEventListener("click",l(this,Fc)),l(this,Xe).removeEventListener("keydown",l(this,Oc)))},jp=function(){l(this,Ls)||this.render(),this.isVisible?l(this,sr)&&l(this,Xe).classList.add("focused"):(S(this,Ce,Jx).call(this),l(this,Xe).hidden=!1,l(this,Xe).style.zIndex=parseInt(l(this,Xe).style.zIndex)+1e3)},Jv=function(){l(this,Xe).classList.remove("focused"),!(l(this,sr)||!this.isVisible)&&(l(this,Xe).hidden=!0,l(this,Xe).style.zIndex=parseInt(l(this,Xe).style.zIndex)-1e3)};class Zx extends tt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=Z.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const s=document.createElement("span");s.textContent=t,e.append(s)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Gh;class EL extends tt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});A(this,Gh,null)}render(){this.container.classList.add("lineAnnotation");const{data:t,width:s,height:i}=this,r=this.svgFactory.create(s,i,!0),o=y(this,Gh,this.svgFactory.createElement("svg:line"));return o.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),o.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),o.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),o.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),o.setAttribute("stroke-width",t.borderStyle.width||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,Gh)}addHighlightArea(){this.container.classList.add("highlightArea")}}Gh=new WeakMap;var Wh;class xL extends tt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});A(this,Wh,null)}render(){this.container.classList.add("squareAnnotation");const{data:t,width:s,height:i}=this,r=this.svgFactory.create(s,i,!0),o=t.borderStyle.width,a=y(this,Wh,this.svgFactory.createElement("svg:rect"));return a.setAttribute("x",o/2),a.setAttribute("y",o/2),a.setAttribute("width",s-o),a.setAttribute("height",i-o),a.setAttribute("stroke-width",o||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),r.append(a),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,Wh)}addHighlightArea(){this.container.classList.add("highlightArea")}}Wh=new WeakMap;var Xh;class _L extends tt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});A(this,Xh,null)}render(){this.container.classList.add("circleAnnotation");const{data:t,width:s,height:i}=this,r=this.svgFactory.create(s,i,!0),o=t.borderStyle.width,a=y(this,Xh,this.svgFactory.createElement("svg:ellipse"));return a.setAttribute("cx",s/2),a.setAttribute("cy",i/2),a.setAttribute("rx",s/2-o/2),a.setAttribute("ry",i/2-o/2),a.setAttribute("stroke-width",o||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),r.append(a),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,Xh)}addHighlightArea(){this.container.classList.add("highlightArea")}}Xh=new WeakMap;var Yh;class e_ extends tt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});A(this,Yh,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:s,borderStyle:i,popupRef:r},width:o,height:a}=this;if(!s)return this.container;const c=this.svgFactory.create(o,a,!0);let u=[];for(let h=0,f=s.length;h<f;h+=2){const p=s[h]-t[0],w=t[3]-s[h+1];u.push(`${p},${w}`)}u=u.join(" ");const d=y(this,Yh,this.svgFactory.createElement(this.svgElementName));return d.setAttribute("points",u),d.setAttribute("stroke-width",i.width||1),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),c.append(d),this.container.append(c),!r&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,Yh)}addHighlightArea(){this.container.classList.add("highlightArea")}}Yh=new WeakMap;class CL extends e_{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class kL extends tt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var qh,Fa,Kh,Zv;class Hw extends tt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});A(this,Kh);A(this,qh,null);A(this,Fa,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Z.HIGHLIGHT:Z.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:s,inkLists:i,borderStyle:r,popupRef:o}}=this,{transform:a,width:c,height:u}=S(this,Kh,Zv).call(this,s,t),d=this.svgFactory.create(c,u,!0),h=y(this,qh,this.svgFactory.createElement("svg:g"));d.append(h),h.setAttribute("stroke-width",r.width||1),h.setAttribute("stroke-linecap","round"),h.setAttribute("stroke-linejoin","round"),h.setAttribute("stroke-miterlimit",10),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),h.setAttribute("transform",a);for(let f=0,p=i.length;f<p;f++){const w=this.svgFactory.createElement(this.svgElementName);l(this,Fa).push(w),w.setAttribute("points",i[f].join(",")),h.append(w)}return!o&&this.hasPopupData&&this._createPopup(),this.container.append(d),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:s,points:i,rect:r}=t,o=l(this,qh);if(s>=0&&o.setAttribute("stroke-width",s||1),i)for(let a=0,c=l(this,Fa).length;a<c;a++)l(this,Fa)[a].setAttribute("points",i[a].join(","));if(r){const{transform:a,width:c,height:u}=S(this,Kh,Zv).call(this,this.data.rotation,r);o.parentElement.setAttribute("viewBox",`0 0 ${c} ${u}`),o.setAttribute("transform",a)}}getElementsToTriggerPopup(){return l(this,Fa)}addHighlightArea(){this.container.classList.add("highlightArea")}}qh=new WeakMap,Fa=new WeakMap,Kh=new WeakSet,Zv=function(t,s){switch(t){case 90:return{transform:`rotate(90) translate(${-s[0]},${s[1]}) scale(1,-1)`,width:s[3]-s[1],height:s[2]-s[0]};case 180:return{transform:`rotate(180) translate(${-s[2]},${s[1]}) scale(1,-1)`,width:s[2]-s[0],height:s[3]-s[1]};case 270:return{transform:`rotate(270) translate(${-s[2]},${s[3]}) scale(1,-1)`,width:s[3]-s[1],height:s[2]-s[0]};default:return{transform:`translate(${-s[0]},${s[3]}) scale(1,-1)`,width:s[2]-s[0],height:s[3]-s[1]}}};class t_ extends tt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Z.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class TL extends tt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class RL extends tt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class PL extends tt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class n_ extends tt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Z.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Qh,Jh,e0;class LL extends tt{constructor(t){var i;super(t,{isRenderable:!0});A(this,Jh);A(this,Qh,null);const{file:s}=this.data;this.filename=s.filename,this.content=s.content,(i=this.linkService.eventBus)==null||i.dispatch("fileattachmentannotation",{source:this,...s})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:s}=this;let i;s.hasAppearance||s.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(s.name)?"paperclip":"pushpin"}.svg`,s.fillAlpha&&s.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(s.fillAlpha*100)}%);`)),i.addEventListener("dblclick",S(this,Jh,e0).bind(this)),y(this,Qh,i);const{isMac:r}=xt.platform;return t.addEventListener("keydown",o=>{o.key==="Enter"&&(r?o.metaKey:o.ctrlKey)&&S(this,Jh,e0).call(this)}),!s.popupRef&&this.hasPopupData?this._createPopup():i.classList.add("popupTriggerArea"),t.append(i),t}getElementsToTriggerPopup(){return l(this,Qh)}addHighlightArea(){this.container.classList.add("highlightArea")}}Qh=new WeakMap,Jh=new WeakSet,e0=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var Zh,ja,oo,ef,zo,t0,n0,$c;let Uw=($c=class{constructor({div:e,accessibilityManager:t,annotationCanvasMap:s,annotationEditorUIManager:i,page:r,viewport:o,structTreeLayer:a}){A(this,zo);A(this,Zh,null);A(this,ja,null);A(this,oo,new Map);A(this,ef,null);this.div=e,y(this,Zh,t),y(this,ja,s),y(this,ef,a||null),this.page=r,this.viewport=o,this.zIndex=0,this._annotationEditorUIManager=i}hasEditableAnnotations(){return l(this,oo).size>0}async render(e){var o;const{annotations:t}=e,s=this.div;No(s,this.viewport);const i=new Map,r={data:null,layer:s,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new Gd,annotationStorage:e.annotationStorage||new Ow,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const a of t){if(a.noHTML)continue;const c=a.annotationType===Ke.POPUP;if(c){const h=i.get(a.id);if(!h)continue;r.elements=h}else if(a.rect[2]===a.rect[0]||a.rect[3]===a.rect[1])continue;r.data=a;const u=UA.create(r);if(!u.isRenderable)continue;if(!c&&a.popupRef){const h=i.get(a.popupRef);h?h.push(u):i.set(a.popupRef,[u])}const d=u.render();a.hidden&&(d.style.visibility="hidden"),await S(this,zo,t0).call(this,d,a.id),u._isEditable&&(l(this,oo).set(u.data.id,u),(o=this._annotationEditorUIManager)==null||o.renderAnnotationElement(u))}S(this,zo,n0).call(this)}async addLinkAnnotations(e,t){const s={data:null,layer:this.div,linkService:t,svgFactory:new Gd,parent:this};for(const i of e){i.borderStyle||(i.borderStyle=$c._defaultBorderStyle),s.data=i;const r=UA.create(s);if(!r.isRenderable)continue;const o=r.render();await S(this,zo,t0).call(this,o,i.id)}}update({viewport:e}){const t=this.div;this.viewport=e,No(t,{rotation:e.rotation}),S(this,zo,n0).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(l(this,oo).values())}getEditableAnnotation(e){return l(this,oo).get(e)}static get _defaultBorderStyle(){return le(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:xl.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}},Zh=new WeakMap,ja=new WeakMap,oo=new WeakMap,ef=new WeakMap,zo=new WeakSet,t0=async function(e,t){var o,a;const s=e.firstChild||e,i=s.id=`${Nw}${t}`,r=await((o=l(this,ef))==null?void 0:o.getAriaAttributes(i));if(r)for(const[c,u]of r)s.setAttribute(c,u);this.div.append(e),(a=l(this,Zh))==null||a.moveElementInDOM(this.div,e,s,!1)},n0=function(){var t;if(!l(this,ja))return;const e=this.div;for(const[s,i]of l(this,ja)){const r=e.querySelector(`[data-annotation-id="${s}"]`);if(!r)continue;i.className="annotationContent";const{firstChild:o}=r;o?o.nodeName==="CANVAS"?o.replaceWith(i):o.classList.contains("annotationContent")?o.after(i):o.before(i):r.append(i);const a=l(this,oo).get(s);a&&(a._hasNoCanvas?((t=this._annotationEditorUIManager)==null||t.setMissingCanvas(s,r.id,i),a._hasNoCanvas=!1):a.canvas=i)}l(this,ja).clear()},$c);const cp=/\r\n?|\n/g;var Ms,On,tf,za,Fn,rt,s_,i_,r_,zp,vr,Bp,$p,o_,i0,a_;const Pe=class Pe extends Me{constructor(t){super({...t,name:"freeTextEditor"});A(this,rt);A(this,Ms);A(this,On,"");A(this,tf,`${this.id}-editor`);A(this,za,null);A(this,Fn);y(this,Ms,t.color||Pe._defaultColor||Me._defaultLineColor),y(this,Fn,t.fontSize||Pe._defaultFontSize)}static get _keyboardManager(){const t=Pe.prototype,s=o=>o.isEmpty(),i=Io.TRANSLATE_SMALL,r=Io.TRANSLATE_BIG;return le(this,"_keyboardManager",new Lf([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:s}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:s}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[i,0],checker:s}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[r,0],checker:s}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:s}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:s}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,i],checker:s}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,r],checker:s}]]))}static initialize(t,s){Me.initialize(t,s);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,s){switch(t){case de.FREETEXT_SIZE:Pe._defaultFontSize=s;break;case de.FREETEXT_COLOR:Pe._defaultColor=s;break}}updateParams(t,s){switch(t){case de.FREETEXT_SIZE:S(this,rt,s_).call(this,s);break;case de.FREETEXT_COLOR:S(this,rt,i_).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[de.FREETEXT_SIZE,Pe._defaultFontSize],[de.FREETEXT_COLOR,Pe._defaultColor||Me._defaultLineColor]]}get propertiesToUpdate(){return[[de.FREETEXT_SIZE,l(this,Fn)],[de.FREETEXT_COLOR,l(this,Ms)]]}_translateEmpty(t,s){this._uiManager.translateSelectedEditors(t,s,!0)}getInitialTranslation(){const t=this.parentScale;return[-Pe._internalPadding*t,-(Pe._internalPadding+l(this,Fn))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),y(this,za,new AbortController);const t=this._uiManager.combinedSignal(l(this,za));return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){var t;return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",l(this,tf)),this._isDraggable=!0,(t=l(this,za))==null||t.abort(),y(this,za,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var s;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(s=this._initialOptions)!=null&&s.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=l(this,On),s=y(this,On,S(this,rt,r_).call(this).trimEnd());if(t===s)return;const i=r=>{if(y(this,On,r),!r){this.remove();return}S(this,rt,$p).call(this),this._uiManager.rebuild(this),S(this,rt,zp).call(this)};this.addCommands({cmd:()=>{i(s)},undo:()=>{i(t)},mustExec:!1}),S(this,rt,zp).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Pe._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,s;(this._isCopy||this.annotationElementId)&&(t=this.x,s=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",l(this,tf)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${l(this,Fn)}px * var(--total-scale-factor))`,i.color=l(this,Ms),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[r,o]=this.parentDimensions;if(this.annotationElementId){const{position:a}=this._initialData;let[c,u]=this.getInitialTranslation();[c,u]=this.pageTranslationToScreen(c,u);const[d,h]=this.pageDimensions,[f,p]=this.pageTranslation;let w,g;switch(this.rotation){case 0:w=t+(a[0]-f)/d,g=s+this.height-(a[1]-p)/h;break;case 90:w=t+(a[0]-f)/d,g=s-(a[1]-p)/h,[c,u]=[u,-c];break;case 180:w=t-this.width+(a[0]-f)/d,g=s-(a[1]-p)/h,[c,u]=[-c,-u];break;case 270:w=t+(a[0]-f-this.height*h)/d,g=s+(a[1]-p-this.width*d)/h,[c,u]=[-u,c];break}this.setAt(w*r,g*o,c,u)}else this._moveAfterPaste(t,s);S(this,rt,$p).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var w,g,E;const s=t.clipboardData||window.clipboardData,{types:i}=s;if(i.length===1&&i[0]==="text/plain")return;t.preventDefault();const r=S(w=Pe,vr,i0).call(w,s.getData("text")||"").replaceAll(cp,`
`);if(!r)return;const o=window.getSelection();if(!o.rangeCount)return;this.editorDiv.normalize(),o.deleteFromDocument();const a=o.getRangeAt(0);if(!r.includes(`
`)){a.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),o.collapseToStart();return}const{startContainer:c,startOffset:u}=a,d=[],h=[];if(c.nodeType===Node.TEXT_NODE){const m=c.parentElement;if(h.push(c.nodeValue.slice(u).replaceAll(cp,"")),m!==this.editorDiv){let v=d;for(const b of this.editorDiv.childNodes){if(b===m){v=h;continue}v.push(S(g=Pe,vr,Bp).call(g,b))}}d.push(c.nodeValue.slice(0,u).replaceAll(cp,""))}else if(c===this.editorDiv){let m=d,v=0;for(const b of this.editorDiv.childNodes)v++===u&&(m=h),m.push(S(E=Pe,vr,Bp).call(E,b))}y(this,On,`${d.join(`
`)}${r}${h.join(`
`)}`),S(this,rt,$p).call(this);const f=new Range;let p=Math.sumPrecise(d.map(m=>m.length));for(const{firstChild:m}of this.editorDiv.childNodes)if(m.nodeType===Node.TEXT_NODE){const v=m.nodeValue.length;if(p<=v){f.setStart(m,p),f.setEnd(m,p);break}p-=v}o.removeAllRanges(),o.addRange(f)}get contentDiv(){return this.editorDiv}static async deserialize(t,s,i){var a;let r=null;if(t instanceof Zx){const{data:{defaultAppearanceData:{fontSize:c,fontColor:u},rect:d,rotation:h,id:f,popupRef:p},textContent:w,textPosition:g,parent:{page:{pageNumber:E}}}=t;if(!w||w.length===0)return null;r=t={annotationType:Z.FREETEXT,color:Array.from(u),fontSize:c,value:w.join(`
`),position:g,pageIndex:E-1,rect:d.slice(0),rotation:h,id:f,deleted:!1,popupRef:p}}const o=await super.deserialize(t,s,i);return y(o,Fn,t.fontSize),y(o,Ms,Y.makeHexColor(...t.color)),y(o,On,S(a=Pe,vr,i0).call(a,t.value)),o.annotationElementId=t.id||null,o._initialData=r,o}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s=Pe._internalPadding*this.parentScale,i=this.getRect(s,s),r=Me._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:l(this,Ms)),o={annotationType:Z.FREETEXT,color:r,fontSize:l(this,Fn),value:S(this,rt,o_).call(this),pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?(o.isCopy=!0,o):this.annotationElementId&&!S(this,rt,a_).call(this,o)?null:(o.id=this.annotationElementId,o)}renderAnnotationElement(t){const s=super.renderAnnotationElement(t);if(this.deleted)return s;const{style:i}=s;i.fontSize=`calc(${l(this,Fn)}px * var(--total-scale-factor))`,i.color=l(this,Ms),s.replaceChildren();for(const o of l(this,On).split(`
`)){const a=document.createElement("div");a.append(o?document.createTextNode(o):document.createElement("br")),s.append(a)}const r=Pe._internalPadding*this.parentScale;return t.updateEdited({rect:this.getRect(r,r),popupContent:l(this,On)}),s}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};Ms=new WeakMap,On=new WeakMap,tf=new WeakMap,za=new WeakMap,Fn=new WeakMap,rt=new WeakSet,s_=function(t){const s=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--total-scale-factor))`,this.translate(0,-(r-l(this,Fn))*this.parentScale),y(this,Fn,r),S(this,rt,zp).call(this)},i=l(this,Fn);this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:de.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},i_=function(t){const s=r=>{y(this,Ms,this.editorDiv.style.color=r)},i=l(this,Ms);this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:de.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},r_=function(){var i;const t=[];this.editorDiv.normalize();let s=null;for(const r of this.editorDiv.childNodes)(s==null?void 0:s.nodeType)===Node.TEXT_NODE&&r.nodeName==="BR"||(t.push(S(i=Pe,vr,Bp).call(i,r)),s=r);return t.join(`
`)},zp=function(){const[t,s]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:r,div:o}=this,a=o.style.display,c=o.classList.contains("hidden");o.classList.remove("hidden"),o.style.display="hidden",r.div.append(this.div),i=o.getBoundingClientRect(),o.remove(),o.style.display=a,o.classList.toggle("hidden",c)}this.rotation%180===this.parentRotation%180?(this.width=i.width/t,this.height=i.height/s):(this.width=i.height/t,this.height=i.width/s),this.fixAndSetPosition()},vr=new WeakSet,Bp=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(cp,"")},$p=function(){if(this.editorDiv.replaceChildren(),!!l(this,On))for(const t of l(this,On).split(`
`)){const s=document.createElement("div");s.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(s)}},o_=function(){return l(this,On).replaceAll(" "," ")},i0=function(t){return t.replaceAll(" "," ")},a_=function(t){const{value:s,fontSize:i,color:r,pageIndex:o}=this._initialData;return this._hasBeenMoved||t.value!==s||t.fontSize!==i||t.color.some((a,c)=>a!==r[c])||t.pageIndex!==o},A(Pe,vr),F(Pe,"_freeTextDefaultContent",""),F(Pe,"_internalPadding",0),F(Pe,"_defaultColor",null),F(Pe,"_defaultFontSize",10),F(Pe,"_type","freetext"),F(Pe,"_editorType",Z.FREETEXT);let s0=Pe;class H{toSVGPath(){_e("Abstract method `toSVGPath` must be implemented.")}get box(){_e("Abstract getter `box` must be implemented.")}serialize(e,t){_e("Abstract method `serialize` must be implemented.")}static _rescale(e,t,s,i,r,o){o||(o=new Float32Array(e.length));for(let a=0,c=e.length;a<c;a+=2)o[a]=t+e[a]*i,o[a+1]=s+e[a+1]*r;return o}static _rescaleAndSwap(e,t,s,i,r,o){o||(o=new Float32Array(e.length));for(let a=0,c=e.length;a<c;a+=2)o[a]=t+e[a+1]*i,o[a+1]=s+e[a]*r;return o}static _translate(e,t,s,i){i||(i=new Float32Array(e.length));for(let r=0,o=e.length;r<o;r+=2)i[r]=t+e[r],i[r+1]=s+e[r+1];return i}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,s,i,r){switch(r){case 90:return[1-t/s,e/i];case 180:return[1-e/s,1-t/i];case 270:return[t/s,1-e/i];default:return[e/s,t/i]}}static _normalizePagePoint(e,t,s){switch(s){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,s,i,r,o){return[(e+5*s)/6,(t+5*i)/6,(5*s+r)/6,(5*i+o)/6,(s+r)/2,(i+o)/2]}}F(H,"PRECISION",1e-4);var jn,Ds,Hc,Uc,pi,ae,Ba,$a,nf,sf,Vc,Gc,ao,rf,Qg,Jg,ft,id,l_,c_,u_,d_,h_,f_;const Fi=class Fi{constructor({x:e,y:t},s,i,r,o,a=0){A(this,ft);A(this,jn);A(this,Ds,[]);A(this,Hc);A(this,Uc);A(this,pi,[]);A(this,ae,new Float32Array(18));A(this,Ba);A(this,$a);A(this,nf);A(this,sf);A(this,Vc);A(this,Gc);A(this,ao,[]);y(this,jn,s),y(this,Gc,r*i),y(this,Uc,o),l(this,ae).set([NaN,NaN,NaN,NaN,e,t],6),y(this,Hc,a),y(this,sf,l(Fi,rf)*i),y(this,nf,l(Fi,Jg)*i),y(this,Vc,i),l(this,ao).push(e,t)}isEmpty(){return isNaN(l(this,ae)[8])}add({x:e,y:t}){var L;y(this,Ba,e),y(this,$a,t);const[s,i,r,o]=l(this,jn);let[a,c,u,d]=l(this,ae).subarray(8,12);const h=e-u,f=t-d,p=Math.hypot(h,f);if(p<l(this,nf))return!1;const w=p-l(this,sf),g=w/p,E=g*h,m=g*f;let v=a,b=c;a=u,c=d,u+=E,d+=m,(L=l(this,ao))==null||L.push(e,t);const x=-m/w,_=E/w,k=x*l(this,Gc),C=_*l(this,Gc);return l(this,ae).set(l(this,ae).subarray(2,8),0),l(this,ae).set([u+k,d+C],4),l(this,ae).set(l(this,ae).subarray(14,18),12),l(this,ae).set([u-k,d-C],16),isNaN(l(this,ae)[6])?(l(this,pi).length===0&&(l(this,ae).set([a+k,c+C],2),l(this,pi).push(NaN,NaN,NaN,NaN,(a+k-s)/r,(c+C-i)/o),l(this,ae).set([a-k,c-C],14),l(this,Ds).push(NaN,NaN,NaN,NaN,(a-k-s)/r,(c-C-i)/o)),l(this,ae).set([v,b,a,c,u,d],6),!this.isEmpty()):(l(this,ae).set([v,b,a,c,u,d],6),Math.abs(Math.atan2(b-c,v-a)-Math.atan2(m,E))<Math.PI/2?([a,c,u,d]=l(this,ae).subarray(2,6),l(this,pi).push(NaN,NaN,NaN,NaN,((a+u)/2-s)/r,((c+d)/2-i)/o),[a,c,v,b]=l(this,ae).subarray(14,18),l(this,Ds).push(NaN,NaN,NaN,NaN,((v+a)/2-s)/r,((b+c)/2-i)/o),!0):([v,b,a,c,u,d]=l(this,ae).subarray(0,6),l(this,pi).push(((v+5*a)/6-s)/r,((b+5*c)/6-i)/o,((5*a+u)/6-s)/r,((5*c+d)/6-i)/o,((a+u)/2-s)/r,((c+d)/2-i)/o),[u,d,a,c,v,b]=l(this,ae).subarray(12,18),l(this,Ds).push(((v+5*a)/6-s)/r,((b+5*c)/6-i)/o,((5*a+u)/6-s)/r,((5*c+d)/6-i)/o,((a+u)/2-s)/r,((c+d)/2-i)/o),!0))}toSVGPath(){if(this.isEmpty())return"";const e=l(this,pi),t=l(this,Ds);if(isNaN(l(this,ae)[6])&&!this.isEmpty())return S(this,ft,l_).call(this);const s=[];s.push(`M${e[4]} ${e[5]}`);for(let i=6;i<e.length;i+=6)isNaN(e[i])?s.push(`L${e[i+4]} ${e[i+5]}`):s.push(`C${e[i]} ${e[i+1]} ${e[i+2]} ${e[i+3]} ${e[i+4]} ${e[i+5]}`);S(this,ft,u_).call(this,s);for(let i=t.length-6;i>=6;i-=6)isNaN(t[i])?s.push(`L${t[i+4]} ${t[i+5]}`):s.push(`C${t[i]} ${t[i+1]} ${t[i+2]} ${t[i+3]} ${t[i+4]} ${t[i+5]}`);return S(this,ft,c_).call(this,s),s.join(" ")}newFreeDrawOutline(e,t,s,i,r,o){return new p_(e,t,s,i,r,o)}getOutlines(){var h;const e=l(this,pi),t=l(this,Ds),s=l(this,ae),[i,r,o,a]=l(this,jn),c=new Float32Array((((h=l(this,ao))==null?void 0:h.length)??0)+2);for(let f=0,p=c.length-2;f<p;f+=2)c[f]=(l(this,ao)[f]-i)/o,c[f+1]=(l(this,ao)[f+1]-r)/a;if(c[c.length-2]=(l(this,Ba)-i)/o,c[c.length-1]=(l(this,$a)-r)/a,isNaN(s[6])&&!this.isEmpty())return S(this,ft,d_).call(this,c);const u=new Float32Array(l(this,pi).length+24+l(this,Ds).length);let d=e.length;for(let f=0;f<d;f+=2){if(isNaN(e[f])){u[f]=u[f+1]=NaN;continue}u[f]=e[f],u[f+1]=e[f+1]}d=S(this,ft,f_).call(this,u,d);for(let f=t.length-6;f>=6;f-=6)for(let p=0;p<6;p+=2){if(isNaN(t[f+p])){u[d]=u[d+1]=NaN,d+=2;continue}u[d]=t[f+p],u[d+1]=t[f+p+1],d+=2}return S(this,ft,h_).call(this,u,d),this.newFreeDrawOutline(u,c,l(this,jn),l(this,Vc),l(this,Hc),l(this,Uc))}};jn=new WeakMap,Ds=new WeakMap,Hc=new WeakMap,Uc=new WeakMap,pi=new WeakMap,ae=new WeakMap,Ba=new WeakMap,$a=new WeakMap,nf=new WeakMap,sf=new WeakMap,Vc=new WeakMap,Gc=new WeakMap,ao=new WeakMap,rf=new WeakMap,Qg=new WeakMap,Jg=new WeakMap,ft=new WeakSet,id=function(){const e=l(this,ae).subarray(4,6),t=l(this,ae).subarray(16,18),[s,i,r,o]=l(this,jn);return[(l(this,Ba)+(e[0]-t[0])/2-s)/r,(l(this,$a)+(e[1]-t[1])/2-i)/o,(l(this,Ba)+(t[0]-e[0])/2-s)/r,(l(this,$a)+(t[1]-e[1])/2-i)/o]},l_=function(){const[e,t,s,i]=l(this,jn),[r,o,a,c]=S(this,ft,id).call(this);return`M${(l(this,ae)[2]-e)/s} ${(l(this,ae)[3]-t)/i} L${(l(this,ae)[4]-e)/s} ${(l(this,ae)[5]-t)/i} L${r} ${o} L${a} ${c} L${(l(this,ae)[16]-e)/s} ${(l(this,ae)[17]-t)/i} L${(l(this,ae)[14]-e)/s} ${(l(this,ae)[15]-t)/i} Z`},c_=function(e){const t=l(this,Ds);e.push(`L${t[4]} ${t[5]} Z`)},u_=function(e){const[t,s,i,r]=l(this,jn),o=l(this,ae).subarray(4,6),a=l(this,ae).subarray(16,18),[c,u,d,h]=S(this,ft,id).call(this);e.push(`L${(o[0]-t)/i} ${(o[1]-s)/r} L${c} ${u} L${d} ${h} L${(a[0]-t)/i} ${(a[1]-s)/r}`)},d_=function(e){const t=l(this,ae),[s,i,r,o]=l(this,jn),[a,c,u,d]=S(this,ft,id).call(this),h=new Float32Array(36);return h.set([NaN,NaN,NaN,NaN,(t[2]-s)/r,(t[3]-i)/o,NaN,NaN,NaN,NaN,(t[4]-s)/r,(t[5]-i)/o,NaN,NaN,NaN,NaN,a,c,NaN,NaN,NaN,NaN,u,d,NaN,NaN,NaN,NaN,(t[16]-s)/r,(t[17]-i)/o,NaN,NaN,NaN,NaN,(t[14]-s)/r,(t[15]-i)/o],0),this.newFreeDrawOutline(h,e,l(this,jn),l(this,Vc),l(this,Hc),l(this,Uc))},h_=function(e,t){const s=l(this,Ds);return e.set([NaN,NaN,NaN,NaN,s[4],s[5]],t),t+=6},f_=function(e,t){const s=l(this,ae).subarray(4,6),i=l(this,ae).subarray(16,18),[r,o,a,c]=l(this,jn),[u,d,h,f]=S(this,ft,id).call(this);return e.set([NaN,NaN,NaN,NaN,(s[0]-r)/a,(s[1]-o)/c,NaN,NaN,NaN,NaN,u,d,NaN,NaN,NaN,NaN,h,f,NaN,NaN,NaN,NaN,(i[0]-r)/a,(i[1]-o)/c],t),t+=24},A(Fi,rf,8),A(Fi,Qg,2),A(Fi,Jg,l(Fi,rf)+l(Fi,Qg));let Tg=Fi;var Wc,Ha,or,of,zn,af,Je,Zg,g_;class p_ extends H{constructor(t,s,i,r,o,a){super();A(this,Zg);A(this,Wc);A(this,Ha,new Float32Array(4));A(this,or);A(this,of);A(this,zn);A(this,af);A(this,Je);y(this,Je,t),y(this,zn,s),y(this,Wc,i),y(this,af,r),y(this,or,o),y(this,of,a),this.lastPoint=[NaN,NaN],S(this,Zg,g_).call(this,a);const[c,u,d,h]=l(this,Ha);for(let f=0,p=t.length;f<p;f+=2)t[f]=(t[f]-c)/d,t[f+1]=(t[f+1]-u)/h;for(let f=0,p=s.length;f<p;f+=2)s[f]=(s[f]-c)/d,s[f+1]=(s[f+1]-u)/h}toSVGPath(){const t=[`M${l(this,Je)[4]} ${l(this,Je)[5]}`];for(let s=6,i=l(this,Je).length;s<i;s+=6){if(isNaN(l(this,Je)[s])){t.push(`L${l(this,Je)[s+4]} ${l(this,Je)[s+5]}`);continue}t.push(`C${l(this,Je)[s]} ${l(this,Je)[s+1]} ${l(this,Je)[s+2]} ${l(this,Je)[s+3]} ${l(this,Je)[s+4]} ${l(this,Je)[s+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,s,i,r],o){const a=i-t,c=r-s;let u,d;switch(o){case 0:u=H._rescale(l(this,Je),t,r,a,-c),d=H._rescale(l(this,zn),t,r,a,-c);break;case 90:u=H._rescaleAndSwap(l(this,Je),t,s,a,c),d=H._rescaleAndSwap(l(this,zn),t,s,a,c);break;case 180:u=H._rescale(l(this,Je),i,s,-a,c),d=H._rescale(l(this,zn),i,s,-a,c);break;case 270:u=H._rescaleAndSwap(l(this,Je),i,r,-a,-c),d=H._rescaleAndSwap(l(this,zn),i,r,-a,-c);break}return{outline:Array.from(u),points:[Array.from(d)]}}get box(){return l(this,Ha)}newOutliner(t,s,i,r,o,a=0){return new Tg(t,s,i,r,o,a)}getNewOutline(t,s){const[i,r,o,a]=l(this,Ha),[c,u,d,h]=l(this,Wc),f=o*d,p=a*h,w=i*d+c,g=r*h+u,E=this.newOutliner({x:l(this,zn)[0]*f+w,y:l(this,zn)[1]*p+g},l(this,Wc),l(this,af),t,l(this,of),s??l(this,or));for(let m=2;m<l(this,zn).length;m+=2)E.add({x:l(this,zn)[m]*f+w,y:l(this,zn)[m+1]*p+g});return E.getOutlines()}}Wc=new WeakMap,Ha=new WeakMap,or=new WeakMap,of=new WeakMap,zn=new WeakMap,af=new WeakMap,Je=new WeakMap,Zg=new WeakSet,g_=function(t){const s=l(this,Je);let i=s[4],r=s[5];const o=[i,r,i,r];let a=i,c=r;const u=t?Math.max:Math.min;for(let h=6,f=s.length;h<f;h+=6){const p=s[h+4],w=s[h+5];if(isNaN(s[h]))Y.pointBoundingBox(p,w,o),c<w?(a=p,c=w):c===w&&(a=u(a,p));else{const g=[1/0,1/0,-1/0,-1/0];Y.bezierBoundingBox(i,r,...s.slice(h,h+6),g),Y.rectBoundingBox(...g,o),c<g[3]?(a=g[2],c=g[3]):c===g[3]&&(a=u(a,g[2]))}i=p,r=w}const d=l(this,Ha);d[0]=o[0]-l(this,or),d[1]=o[1]-l(this,or),d[2]=o[2]-o[0]+2*l(this,or),d[3]=o[3]-o[1]+2*l(this,or),this.lastPoint=[a,c]};var lf,cf,lo,Ns,cn,m_,Hp,y_,v_,o0;class r0{constructor(e,t=0,s=0,i=!0){A(this,cn);A(this,lf);A(this,cf);A(this,lo,[]);A(this,Ns,[]);const r=[1/0,1/0,-1/0,-1/0],o=10**-4;for(const{x:p,y:w,width:g,height:E}of e){const m=Math.floor((p-t)/o)*o,v=Math.ceil((p+g+t)/o)*o,b=Math.floor((w-t)/o)*o,x=Math.ceil((w+E+t)/o)*o,_=[m,b,x,!0],k=[v,b,x,!1];l(this,lo).push(_,k),Y.rectBoundingBox(m,b,v,x,r)}const a=r[2]-r[0]+2*s,c=r[3]-r[1]+2*s,u=r[0]-s,d=r[1]-s,h=l(this,lo).at(i?-1:-2),f=[h[0],h[2]];for(const p of l(this,lo)){const[w,g,E]=p;p[0]=(w-u)/a,p[1]=(g-d)/c,p[2]=(E-d)/c}y(this,lf,new Float32Array([u,d,a,c])),y(this,cf,f)}getOutlines(){l(this,lo).sort((t,s)=>t[0]-s[0]||t[1]-s[1]||t[2]-s[2]);const e=[];for(const t of l(this,lo))t[3]?(e.push(...S(this,cn,o0).call(this,t)),S(this,cn,y_).call(this,t)):(S(this,cn,v_).call(this,t),e.push(...S(this,cn,o0).call(this,t)));return S(this,cn,m_).call(this,e)}}lf=new WeakMap,cf=new WeakMap,lo=new WeakMap,Ns=new WeakMap,cn=new WeakSet,m_=function(e){const t=[],s=new Set;for(const o of e){const[a,c,u]=o;t.push([a,c,o],[a,u,o])}t.sort((o,a)=>o[1]-a[1]||o[0]-a[0]);for(let o=0,a=t.length;o<a;o+=2){const c=t[o][2],u=t[o+1][2];c.push(u),u.push(c),s.add(c),s.add(u)}const i=[];let r;for(;s.size>0;){const o=s.values().next().value;let[a,c,u,d,h]=o;s.delete(o);let f=a,p=c;for(r=[a,u],i.push(r);;){let w;if(s.has(d))w=d;else if(s.has(h))w=h;else break;s.delete(w),[a,c,u,d,h]=w,f!==a&&(r.push(f,p,a,p===c?c:u),f=a),p=p===c?u:c}r.push(f,p)}return new ML(i,l(this,lf),l(this,cf))},Hp=function(e){const t=l(this,Ns);let s=0,i=t.length-1;for(;s<=i;){const r=s+i>>1,o=t[r][0];if(o===e)return r;o<e?s=r+1:i=r-1}return i+1},y_=function([,e,t]){const s=S(this,cn,Hp).call(this,e);l(this,Ns).splice(s,0,[e,t])},v_=function([,e,t]){const s=S(this,cn,Hp).call(this,e);for(let i=s;i<l(this,Ns).length;i++){const[r,o]=l(this,Ns)[i];if(r!==e)break;if(r===e&&o===t){l(this,Ns).splice(i,1);return}}for(let i=s-1;i>=0;i--){const[r,o]=l(this,Ns)[i];if(r!==e)break;if(r===e&&o===t){l(this,Ns).splice(i,1);return}}},o0=function(e){const[t,s,i]=e,r=[[t,s,i]],o=S(this,cn,Hp).call(this,i);for(let a=0;a<o;a++){const[c,u]=l(this,Ns)[a];for(let d=0,h=r.length;d<h;d++){const[,f,p]=r[d];if(!(u<=f||p<=c)){if(f>=c){if(p>u)r[d][1]=u;else{if(h===1)return[];r.splice(d,1),d--,h--}continue}r[d][2]=c,p>u&&r.push([t,u,p])}}}return r};var uf,Xc;class ML extends H{constructor(t,s,i){super();A(this,uf);A(this,Xc);y(this,Xc,t),y(this,uf,s),this.lastPoint=i}toSVGPath(){const t=[];for(const s of l(this,Xc)){let[i,r]=s;t.push(`M${i} ${r}`);for(let o=2;o<s.length;o+=2){const a=s[o],c=s[o+1];a===i?(t.push(`V${c}`),r=c):c===r&&(t.push(`H${a}`),i=a)}t.push("Z")}return t.join(" ")}serialize([t,s,i,r],o){const a=[],c=i-t,u=r-s;for(const d of l(this,Xc)){const h=new Array(d.length);for(let f=0;f<d.length;f+=2)h[f]=t+d[f]*c,h[f+1]=r-d[f+1]*u;a.push(h)}return a}get box(){return l(this,uf)}get classNamesForOutlining(){return["highlightOutline"]}}uf=new WeakMap,Xc=new WeakMap;class a0 extends Tg{newFreeDrawOutline(e,t,s,i,r,o){return new DL(e,t,s,i,r,o)}}class DL extends p_{newOutliner(e,t,s,i,r,o=0){return new a0(e,t,s,i,r,o)}}var Is,Ua,Yc,lt,df,qc,hf,ff,co,Os,Kc,pf,xe,l0,c0,u0,Xo,w_,Mr;const fn=class fn{constructor({editor:e=null,uiManager:t=null}){A(this,xe);A(this,Is,null);A(this,Ua,null);A(this,Yc);A(this,lt,null);A(this,df,!1);A(this,qc,!1);A(this,hf,null);A(this,ff);A(this,co,null);A(this,Os,null);A(this,Kc);var s;e?(y(this,qc,!1),y(this,Kc,de.HIGHLIGHT_COLOR),y(this,hf,e)):(y(this,qc,!0),y(this,Kc,de.HIGHLIGHT_DEFAULT_COLOR)),y(this,Os,(e==null?void 0:e._uiManager)||t),y(this,ff,l(this,Os)._eventBus),y(this,Yc,(e==null?void 0:e.color)||((s=l(this,Os))==null?void 0:s.highlightColors.values().next().value)||"#FFFF98"),l(fn,pf)||y(fn,pf,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return le(this,"_keyboardManager",new Lf([[["Escape","mac+Escape"],fn.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],fn.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],fn.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],fn.prototype._moveToPrevious],[["Home","mac+Home"],fn.prototype._moveToBeginning],[["End","mac+End"],fn.prototype._moveToEnd]]))}renderButton(){const e=y(this,Is,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.setAttribute("aria-haspopup",!0);const t=l(this,Os)._signal;e.addEventListener("click",S(this,xe,Xo).bind(this),{signal:t}),e.addEventListener("keydown",S(this,xe,u0).bind(this),{signal:t});const s=y(this,Ua,document.createElement("span"));return s.className="swatch",s.setAttribute("aria-hidden",!0),s.style.backgroundColor=l(this,Yc),e.append(s),e}renderMainDropdown(){const e=y(this,lt,S(this,xe,l0).call(this));return e.setAttribute("aria-orientation","horizontal"),e.setAttribute("aria-labelledby","highlightColorPickerLabel"),e}_colorSelectFromKeyboard(e){if(e.target===l(this,Is)){S(this,xe,Xo).call(this,e);return}const t=e.target.getAttribute("data-color");t&&S(this,xe,c0).call(this,t,e)}_moveToNext(e){var t,s;if(!l(this,xe,Mr)){S(this,xe,Xo).call(this,e);return}if(e.target===l(this,Is)){(t=l(this,lt).firstChild)==null||t.focus();return}(s=e.target.nextSibling)==null||s.focus()}_moveToPrevious(e){var t,s;if(e.target===((t=l(this,lt))==null?void 0:t.firstChild)||e.target===l(this,Is)){l(this,xe,Mr)&&this._hideDropdownFromKeyboard();return}l(this,xe,Mr)||S(this,xe,Xo).call(this,e),(s=e.target.previousSibling)==null||s.focus()}_moveToBeginning(e){var t;if(!l(this,xe,Mr)){S(this,xe,Xo).call(this,e);return}(t=l(this,lt).firstChild)==null||t.focus()}_moveToEnd(e){var t;if(!l(this,xe,Mr)){S(this,xe,Xo).call(this,e);return}(t=l(this,lt).lastChild)==null||t.focus()}hideDropdown(){var e,t;(e=l(this,lt))==null||e.classList.add("hidden"),(t=l(this,co))==null||t.abort(),y(this,co,null)}_hideDropdownFromKeyboard(){var e;if(!l(this,qc)){if(!l(this,xe,Mr)){(e=l(this,hf))==null||e.unselect();return}this.hideDropdown(),l(this,Is).focus({preventScroll:!0,focusVisible:l(this,df)})}}updateColor(e){if(l(this,Ua)&&(l(this,Ua).style.backgroundColor=e),!l(this,lt))return;const t=l(this,Os).highlightColors.values();for(const s of l(this,lt).children)s.setAttribute("aria-selected",t.next().value===e)}destroy(){var e,t;(e=l(this,Is))==null||e.remove(),y(this,Is,null),y(this,Ua,null),(t=l(this,lt))==null||t.remove(),y(this,lt,null)}};Is=new WeakMap,Ua=new WeakMap,Yc=new WeakMap,lt=new WeakMap,df=new WeakMap,qc=new WeakMap,hf=new WeakMap,ff=new WeakMap,co=new WeakMap,Os=new WeakMap,Kc=new WeakMap,pf=new WeakMap,xe=new WeakSet,l0=function(){const e=document.createElement("div"),t=l(this,Os)._signal;e.addEventListener("contextmenu",As,{signal:t}),e.className="dropdown",e.role="listbox",e.setAttribute("aria-multiselectable",!1),e.setAttribute("aria-orientation","vertical"),e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[s,i]of l(this,Os).highlightColors){const r=document.createElement("button");r.tabIndex="0",r.role="option",r.setAttribute("data-color",i),r.title=s,r.setAttribute("data-l10n-id",l(fn,pf)[s]);const o=document.createElement("span");r.append(o),o.className="swatch",o.style.backgroundColor=i,r.setAttribute("aria-selected",i===l(this,Yc)),r.addEventListener("click",S(this,xe,c0).bind(this,i),{signal:t}),e.append(r)}return e.addEventListener("keydown",S(this,xe,u0).bind(this),{signal:t}),e},c0=function(e,t){t.stopPropagation(),l(this,ff).dispatch("switchannotationeditorparams",{source:this,type:l(this,Kc),value:e})},u0=function(e){fn._keyboardManager.exec(this,e)},Xo=function(e){if(l(this,xe,Mr)){this.hideDropdown();return}if(y(this,df,e.detail===0),l(this,co)||(y(this,co,new AbortController),window.addEventListener("pointerdown",S(this,xe,w_).bind(this),{signal:l(this,Os).combinedSignal(l(this,co))})),l(this,lt)){l(this,lt).classList.remove("hidden");return}const t=y(this,lt,S(this,xe,l0).call(this));l(this,Is).append(t)},w_=function(e){var t;(t=l(this,lt))!=null&&t.contains(e.target)||this.hideDropdown()},Mr=function(){return l(this,lt)&&!l(this,lt).classList.contains("hidden")},A(fn,pf,null);let Wd=fn;var Qc,gf,ar,Va,Jc,mn,mf,yf,Ga,as,Bn,Pt,Zc,lr,Gt,eu,ls,vf,ne,d0,Up,b_,A_,S_,h0,Yo,gs,Rl,E_,Vp,rd,x_,__,C_,k_,T_;const ve=class ve extends Me{constructor(t){super({...t,name:"highlightEditor"});A(this,ne);A(this,Qc,null);A(this,gf,0);A(this,ar);A(this,Va,null);A(this,Jc,null);A(this,mn,null);A(this,mf,null);A(this,yf,0);A(this,Ga,null);A(this,as,null);A(this,Bn,null);A(this,Pt,!1);A(this,Zc,null);A(this,lr);A(this,Gt,null);A(this,eu,"");A(this,ls);A(this,vf,"");this.color=t.color||ve._defaultColor,y(this,ls,t.thickness||ve._defaultThickness),y(this,lr,t.opacity||ve._defaultOpacity),y(this,ar,t.boxes||null),y(this,vf,t.methodOfCreation||""),y(this,eu,t.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(y(this,Pt,!0),S(this,ne,Up).call(this,t),S(this,ne,Yo).call(this)):l(this,ar)&&(y(this,Qc,t.anchorNode),y(this,gf,t.anchorOffset),y(this,mf,t.focusNode),y(this,yf,t.focusOffset),S(this,ne,d0).call(this),S(this,ne,Yo).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const t=ve.prototype;return le(this,"_keyboardManager",new Lf([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:l(this,Pt)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:l(this,ls),methodOfCreation:l(this,vf)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,s){var i;Me.initialize(t,s),ve._defaultColor||(ve._defaultColor=((i=s.highlightColors)==null?void 0:i.values().next().value)||"#fff066")}static updateDefaultParams(t,s){switch(t){case de.HIGHLIGHT_DEFAULT_COLOR:ve._defaultColor=s;break;case de.HIGHLIGHT_THICKNESS:ve._defaultThickness=s;break}}translateInPage(t,s){}get toolbarPosition(){return l(this,Zc)}updateParams(t,s){switch(t){case de.HIGHLIGHT_COLOR:S(this,ne,b_).call(this,s);break;case de.HIGHLIGHT_THICKNESS:S(this,ne,A_).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[de.HIGHLIGHT_DEFAULT_COLOR,ve._defaultColor],[de.HIGHLIGHT_THICKNESS,ve._defaultThickness]]}get propertiesToUpdate(){return[[de.HIGHLIGHT_COLOR,this.color||ve._defaultColor],[de.HIGHLIGHT_THICKNESS,l(this,ls)||ve._defaultThickness],[de.HIGHLIGHT_FREE,l(this,Pt)]]}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.highlightColors&&(y(this,Jc,new Wd({editor:this})),t.addColorPicker(l(this,Jc))),t):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(S(this,ne,rd).call(this))}getBaseTranslation(){return[0,0]}getRect(t,s){return super.getRect(t,s,S(this,ne,rd).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){S(this,ne,h0).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(S(this,ne,Yo).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var i;let s=!1;this.parent&&!t?S(this,ne,h0).call(this):t&&(S(this,ne,Yo).call(this,t),s=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),s&&this.select()}rotate(t){var r,o,a;const{drawLayer:s}=this.parent;let i;l(this,Pt)?(t=(t-this.rotation+360)%360,i=S(r=ve,gs,Rl).call(r,l(this,as).box,t)):i=S(o=ve,gs,Rl).call(o,[this.x,this.y,this.width,this.height],t),s.updateProperties(l(this,Bn),{bbox:i,root:{"data-main-rotation":t}}),s.updateProperties(l(this,Gt),{bbox:S(a=ve,gs,Rl).call(a,l(this,mn).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();l(this,eu)&&(t.setAttribute("aria-label",l(this,eu)),t.setAttribute("role","mark")),l(this,Pt)?t.classList.add("free"):this.div.addEventListener("keydown",S(this,ne,E_).bind(this),{signal:this._uiManager._signal});const s=y(this,Ga,document.createElement("div"));t.append(s),s.setAttribute("aria-hidden","true"),s.className="internal",s.style.clipPath=l(this,Va);const[i,r]=this.parentDimensions;return this.setDims(this.width*i,this.height*r),X1(this,l(this,Ga),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(l(this,Gt),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(l(this,Gt),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:S(this,ne,Vp).call(this,!0);break;case 1:case 3:S(this,ne,Vp).call(this,!1);break}}select(){var t;super.select(),l(this,Gt)&&((t=this.parent)==null||t.drawLayer.updateProperties(l(this,Gt),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),l(this,Gt)&&((t=this.parent)==null||t.drawLayer.updateProperties(l(this,Gt),{rootClass:{selected:!1}}),l(this,Pt)||S(this,ne,Vp).call(this,!1))}get _mustFixPosition(){return!l(this,Pt)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(l(this,Bn),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(l(this,Gt),{rootClass:{hidden:!t}}))}static startHighlighting(t,s,{target:i,x:r,y:o}){const{x:a,y:c,width:u,height:d}=i.getBoundingClientRect(),h=new AbortController,f=t.combinedSignal(h),p=w=>{h.abort(),S(this,gs,k_).call(this,t,w)};window.addEventListener("blur",p,{signal:f}),window.addEventListener("pointerup",p,{signal:f}),window.addEventListener("pointerdown",Ze,{capture:!0,passive:!1,signal:f}),window.addEventListener("contextmenu",As,{signal:f}),i.addEventListener("pointermove",S(this,gs,C_).bind(this,t),{signal:f}),this._freeHighlight=new a0({x:r,y:o},[a,c,u,d],t.scale,this._defaultThickness/2,s,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,s,i){var g,E,m,v;let r=null;if(t instanceof t_){const{data:{quadPoints:b,rect:x,rotation:_,id:k,color:C,opacity:T,popupRef:L},parent:{page:{pageNumber:M}}}=t;r=t={annotationType:Z.HIGHLIGHT,color:Array.from(C),opacity:T,quadPoints:b,boxes:null,pageIndex:M-1,rect:x.slice(0),rotation:_,id:k,deleted:!1,popupRef:L}}else if(t instanceof Hw){const{data:{inkLists:b,rect:x,rotation:_,id:k,color:C,borderStyle:{rawWidth:T},popupRef:L},parent:{page:{pageNumber:M}}}=t;r=t={annotationType:Z.HIGHLIGHT,color:Array.from(C),thickness:T,inkLists:b,boxes:null,pageIndex:M-1,rect:x.slice(0),rotation:_,id:k,deleted:!1,popupRef:L}}const{color:o,quadPoints:a,inkLists:c,opacity:u}=t,d=await super.deserialize(t,s,i);d.color=Y.makeHexColor(...o),y(d,lr,u||1),c&&y(d,ls,t.thickness),d.annotationElementId=t.id||null,d._initialData=r;const[h,f]=d.pageDimensions,[p,w]=d.pageTranslation;if(a){const b=y(d,ar,[]);for(let x=0;x<a.length;x+=8)b.push({x:(a[x]-p)/h,y:1-(a[x+1]-w)/f,width:(a[x+2]-a[x])/h,height:(a[x+1]-a[x+5])/f});S(g=d,ne,d0).call(g),S(E=d,ne,Yo).call(E),d.rotate(d.rotation)}else if(c){y(d,Pt,!0);const b=c[0],x={x:b[0]-p,y:f-(b[1]-w)},_=new a0(x,[0,0,h,f],1,l(d,ls)/2,!0,.001);for(let T=0,L=b.length;T<L;T+=2)x.x=b[T]-p,x.y=f-(b[T+1]-w),_.add(x);const{id:k,clipPathId:C}=s.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:d.color,"fill-opacity":d._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:_.toSVGPath()}},!0,!0);S(m=d,ne,Up).call(m,{highlightOutlines:_.getOutlines(),highlightId:k,clipPathId:C}),S(v=d,ne,Yo).call(v),d.rotate(d.parentRotation)}return d}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const s=this.getRect(0,0),i=Me._colorManager.convert(this.color),r={annotationType:Z.HIGHLIGHT,color:i,opacity:l(this,lr),thickness:l(this,ls),quadPoints:S(this,ne,x_).call(this),outlines:S(this,ne,__).call(this,s),pageIndex:this.pageIndex,rect:s,rotation:S(this,ne,rd).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!S(this,ne,T_).call(this,r)?null:(r.id=this.annotationElementId,r)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};Qc=new WeakMap,gf=new WeakMap,ar=new WeakMap,Va=new WeakMap,Jc=new WeakMap,mn=new WeakMap,mf=new WeakMap,yf=new WeakMap,Ga=new WeakMap,as=new WeakMap,Bn=new WeakMap,Pt=new WeakMap,Zc=new WeakMap,lr=new WeakMap,Gt=new WeakMap,eu=new WeakMap,ls=new WeakMap,vf=new WeakMap,ne=new WeakSet,d0=function(){const t=new r0(l(this,ar),.001);y(this,as,t.getOutlines()),[this.x,this.y,this.width,this.height]=l(this,as).box;const s=new r0(l(this,ar),.0025,.001,this._uiManager.direction==="ltr");y(this,mn,s.getOutlines());const{lastPoint:i}=l(this,mn);y(this,Zc,[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height])},Up=function({highlightOutlines:t,highlightId:s,clipPathId:i}){var h,f;if(y(this,as,t),y(this,mn,t.getNewOutline(l(this,ls)/2+1.5,.0025)),s>=0)y(this,Bn,s),y(this,Va,i),this.parent.drawLayer.finalizeDraw(s,{bbox:t.box,path:{d:t.toSVGPath()}}),y(this,Gt,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:l(this,mn).box,path:{d:l(this,mn).toSVGPath()}},!0));else if(this.parent){const p=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(l(this,Bn),{bbox:S(h=ve,gs,Rl).call(h,l(this,as).box,(p-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(l(this,Gt),{bbox:S(f=ve,gs,Rl).call(f,l(this,mn).box,p),path:{d:l(this,mn).toSVGPath()}})}const[o,a,c,u]=t.box;switch(this.rotation){case 0:this.x=o,this.y=a,this.width=c,this.height=u;break;case 90:{const[p,w]=this.parentDimensions;this.x=a,this.y=1-o,this.width=c*w/p,this.height=u*p/w;break}case 180:this.x=1-o,this.y=1-a,this.width=c,this.height=u;break;case 270:{const[p,w]=this.parentDimensions;this.x=1-a,this.y=o,this.width=c*w/p,this.height=u*p/w;break}}const{lastPoint:d}=l(this,mn);y(this,Zc,[(d[0]-o)/c,(d[1]-a)/u])},b_=function(t){const s=(o,a)=>{var c,u;this.color=o,y(this,lr,a),(c=this.parent)==null||c.drawLayer.updateProperties(l(this,Bn),{root:{fill:o,"fill-opacity":a}}),(u=l(this,Jc))==null||u.updateColor(o)},i=this.color,r=l(this,lr);this.addCommands({cmd:s.bind(this,t,ve._defaultOpacity),undo:s.bind(this,i,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:de.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(t)},!0)},A_=function(t){const s=l(this,ls),i=r=>{y(this,ls,r),S(this,ne,S_).call(this,r)};this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:de.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},S_=function(t){if(!l(this,Pt))return;S(this,ne,Up).call(this,{highlightOutlines:l(this,as).getNewOutline(t/2)}),this.fixAndSetPosition();const[s,i]=this.parentDimensions;this.setDims(this.width*s,this.height*i)},h0=function(){l(this,Bn)===null||!this.parent||(this.parent.drawLayer.remove(l(this,Bn)),y(this,Bn,null),this.parent.drawLayer.remove(l(this,Gt)),y(this,Gt,null))},Yo=function(t=this.parent){l(this,Bn)===null&&({id:Qt(this,Bn)._,clipPathId:Qt(this,Va)._}=t.drawLayer.draw({bbox:l(this,as).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":l(this,lr)},rootClass:{highlight:!0,free:l(this,Pt)},path:{d:l(this,as).toSVGPath()}},!1,!0),y(this,Gt,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:l(this,Pt)},bbox:l(this,mn).box,path:{d:l(this,mn).toSVGPath()}},l(this,Pt))),l(this,Ga)&&(l(this,Ga).style.clipPath=l(this,Va)))},gs=new WeakSet,Rl=function([t,s,i,r],o){switch(o){case 90:return[1-s-r,t,r,i];case 180:return[1-t-i,1-s-r,i,r];case 270:return[s,1-t-i,r,i]}return[t,s,i,r]},E_=function(t){ve._keyboardManager.exec(this,t)},Vp=function(t){if(!l(this,Qc))return;const s=window.getSelection();t?s.setPosition(l(this,Qc),l(this,gf)):s.setPosition(l(this,mf),l(this,yf))},rd=function(){return l(this,Pt)?this.rotation:0},x_=function(){if(l(this,Pt))return null;const[t,s]=this.pageDimensions,[i,r]=this.pageTranslation,o=l(this,ar),a=new Float32Array(o.length*8);let c=0;for(const{x:u,y:d,width:h,height:f}of o){const p=u*t+i,w=(1-d)*s+r;a[c]=a[c+4]=p,a[c+1]=a[c+3]=w,a[c+2]=a[c+6]=p+h*t,a[c+5]=a[c+7]=w-f*s,c+=8}return a},__=function(t){return l(this,as).serialize(t,S(this,ne,rd).call(this))},C_=function(t,s){this._freeHighlight.add(s)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},k_=function(t,s){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(s,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},T_=function(t){const{color:s}=this._initialData;return t.color.some((i,r)=>i!==s[r])},A(ve,gs),F(ve,"_defaultColor",null),F(ve,"_defaultOpacity",1),F(ve,"_defaultThickness",12),F(ve,"_type","highlight"),F(ve,"_editorType",Z.HIGHLIGHT),F(ve,"_freeHighlightId",-1),F(ve,"_freeHighlight",null),F(ve,"_freeHighlightClipId","");let Rg=ve;var Wa;class R_{constructor(){A(this,Wa,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,s]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,s)}updateSVGProperty(e,t){l(this,Wa)[e]=t}toSVGProperties(){const e=l(this,Wa);return y(this,Wa,Object.create(null)),{root:e}}reset(){y(this,Wa,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){_e("Not implemented")}}Wa=new WeakMap;var $n,tu,yt,Xa,Ya,uo,ho,fo,qa,me,f0,p0,g0,od,P_,Gp,ad,Pl;const V=class V extends Me{constructor(t){super(t);A(this,me);A(this,$n,null);A(this,tu);F(this,"_drawId",null);y(this,tu,t.mustBeCommitted||!1),this._addOutlines(t)}_addOutlines(t){t.drawOutlines&&(S(this,me,f0).call(this,t),S(this,me,od).call(this))}static _mergeSVGProperties(t,s){const i=new Set(Object.keys(t));for(const[r,o]of Object.entries(s))i.has(r)?Object.assign(t[r],o):t[r]=o;return t}static getDefaultDrawingOptions(t){_e("Not implemented")}static get typesMap(){_e("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,s){const i=this.typesMap.get(t);i&&this._defaultDrawingOptions.updateProperty(i,s),this._currentParent&&(l(V,yt).updateProperty(i,s),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,s){const i=this.constructor.typesMap.get(t);i&&this._updateProperty(t,i,s)}static get defaultPropertiesToUpdate(){const t=[],s=this._defaultDrawingOptions;for(const[i,r]of this.typesMap)t.push([i,s[r]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:s}=this;for(const[i,r]of this.constructor.typesMap)t.push([i,s[r]]);return t}_updateProperty(t,s,i){const r=this._drawingOptions,o=r[s],a=c=>{var d;r.updateProperty(s,c);const u=l(this,$n).updateProperty(s,c);u&&S(this,me,ad).call(this,u),(d=this.parent)==null||d.drawLayer.updateProperties(this._drawId,r.toSVGProperties())};this.addCommands({cmd:a.bind(this,i),undo:a.bind(this,o),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,V._mergeSVGProperties(l(this,$n).getPathResizingSVGProperties(S(this,me,Gp).call(this)),{bbox:S(this,me,Pl).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,V._mergeSVGProperties(l(this,$n).getPathResizedSVGProperties(S(this,me,Gp).call(this)),{bbox:S(this,me,Pl).call(this)}))}_onTranslating(t,s){var i;(i=this.parent)==null||i.drawLayer.updateProperties(this._drawId,{bbox:S(this,me,Pl).call(this)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,V._mergeSVGProperties(l(this,$n).getPathTranslatedSVGProperties(S(this,me,Gp).call(this),this.parentDimensions),{bbox:S(this,me,Pl).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,l(this,tu)&&(y(this,tu,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){S(this,me,g0).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(S(this,me,od).call(this),S(this,me,ad).call(this,l(this,$n).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var i;let s=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),S(this,me,g0).call(this)):t&&(this._uiManager.addShouldRescale(this),S(this,me,od).call(this,t),s=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(t),s&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,V._mergeSVGProperties({bbox:S(this,me,Pl).call(this)},l(this,$n).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&S(this,me,ad).call(this,l(this,$n).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,s;this._isCopy&&(t=this.x,s=this.y);const i=super.render();i.classList.add("draw");const r=document.createElement("div");i.append(r),r.setAttribute("aria-hidden","true"),r.className="internal";const[o,a]=this.parentDimensions;return this.setDims(this.width*o,this.height*a),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,s),i}static createDrawerInstance(t,s,i,r,o){_e("Not implemented")}static startDrawing(t,s,i,r){var E;const{target:o,offsetX:a,offsetY:c,pointerId:u,pointerType:d}=r;if(l(V,ho)&&l(V,ho)!==d)return;const{viewport:{rotation:h}}=t,{width:f,height:p}=o.getBoundingClientRect(),w=y(V,Xa,new AbortController),g=t.combinedSignal(w);if(l(V,uo)||y(V,uo,u),l(V,ho)??y(V,ho,d),window.addEventListener("pointerup",m=>{var v;l(V,uo)===m.pointerId?this._endDraw(m):(v=l(V,fo))==null||v.delete(m.pointerId)},{signal:g}),window.addEventListener("pointercancel",m=>{var v;l(V,uo)===m.pointerId?this._currentParent.endDrawingSession():(v=l(V,fo))==null||v.delete(m.pointerId)},{signal:g}),window.addEventListener("pointerdown",m=>{l(V,ho)===m.pointerType&&((l(V,fo)||y(V,fo,new Set)).add(m.pointerId),l(V,yt).isCancellable()&&(l(V,yt).removeLastElement(),l(V,yt).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:g}),window.addEventListener("contextmenu",As,{signal:g}),o.addEventListener("pointermove",this._drawMove.bind(this),{signal:g}),o.addEventListener("touchmove",m=>{m.timeStamp===l(V,qa)&&Ze(m)},{signal:g}),t.toggleDrawing(),(E=s._editorUndoBar)==null||E.hide(),l(V,yt)){t.drawLayer.updateProperties(this._currentDrawId,l(V,yt).startNew(a,c,f,p,h));return}s.updateUIForDefaultProperties(this),y(V,yt,this.createDrawerInstance(a,c,f,p,h)),y(V,Ya,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(l(V,Ya).toSVGProperties(),l(V,yt).defaultSVGProperties),!0,!1)}static _drawMove(t){var o;if(y(V,qa,-1),!l(V,yt))return;const{offsetX:s,offsetY:i,pointerId:r}=t;if(l(V,uo)===r){if(((o=l(V,fo))==null?void 0:o.size)>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,l(V,yt).add(s,i)),y(V,qa,t.timeStamp),Ze(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,y(V,yt,null),y(V,Ya,null),y(V,ho,null),y(V,qa,NaN)),l(V,Xa)&&(l(V,Xa).abort(),y(V,Xa,null),y(V,uo,NaN),y(V,fo,null))}static _endDraw(t){const s=this._currentParent;if(s){if(s.toggleDrawing(!0),this._cleanup(!1),(t==null?void 0:t.target)===s.div&&s.drawLayer.updateProperties(this._currentDrawId,l(V,yt).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const i=l(V,yt),r=this._currentDrawId,o=i.getLastElement();s.addCommands({cmd:()=>{s.drawLayer.updateProperties(r,i.setLastElement(o))},undo:()=>{s.drawLayer.updateProperties(r,i.removeLastElement())},mustExec:!1,type:de.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const s=this._currentParent;if(!s)return null;if(s.toggleDrawing(!0),s.cleanUndoStack(de.DRAW_STEP),!l(V,yt).isEmpty()){const{pageDimensions:[i,r],scale:o}=s,a=s.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:l(V,yt).getOutlines(i*o,r*o,o,this._INNER_MARGIN),drawingOptions:l(V,Ya),mustBeCommitted:!t});return this._cleanup(!0),a}return s.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,s,i,r,o,a){_e("Not implemented")}static async deserialize(t,s,i){var h,f;const{rawDims:{pageWidth:r,pageHeight:o,pageX:a,pageY:c}}=s.viewport,u=this.deserializeDraw(a,c,r,o,this._INNER_MARGIN,t),d=await super.deserialize(t,s,i);return d.createDrawingOptions(t),S(h=d,me,f0).call(h,{drawOutlines:u}),S(f=d,me,od).call(f),d.onScaleChanging(),d.rotate(),d}serializeDraw(t){const[s,i]=this.pageTranslation,[r,o]=this.pageDimensions;return l(this,$n).serialize([s,i,r,o],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};$n=new WeakMap,tu=new WeakMap,yt=new WeakMap,Xa=new WeakMap,Ya=new WeakMap,uo=new WeakMap,ho=new WeakMap,fo=new WeakMap,qa=new WeakMap,me=new WeakSet,f0=function({drawOutlines:t,drawId:s,drawingOptions:i}){y(this,$n,t),this._drawingOptions||(this._drawingOptions=i),s>=0?(this._drawId=s,this.parent.drawLayer.finalizeDraw(s,t.defaultProperties)):this._drawId=S(this,me,p0).call(this,t,this.parent),S(this,me,ad).call(this,t.box)},p0=function(t,s){const{id:i}=s.drawLayer.draw(V._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return i},g0=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},od=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=S(this,me,p0).call(this,l(this,$n),t)}},P_=function([t,s,i,r]){const{parentDimensions:[o,a],rotation:c}=this;switch(c){case 90:return[s,1-t,i*(a/o),r*(o/a)];case 180:return[1-t,1-s,i,r];case 270:return[1-s,t,i*(a/o),r*(o/a)];default:return[t,s,i,r]}},Gp=function(){const{x:t,y:s,width:i,height:r,parentDimensions:[o,a],rotation:c}=this;switch(c){case 90:return[1-s,t,i*(o/a),r*(a/o)];case 180:return[1-t,1-s,i,r];case 270:return[s,1-t,i*(o/a),r*(a/o)];default:return[t,s,i,r]}},ad=function(t){if([this.x,this.y,this.width,this.height]=S(this,me,P_).call(this,t),this.div){this.fixAndSetPosition();const[s,i]=this.parentDimensions;this.setDims(this.width*s,this.height*i)}this._onResized()},Pl=function(){const{x:t,y:s,width:i,height:r,rotation:o,parentRotation:a,parentDimensions:[c,u]}=this;switch((o*4+a)/90){case 1:return[1-s-r,t,r,i];case 2:return[1-t-i,1-s-r,i,r];case 3:return[s,1-t-i,r,i];case 4:return[t,s-i*(c/u),r*(u/c),i*(c/u)];case 5:return[1-s,t,i*(c/u),r*(u/c)];case 6:return[1-t-r*(u/c),1-s,r*(u/c),i*(c/u)];case 7:return[s-i*(c/u),1-t-r*(u/c),i*(c/u),r*(u/c)];case 8:return[t-i,s-r,i,r];case 9:return[1-s,t-i,r,i];case 10:return[1-t,1-s,i,r];case 11:return[s-r,1-t,r,i];case 12:return[t-r*(u/c),s,r*(u/c),i*(c/u)];case 13:return[1-s-i*(c/u),t-r*(u/c),i*(c/u),r*(u/c)];case 14:return[1-t,1-s-i*(c/u),r*(u/c),i*(c/u)];case 15:return[s,1-t,i*(c/u),r*(u/c)];default:return[t,s,i,r]}},F(V,"_currentDrawId",-1),F(V,"_currentParent",null),A(V,yt,null),A(V,Xa,null),A(V,Ya,null),A(V,uo,NaN),A(V,ho,null),A(V,fo,null),A(V,qa,NaN),F(V,"_INNER_MARGIN",3);let Pg=V;var gi,vt,wt,Ka,nu,en,Lt,cs,Qa,Ja,Za,su,Wp;class NL{constructor(e,t,s,i,r,o){A(this,su);A(this,gi,new Float64Array(6));A(this,vt);A(this,wt);A(this,Ka);A(this,nu);A(this,en);A(this,Lt,"");A(this,cs,0);A(this,Qa,new Nf);A(this,Ja);A(this,Za);y(this,Ja,s),y(this,Za,i),y(this,Ka,r),y(this,nu,o),[e,t]=S(this,su,Wp).call(this,e,t);const a=y(this,vt,[NaN,NaN,NaN,NaN,e,t]);y(this,en,[e,t]),y(this,wt,[{line:a,points:l(this,en)}]),l(this,gi).set(a,0)}updateProperty(e,t){e==="stroke-width"&&y(this,nu,t)}isEmpty(){return!l(this,wt)||l(this,wt).length===0}isCancellable(){return l(this,en).length<=10}add(e,t){[e,t]=S(this,su,Wp).call(this,e,t);const[s,i,r,o]=l(this,gi).subarray(2,6),a=e-r,c=t-o;return Math.hypot(l(this,Ja)*a,l(this,Za)*c)<=2?null:(l(this,en).push(e,t),isNaN(s)?(l(this,gi).set([r,o,e,t],2),l(this,vt).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(l(this,gi)[0])&&l(this,vt).splice(6,6),l(this,gi).set([s,i,r,o,e,t],0),l(this,vt).push(...H.createBezierPoints(s,i,r,o,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const s=this.add(e,t);return s||(l(this,en).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,s,i,r){y(this,Ja,s),y(this,Za,i),y(this,Ka,r),[e,t]=S(this,su,Wp).call(this,e,t);const o=y(this,vt,[NaN,NaN,NaN,NaN,e,t]);y(this,en,[e,t]);const a=l(this,wt).at(-1);return a&&(a.line=new Float32Array(a.line),a.points=new Float32Array(a.points)),l(this,wt).push({line:o,points:l(this,en)}),l(this,gi).set(o,0),y(this,cs,0),this.toSVGPath(),null}getLastElement(){return l(this,wt).at(-1)}setLastElement(e){return l(this,wt)?(l(this,wt).push(e),y(this,vt,e.line),y(this,en,e.points),y(this,cs,0),{path:{d:this.toSVGPath()}}):l(this,Qa).setLastElement(e)}removeLastElement(){if(!l(this,wt))return l(this,Qa).removeLastElement();l(this,wt).pop(),y(this,Lt,"");for(let e=0,t=l(this,wt).length;e<t;e++){const{line:s,points:i}=l(this,wt)[e];y(this,vt,s),y(this,en,i),y(this,cs,0),this.toSVGPath()}return{path:{d:l(this,Lt)}}}toSVGPath(){const e=H.svgRound(l(this,vt)[4]),t=H.svgRound(l(this,vt)[5]);if(l(this,en).length===2)return y(this,Lt,`${l(this,Lt)} M ${e} ${t} Z`),l(this,Lt);if(l(this,en).length<=6){const i=l(this,Lt).lastIndexOf("M");y(this,Lt,`${l(this,Lt).slice(0,i)} M ${e} ${t}`),y(this,cs,6)}if(l(this,en).length===4){const i=H.svgRound(l(this,vt)[10]),r=H.svgRound(l(this,vt)[11]);return y(this,Lt,`${l(this,Lt)} L ${i} ${r}`),y(this,cs,12),l(this,Lt)}const s=[];l(this,cs)===0&&(s.push(`M ${e} ${t}`),y(this,cs,6));for(let i=l(this,cs),r=l(this,vt).length;i<r;i+=6){const[o,a,c,u,d,h]=l(this,vt).slice(i,i+6).map(H.svgRound);s.push(`C${o} ${a} ${c} ${u} ${d} ${h}`)}return y(this,Lt,l(this,Lt)+s.join(" ")),y(this,cs,l(this,vt).length),l(this,Lt)}getOutlines(e,t,s,i){const r=l(this,wt).at(-1);return r.line=new Float32Array(r.line),r.points=new Float32Array(r.points),l(this,Qa).build(l(this,wt),e,t,s,l(this,Ka),l(this,nu),i),y(this,gi,null),y(this,vt,null),y(this,wt,null),y(this,Lt,null),l(this,Qa)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}gi=new WeakMap,vt=new WeakMap,wt=new WeakMap,Ka=new WeakMap,nu=new WeakMap,en=new WeakMap,Lt=new WeakMap,cs=new WeakMap,Qa=new WeakMap,Ja=new WeakMap,Za=new WeakMap,su=new WeakSet,Wp=function(e,t){return H._normalizePoint(e,t,l(this,Ja),l(this,Za),l(this,Ka))};var tn,wf,bf,Hn,mi,yi,iu,ru,el,Nt,Ni,L_,M_,D_;class Nf extends H{constructor(){super(...arguments);A(this,Nt);A(this,tn);A(this,wf,0);A(this,bf);A(this,Hn);A(this,mi);A(this,yi);A(this,iu);A(this,ru);A(this,el)}build(t,s,i,r,o,a,c){y(this,mi,s),y(this,yi,i),y(this,iu,r),y(this,ru,o),y(this,el,a),y(this,bf,c??0),y(this,Hn,t),S(this,Nt,M_).call(this)}get thickness(){return l(this,el)}setLastElement(t){return l(this,Hn).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return l(this,Hn).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:s}of l(this,Hn)){if(t.push(`M${H.svgRound(s[4])} ${H.svgRound(s[5])}`),s.length===6){t.push("Z");continue}if(s.length===12&&isNaN(s[6])){t.push(`L${H.svgRound(s[10])} ${H.svgRound(s[11])}`);continue}for(let i=6,r=s.length;i<r;i+=6){const[o,a,c,u,d,h]=s.subarray(i,i+6).map(H.svgRound);t.push(`C${o} ${a} ${c} ${u} ${d} ${h}`)}}return t.join("")}serialize([t,s,i,r],o){const a=[],c=[],[u,d,h,f]=S(this,Nt,L_).call(this);let p,w,g,E,m,v,b,x,_;switch(l(this,ru)){case 0:_=H._rescale,p=t,w=s+r,g=i,E=-r,m=t+u*i,v=s+(1-d-f)*r,b=t+(u+h)*i,x=s+(1-d)*r;break;case 90:_=H._rescaleAndSwap,p=t,w=s,g=i,E=r,m=t+d*i,v=s+u*r,b=t+(d+f)*i,x=s+(u+h)*r;break;case 180:_=H._rescale,p=t+i,w=s,g=-i,E=r,m=t+(1-u-h)*i,v=s+d*r,b=t+(1-u)*i,x=s+(d+f)*r;break;case 270:_=H._rescaleAndSwap,p=t+i,w=s+r,g=-i,E=-r,m=t+(1-d-f)*i,v=s+(1-u-h)*r,b=t+(1-d)*i,x=s+(1-u)*r;break}for(const{line:k,points:C}of l(this,Hn))a.push(_(k,p,w,g,E,o?new Array(k.length):null)),c.push(_(C,p,w,g,E,o?new Array(C.length):null));return{lines:a,points:c,rect:[m,v,b,x]}}static deserialize(t,s,i,r,o,{paths:{lines:a,points:c},rotation:u,thickness:d}){const h=[];let f,p,w,g,E;switch(u){case 0:E=H._rescale,f=-t/i,p=s/r+1,w=1/i,g=-1/r;break;case 90:E=H._rescaleAndSwap,f=-s/r,p=-t/i,w=1/r,g=1/i;break;case 180:E=H._rescale,f=t/i+1,p=-s/r,w=-1/i,g=1/r;break;case 270:E=H._rescaleAndSwap,f=s/r+1,p=t/i+1,w=-1/r,g=-1/i;break}if(!a){a=[];for(const v of c){const b=v.length;if(b===2){a.push(new Float32Array([NaN,NaN,NaN,NaN,v[0],v[1]]));continue}if(b===4){a.push(new Float32Array([NaN,NaN,NaN,NaN,v[0],v[1],NaN,NaN,NaN,NaN,v[2],v[3]]));continue}const x=new Float32Array(3*(b-2));a.push(x);let[_,k,C,T]=v.subarray(0,4);x.set([NaN,NaN,NaN,NaN,_,k],0);for(let L=4;L<b;L+=2){const M=v[L],D=v[L+1];x.set(H.createBezierPoints(_,k,C,T,M,D),(L-2)*3),[_,k,C,T]=[C,T,M,D]}}}for(let v=0,b=a.length;v<b;v++)h.push({line:E(a[v].map(x=>x??NaN),f,p,w,g),points:E(c[v].map(x=>x??NaN),f,p,w,g)});const m=new this.prototype.constructor;return m.build(h,i,r,1,u,d,o),m}get box(){return l(this,tn)}updateProperty(t,s){return t==="stroke-width"?S(this,Nt,D_).call(this,s):null}updateParentDimensions([t,s],i){const[r,o]=S(this,Nt,Ni).call(this);y(this,mi,t),y(this,yi,s),y(this,iu,i);const[a,c]=S(this,Nt,Ni).call(this),u=a-r,d=c-o,h=l(this,tn);return h[0]-=u,h[1]-=d,h[2]+=2*u,h[3]+=2*d,h}updateRotation(t){return y(this,wf,t),{path:{transform:this.rotationTransform}}}get viewBox(){return l(this,tn).map(H.svgRound).join(" ")}get defaultProperties(){const[t,s]=l(this,tn);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${H.svgRound(t)} ${H.svgRound(s)}`}}}get rotationTransform(){const[,,t,s]=l(this,tn);let i=0,r=0,o=0,a=0,c=0,u=0;switch(l(this,wf)){case 90:r=s/t,o=-t/s,c=t;break;case 180:i=-1,a=-1,c=t,u=s;break;case 270:r=-s/t,o=t/s,u=s;break;default:return""}return`matrix(${i} ${r} ${o} ${a} ${H.svgRound(c)} ${H.svgRound(u)})`}getPathResizingSVGProperties([t,s,i,r]){const[o,a]=S(this,Nt,Ni).call(this),[c,u,d,h]=l(this,tn);if(Math.abs(d-o)<=H.PRECISION||Math.abs(h-a)<=H.PRECISION){const E=t+i/2-(c+d/2),m=s+r/2-(u+h/2);return{path:{"transform-origin":`${H.svgRound(t)} ${H.svgRound(s)}`,transform:`${this.rotationTransform} translate(${E} ${m})`}}}const f=(i-2*o)/(d-2*o),p=(r-2*a)/(h-2*a),w=d/i,g=h/r;return{path:{"transform-origin":`${H.svgRound(c)} ${H.svgRound(u)}`,transform:`${this.rotationTransform} scale(${w} ${g}) translate(${H.svgRound(o)} ${H.svgRound(a)}) scale(${f} ${p}) translate(${H.svgRound(-o)} ${H.svgRound(-a)})`}}}getPathResizedSVGProperties([t,s,i,r]){const[o,a]=S(this,Nt,Ni).call(this),c=l(this,tn),[u,d,h,f]=c;if(c[0]=t,c[1]=s,c[2]=i,c[3]=r,Math.abs(h-o)<=H.PRECISION||Math.abs(f-a)<=H.PRECISION){const m=t+i/2-(u+h/2),v=s+r/2-(d+f/2);for(const{line:b,points:x}of l(this,Hn))H._translate(b,m,v,b),H._translate(x,m,v,x);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${H.svgRound(t)} ${H.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const p=(i-2*o)/(h-2*o),w=(r-2*a)/(f-2*a),g=-p*(u+o)+t+o,E=-w*(d+a)+s+a;if(p!==1||w!==1||g!==0||E!==0)for(const{line:m,points:v}of l(this,Hn))H._rescale(m,g,E,p,w,m),H._rescale(v,g,E,p,w,v);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${H.svgRound(t)} ${H.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,s],i){const[r,o]=i,a=l(this,tn),c=t-a[0],u=s-a[1];if(l(this,mi)===r&&l(this,yi)===o)for(const{line:d,points:h}of l(this,Hn))H._translate(d,c,u,d),H._translate(h,c,u,h);else{const d=l(this,mi)/r,h=l(this,yi)/o;y(this,mi,r),y(this,yi,o);for(const{line:f,points:p}of l(this,Hn))H._rescale(f,c,u,d,h,f),H._rescale(p,c,u,d,h,p);a[2]*=d,a[3]*=h}return a[0]=t,a[1]=s,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${H.svgRound(t)} ${H.svgRound(s)}`}}}get defaultSVGProperties(){const t=l(this,tn);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${H.svgRound(t[0])} ${H.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}tn=new WeakMap,wf=new WeakMap,bf=new WeakMap,Hn=new WeakMap,mi=new WeakMap,yi=new WeakMap,iu=new WeakMap,ru=new WeakMap,el=new WeakMap,Nt=new WeakSet,Ni=function(t=l(this,el)){const s=l(this,bf)+t/2*l(this,iu);return l(this,ru)%180===0?[s/l(this,mi),s/l(this,yi)]:[s/l(this,yi),s/l(this,mi)]},L_=function(){const[t,s,i,r]=l(this,tn),[o,a]=S(this,Nt,Ni).call(this,0);return[t+o,s+a,i-2*o,r-2*a]},M_=function(){const t=y(this,tn,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:r}of l(this,Hn)){if(r.length<=12){for(let c=4,u=r.length;c<u;c+=6)Y.pointBoundingBox(r[c],r[c+1],t);continue}let o=r[4],a=r[5];for(let c=6,u=r.length;c<u;c+=6){const[d,h,f,p,w,g]=r.subarray(c,c+6);Y.bezierBoundingBox(o,a,d,h,f,p,w,g,t),o=w,a=g}}const[s,i]=S(this,Nt,Ni).call(this);t[0]=Xt(t[0]-s,0,1),t[1]=Xt(t[1]-i,0,1),t[2]=Xt(t[2]+s,0,1),t[3]=Xt(t[3]+i,0,1),t[2]-=t[0],t[3]-=t[1]},D_=function(t){const[s,i]=S(this,Nt,Ni).call(this);y(this,el,t);const[r,o]=S(this,Nt,Ni).call(this),[a,c]=[r-s,o-i],u=l(this,tn);return u[0]-=a,u[1]-=c,u[2]+=2*a,u[3]+=2*c,u};class _m extends R_{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:Me._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??(t=this["stroke-width"]),t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new _m(this._viewParameters);return e.updateAll(this),e}}var em,N_;const Wl=class Wl extends Pg{constructor(t){super({...t,name:"inkEditor"});A(this,em);this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,s){Me.initialize(t,s),this._defaultDrawingOptions=new _m(s.viewParameters)}static getDefaultDrawingOptions(t){const s=this._defaultDrawingOptions.clone();return s.updateProperties(t),s}static get supportMultipleDrawings(){return!0}static get typesMap(){return le(this,"typesMap",new Map([[de.INK_THICKNESS,"stroke-width"],[de.INK_COLOR,"stroke"],[de.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,s,i,r,o){return new NL(t,s,i,r,o,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,s,i,r,o,a){return Nf.deserialize(t,s,i,r,o,a)}static async deserialize(t,s,i){let r=null;if(t instanceof Hw){const{data:{inkLists:a,rect:c,rotation:u,id:d,color:h,opacity:f,borderStyle:{rawWidth:p},popupRef:w},parent:{page:{pageNumber:g}}}=t;r=t={annotationType:Z.INK,color:Array.from(h),thickness:p,opacity:f,paths:{points:a},boxes:null,pageIndex:g-1,rect:c.slice(0),rotation:u,id:d,deleted:!1,popupRef:w}}const o=await super.deserialize(t,s,i);return o.annotationElementId=t.id||null,o._initialData=r,o}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:s,parent:i}=this;s.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(t,s.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:s,opacity:i}){this._drawingOptions=Wl.getDefaultDrawingOptions({stroke:Y.makeHexColor(...t),"stroke-width":s,"stroke-opacity":i})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:s,points:i,rect:r}=this.serializeDraw(t),{_drawingOptions:{stroke:o,"stroke-opacity":a,"stroke-width":c}}=this,u={annotationType:Z.INK,color:Me._colorManager.convert(o),opacity:a,thickness:c,paths:{lines:s,points:i},pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?(u.isCopy=!0,u):this.annotationElementId&&!S(this,em,N_).call(this,u)?null:(u.id=this.annotationElementId,u)}renderAnnotationElement(t){const{points:s,rect:i}=this.serializeDraw(!1);return t.updateEdited({rect:i,thickness:this._drawingOptions["stroke-width"],points:s}),null}};em=new WeakSet,N_=function(t){const{color:s,thickness:i,opacity:r,pageIndex:o}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||t.color.some((a,c)=>a!==s[c])||t.thickness!==i||t.opacity!==r||t.pageIndex!==o},F(Wl,"_type","ink"),F(Wl,"_editorType",Z.INK),F(Wl,"_defaultDrawingOptions",null);let m0=Wl;class y0 extends Nf{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const up=8,Bu=3;var tl,we,v0,Fs,I_,O_,w0,Xp,F_,j_,z_,b0,A0,B_;class Si{static extractContoursFromText(e,{fontFamily:t,fontStyle:s,fontWeight:i},r,o,a,c){let u=new OffscreenCanvas(1,1),d=u.getContext("2d",{alpha:!1});const h=200,f=d.font=`${s} ${i} ${h}px ${t}`,{actualBoundingBoxLeft:p,actualBoundingBoxRight:w,actualBoundingBoxAscent:g,actualBoundingBoxDescent:E,fontBoundingBoxAscent:m,fontBoundingBoxDescent:v,width:b}=d.measureText(e),x=1.5,_=Math.ceil(Math.max(Math.abs(p)+Math.abs(w)||0,b)*x),k=Math.ceil(Math.max(Math.abs(g)+Math.abs(E)||h,Math.abs(m)+Math.abs(v)||h)*x);u=new OffscreenCanvas(_,k),d=u.getContext("2d",{alpha:!0,willReadFrequently:!0}),d.font=f,d.filter="grayscale(1)",d.fillStyle="white",d.fillRect(0,0,_,k),d.fillStyle="black",d.fillText(e,_*(x-1)/2,k*(3-x)/2);const C=S(this,we,b0).call(this,d.getImageData(0,0,_,k).data),T=S(this,we,z_).call(this,C),L=S(this,we,A0).call(this,T),M=S(this,we,w0).call(this,C,_,k,L);return this.processDrawnLines({lines:{curves:M,width:_,height:k},pageWidth:r,pageHeight:o,rotation:a,innerMargin:c,mustSmooth:!0,areContours:!0})}static process(e,t,s,i,r){const[o,a,c]=S(this,we,B_).call(this,e),[u,d]=S(this,we,j_).call(this,o,a,c,Math.hypot(a,c)*l(this,tl).sigmaSFactor,l(this,tl).sigmaR,l(this,tl).kernelSize),h=S(this,we,A0).call(this,d),f=S(this,we,w0).call(this,u,a,c,h);return this.processDrawnLines({lines:{curves:f,width:a,height:c},pageWidth:t,pageHeight:s,rotation:i,innerMargin:r,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:s,rotation:i,innerMargin:r,mustSmooth:o,areContours:a}){i%180!==0&&([t,s]=[s,t]);const{curves:c,width:u,height:d}=e,h=e.thickness??0,f=[],p=Math.min(t/u,s/d),w=p/t,g=p/s,E=[];for(const{points:v}of c){const b=o?S(this,we,F_).call(this,v):v;if(!b)continue;E.push(b);const x=b.length,_=new Float32Array(x),k=new Float32Array(3*(x===2?2:x-2));if(f.push({line:k,points:_}),x===2){_[0]=b[0]*w,_[1]=b[1]*g,k.set([NaN,NaN,NaN,NaN,_[0],_[1]],0);continue}let[C,T,L,M]=b;C*=w,T*=g,L*=w,M*=g,_.set([C,T,L,M],0),k.set([NaN,NaN,NaN,NaN,C,T],0);for(let D=4;D<x;D+=2){const q=_[D]=b[D]*w,K=_[D+1]=b[D+1]*g;k.set(H.createBezierPoints(C,T,L,M,q,K),(D-2)*3),[C,T,L,M]=[L,M,q,K]}}if(f.length===0)return null;const m=a?new y0:new Nf;return m.build(f,t,s,1,i,a?0:h,r),{outline:m,newCurves:E,areContours:a,thickness:h,width:u,height:d}}static async compressSignature({outlines:e,areContours:t,thickness:s,width:i,height:r}){let o=1/0,a=-1/0,c=0;for(const b of e){c+=b.length;for(let x=2,_=b.length;x<_;x++){const k=b[x]-b[x-2];o=Math.min(o,k),a=Math.max(a,k)}}let u;o>=-128&&a<=127?u=Int8Array:o>=-32768&&a<=32767?u=Int16Array:u=Int32Array;const d=e.length,h=up+Bu*d,f=new Uint32Array(h);let p=0;f[p++]=h*Uint32Array.BYTES_PER_ELEMENT+(c-2*d)*u.BYTES_PER_ELEMENT,f[p++]=0,f[p++]=i,f[p++]=r,f[p++]=t?0:1,f[p++]=Math.max(0,Math.floor(s??0)),f[p++]=d,f[p++]=u.BYTES_PER_ELEMENT;for(const b of e)f[p++]=b.length-2,f[p++]=b[0],f[p++]=b[1];const w=new CompressionStream("deflate-raw"),g=w.writable.getWriter();await g.ready,g.write(f);const E=u.prototype.constructor;for(const b of e){const x=new E(b.length-2);for(let _=2,k=b.length;_<k;_++)x[_-2]=b[_]-b[_-2];g.write(x)}g.close();const m=await new Response(w.readable).arrayBuffer(),v=new Uint8Array(m);return O1(v)}static async decompressSignature(e){try{const t=uP(e),{readable:s,writable:i}=new DecompressionStream("deflate-raw"),r=i.getWriter();await r.ready,r.write(t).then(async()=>{await r.ready,await r.close()}).catch(()=>{});let o=null,a=0;for await(const b of s)o||(o=new Uint8Array(new Uint32Array(b.buffer,0,4)[0])),o.set(b,a),a+=b.length;const c=new Uint32Array(o.buffer,0,o.length>>2),u=c[1];if(u!==0)throw new Error(`Invalid version: ${u}`);const d=c[2],h=c[3],f=c[4]===0,p=c[5],w=c[6],g=c[7],E=[],m=(up+Bu*w)*Uint32Array.BYTES_PER_ELEMENT;let v;switch(g){case Int8Array.BYTES_PER_ELEMENT:v=new Int8Array(o.buffer,m);break;case Int16Array.BYTES_PER_ELEMENT:v=new Int16Array(o.buffer,m);break;case Int32Array.BYTES_PER_ELEMENT:v=new Int32Array(o.buffer,m);break}a=0;for(let b=0;b<w;b++){const x=c[Bu*b+up],_=new Float32Array(x+2);E.push(_);for(let k=0;k<Bu-1;k++)_[k]=c[Bu*b+up+k+1];for(let k=0;k<x;k++)_[k+2]=_[k]+v[a++]}return{areContours:f,thickness:p,outlines:E,width:d,height:h}}catch(t){return te(`decompressSignature: ${t}`),null}}}tl=new WeakMap,we=new WeakSet,v0=function(e,t,s,i){return s-=e,i-=t,s===0?i>0?0:4:s===1?i+6:2-i},Fs=new WeakMap,I_=function(e,t,s,i,r,o,a){const c=S(this,we,v0).call(this,s,i,r,o);for(let u=0;u<8;u++){const d=(-u+c-a+16)%8,h=l(this,Fs)[2*d],f=l(this,Fs)[2*d+1];if(e[(s+h)*t+(i+f)]!==0)return d}return-1},O_=function(e,t,s,i,r,o,a){const c=S(this,we,v0).call(this,s,i,r,o);for(let u=0;u<8;u++){const d=(u+c+a+16)%8,h=l(this,Fs)[2*d],f=l(this,Fs)[2*d+1];if(e[(s+h)*t+(i+f)]!==0)return d}return-1},w0=function(e,t,s,i){const r=e.length,o=new Int32Array(r);for(let d=0;d<r;d++)o[d]=e[d]<=i?1:0;for(let d=1;d<s-1;d++)o[d*t]=o[d*t+t-1]=0;for(let d=0;d<t;d++)o[d]=o[t*s-1-d]=0;let a=1,c;const u=[];for(let d=1;d<s-1;d++){c=1;for(let h=1;h<t-1;h++){const f=d*t+h,p=o[f];if(p===0)continue;let w=d,g=h;if(p===1&&o[f-1]===0)a+=1,g-=1;else if(p>=1&&o[f+1]===0)a+=1,g+=1,p>1&&(c=p);else{p!==1&&(c=Math.abs(p));continue}const E=[h,d],m=g===h+1,v={isHole:m,points:E,id:a,parent:0};u.push(v);let b;for(const D of u)if(D.id===c){b=D;break}b?b.isHole?v.parent=m?b.parent:c:v.parent=m?c:b.parent:v.parent=m?c:0;const x=S(this,we,I_).call(this,o,t,d,h,w,g,0);if(x===-1){o[f]=-a,o[f]!==1&&(c=Math.abs(o[f]));continue}let _=l(this,Fs)[2*x],k=l(this,Fs)[2*x+1];const C=d+_,T=h+k;w=C,g=T;let L=d,M=h;for(;;){const D=S(this,we,O_).call(this,o,t,L,M,w,g,1);_=l(this,Fs)[2*D],k=l(this,Fs)[2*D+1];const q=L+_,K=M+k;E.push(K,q);const G=L*t+M;if(o[G+1]===0?o[G]=-a:o[G]===1&&(o[G]=a),q===d&&K===h&&L===C&&M===T){o[f]!==1&&(c=Math.abs(o[f]));break}else w=L,g=M,L=q,M=K}}}return u},Xp=function(e,t,s,i){if(s-t<=4){for(let C=t;C<s-2;C+=2)i.push(e[C],e[C+1]);return}const r=e[t],o=e[t+1],a=e[s-4]-r,c=e[s-3]-o,u=Math.hypot(a,c),d=a/u,h=c/u,f=d*o-h*r,p=c/a,w=1/u,g=Math.atan(p),E=Math.cos(g),m=Math.sin(g),v=w*(Math.abs(E)+Math.abs(m)),b=w*(1-v+v**2),x=Math.max(Math.atan(Math.abs(m+E)*b),Math.atan(Math.abs(m-E)*b));let _=0,k=t;for(let C=t+2;C<s-2;C+=2){const T=Math.abs(f-d*e[C+1]+h*e[C]);T>_&&(k=C,_=T)}_>(u*x)**2?(S(this,we,Xp).call(this,e,t,k+2,i),S(this,we,Xp).call(this,e,k,s,i)):i.push(r,o)},F_=function(e){const t=[],s=e.length;return S(this,we,Xp).call(this,e,0,s,t),t.push(e[s-2],e[s-1]),t.length<=4?null:t},j_=function(e,t,s,i,r,o){const a=new Float32Array(o**2),c=-2*i**2,u=o>>1;for(let g=0;g<o;g++){const E=(g-u)**2;for(let m=0;m<o;m++)a[g*o+m]=Math.exp((E+(m-u)**2)/c)}const d=new Float32Array(256),h=-2*r**2;for(let g=0;g<256;g++)d[g]=Math.exp(g**2/h);const f=e.length,p=new Uint8Array(f),w=new Uint32Array(256);for(let g=0;g<s;g++)for(let E=0;E<t;E++){const m=g*t+E,v=e[m];let b=0,x=0;for(let k=0;k<o;k++){const C=g+k-u;if(!(C<0||C>=s))for(let T=0;T<o;T++){const L=E+T-u;if(L<0||L>=t)continue;const M=e[C*t+L],D=a[k*o+T]*d[Math.abs(M-v)];b+=M*D,x+=D}}const _=p[m]=Math.round(b/x);w[_]++}return[p,w]},z_=function(e){const t=new Uint32Array(256);for(const s of e)t[s]++;return t},b0=function(e){const t=e.length,s=new Uint8ClampedArray(t>>2);let i=-1/0,r=1/0;for(let a=0,c=s.length;a<c;a++){if(e[(a<<2)+3]===0){i=s[a]=255;continue}const d=s[a]=e[a<<2];d>i&&(i=d),d<r&&(r=d)}const o=255/(i-r);for(let a=0;a<t;a++)s[a]=(s[a]-r)*o;return s},A0=function(e){let t,s=-1/0,i=-1/0;const r=e.findIndex(c=>c!==0);let o=r,a=r;for(t=r;t<256;t++){const c=e[t];c>s&&(t-o>i&&(i=t-o,a=t-1),s=c,o=t)}for(t=a-1;t>=0&&!(e[t]>e[t+1]);t--);return t},B_=function(e){const t=e,{width:s,height:i}=e,{maxDim:r}=l(this,tl);let o=s,a=i;if(s>r||i>r){let f=s,p=i,w=Math.log2(Math.max(s,i)/r);const g=Math.floor(w);w=w===g?g-1:g;for(let m=0;m<w;m++){o=Math.ceil(f/2),a=Math.ceil(p/2);const v=new OffscreenCanvas(o,a);v.getContext("2d").drawImage(e,0,0,f,p,0,0,o,a),f=o,p=a,e!==t&&e.close(),e=v.transferToImageBitmap()}const E=Math.min(r/o,r/a);o=Math.round(o*E),a=Math.round(a*E)}const u=new OffscreenCanvas(o,a).getContext("2d",{willReadFrequently:!0});u.filter="grayscale(1)",u.drawImage(e,0,0,e.width,e.height,0,0,o,a);const d=u.getImageData(0,0,o,a).data;return[S(this,we,b0).call(this,d),o,a]},A(Si,we),A(Si,tl,{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}),A(Si,Fs,new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]));class Vw extends R_{constructor(){super(),super.updateProperties({fill:Me._defaultLineColor,"stroke-width":0})}clone(){const e=new Vw;return e.updateAll(this),e}}class Gw extends _m{constructor(e){super(e),super.updateProperties({stroke:Me._defaultLineColor,"stroke-width":1})}clone(){const e=new Gw(this._viewParameters);return e.updateAll(this),e}}var po,Un,go,mo;const Ln=class Ln extends Pg{constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"});A(this,po,!1);A(this,Un,null);A(this,go,null);A(this,mo,null);this._willKeepAspectRatio=!0,y(this,go,t.signatureData||null),y(this,Un,null),this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,s){Me.initialize(t,s),this._defaultDrawingOptions=new Vw,this._defaultDrawnSignatureOptions=new Gw(s.viewParameters)}static getDefaultDrawingOptions(t){const s=this._defaultDrawingOptions.clone();return s.updateProperties(t),s}static get supportMultipleDrawings(){return!1}static get typesMap(){return le(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!l(this,Un)}}static computeTelemetryFinalData(t){const s=t.get("hasDescription");return{hasAltText:s.get(!0)??0,hasNoAltText:s.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,s;const{_isCopy:i}=this;if(i&&(this._isCopy=!1,t=this.x,s=this.y),super.render(),this._drawId===null)if(l(this,go)){const{lines:r,mustSmooth:o,areContours:a,description:c,uuid:u,heightInPage:d}=l(this,go),{rawDims:{pageWidth:h,pageHeight:f},rotation:p}=this.parent.viewport,w=Si.processDrawnLines({lines:r,pageWidth:h,pageHeight:f,rotation:p,innerMargin:Ln._INNER_MARGIN,mustSmooth:o,areContours:a});this.addSignature(w,d,c,u)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);return i&&(this._isCopy=!0,this._moveAfterPaste(t,s)),this.div}setUuid(t){y(this,mo,t),this.addEditToolbar()}getUuid(){return l(this,mo)}get description(){return l(this,Un)}set description(t){y(this,Un,t),super.addEditToolbar().then(s=>{s==null||s.updateEditSignatureButton(t)})}getSignaturePreview(){const{newCurves:t,areContours:s,thickness:i,width:r,height:o}=l(this,go),a=Math.max(r,o),c=Si.processDrawnLines({lines:{curves:t.map(u=>({points:u})),thickness:i,width:r,height:o},pageWidth:a,pageHeight:a,rotation:0,innerMargin:0,mustSmooth:!1,areContours:s});return{areContours:s,outline:c.outline}}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.signatureManager&&l(this,Un)!==null&&(await t.addEditSignatureButton(this._uiManager.signatureManager,l(this,mo),l(this,Un)),t.show()),t):null}addSignature(t,s,i,r){const{x:o,y:a}=this,{outline:c}=y(this,go,t);y(this,po,c instanceof y0),y(this,Un,i),this.div.setAttribute("data-l10n-args",JSON.stringify({description:i}));let u;l(this,po)?u=Ln.getDefaultDrawingOptions():(u=Ln._defaultDrawnSignatureOptions.clone(),u.updateProperties({"stroke-width":c.thickness})),this._addOutlines({drawOutlines:c,drawingOptions:u});const[d,h]=this.parentDimensions,[,f]=this.pageDimensions;let p=s/f;p=p>=1?.5:p,this.width*=p/this.height,this.width>=1&&(p*=.9/this.width,this.width=.9),this.height=p,this.setDims(d*this.width,h*this.height),this.x=o,this.y=a,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(r),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!r,hasDescription:!!i}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:s,pageHeight:i},rotation:r}=this.parent.viewport;return Si.process(t,s,i,r,Ln._INNER_MARGIN)}getFromText(t,s){const{rawDims:{pageWidth:i,pageHeight:r},rotation:o}=this.parent.viewport;return Si.extractContoursFromText(t,s,i,r,o,Ln._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:s,pageHeight:i},rotation:r}=this.parent.viewport;return Si.processDrawnLines({lines:t,pageWidth:s,pageHeight:i,rotation:r,innerMargin:Ln._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:s}){t?this._drawingOptions=Ln.getDefaultDrawingOptions():(this._drawingOptions=Ln._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":s}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:s,points:i,rect:r}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":o}}=this,a={annotationType:Z.SIGNATURE,isSignature:!0,areContours:l(this,po),color:[0,0,0],thickness:l(this,po)?0:o,pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?(a.paths={lines:s,points:i},a.uuid=l(this,mo),a.isCopy=!0):a.lines=s,l(this,Un)&&(a.accessibilityData={type:"Figure",alt:l(this,Un)}),a}static deserializeDraw(t,s,i,r,o,a){return a.areContours?y0.deserialize(t,s,i,r,o,a):Nf.deserialize(t,s,i,r,o,a)}static async deserialize(t,s,i){var o;const r=await super.deserialize(t,s,i);return y(r,po,t.areContours),y(r,Un,((o=t.accessibilityData)==null?void 0:o.alt)||""),y(r,mo,t.uuid),r}};po=new WeakMap,Un=new WeakMap,go=new WeakMap,mo=new WeakMap,F(Ln,"_type","signature"),F(Ln,"_editorType",Z.SIGNATURE),F(Ln,"_defaultDrawingOptions",null);let S0=Ln;var Fe,bt,yo,cr,vo,ou,ur,nl,vi,Vn,au,ye,ld,cd,Yp,qp,Kp,x0,Qp,$_;class E0 extends Me{constructor(t){super({...t,name:"stampEditor"});A(this,ye);A(this,Fe,null);A(this,bt,null);A(this,yo,null);A(this,cr,null);A(this,vo,null);A(this,ou,"");A(this,ur,null);A(this,nl,!1);A(this,vi,null);A(this,Vn,!1);A(this,au,!1);y(this,cr,t.bitmapUrl),y(this,vo,t.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,s){Me.initialize(t,s)}static isHandlingMimeForPasting(t){return Cg.includes(t)}static paste(t,s){s.pasteEditor({mode:Z.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const s=t.get("hasAltText");return{hasAltText:s.get(!0)??0,hasNoAltText:s.get(!1)??0}}async mlGuessAltText(t=null,s=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:o,height:a}=t||this.copyCanvas(null,null,!0).imageData,c=await i.guess({name:"altText",request:{data:r,width:o,height:a,channels:r.length/(o*a)}});if(!c)throw new Error("No response from the AI service.");if(c.error)throw new Error("Error from the AI service.");if(c.cancel)return null;if(!c.output)throw new Error("No valid response from the AI service.");const u=c.output;return await this.setGuessedAltText(u),s&&!this.hasAltTextData()&&(this.altTextData={alt:u,decorative:!1}),u}remove(){var t;l(this,bt)&&(y(this,Fe,null),this._uiManager.imageManager.deleteId(l(this,bt)),(t=l(this,ur))==null||t.remove(),y(this,ur,null),l(this,vi)&&(clearTimeout(l(this,vi)),y(this,vi,null))),super.remove()}rebuild(){if(!this.parent){l(this,bt)&&S(this,ye,Yp).call(this);return}super.rebuild(),this.div!==null&&(l(this,bt)&&l(this,ur)===null&&S(this,ye,Yp).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(l(this,yo)||l(this,Fe)||l(this,cr)||l(this,vo)||l(this,bt)||l(this,nl))}get isResizable(){return!0}render(){if(this.div)return this.div;let t,s;return this._isCopy&&(t=this.x,s=this.y),super.render(),this.div.hidden=!0,this.addAltTextButton(),l(this,nl)||(l(this,Fe)?S(this,ye,qp).call(this):S(this,ye,Yp).call(this)),this._isCopy&&this._moveAfterPaste(t,s),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,s){const{id:i,bitmap:r}=this._uiManager.imageManager.getFromCanvas(t,s);s.remove(),i&&this._uiManager.imageManager.isValidId(i)&&(y(this,bt,i),r&&y(this,Fe,r),y(this,nl,!1),S(this,ye,qp).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;l(this,vi)!==null&&clearTimeout(l(this,vi)),y(this,vi,setTimeout(()=>{y(this,vi,null),S(this,ye,x0).call(this)},200))}copyCanvas(t,s,i=!1){var p;t||(t=224);const{width:r,height:o}=l(this,Fe),a=new Ws;let c=l(this,Fe),u=r,d=o,h=null;if(s){if(r>s||o>s){const T=Math.min(s/r,s/o);u=Math.floor(r*T),d=Math.floor(o*T)}h=document.createElement("canvas");const w=h.width=Math.ceil(u*a.sx),g=h.height=Math.ceil(d*a.sy);l(this,Vn)||(c=S(this,ye,Kp).call(this,w,g));const E=h.getContext("2d");E.filter=this._uiManager.hcmFilter;let m="white",v="#cfcfd8";this._uiManager.hcmFilter!=="none"?v="black":(p=window.matchMedia)!=null&&p.call(window,"(prefers-color-scheme: dark)").matches&&(m="#8f8f9d",v="#42414d");const b=15,x=b*a.sx,_=b*a.sy,k=new OffscreenCanvas(x*2,_*2),C=k.getContext("2d");C.fillStyle=m,C.fillRect(0,0,x*2,_*2),C.fillStyle=v,C.fillRect(0,0,x,_),C.fillRect(x,_,x,_),E.fillStyle=E.createPattern(k,"repeat"),E.fillRect(0,0,w,g),E.drawImage(c,0,0,c.width,c.height,0,0,w,g)}let f=null;if(i){let w,g;if(a.symmetric&&c.width<t&&c.height<t)w=c.width,g=c.height;else if(c=l(this,Fe),r>t||o>t){const v=Math.min(t/r,t/o);w=Math.floor(r*v),g=Math.floor(o*v),l(this,Vn)||(c=S(this,ye,Kp).call(this,w,g))}const m=new OffscreenCanvas(w,g).getContext("2d",{willReadFrequently:!0});m.drawImage(c,0,0,c.width,c.height,0,0,w,g),f={width:w,height:g,data:m.getImageData(0,0,w,g).data}}return{canvas:h,width:u,height:d,imageData:f}}static async deserialize(t,s,i){var E;let r=null,o=!1;if(t instanceof n_){const{data:{rect:m,rotation:v,id:b,structParent:x,popupRef:_},container:k,parent:{page:{pageNumber:C}},canvas:T}=t;let L,M;T?(delete t.canvas,{id:L,bitmap:M}=i.imageManager.getFromCanvas(k.id,T),T.remove()):(o=!0,t._hasNoCanvas=!0);const D=((E=await s._structTree.getAriaAttributes(`${Nw}${b}`))==null?void 0:E.get("aria-label"))||"";r=t={annotationType:Z.STAMP,bitmapId:L,bitmap:M,pageIndex:C-1,rect:m.slice(0),rotation:v,id:b,deleted:!1,accessibilityData:{decorative:!1,altText:D},isSvg:!1,structParent:x,popupRef:_}}const a=await super.deserialize(t,s,i),{rect:c,bitmap:u,bitmapUrl:d,bitmapId:h,isSvg:f,accessibilityData:p}=t;o?(i.addMissingCanvas(t.id,a),y(a,nl,!0)):h&&i.imageManager.isValidId(h)?(y(a,bt,h),u&&y(a,Fe,u)):y(a,cr,d),y(a,Vn,f);const[w,g]=a.pageDimensions;return a.width=(c[2]-c[0])/w,a.height=(c[3]-c[1])/g,a.annotationElementId=t.id||null,p&&(a.altTextData=p),a._initialData=r,y(a,au,!!r),a}serialize(t=!1,s=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i={annotationType:Z.STAMP,bitmapId:l(this,bt),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:l(this,Vn),structTreeParentId:this._structTreeParentId};if(t)return i.bitmapUrl=S(this,ye,Qp).call(this,!0),i.accessibilityData=this.serializeAltText(!0),i.isCopy=!0,i;const{decorative:r,altText:o}=this.serializeAltText(!1);if(!r&&o&&(i.accessibilityData={type:"Figure",alt:o}),this.annotationElementId){const c=S(this,ye,$_).call(this,i);if(c.isSame)return null;c.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1}if(i.id=this.annotationElementId,s===null)return i;s.stamps||(s.stamps=new Map);const a=l(this,Vn)?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!s.stamps.has(l(this,bt)))s.stamps.set(l(this,bt),{area:a,serialized:i}),i.bitmap=S(this,ye,Qp).call(this,!1);else if(l(this,Vn)){const c=s.stamps.get(l(this,bt));a>c.area&&(c.area=a,c.serialized.bitmap.close(),c.serialized.bitmap=S(this,ye,Qp).call(this,!1))}return i}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}}Fe=new WeakMap,bt=new WeakMap,yo=new WeakMap,cr=new WeakMap,vo=new WeakMap,ou=new WeakMap,ur=new WeakMap,nl=new WeakMap,vi=new WeakMap,Vn=new WeakMap,au=new WeakMap,ye=new WeakSet,ld=function(t,s=!1){if(!t){this.remove();return}y(this,Fe,t.bitmap),s||(y(this,bt,t.id),y(this,Vn,t.isSvg)),t.file&&y(this,ou,t.file.name),S(this,ye,qp).call(this)},cd=function(){if(y(this,yo,null),this._uiManager.enableWaiting(!1),!!l(this,ur)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&l(this,Fe)){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&l(this,Fe)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},Yp=function(){if(l(this,bt)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(l(this,bt)).then(i=>S(this,ye,ld).call(this,i,!0)).finally(()=>S(this,ye,cd).call(this));return}if(l(this,cr)){const i=l(this,cr);y(this,cr,null),this._uiManager.enableWaiting(!0),y(this,yo,this._uiManager.imageManager.getFromUrl(i).then(r=>S(this,ye,ld).call(this,r)).finally(()=>S(this,ye,cd).call(this)));return}if(l(this,vo)){const i=l(this,vo);y(this,vo,null),this._uiManager.enableWaiting(!0),y(this,yo,this._uiManager.imageManager.getFromFile(i).then(r=>S(this,ye,ld).call(this,r)).finally(()=>S(this,ye,cd).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=Cg.join(",");const s=this._uiManager._signal;y(this,yo,new Promise(i=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),S(this,ye,ld).call(this,r)}i()},{signal:s}),t.addEventListener("cancel",()=>{this.remove(),i()},{signal:s})}).finally(()=>S(this,ye,cd).call(this))),t.click()},qp=function(){var h;const{div:t}=this;let{width:s,height:i}=l(this,Fe);const[r,o]=this.pageDimensions,a=.75;if(this.width)s=this.width*r,i=this.height*o;else if(s>a*r||i>a*o){const f=Math.min(a*r/s,a*o/i);s*=f,i*=f}const[c,u]=this.parentDimensions;this.setDims(s*c/r,i*u/o),this._uiManager.enableWaiting(!1);const d=y(this,ur,document.createElement("canvas"));d.setAttribute("role","img"),this.addContainer(d),this.width=s/r,this.height=i/o,(h=this._initialOptions)!=null&&h.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),S(this,ye,x0).call(this),l(this,au)||(this.parent.addUndoableEditor(this),y(this,au,!0)),this._reportTelemetry({action:"inserted_image"}),l(this,ou)&&this.div.setAttribute("aria-description",l(this,ou))},Kp=function(t,s){const{width:i,height:r}=l(this,Fe);let o=i,a=r,c=l(this,Fe);for(;o>2*t||a>2*s;){const u=o,d=a;o>2*t&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2)),a>2*s&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2));const h=new OffscreenCanvas(o,a);h.getContext("2d").drawImage(c,0,0,u,d,0,0,o,a),c=h.transferToImageBitmap()}return c},x0=function(){const[t,s]=this.parentDimensions,{width:i,height:r}=this,o=new Ws,a=Math.ceil(i*t*o.sx),c=Math.ceil(r*s*o.sy),u=l(this,ur);if(!u||u.width===a&&u.height===c)return;u.width=a,u.height=c;const d=l(this,Vn)?l(this,Fe):S(this,ye,Kp).call(this,a,c),h=u.getContext("2d");h.filter=this._uiManager.hcmFilter,h.drawImage(d,0,0,d.width,d.height,0,0,a,c)},Qp=function(t){if(t){if(l(this,Vn)){const r=this._uiManager.imageManager.getSvgUrl(l(this,bt));if(r)return r}const s=document.createElement("canvas");return{width:s.width,height:s.height}=l(this,Fe),s.getContext("2d").drawImage(l(this,Fe),0,0),s.toDataURL()}if(l(this,Vn)){const[s,i]=this.pageDimensions,r=Math.round(this.width*s*xr.PDF_TO_CSS_UNITS),o=Math.round(this.height*i*xr.PDF_TO_CSS_UNITS),a=new OffscreenCanvas(r,o);return a.getContext("2d").drawImage(l(this,Fe),0,0,l(this,Fe).width,l(this,Fe).height,0,0,r,o),a.transferToImageBitmap()}return structuredClone(l(this,Fe))},$_=function(t){var a;const{pageIndex:s,accessibilityData:{altText:i}}=this._initialData,r=t.pageIndex===s,o=(((a=t.accessibilityData)==null?void 0:a.alt)||"")===i;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&r&&o,isSameAltText:o}},F(E0,"_type","stamp"),F(E0,"_editorType",Z.STAMP);var sl,lu,wi,wo,dr,us,bo,cu,il,js,hr,Wt,fr,W,Ao,je,H_,ni,_0,C0,Jp;const _s=class _s{constructor({uiManager:e,pageIndex:t,div:s,structTreeLayer:i,accessibilityManager:r,annotationLayer:o,drawLayer:a,textLayer:c,viewport:u,l10n:d}){A(this,je);A(this,sl);A(this,lu,!1);A(this,wi,null);A(this,wo,null);A(this,dr,null);A(this,us,new Map);A(this,bo,!1);A(this,cu,!1);A(this,il,!1);A(this,js,null);A(this,hr,null);A(this,Wt,null);A(this,fr,null);A(this,W);const h=[...l(_s,Ao).values()];if(!_s._initialized){_s._initialized=!0;for(const f of h)f.initialize(d,e)}e.registerEditorTypes(h),y(this,W,e),this.pageIndex=t,this.div=s,y(this,sl,r),y(this,wi,o),this.viewport=u,y(this,Wt,c),this.drawLayer=a,this._structTree=i,l(this,W).addLayer(this)}get isEmpty(){return l(this,us).size===0}get isInvisible(){return this.isEmpty&&l(this,W).getMode()===Z.NONE}updateToolbar(e){l(this,W).updateToolbar(e)}updateMode(e=l(this,W).getMode()){switch(S(this,je,Jp).call(this),e){case Z.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Z.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Z.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const s of l(_s,Ao).values())t.toggle(`${s._type}Editing`,e===s._editorType);this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=l(this,Wt))==null?void 0:t.div)}setEditingState(e){l(this,W).setEditingState(e)}addCommands(e){l(this,W).addCommands(e)}cleanUndoStack(e){l(this,W).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=l(this,wi))==null||t.div.classList.toggle("disabled",!e)}async enable(){y(this,il,!0),this.div.tabIndex=0,this.togglePointerEvents(!0);const e=new Set;for(const s of l(this,us).values())s.enableEditing(),s.show(!0),s.annotationElementId&&(l(this,W).removeChangedExistingAnnotation(s),e.add(s.annotationElementId));if(!l(this,wi)){y(this,il,!1);return}const t=l(this,wi).getEditableAnnotations();for(const s of t){if(s.hide(),l(this,W).isDeletedAnnotationElement(s.data.id)||e.has(s.data.id))continue;const i=await this.deserialize(s);i&&(this.addOrRebuild(i),i.enableEditing())}y(this,il,!1)}disable(){var i;y(this,cu,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const e=new Map,t=new Map;for(const r of l(this,us).values())if(r.disableEditing(),!!r.annotationElementId){if(r.serialize()!==null){e.set(r.annotationElementId,r);continue}else t.set(r.annotationElementId,r);(i=this.getEditableAnnotation(r.annotationElementId))==null||i.show(),r.remove()}if(l(this,wi)){const r=l(this,wi).getEditableAnnotations();for(const o of r){const{id:a}=o.data;if(l(this,W).isDeletedAnnotationElement(a))continue;let c=t.get(a);if(c){c.resetAnnotationElement(o),c.show(!1),o.show();continue}c=e.get(a),c&&(l(this,W).addChangedExistingAnnotation(c),c.renderAnnotationElement(o)&&c.show(!1)),o.show()}}S(this,je,Jp).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:s}=this.div;for(const r of l(_s,Ao).values())s.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),y(this,cu,!1)}getEditableAnnotation(e){var t;return((t=l(this,wi))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){l(this,W).getActive()!==e&&l(this,W).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=l(this,Wt))!=null&&e.div&&!l(this,fr)){y(this,fr,new AbortController);const t=l(this,W).combinedSignal(l(this,fr));l(this,Wt).div.addEventListener("pointerdown",S(this,je,H_).bind(this),{signal:t}),l(this,Wt).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=l(this,Wt))!=null&&e.div&&l(this,fr)&&(l(this,fr).abort(),y(this,fr,null),l(this,Wt).div.classList.remove("highlighting"))}enableClick(){if(l(this,wo))return;y(this,wo,new AbortController);const e=l(this,W).combinedSignal(l(this,wo));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;(e=l(this,wo))==null||e.abort(),y(this,wo,null)}attach(e){l(this,us).set(e.id,e);const{annotationElementId:t}=e;t&&l(this,W).isDeletedAnnotationElement(t)&&l(this,W).removeDeletedAnnotationElement(e)}detach(e){var t;l(this,us).delete(e.id),(t=l(this,sl))==null||t.removePointerInTextLayer(e.contentDiv),!l(this,cu)&&e.annotationElementId&&l(this,W).addDeletedAnnotationElement(e)}remove(e){this.detach(e),l(this,W).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(l(this,W).addDeletedAnnotationElement(e.annotationElementId),Me.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),l(this,W).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!l(this,il)),l(this,W).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var s;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!l(this,dr)&&(e._focusEventsAllowed=!1,y(this,dr,setTimeout(()=>{y(this,dr,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:l(this,W)._signal}),t.focus())},0))),e._structTreeParentId=(s=l(this,sl))==null?void 0:s.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),s=()=>{e.remove()};this.addCommands({cmd:t,undo:s,mustExec:!1})}getNextId(){return l(this,W).getId()}combinedSignal(e){return l(this,W).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=l(this,je,ni))==null?void 0:e.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await l(this,W).updateMode(e.mode);const{offsetX:s,offsetY:i}=S(this,je,C0).call(this),r=this.getNextId(),o=S(this,je,_0).call(this,{parent:this,id:r,x:s,y:i,uiManager:l(this,W),isCentered:!0,...t});o&&this.add(o)}async deserialize(e){var t;return await((t=l(_s,Ao).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,l(this,W)))||null}createAndAddNewEditor(e,t,s={}){const i=this.getNextId(),r=S(this,je,_0).call(this,{parent:this,id:i,x:e.offsetX,y:e.offsetY,uiManager:l(this,W),isCentered:t,...s});return r&&this.add(r),r}addNewEditor(e={}){this.createAndAddNewEditor(S(this,je,C0).call(this),!0,e)}setSelected(e){l(this,W).setSelected(e)}toggleSelected(e){l(this,W).toggleSelected(e)}unselect(e){l(this,W).unselect(e)}pointerup(e){var i;const{isMac:t}=xt.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!l(this,bo)||(y(this,bo,!1),(i=l(this,je,ni))!=null&&i.isDrawer&&l(this,je,ni).supportMultipleDrawings))return;if(!l(this,lu)){y(this,lu,!0);return}const s=l(this,W).getMode();if(s===Z.STAMP||s===Z.SIGNATURE){l(this,W).unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){var i;if(l(this,W).getMode()===Z.HIGHLIGHT&&this.enableTextSelection(),l(this,bo)){y(this,bo,!1);return}const{isMac:t}=xt.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(y(this,bo,!0),(i=l(this,je,ni))!=null&&i.isDrawer){this.startDrawingSession(e);return}const s=l(this,W).getActive();y(this,lu,!s||s.isEmpty())}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),l(this,js)){l(this,je,ni).startDrawing(this,l(this,W),!1,e);return}l(this,W).setCurrentDrawingSession(this),y(this,js,new AbortController);const t=l(this,W).combinedSignal(l(this,js));this.div.addEventListener("blur",({relatedTarget:s})=>{s&&!this.div.contains(s)&&(y(this,hr,null),this.commitOrRemove())},{signal:t}),l(this,je,ni).startDrawing(this,l(this,W),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&y(this,hr,t);return}l(this,hr)&&setTimeout(()=>{var t;(t=l(this,hr))==null||t.focus(),y(this,hr,null)},0)}endDrawingSession(e=!1){return l(this,js)?(l(this,W).setCurrentDrawingSession(null),l(this,js).abort(),y(this,js,null),y(this,hr,null),l(this,je,ni).endDrawing(e)):null}findNewParent(e,t,s){const i=l(this,W).findParent(t,s);return i===null||i===this?!1:(i.changeParent(e),!0)}commitOrRemove(){return l(this,js)?(this.endDrawingSession(),!0):!1}onScaleChanging(){l(this,js)&&l(this,je,ni).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=l(this,W).getActive())==null?void 0:e.parent)===this&&(l(this,W).commitOrRemove(),l(this,W).setActiveEditor(null)),l(this,dr)&&(clearTimeout(l(this,dr)),y(this,dr,null));for(const s of l(this,us).values())(t=l(this,sl))==null||t.removePointerInTextLayer(s.contentDiv),s.setParent(null),s.isAttachedToDOM=!1,s.div.remove();this.div=null,l(this,us).clear(),l(this,W).removeLayer(this)}render({viewport:e}){this.viewport=e,No(this.div,e);for(const t of l(this,W).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){l(this,W).commitOrRemove(),S(this,je,Jp).call(this);const t=this.viewport.rotation,s=e.rotation;if(this.viewport=e,No(this.div,{rotation:s}),t!==s)for(const i of l(this,us).values())i.rotate(s)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return l(this,W).viewParameters.realScale}};sl=new WeakMap,lu=new WeakMap,wi=new WeakMap,wo=new WeakMap,dr=new WeakMap,us=new WeakMap,bo=new WeakMap,cu=new WeakMap,il=new WeakMap,js=new WeakMap,hr=new WeakMap,Wt=new WeakMap,fr=new WeakMap,W=new WeakMap,Ao=new WeakMap,je=new WeakSet,H_=function(e){l(this,W).unselectAll();const{target:t}=e;if(t===l(this,Wt).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&l(this,Wt).div.contains(t)){const{isMac:s}=xt.platform;if(e.button!==0||e.ctrlKey&&s)return;l(this,W).showAllEditors("highlight",!0,!0),l(this,Wt).div.classList.add("free"),this.toggleDrawing(),Rg.startHighlighting(this,l(this,W).direction==="ltr",{target:l(this,Wt).div,x:e.x,y:e.y}),l(this,Wt).div.addEventListener("pointerup",()=>{l(this,Wt).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:l(this,W)._signal}),e.preventDefault()}},ni=function(){return l(_s,Ao).get(l(this,W).getMode())},_0=function(e){const t=l(this,je,ni);return t?new t.prototype.constructor(e):null},C0=function(){const{x:e,y:t,width:s,height:i}=this.div.getBoundingClientRect(),r=Math.max(0,e),o=Math.max(0,t),a=Math.min(window.innerWidth,e+s),c=Math.min(window.innerHeight,t+i),u=(r+a)/2-e,d=(o+c)/2-t,[h,f]=this.viewport.rotation%180===0?[u,d]:[d,u];return{offsetX:h,offsetY:f}},Jp=function(){for(const e of l(this,us).values())e.isEmpty()&&e.remove()},F(_s,"_initialized",!1),A(_s,Ao,new Map([s0,m0,E0,Rg,S0].map(e=>[e._editorType,e])));let Lg=_s;var zs,nn,rl,Af,tm,U_,_i,k0,V_,T0;const ot=class ot{constructor({pageIndex:e}){A(this,_i);A(this,zs,null);A(this,nn,new Map);A(this,rl,new Map);this.pageIndex=e}setParent(e){if(!l(this,zs)){y(this,zs,e);return}if(l(this,zs)!==e){if(l(this,nn).size>0)for(const t of l(this,nn).values())t.remove(),e.append(t);y(this,zs,e)}}static get _svgFactory(){return le(this,"_svgFactory",new Gd)}draw(e,t=!1,s=!1){const i=Qt(ot,Af)._++,r=S(this,_i,k0).call(this),o=ot._svgFactory.createElement("defs");r.append(o);const a=ot._svgFactory.createElement("path");o.append(a);const c=`path_p${this.pageIndex}_${i}`;a.setAttribute("id",c),a.setAttribute("vector-effect","non-scaling-stroke"),t&&l(this,rl).set(i,a);const u=s?S(this,_i,V_).call(this,o,c):null,d=ot._svgFactory.createElement("use");return r.append(d),d.setAttribute("href",`#${c}`),this.updateProperties(r,e),l(this,nn).set(i,r),{id:i,clipPathId:`url(#${u})`}}drawOutline(e,t){const s=Qt(ot,Af)._++,i=S(this,_i,k0).call(this),r=ot._svgFactory.createElement("defs");i.append(r);const o=ot._svgFactory.createElement("path");r.append(o);const a=`path_p${this.pageIndex}_${s}`;o.setAttribute("id",a),o.setAttribute("vector-effect","non-scaling-stroke");let c;if(t){const h=ot._svgFactory.createElement("mask");r.append(h),c=`mask_p${this.pageIndex}_${s}`,h.setAttribute("id",c),h.setAttribute("maskUnits","objectBoundingBox");const f=ot._svgFactory.createElement("rect");h.append(f),f.setAttribute("width","1"),f.setAttribute("height","1"),f.setAttribute("fill","white");const p=ot._svgFactory.createElement("use");h.append(p),p.setAttribute("href",`#${a}`),p.setAttribute("stroke","none"),p.setAttribute("fill","black"),p.setAttribute("fill-rule","nonzero"),p.classList.add("mask")}const u=ot._svgFactory.createElement("use");i.append(u),u.setAttribute("href",`#${a}`),c&&u.setAttribute("mask",`url(#${c})`);const d=u.cloneNode();return i.append(d),u.classList.add("mainOutline"),d.classList.add("secondaryOutline"),this.updateProperties(i,e),l(this,nn).set(s,i),s}finalizeDraw(e,t){l(this,rl).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var c;if(!t)return;const{root:s,bbox:i,rootClass:r,path:o}=t,a=typeof e=="number"?l(this,nn).get(e):e;if(a){if(s&&S(this,_i,T0).call(this,a,s),i&&S(c=ot,tm,U_).call(c,a,i),r){const{classList:u}=a;for(const[d,h]of Object.entries(r))u.toggle(d,h)}if(o){const d=a.firstChild.firstChild;S(this,_i,T0).call(this,d,o)}}}updateParent(e,t){if(t===this)return;const s=l(this,nn).get(e);s&&(l(t,zs).append(s),l(this,nn).delete(e),l(t,nn).set(e,s))}remove(e){l(this,rl).delete(e),l(this,zs)!==null&&(l(this,nn).get(e).remove(),l(this,nn).delete(e))}destroy(){y(this,zs,null);for(const e of l(this,nn).values())e.remove();l(this,nn).clear(),l(this,rl).clear()}};zs=new WeakMap,nn=new WeakMap,rl=new WeakMap,Af=new WeakMap,tm=new WeakSet,U_=function(e,[t,s,i,r]){const{style:o}=e;o.top=`${100*s}%`,o.left=`${100*t}%`,o.width=`${100*i}%`,o.height=`${100*r}%`},_i=new WeakSet,k0=function(){const e=ot._svgFactory.create(1,1,!0);return l(this,zs).append(e),e.setAttribute("aria-hidden",!0),e},V_=function(e,t){const s=ot._svgFactory.createElement("clipPath");e.append(s);const i=`clip_${t}`;s.setAttribute("id",i),s.setAttribute("clipPathUnits","objectBoundingBox");const r=ot._svgFactory.createElement("use");return s.append(r),r.setAttribute("href",`#${t}`),r.classList.add("clip"),i},T0=function(e,t){for(const[s,i]of Object.entries(t))i===null?e.removeAttribute(s):e.setAttribute(s,i)},A(ot,tm),A(ot,Af,0);let Mg=ot;globalThis._pdfjsTestingUtils={HighlightOutliner:r0};globalThis.pdfjsLib={AbortException:Er,AnnotationEditorLayer:Lg,AnnotationEditorParamsType:de,AnnotationEditorType:Z,AnnotationEditorUIManager:Io,AnnotationLayer:Uw,AnnotationMode:Ai,AnnotationType:Ke,build:Vx,ColorPicker:Wd,createValidAbsoluteUrl:Lw,DOMSVGFactory:Gd,DrawLayer:Mg,FeatureTest:xt,fetchData:Eu,getDocument:zw,getFilenameFromUrl:F1,getPdfFilenameFromUrl:j1,getUuid:Dw,getXfaPageViewport:z1,GlobalWorkerOptions:ps,ImageKind:wd,InvalidPDFException:_g,isDataScheme:Pf,isPdfFile:Sm,isValidExplicitDest:bx,MathClamp:Xt,noContextMenu:As,normalizeUnicode:I1,OPS:Bd,OutputScale:Ws,PasswordResponses:D1,PDFDataRangeTransport:Bw,PDFDateString:Em,PDFWorker:vu,PermissionFlag:M1,PixelsPerInch:xr,RenderingCancelledException:Am,ResponseException:$d,setLayerDimensions:No,shadow:le,SignatureExtractor:Si,stopEvent:Ze,SupportedImageMimeTypes:Cg,TextLayer:Ud,TouchManager:Hd,updateUrlHash:Mw,Util:Y,VerbosityLevel:kf,version:Ux,XfaLayer:$w};const IL=Object.freeze(Object.defineProperty({__proto__:null,AbortException:Er,AnnotationEditorLayer:Lg,AnnotationEditorParamsType:de,AnnotationEditorType:Z,AnnotationEditorUIManager:Io,AnnotationLayer:Uw,AnnotationMode:Ai,AnnotationType:Ke,ColorPicker:Wd,DOMSVGFactory:Gd,DrawLayer:Mg,FeatureTest:xt,GlobalWorkerOptions:ps,ImageKind:wd,InvalidPDFException:_g,MathClamp:Xt,OPS:Bd,OutputScale:Ws,PDFDataRangeTransport:Bw,PDFDateString:Em,PDFWorker:vu,PasswordResponses:D1,PermissionFlag:M1,PixelsPerInch:xr,RenderingCancelledException:Am,ResponseException:$d,SignatureExtractor:Si,SupportedImageMimeTypes:Cg,TextLayer:Ud,TouchManager:Hd,Util:Y,VerbosityLevel:kf,XfaLayer:$w,build:Vx,createValidAbsoluteUrl:Lw,fetchData:Eu,getDocument:zw,getFilenameFromUrl:F1,getPdfFilenameFromUrl:j1,getUuid:Dw,getXfaPageViewport:z1,isDataScheme:Pf,isPdfFile:Sm,isValidExplicitDest:bx,noContextMenu:As,normalizeUnicode:I1,setLayerDimensions:No,shadow:le,stopEvent:Ze,updateUrlHash:Mw,version:Ux},Symbol.toStringTag,{value:"Module"})),OL=["onCopy","onCut","onPaste"],FL=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],jL=["onFocus","onBlur"],zL=["onInput","onInvalid","onReset","onSubmit"],BL=["onLoad","onError"],$L=["onKeyDown","onKeyPress","onKeyUp"],HL=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],UL=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],VL=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],GL=["onSelect"],WL=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],XL=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],YL=["onScroll"],qL=["onWheel"],KL=["onAnimationStart","onAnimationEnd","onAnimationIteration"],QL=["onTransitionEnd"],JL=["onToggle"],ZL=["onChange"],eM=[...OL,...FL,...jL,...zL,...BL,...$L,...HL,...UL,...VL,...GL,...WL,...XL,...YL,...qL,...KL,...QL,...ZL,...JL];function G_(n,e){const t={};for(const s of eM){const i=n[s];i&&(e?t[s]=r=>i(r,e(s)):t[s]=i)}return t}function If(n){let e=!1;return{promise:new Promise((s,i)=>{n.then(r=>!e&&s(r)).catch(r=>!e&&i(r))}),cancel(){e=!0}}}function W_(n){var e,t,s="";if(typeof n=="string"||typeof n=="number")s+=n;else if(typeof n=="object")if(Array.isArray(n)){var i=n.length;for(e=0;e<i;e++)n[e]&&(t=W_(n[e]))&&(s&&(s+=" "),s+=t)}else for(t in n)n[t]&&(s&&(s+=" "),s+=t);return s}function Oo(){for(var n,e,t=0,s="",i=arguments.length;t<i;t++)(n=arguments[t])&&(e=W_(n))&&(s&&(s+=" "),s+=e);return s}var tM="Invariant failed";function Te(n,e){if(!n)throw new Error(tM)}var nM=function(){},sM=nM;const qt=O0(sM);var VA=Object.prototype.hasOwnProperty;function GA(n,e,t){for(t of n.keys())if(ec(t,e))return t}function ec(n,e){var t,s,i;if(n===e)return!0;if(n&&e&&(t=n.constructor)===e.constructor){if(t===Date)return n.getTime()===e.getTime();if(t===RegExp)return n.toString()===e.toString();if(t===Array){if((s=n.length)===e.length)for(;s--&&ec(n[s],e[s]););return s===-1}if(t===Set){if(n.size!==e.size)return!1;for(s of n)if(i=s,i&&typeof i=="object"&&(i=GA(e,i),!i)||!e.has(i))return!1;return!0}if(t===Map){if(n.size!==e.size)return!1;for(s of n)if(i=s[0],i&&typeof i=="object"&&(i=GA(e,i),!i)||!ec(s[1],e.get(i)))return!1;return!0}if(t===ArrayBuffer)n=new Uint8Array(n),e=new Uint8Array(e);else if(t===DataView){if((s=n.byteLength)===e.byteLength)for(;s--&&n.getInt8(s)===e.getInt8(s););return s===-1}if(ArrayBuffer.isView(n)){if((s=n.byteLength)===e.byteLength)for(;s--&&n[s]===e[s];);return s===-1}if(!t||typeof n=="object"){s=0;for(t in n)if(VA.call(n,t)&&++s&&!VA.call(e,t)||!(t in e)||!ec(n[t],e[t]))return!1;return Object.keys(e).length===s}}return n!==n&&e!==e}const X_=R.createContext(null);function tc({children:n,type:e}){return P.jsx("div",{className:`react-pdf__message react-pdf__message--${e}`,children:n})}const iM="noopener noreferrer nofollow";class rM{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(e){this.pdfDocument=e}setViewer(e){this.pdfViewer=e}setExternalLinkRel(e){this.externalLinkRel=e}setExternalLinkTarget(e){this.externalLinkTarget=e}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return Te(this.pdfViewer),this.pdfViewer.currentPageNumber||0}set page(e){Te(this.pdfViewer),this.pdfViewer.currentPageNumber=e}get rotation(){return 0}set rotation(e){}goToDestination(e){return new Promise(t=>{Te(this.pdfDocument),Te(e),typeof e=="string"?this.pdfDocument.getDestination(e).then(t):Array.isArray(e)?t(e):e.then(t)}).then(t=>{Te(Array.isArray(t));const s=t[0];new Promise(i=>{Te(this.pdfDocument),s instanceof Object?this.pdfDocument.getPageIndex(s).then(r=>{i(r)}).catch(()=>{Te(!1)}):typeof s=="number"?i(s):Te(!1)}).then(i=>{const r=i+1;Te(this.pdfViewer),Te(r>=1&&r<=this.pagesCount),this.pdfViewer.scrollPageIntoView({dest:t,pageIndex:i,pageNumber:r})})})}navigateTo(e){this.goToDestination(e)}goToPage(e){const t=e-1;Te(this.pdfViewer),Te(e>=1&&e<=this.pagesCount),this.pdfViewer.scrollPageIntoView({pageIndex:t,pageNumber:e})}addLinkAttributes(e,t,s){e.href=t,e.rel=this.externalLinkRel||iM,e.target=s?"_blank":this.externalLinkTarget||""}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}setHash(){}executeNamedAction(){}cachePageRef(){}isPageVisible(){return!0}isPageCached(){return!0}executeSetOCGState(){}}const WA={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},Cm=typeof window<"u",Y_=Cm&&window.location.protocol==="file:";function oM(n){return typeof n<"u"}function Uo(n){return oM(n)&&n!==null}function aM(n){return typeof n=="string"}function lM(n){return n instanceof ArrayBuffer}function cM(n){return Te(Cm),n instanceof Blob}function R0(n){return aM(n)&&/^data:/.test(n)}function XA(n){Te(R0(n));const[e="",t=""]=n.split(",");return e.split(";").indexOf("base64")!==-1?atob(t):unescape(t)}function uM(){return Cm&&window.devicePixelRatio||1}const q_="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function YA(){qt(!Y_,`Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ${q_}`)}function dM(){qt(!Y_,`Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ${q_}`)}function pl(n){n!=null&&n.cancel&&n.cancel()}function P0(n,e){return Object.defineProperty(n,"width",{get(){return this.view[2]*e},configurable:!0}),Object.defineProperty(n,"height",{get(){return this.view[3]*e},configurable:!0}),Object.defineProperty(n,"originalWidth",{get(){return this.view[2]},configurable:!0}),Object.defineProperty(n,"originalHeight",{get(){return this.view[3]},configurable:!0}),n}function hM(n){return n.name==="RenderingCancelledException"}function fM(n){return new Promise((e,t)=>{const s=new FileReader;s.onload=()=>{if(!s.result)return t(new Error("Error while reading a file."));e(s.result)},s.onerror=i=>{if(!i.target)return t(new Error("Error while reading a file."));const{error:r}=i.target;if(!r)return t(new Error("Error while reading a file."));switch(r.code){case r.NOT_FOUND_ERR:return t(new Error("Error while reading a file: File not found."));case r.SECURITY_ERR:return t(new Error("Error while reading a file: Security error."));case r.ABORT_ERR:return t(new Error("Error while reading a file: Aborted."));default:return t(new Error("Error while reading a file."))}},s.readAsArrayBuffer(n)})}function pM(n,e){switch(e.type){case"RESOLVE":return{value:e.value,error:void 0};case"REJECT":return{value:!1,error:e.error};case"RESET":return{value:void 0,error:void 0};default:return n}}function wu(){return R.useReducer(pM,{value:void 0,error:void 0})}var qA=function(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(n);i<s.length;i++)e.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(n,s[i])&&(t[s[i]]=n[s[i]]);return t};const{PDFDataRangeTransport:gM}=IL,mM=(n,e)=>{switch(e){case WA.NEED_PASSWORD:{const t=prompt("Enter the password to open this PDF file.");n(t);break}case WA.INCORRECT_PASSWORD:{const t=prompt("Invalid password. Please try again.");n(t);break}}};function KA(n){return typeof n=="object"&&n!==null&&("data"in n||"range"in n||"url"in n)}const yM=R.forwardRef(function(e,t){var{children:s,className:i,error:r="Failed to load PDF file.",externalLinkRel:o,externalLinkTarget:a,file:c,inputRef:u,imageResourcesPath:d,loading:h="Loading PDF…",noData:f="No PDF file specified.",onItemClick:p,onLoadError:w,onLoadProgress:g,onLoadSuccess:E,onPassword:m=mM,onSourceError:v,onSourceSuccess:b,options:x,renderMode:_,rotate:k,scale:C}=e,T=qA(e,["children","className","error","externalLinkRel","externalLinkTarget","file","inputRef","imageResourcesPath","loading","noData","onItemClick","onLoadError","onLoadProgress","onLoadSuccess","onPassword","onSourceError","onSourceSuccess","options","renderMode","rotate","scale"]);const[L,M]=wu(),{value:D,error:q}=L,[K,G]=wu(),{value:ee,error:j}=K,O=R.useRef(new rM),I=R.useRef([]),$=R.useRef(void 0),X=R.useRef(void 0);c&&c!==$.current&&KA(c)&&(qt(!ec(c,$.current),`File prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "file" prop.`),$.current=c),x&&x!==X.current&&(qt(!ec(x,X.current),`Options prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "options" prop.`),X.current=x);const re=R.useRef({scrollPageIntoView:pe=>{const{dest:Be,pageNumber:Se,pageIndex:Ss=Se-1}=pe;if(p){p({dest:Be,pageIndex:Ss,pageNumber:Se});return}const ki=I.current[Ss];if(ki){ki.scrollIntoView();return}qt(!1,`An internal link leading to page ${Se} was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>.`)}});R.useImperativeHandle(t,()=>({linkService:O,pages:I,viewer:re}),[]);function Q(){b&&b()}function oe(){q&&(qt(!1,q.toString()),v&&v(q))}function Re(){M({type:"RESET"})}R.useEffect(Re,[c,M]);const We=R.useCallback(async()=>{if(!c)return null;if(typeof c=="string")return R0(c)?{data:XA(c)}:(YA(),{url:c});if(c instanceof gM)return{range:c};if(lM(c))return{data:c};if(Cm&&cM(c))return{data:await fM(c)};if(Te(typeof c=="object"),Te(KA(c)),"url"in c&&typeof c.url=="string"){if(R0(c.url)){const{url:pe}=c,Be=qA(c,["url"]),Se=XA(pe);return Object.assign({data:Se},Be)}YA()}return c},[c]);R.useEffect(()=>{const pe=If(We());return pe.promise.then(Be=>{M({type:"RESOLVE",value:Be})}).catch(Be=>{M({type:"REJECT",error:Be})}),()=>{pl(pe)}},[We,M]),R.useEffect(()=>{if(!(typeof D>"u")){if(D===!1){oe();return}Q()}},[D]);function he(){ee&&(E&&E(ee),I.current=new Array(ee.numPages),O.current.setDocument(ee))}function fe(){j&&(qt(!1,j.toString()),w&&w(j))}R.useEffect(function(){G({type:"RESET"})},[G,D]),R.useEffect(function(){if(!D)return;const Be=x?Object.assign(Object.assign({},D),x):D,Se=zw(Be);g&&(Se.onProgress=g),m&&(Se.onPassword=m);const Ss=Se,ki=Ss.promise.then(Ti=>{G({type:"RESOLVE",value:Ti})}).catch(Ti=>{Ss.destroyed||G({type:"REJECT",error:Ti})});return()=>{ki.finally(()=>Ss.destroy())}},[x,G,D]),R.useEffect(()=>{if(!(typeof ee>"u")){if(ee===!1){fe();return}he()}},[ee]),R.useEffect(function(){O.current.setViewer(re.current),O.current.setExternalLinkRel(o),O.current.setExternalLinkTarget(a)},[o,a]);const xn=R.useCallback((pe,Be)=>{I.current[pe]=Be},[]),_n=R.useCallback(pe=>{delete I.current[pe]},[]),ue=R.useMemo(()=>({imageResourcesPath:d,linkService:O.current,onItemClick:p,pdf:ee,registerPage:xn,renderMode:_,rotate:k,scale:C,unregisterPage:_n}),[d,p,ee,xn,_,k,C,_n]),Cn=R.useMemo(()=>G_(T,()=>ee),[T,ee]);function _t(){return P.jsx(X_.Provider,{value:ue,children:s})}function pt(){return c?ee==null?P.jsx(tc,{type:"loading",children:typeof h=="function"?h():h}):ee===!1?P.jsx(tc,{type:"error",children:typeof r=="function"?r():r}):_t():P.jsx(tc,{type:"no-data",children:typeof f=="function"?f():f})}return P.jsx("div",Object.assign({className:Oo("react-pdf__Document",i),ref:u},Cn,{children:pt()}))});function K_(){return R.useContext(X_)}function Q_(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=n.filter(Boolean);if(t.length<=1){var s=t[0];return s||null}return function(r){for(var o=0,a=t;o<a.length;o++){var c=a[o];typeof c=="function"?c(r):c&&(c.current=r)}}}const J_=R.createContext(null),Z_={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},vM=/^H(\d+)$/;function wM(n){return n in Z_}function km(n){return"children"in n}function eC(n){return km(n)?n.children.length===1&&0 in n.children&&"id"in n.children[0]:!1}function bM(n){const e={};if(km(n)){const{role:t}=n,s=t.match(vM);if(s)e.role="heading",e["aria-level"]=Number(s[1]);else if(wM(t)){const i=Z_[t];i&&(e.role=i)}}return e}function tC(n){const e={};if(km(n)){if(n.alt!==void 0&&(e["aria-label"]=n.alt),n.lang!==void 0&&(e.lang=n.lang),eC(n)){const[t]=n.children;if(t){const s=tC(t);return Object.assign(Object.assign({},e),s)}}}else"id"in n&&(e["aria-owns"]=n.id);return e}function AM(n){return n?Object.assign(Object.assign({},bM(n)),tC(n)):null}function nC({className:n,node:e}){const t=R.useMemo(()=>AM(e),[e]),s=R.useMemo(()=>!km(e)||eC(e)?null:e.children.map((i,r)=>P.jsx(nC,{node:i},r)),[e]);return P.jsx("span",Object.assign({className:n},t,{children:s}))}function Tm(){return R.useContext(J_)}function SM(){const n=Tm();Te(n);const{onGetStructTreeError:e,onGetStructTreeSuccess:t}=n,[s,i]=wu(),{value:r,error:o}=s,{customTextRenderer:a,page:c}=n;function u(){r&&t&&t(r)}function d(){o&&(qt(!1,o.toString()),e&&e(o))}return R.useEffect(function(){i({type:"RESET"})},[i,c]),R.useEffect(function(){if(a||!c)return;const f=If(c.getStructTree()),p=f;return f.promise.then(w=>{i({type:"RESOLVE",value:w})}).catch(w=>{i({type:"REJECT",error:w})}),()=>pl(p)},[a,c,i]),R.useEffect(()=>{if(r!==void 0){if(r===!1){d();return}u()}},[r]),r?P.jsx(nC,{className:"react-pdf__Page__structTree structTree",node:r}):null}const QA=Ai;function EM(n){const e=Tm();Te(e);const t=Object.assign(Object.assign({},e),n),{_className:s,canvasBackground:i,devicePixelRatio:r=uM(),onRenderError:o,onRenderSuccess:a,page:c,renderForms:u,renderTextLayer:d,rotate:h,scale:f}=t,{canvasRef:p}=n;Te(c);const w=R.useRef(null);function g(){c&&a&&a(P0(c,f))}function E(x){hM(x)||(qt(!1,x.toString()),o&&o(x))}const m=R.useMemo(()=>c.getViewport({scale:f*r,rotation:h}),[r,c,h,f]),v=R.useMemo(()=>c.getViewport({scale:f,rotation:h}),[c,h,f]);R.useEffect(function(){if(!c)return;c.cleanup();const{current:_}=w;if(!_)return;_.width=m.width,_.height=m.height,_.style.width=`${Math.floor(v.width)}px`,_.style.height=`${Math.floor(v.height)}px`,_.style.visibility="hidden";const k={annotationMode:u?QA.ENABLE_FORMS:QA.ENABLE,canvasContext:_.getContext("2d",{alpha:!1}),viewport:m};i&&(k.background=i);const C=c.render(k),T=C;return C.promise.then(()=>{_.style.visibility="",g()}).catch(E),()=>pl(T)},[i,c,u,m,v]);const b=R.useCallback(()=>{const{current:x}=w;x&&(x.width=0,x.height=0)},[]);return R.useEffect(()=>b,[b]),P.jsx("canvas",{className:`${s}__canvas`,dir:"ltr",ref:Q_(p,w),style:{display:"block",userSelect:"none"},children:d?P.jsx(SM,{}):null})}function xM(n){return"str"in n}function _M(){const n=Tm();Te(n);const{customTextRenderer:e,onGetTextError:t,onGetTextSuccess:s,onRenderTextLayerError:i,onRenderTextLayerSuccess:r,page:o,pageIndex:a,pageNumber:c,rotate:u,scale:d}=n;Te(o);const[h,f]=wu(),{value:p,error:w}=h,g=R.useRef(null);qt(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer");function E(){p&&s&&s(p)}function m(){w&&(qt(!1,w.toString()),t&&t(w))}R.useEffect(function(){f({type:"RESET"})},[o,f]),R.useEffect(function(){if(!o)return;const T=If(o.getTextContent()),L=T;return T.promise.then(M=>{f({type:"RESOLVE",value:M})}).catch(M=>{f({type:"REJECT",error:M})}),()=>pl(L)},[o,f]),R.useEffect(()=>{if(p!==void 0){if(p===!1){m();return}E()}},[p]);const v=R.useCallback(()=>{r&&r()},[r]),b=R.useCallback(C=>{qt(!1,C.toString()),i&&i(C)},[i]);function x(){const C=g.current;C&&C.classList.add("selecting")}function _(){const C=g.current;C&&C.classList.remove("selecting")}const k=R.useMemo(()=>o.getViewport({scale:d,rotation:u}),[o,u,d]);return R.useLayoutEffect(function(){if(!o||!p)return;const{current:T}=g;if(!T)return;T.innerHTML="";const L=o.streamTextContent({includeMarkedContent:!0}),M={container:T,textContentSource:L,viewport:k},D=new Ud(M),q=D;return D.render().then(()=>{const K=document.createElement("div");K.className="endOfContent",T.append(K);const G=T.querySelectorAll('[role="presentation"]');if(e){let ee=0;p.items.forEach((j,O)=>{if(!xM(j))return;const I=G[ee];if(!I)return;const $=e(Object.assign({pageIndex:a,pageNumber:c,itemIndex:O},j));I.innerHTML=$,ee+=j.str&&j.hasEOL?2:1})}v()}).catch(b),()=>pl(q)},[e,b,v,o,a,c,p,k]),P.jsx("div",{className:Oo("react-pdf__Page__textContent","textLayer"),onMouseUp:_,onMouseDown:x,ref:g})}function CM(){const n=K_(),e=Tm();Te(e);const t=Object.assign(Object.assign({},n),e),{imageResourcesPath:s,linkService:i,onGetAnnotationsError:r,onGetAnnotationsSuccess:o,onRenderAnnotationLayerError:a,onRenderAnnotationLayerSuccess:c,page:u,pdf:d,renderForms:h,rotate:f,scale:p=1}=t;Te(d),Te(u),Te(i);const[w,g]=wu(),{value:E,error:m}=w,v=R.useRef(null);qt(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations");function b(){E&&o&&o(E)}function x(){m&&(qt(!1,m.toString()),r&&r(m))}R.useEffect(function(){g({type:"RESET"})},[g,u]),R.useEffect(function(){if(!u)return;const L=If(u.getAnnotations()),M=L;return L.promise.then(D=>{g({type:"RESOLVE",value:D})}).catch(D=>{g({type:"REJECT",error:D})}),()=>{pl(M)}},[g,u]),R.useEffect(()=>{if(E!==void 0){if(E===!1){x();return}b()}},[E]);function _(){c&&c()}function k(T){qt(!1,`${T}`),a&&a(T)}const C=R.useMemo(()=>u.getViewport({scale:p,rotation:f}),[u,f,p]);return R.useEffect(function(){if(!d||!u||!i||!E)return;const{current:L}=v;if(!L)return;const M=C.clone({dontFlip:!0}),D={accessibilityManager:null,annotationCanvasMap:null,annotationEditorUIManager:null,div:L,l10n:null,page:u,structTreeLayer:null,viewport:M},q={annotations:E,annotationStorage:d.annotationStorage,div:L,imageResourcesPath:s,linkService:i,page:u,renderForms:h,viewport:M};L.innerHTML="";try{new Uw(D).render(q),_()}catch(K){k(K)}return()=>{}},[E,s,i,u,d,h,C]),P.jsx("div",{className:Oo("react-pdf__Page__annotations","annotationLayer"),ref:v})}var kM=function(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(n);i<s.length;i++)e.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(n,s[i])&&(t[s[i]]=n[s[i]]);return t};const JA=1;function TM(n){const e=K_(),t=Object.assign(Object.assign({},e),n),{_className:s="react-pdf__Page",_enableRegisterUnregisterPage:i=!0,canvasBackground:r,canvasRef:o,children:a,className:c,customRenderer:u,customTextRenderer:d,devicePixelRatio:h,error:f="Failed to load the page.",height:p,inputRef:w,loading:g="Loading page…",noData:E="No page specified.",onGetAnnotationsError:m,onGetAnnotationsSuccess:v,onGetStructTreeError:b,onGetStructTreeSuccess:x,onGetTextError:_,onGetTextSuccess:k,onLoadError:C,onLoadSuccess:T,onRenderAnnotationLayerError:L,onRenderAnnotationLayerSuccess:M,onRenderError:D,onRenderSuccess:q,onRenderTextLayerError:K,onRenderTextLayerSuccess:G,pageIndex:ee,pageNumber:j,pdf:O,registerPage:I,renderAnnotationLayer:$=!0,renderForms:X=!1,renderMode:re="canvas",renderTextLayer:Q=!0,rotate:oe,scale:Re=JA,unregisterPage:We,width:he}=t,fe=kM(t,["_className","_enableRegisterUnregisterPage","canvasBackground","canvasRef","children","className","customRenderer","customTextRenderer","devicePixelRatio","error","height","inputRef","loading","noData","onGetAnnotationsError","onGetAnnotationsSuccess","onGetStructTreeError","onGetStructTreeSuccess","onGetTextError","onGetTextSuccess","onLoadError","onLoadSuccess","onRenderAnnotationLayerError","onRenderAnnotationLayerSuccess","onRenderError","onRenderSuccess","onRenderTextLayerError","onRenderTextLayerSuccess","pageIndex","pageNumber","pdf","registerPage","renderAnnotationLayer","renderForms","renderMode","renderTextLayer","rotate","scale","unregisterPage","width"]),[xn,_n]=wu(),{value:ue,error:Cn}=xn,_t=R.useRef(null);Te(O);const pt=Uo(j)?j-1:ee??null,pe=j??(Uo(ee)?ee+1:null),Be=oe??(ue?ue.rotate:null),Se=R.useMemo(()=>{if(!ue)return null;let kn=1;const Es=Re??JA;if(he||p){const Ks=ue.getViewport({scale:1,rotation:Be});he?kn=he/Ks.width:p&&(kn=p/Ks.height)}return Es*kn},[p,ue,Be,Re,he]);R.useEffect(function(){return()=>{Uo(pt)&&i&&We&&We(pt)}},[i,O,pt,We]);function Ss(){if(T){if(!ue||!Se)return;T(P0(ue,Se))}if(i&&I){if(!Uo(pt)||!_t.current)return;I(pt,_t.current)}}function ki(){Cn&&(qt(!1,Cn.toString()),C&&C(Cn))}R.useEffect(function(){_n({type:"RESET"})},[_n,O,pt]),R.useEffect(function(){if(!O||!pe)return;const Es=If(O.getPage(pe)),Ks=Es;return Es.promise.then(Al=>{_n({type:"RESOLVE",value:Al})}).catch(Al=>{_n({type:"REJECT",error:Al})}),()=>pl(Ks)},[_n,O,pe]),R.useEffect(()=>{if(ue!==void 0){if(ue===!1){ki();return}Ss()}},[ue,Se]);const Ti=R.useMemo(()=>ue&&Uo(pt)&&pe&&Uo(Be)&&Uo(Se)?{_className:s,canvasBackground:r,customTextRenderer:d,devicePixelRatio:h,onGetAnnotationsError:m,onGetAnnotationsSuccess:v,onGetStructTreeError:b,onGetStructTreeSuccess:x,onGetTextError:_,onGetTextSuccess:k,onRenderAnnotationLayerError:L,onRenderAnnotationLayerSuccess:M,onRenderError:D,onRenderSuccess:q,onRenderTextLayerError:K,onRenderTextLayerSuccess:G,page:ue,pageIndex:pt,pageNumber:pe,renderForms:X,renderTextLayer:Q,rotate:Be,scale:Se}:null,[s,r,d,h,m,v,b,x,_,k,L,M,D,q,K,G,ue,pt,pe,X,Q,Be,Se]),qs=R.useMemo(()=>G_(fe,()=>ue&&(Se?P0(ue,Se):void 0)),[fe,ue,Se]),Ri=`${pt}@${Se}/${Be}`;function bl(){switch(re){case"custom":return Te(u),P.jsx(u,{},`${Ri}_custom`);case"none":return null;case"canvas":default:return P.jsx(EM,{canvasRef:o},`${Ri}_canvas`)}}function zf(){return Q?P.jsx(_M,{},`${Ri}_text`):null}function Bf(){return $?P.jsx(CM,{},`${Ri}_annotations`):null}function Lm(){return P.jsxs(J_.Provider,{value:Ti,children:[bl(),zf(),Bf(),a]})}function Mm(){return pe?O===null||ue===void 0||ue===null?P.jsx(tc,{type:"loading",children:typeof g=="function"?g():g}):O===!1||ue===!1?P.jsx(tc,{type:"error",children:typeof f=="function"?f():f}):Lm():P.jsx(tc,{type:"no-data",children:typeof E=="function"?E():E})}return P.jsx("div",Object.assign({className:Oo(s,c),"data-page-number":pe,ref:Q_(w,_t),style:{"--scale-round-x":"1px","--scale-round-y":"1px","--scale-factor":"1","--user-unit":`${Se}`,"--total-scale-factor":"calc(var(--scale-factor) * var(--user-unit))",backgroundColor:r||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"}},qs,{children:Mm()}))}dM();ps.workerSrc="pdf.worker.mjs";const RM=({assetId:n,pdfUrl:e,initialParsedData:t,onSave:s,onConfirm:i,onAnalyze:r,onClose:o})=>{const[a,c]=R.useState(null),[u,d]=R.useState(1),[h,f]=R.useState(t),[p,w]=R.useState(!1);function g({numPages:C}){c(C),d(1)}const E=()=>d(C=>Math.max(C-1,1)),m=()=>d(C=>Math.min(C+1,a||1)),v=(C,T)=>{f(L=>({...L,[C]:T})),w(!0)},b=()=>{s(n,h),w(!1)},x=()=>{p&&!window.confirm("You have unsaved changes. Re-analysing will discard your edits. Do you want to continue?")||r(n)},_=()=>{i(n,h),w(!1),o()},k=()=>{p&&!window.confirm("You have unsaved changes. Close without saving?")||o()};return P.jsxs("div",{className:"flex flex-1 w-full h-full",children:[P.jsxs("div",{className:"w-1/2 h-full border-r border-gray-200 flex flex-col bg-gray-50",children:[P.jsx("div",{className:"flex-grow overflow-y-auto",children:P.jsx(yM,{file:e,onLoadSuccess:g,loading:P.jsx("p",{className:"p-4 text-center",children:"Loading PDF..."}),error:P.jsx("p",{className:"p-4 text-center text-red-500",children:"Failed to load PDF. Please check the file URL and ensure the backend is running."}),children:P.jsx(TM,{pageNumber:u})})}),a&&P.jsxs("div",{className:"flex items-center justify-center p-2 border-t bg-white shadow-sm",children:[P.jsx("button",{onClick:E,disabled:u<=1,className:"px-3 py-1 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Prev"}),P.jsxs("p",{className:"text-sm text-gray-700 mx-4",children:["Page ",u," of ",a]}),P.jsx("button",{onClick:m,disabled:u>=a,className:"px-3 py-1 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]}),P.jsxs("div",{className:"w-1/2 h-full flex flex-col overflow-y-auto bg-white",children:[P.jsxs("div",{className:"p-4 flex justify-between items-center border-b",children:[P.jsx("h2",{className:"text-lg font-semibold",children:"Review & Confirm"}),P.jsx("button",{onClick:k,className:"p-2 rounded-full hover:bg-gray-200","aria-label":"Close",children:"×"})]}),P.jsx("div",{className:"p-4 flex-grow space-y-4",children:Object.entries(h).map(([C,T])=>P.jsxs("div",{children:[P.jsx("label",{className:"block text-sm font-medium text-gray-700 capitalize",children:C.replace(/_/g," ")}),typeof T=="object"&&T!==null?P.jsx("textarea",{value:JSON.stringify(T,null,2),onChange:L=>{try{const M=JSON.parse(L.target.value);v(C,M)}catch{v(C,L.target.value)}},rows:4,className:"mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm font-mono"}):P.jsx("input",{type:"text",value:String(T??""),onChange:L=>v(C,L.target.value),className:"mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]},C))}),P.jsxs("div",{className:"p-4 border-t bg-gray-50 flex justify-end space-x-3",children:[P.jsx("button",{onClick:b,className:"px-4 py-2 text-sm font-medium text-white bg-green-600 border border-transparent rounded-md shadow-sm hover:bg-green-700 focus:outline-none",children:"Save"}),P.jsx("button",{onClick:_,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700 focus:outline-none",children:"Confirm & Close"}),P.jsx("button",{onClick:x,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700 focus:outline-none",children:"Re-Analyze"})]})]})]})},Rm=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function xu(n){const e=Object.prototype.toString.call(n);return e==="[object Window]"||e==="[object global]"}function Ww(n){return"nodeType"in n}function En(n){var e,t;return n?xu(n)?n:Ww(n)&&(e=(t=n.ownerDocument)==null?void 0:t.defaultView)!=null?e:window:window}function Xw(n){const{Document:e}=En(n);return n instanceof e}function Of(n){return xu(n)?!1:n instanceof En(n).HTMLElement}function sC(n){return n instanceof En(n).SVGElement}function _u(n){return n?xu(n)?n.document:Ww(n)?Xw(n)?n:Of(n)||sC(n)?n.ownerDocument:document:document:document}const gl=Rm?R.useLayoutEffect:R.useEffect;function Yw(n){const e=R.useRef(n);return gl(()=>{e.current=n}),R.useCallback(function(){for(var t=arguments.length,s=new Array(t),i=0;i<t;i++)s[i]=arguments[i];return e.current==null?void 0:e.current(...s)},[])}function PM(){const n=R.useRef(null),e=R.useCallback((s,i)=>{n.current=setInterval(s,i)},[]),t=R.useCallback(()=>{n.current!==null&&(clearInterval(n.current),n.current=null)},[]);return[e,t]}function Dg(n,e){e===void 0&&(e=[n]);const t=R.useRef(n);return gl(()=>{t.current!==n&&(t.current=n)},e),t}function Ff(n,e){const t=R.useRef();return R.useMemo(()=>{const s=n(t.current);return t.current=s,s},[...e])}function iC(n){const e=Yw(n),t=R.useRef(null),s=R.useCallback(i=>{i!==t.current&&(e==null||e(i,t.current)),t.current=i},[]);return[t,s]}function L0(n){const e=R.useRef();return R.useEffect(()=>{e.current=n},[n]),e.current}let yy={};function qw(n,e){return R.useMemo(()=>{if(e)return e;const t=yy[n]==null?0:yy[n]+1;return yy[n]=t,n+"-"+t},[n,e])}function rC(n){return function(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),i=1;i<t;i++)s[i-1]=arguments[i];return s.reduce((r,o)=>{const a=Object.entries(o);for(const[c,u]of a){const d=r[c];d!=null&&(r[c]=d+n*u)}return r},{...e})}}const nc=rC(1),Ng=rC(-1);function LM(n){return"clientX"in n&&"clientY"in n}function oC(n){if(!n)return!1;const{KeyboardEvent:e}=En(n.target);return e&&n instanceof e}function MM(n){if(!n)return!1;const{TouchEvent:e}=En(n.target);return e&&n instanceof e}function M0(n){if(MM(n)){if(n.touches&&n.touches.length){const{clientX:e,clientY:t}=n.touches[0];return{x:e,y:t}}else if(n.changedTouches&&n.changedTouches.length){const{clientX:e,clientY:t}=n.changedTouches[0];return{x:e,y:t}}}return LM(n)?{x:n.clientX,y:n.clientY}:null}const ZA="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function DM(n){return n.matches(ZA)?n:n.querySelector(ZA)}const NM={display:"none"};function IM(n){let{id:e,value:t}=n;return on.createElement("div",{id:e,style:NM},t)}function OM(n){let{id:e,announcement:t,ariaLiveType:s="assertive"}=n;const i={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return on.createElement("div",{id:e,style:i,role:"status","aria-live":s,"aria-atomic":!0},t)}function FM(){const[n,e]=R.useState("");return{announce:R.useCallback(s=>{s!=null&&e(s)},[]),announcement:n}}const aC=R.createContext(null);function jM(n){const e=R.useContext(aC);R.useEffect(()=>{if(!e)throw new Error("useDndMonitor must be used within a children of <DndContext>");return e(n)},[n,e])}function zM(){const[n]=R.useState(()=>new Set),e=R.useCallback(s=>(n.add(s),()=>n.delete(s)),[n]);return[R.useCallback(s=>{let{type:i,event:r}=s;n.forEach(o=>{var a;return(a=o[i])==null?void 0:a.call(o,r)})},[n]),e]}const BM={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},$M={onDragStart(n){let{active:e}=n;return"Picked up draggable item "+e.id+"."},onDragOver(n){let{active:e,over:t}=n;return t?"Draggable item "+e.id+" was moved over droppable area "+t.id+".":"Draggable item "+e.id+" is no longer over a droppable area."},onDragEnd(n){let{active:e,over:t}=n;return t?"Draggable item "+e.id+" was dropped over droppable area "+t.id:"Draggable item "+e.id+" was dropped."},onDragCancel(n){let{active:e}=n;return"Dragging was cancelled. Draggable item "+e.id+" was dropped."}};function HM(n){let{announcements:e=$M,container:t,hiddenTextDescribedById:s,screenReaderInstructions:i=BM}=n;const{announce:r,announcement:o}=FM(),a=qw("DndLiveRegion"),[c,u]=R.useState(!1);if(R.useEffect(()=>{u(!0)},[]),jM(R.useMemo(()=>({onDragStart(h){let{active:f}=h;r(e.onDragStart({active:f}))},onDragMove(h){let{active:f,over:p}=h;e.onDragMove&&r(e.onDragMove({active:f,over:p}))},onDragOver(h){let{active:f,over:p}=h;r(e.onDragOver({active:f,over:p}))},onDragEnd(h){let{active:f,over:p}=h;r(e.onDragEnd({active:f,over:p}))},onDragCancel(h){let{active:f,over:p}=h;r(e.onDragCancel({active:f,over:p}))}}),[r,e])),!c)return null;const d=on.createElement(on.Fragment,null,on.createElement(IM,{id:s,value:i.draggable}),on.createElement(OM,{id:a,announcement:o}));return t?Ul.createPortal(d,t):d}var dt;(function(n){n.DragStart="dragStart",n.DragMove="dragMove",n.DragEnd="dragEnd",n.DragCancel="dragCancel",n.DragOver="dragOver",n.RegisterDroppable="registerDroppable",n.SetDroppableDisabled="setDroppableDisabled",n.UnregisterDroppable="unregisterDroppable"})(dt||(dt={}));function Ig(){}function UM(n,e){return R.useMemo(()=>({sensor:n,options:{}}),[n,e])}function VM(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return R.useMemo(()=>[...e].filter(s=>s!=null),[...e])}const Xs=Object.freeze({x:0,y:0});function GM(n,e){let{data:{value:t}}=n,{data:{value:s}}=e;return s-t}function WM(n,e){if(!n||n.length===0)return null;const[t]=n;return t[e]}function XM(n,e){const t=Math.max(e.top,n.top),s=Math.max(e.left,n.left),i=Math.min(e.left+e.width,n.left+n.width),r=Math.min(e.top+e.height,n.top+n.height),o=i-s,a=r-t;if(s<i&&t<r){const c=e.width*e.height,u=n.width*n.height,d=o*a,h=d/(c+u-d);return Number(h.toFixed(4))}return 0}const YM=n=>{let{collisionRect:e,droppableRects:t,droppableContainers:s}=n;const i=[];for(const r of s){const{id:o}=r,a=t.get(o);if(a){const c=XM(a,e);c>0&&i.push({id:o,data:{droppableContainer:r,value:c}})}}return i.sort(GM)};function qM(n,e,t){return{...n,scaleX:e&&t?e.width/t.width:1,scaleY:e&&t?e.height/t.height:1}}function lC(n,e){return n&&e?{x:n.left-e.left,y:n.top-e.top}:Xs}function KM(n){return function(t){for(var s=arguments.length,i=new Array(s>1?s-1:0),r=1;r<s;r++)i[r-1]=arguments[r];return i.reduce((o,a)=>({...o,top:o.top+n*a.y,bottom:o.bottom+n*a.y,left:o.left+n*a.x,right:o.right+n*a.x}),{...t})}}const QM=KM(1);function JM(n){if(n.startsWith("matrix3d(")){const e=n.slice(9,-1).split(/, /);return{x:+e[12],y:+e[13],scaleX:+e[0],scaleY:+e[5]}}else if(n.startsWith("matrix(")){const e=n.slice(7,-1).split(/, /);return{x:+e[4],y:+e[5],scaleX:+e[0],scaleY:+e[3]}}return null}function ZM(n,e,t){const s=JM(e);if(!s)return n;const{scaleX:i,scaleY:r,x:o,y:a}=s,c=n.left-o-(1-i)*parseFloat(t),u=n.top-a-(1-r)*parseFloat(t.slice(t.indexOf(" ")+1)),d=i?n.width/i:n.width,h=r?n.height/r:n.height;return{width:d,height:h,top:u,right:c+d,bottom:u+h,left:c}}const e2={ignoreTransform:!1};function jf(n,e){e===void 0&&(e=e2);let t=n.getBoundingClientRect();if(e.ignoreTransform){const{transform:u,transformOrigin:d}=En(n).getComputedStyle(n);u&&(t=ZM(t,u,d))}const{top:s,left:i,width:r,height:o,bottom:a,right:c}=t;return{top:s,left:i,width:r,height:o,bottom:a,right:c}}function eS(n){return jf(n,{ignoreTransform:!0})}function t2(n){const e=n.innerWidth,t=n.innerHeight;return{top:0,left:0,right:e,bottom:t,width:e,height:t}}function n2(n,e){return e===void 0&&(e=En(n).getComputedStyle(n)),e.position==="fixed"}function s2(n,e){e===void 0&&(e=En(n).getComputedStyle(n));const t=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(i=>{const r=e[i];return typeof r=="string"?t.test(r):!1})}function Kw(n,e){const t=[];function s(i){if(e!=null&&t.length>=e||!i)return t;if(Xw(i)&&i.scrollingElement!=null&&!t.includes(i.scrollingElement))return t.push(i.scrollingElement),t;if(!Of(i)||sC(i)||t.includes(i))return t;const r=En(n).getComputedStyle(i);return i!==n&&s2(i,r)&&t.push(i),n2(i,r)?t:s(i.parentNode)}return n?s(n):t}function cC(n){const[e]=Kw(n,1);return e??null}function vy(n){return!Rm||!n?null:xu(n)?n:Ww(n)?Xw(n)||n===_u(n).scrollingElement?window:Of(n)?n:null:null}function uC(n){return xu(n)?n.scrollX:n.scrollLeft}function dC(n){return xu(n)?n.scrollY:n.scrollTop}function D0(n){return{x:uC(n),y:dC(n)}}var St;(function(n){n[n.Forward=1]="Forward",n[n.Backward=-1]="Backward"})(St||(St={}));function hC(n){return!Rm||!n?!1:n===document.scrollingElement}function fC(n){const e={x:0,y:0},t=hC(n)?{height:window.innerHeight,width:window.innerWidth}:{height:n.clientHeight,width:n.clientWidth},s={x:n.scrollWidth-t.width,y:n.scrollHeight-t.height},i=n.scrollTop<=e.y,r=n.scrollLeft<=e.x,o=n.scrollTop>=s.y,a=n.scrollLeft>=s.x;return{isTop:i,isLeft:r,isBottom:o,isRight:a,maxScroll:s,minScroll:e}}const i2={x:.2,y:.2};function r2(n,e,t,s,i){let{top:r,left:o,right:a,bottom:c}=t;s===void 0&&(s=10),i===void 0&&(i=i2);const{isTop:u,isBottom:d,isLeft:h,isRight:f}=fC(n),p={x:0,y:0},w={x:0,y:0},g={height:e.height*i.y,width:e.width*i.x};return!u&&r<=e.top+g.height?(p.y=St.Backward,w.y=s*Math.abs((e.top+g.height-r)/g.height)):!d&&c>=e.bottom-g.height&&(p.y=St.Forward,w.y=s*Math.abs((e.bottom-g.height-c)/g.height)),!f&&a>=e.right-g.width?(p.x=St.Forward,w.x=s*Math.abs((e.right-g.width-a)/g.width)):!h&&o<=e.left+g.width&&(p.x=St.Backward,w.x=s*Math.abs((e.left+g.width-o)/g.width)),{direction:p,speed:w}}function o2(n){if(n===document.scrollingElement){const{innerWidth:r,innerHeight:o}=window;return{top:0,left:0,right:r,bottom:o,width:r,height:o}}const{top:e,left:t,right:s,bottom:i}=n.getBoundingClientRect();return{top:e,left:t,right:s,bottom:i,width:n.clientWidth,height:n.clientHeight}}function pC(n){return n.reduce((e,t)=>nc(e,D0(t)),Xs)}function a2(n){return n.reduce((e,t)=>e+uC(t),0)}function l2(n){return n.reduce((e,t)=>e+dC(t),0)}function c2(n,e){if(e===void 0&&(e=jf),!n)return;const{top:t,left:s,bottom:i,right:r}=e(n);cC(n)&&(i<=0||r<=0||t>=window.innerHeight||s>=window.innerWidth)&&n.scrollIntoView({block:"center",inline:"center"})}const u2=[["x",["left","right"],a2],["y",["top","bottom"],l2]];class Qw{constructor(e,t){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const s=Kw(t),i=pC(s);this.rect={...e},this.width=e.width,this.height=e.height;for(const[r,o,a]of u2)for(const c of o)Object.defineProperty(this,c,{get:()=>{const u=a(s),d=i[r]-u;return this.rect[c]+d},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class bd{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(t=>{var s;return(s=this.target)==null?void 0:s.removeEventListener(...t)})},this.target=e}add(e,t,s){var i;(i=this.target)==null||i.addEventListener(e,t,s),this.listeners.push([e,t,s])}}function d2(n){const{EventTarget:e}=En(n);return n instanceof e?n:_u(n)}function wy(n,e){const t=Math.abs(n.x),s=Math.abs(n.y);return typeof e=="number"?Math.sqrt(t**2+s**2)>e:"x"in e&&"y"in e?t>e.x&&s>e.y:"x"in e?t>e.x:"y"in e?s>e.y:!1}var ds;(function(n){n.Click="click",n.DragStart="dragstart",n.Keydown="keydown",n.ContextMenu="contextmenu",n.Resize="resize",n.SelectionChange="selectionchange",n.VisibilityChange="visibilitychange"})(ds||(ds={}));function tS(n){n.preventDefault()}function h2(n){n.stopPropagation()}var ke;(function(n){n.Space="Space",n.Down="ArrowDown",n.Right="ArrowRight",n.Left="ArrowLeft",n.Up="ArrowUp",n.Esc="Escape",n.Enter="Enter",n.Tab="Tab"})(ke||(ke={}));const gC={start:[ke.Space,ke.Enter],cancel:[ke.Esc],end:[ke.Space,ke.Enter,ke.Tab]},f2=(n,e)=>{let{currentCoordinates:t}=e;switch(n.code){case ke.Right:return{...t,x:t.x+25};case ke.Left:return{...t,x:t.x-25};case ke.Down:return{...t,y:t.y+25};case ke.Up:return{...t,y:t.y-25}}};class mC{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:t}}=e;this.props=e,this.listeners=new bd(_u(t)),this.windowListeners=new bd(En(t)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(ds.Resize,this.handleCancel),this.windowListeners.add(ds.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(ds.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:e,onStart:t}=this.props,s=e.node.current;s&&c2(s),t(Xs)}handleKeyDown(e){if(oC(e)){const{active:t,context:s,options:i}=this.props,{keyboardCodes:r=gC,coordinateGetter:o=f2,scrollBehavior:a="smooth"}=i,{code:c}=e;if(r.end.includes(c)){this.handleEnd(e);return}if(r.cancel.includes(c)){this.handleCancel(e);return}const{collisionRect:u}=s.current,d=u?{x:u.left,y:u.top}:Xs;this.referenceCoordinates||(this.referenceCoordinates=d);const h=o(e,{active:t,context:s.current,currentCoordinates:d});if(h){const f=Ng(h,d),p={x:0,y:0},{scrollableAncestors:w}=s.current;for(const g of w){const E=e.code,{isTop:m,isRight:v,isLeft:b,isBottom:x,maxScroll:_,minScroll:k}=fC(g),C=o2(g),T={x:Math.min(E===ke.Right?C.right-C.width/2:C.right,Math.max(E===ke.Right?C.left:C.left+C.width/2,h.x)),y:Math.min(E===ke.Down?C.bottom-C.height/2:C.bottom,Math.max(E===ke.Down?C.top:C.top+C.height/2,h.y))},L=E===ke.Right&&!v||E===ke.Left&&!b,M=E===ke.Down&&!x||E===ke.Up&&!m;if(L&&T.x!==h.x){const D=g.scrollLeft+f.x,q=E===ke.Right&&D<=_.x||E===ke.Left&&D>=k.x;if(q&&!f.y){g.scrollTo({left:D,behavior:a});return}q?p.x=g.scrollLeft-D:p.x=E===ke.Right?g.scrollLeft-_.x:g.scrollLeft-k.x,p.x&&g.scrollBy({left:-p.x,behavior:a});break}else if(M&&T.y!==h.y){const D=g.scrollTop+f.y,q=E===ke.Down&&D<=_.y||E===ke.Up&&D>=k.y;if(q&&!f.x){g.scrollTo({top:D,behavior:a});return}q?p.y=g.scrollTop-D:p.y=E===ke.Down?g.scrollTop-_.y:g.scrollTop-k.y,p.y&&g.scrollBy({top:-p.y,behavior:a});break}}this.handleMove(e,nc(Ng(h,this.referenceCoordinates),p))}}}handleMove(e,t){const{onMove:s}=this.props;e.preventDefault(),s(t)}handleEnd(e){const{onEnd:t}=this.props;e.preventDefault(),this.detach(),t()}handleCancel(e){const{onCancel:t}=this.props;e.preventDefault(),this.detach(),t()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}mC.activators=[{eventName:"onKeyDown",handler:(n,e,t)=>{let{keyboardCodes:s=gC,onActivation:i}=e,{active:r}=t;const{code:o}=n.nativeEvent;if(s.start.includes(o)){const a=r.activatorNode.current;return a&&n.target!==a?!1:(n.preventDefault(),i==null||i({event:n.nativeEvent}),!0)}return!1}}];function nS(n){return!!(n&&"distance"in n)}function sS(n){return!!(n&&"delay"in n)}class Jw{constructor(e,t,s){var i;s===void 0&&(s=d2(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=t;const{event:r}=e,{target:o}=r;this.props=e,this.events=t,this.document=_u(o),this.documentListeners=new bd(this.document),this.listeners=new bd(s),this.windowListeners=new bd(En(o)),this.initialCoordinates=(i=M0(r))!=null?i:Xs,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:t,bypassActivationConstraint:s}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(ds.Resize,this.handleCancel),this.windowListeners.add(ds.DragStart,tS),this.windowListeners.add(ds.VisibilityChange,this.handleCancel),this.windowListeners.add(ds.ContextMenu,tS),this.documentListeners.add(ds.Keydown,this.handleKeydown),t){if(s!=null&&s({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(sS(t)){this.timeoutId=setTimeout(this.handleStart,t.delay),this.handlePending(t);return}if(nS(t)){this.handlePending(t);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,t){const{active:s,onPending:i}=this.props;i(s,e,this.initialCoordinates,t)}handleStart(){const{initialCoordinates:e}=this,{onStart:t}=this.props;e&&(this.activated=!0,this.documentListeners.add(ds.Click,h2,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(ds.SelectionChange,this.removeTextSelection),t(e))}handleMove(e){var t;const{activated:s,initialCoordinates:i,props:r}=this,{onMove:o,options:{activationConstraint:a}}=r;if(!i)return;const c=(t=M0(e))!=null?t:Xs,u=Ng(i,c);if(!s&&a){if(nS(a)){if(a.tolerance!=null&&wy(u,a.tolerance))return this.handleCancel();if(wy(u,a.distance))return this.handleStart()}if(sS(a)&&wy(u,a.tolerance))return this.handleCancel();this.handlePending(a,u);return}e.cancelable&&e.preventDefault(),o(c)}handleEnd(){const{onAbort:e,onEnd:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleCancel(){const{onAbort:e,onCancel:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleKeydown(e){e.code===ke.Esc&&this.handleCancel()}removeTextSelection(){var e;(e=this.document.getSelection())==null||e.removeAllRanges()}}const p2={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class Zw extends Jw{constructor(e){const{event:t}=e,s=_u(t.target);super(e,p2,s)}}Zw.activators=[{eventName:"onPointerDown",handler:(n,e)=>{let{nativeEvent:t}=n,{onActivation:s}=e;return!t.isPrimary||t.button!==0?!1:(s==null||s({event:t}),!0)}}];const g2={move:{name:"mousemove"},end:{name:"mouseup"}};var N0;(function(n){n[n.RightClick=2]="RightClick"})(N0||(N0={}));class m2 extends Jw{constructor(e){super(e,g2,_u(e.event.target))}}m2.activators=[{eventName:"onMouseDown",handler:(n,e)=>{let{nativeEvent:t}=n,{onActivation:s}=e;return t.button===N0.RightClick?!1:(s==null||s({event:t}),!0)}}];const by={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class y2 extends Jw{constructor(e){super(e,by)}static setup(){return window.addEventListener(by.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(by.move.name,e)};function e(){}}}y2.activators=[{eventName:"onTouchStart",handler:(n,e)=>{let{nativeEvent:t}=n,{onActivation:s}=e;const{touches:i}=t;return i.length>1?!1:(s==null||s({event:t}),!0)}}];var Ad;(function(n){n[n.Pointer=0]="Pointer",n[n.DraggableRect=1]="DraggableRect"})(Ad||(Ad={}));var Og;(function(n){n[n.TreeOrder=0]="TreeOrder",n[n.ReversedTreeOrder=1]="ReversedTreeOrder"})(Og||(Og={}));function v2(n){let{acceleration:e,activator:t=Ad.Pointer,canScroll:s,draggingRect:i,enabled:r,interval:o=5,order:a=Og.TreeOrder,pointerCoordinates:c,scrollableAncestors:u,scrollableAncestorRects:d,delta:h,threshold:f}=n;const p=b2({delta:h,disabled:!r}),[w,g]=PM(),E=R.useRef({x:0,y:0}),m=R.useRef({x:0,y:0}),v=R.useMemo(()=>{switch(t){case Ad.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case Ad.DraggableRect:return i}},[t,i,c]),b=R.useRef(null),x=R.useCallback(()=>{const k=b.current;if(!k)return;const C=E.current.x*m.current.x,T=E.current.y*m.current.y;k.scrollBy(C,T)},[]),_=R.useMemo(()=>a===Og.TreeOrder?[...u].reverse():u,[a,u]);R.useEffect(()=>{if(!r||!u.length||!v){g();return}for(const k of _){if((s==null?void 0:s(k))===!1)continue;const C=u.indexOf(k),T=d[C];if(!T)continue;const{direction:L,speed:M}=r2(k,T,v,e,f);for(const D of["x","y"])p[D][L[D]]||(M[D]=0,L[D]=0);if(M.x>0||M.y>0){g(),b.current=k,w(x,o),E.current=M,m.current=L;return}}E.current={x:0,y:0},m.current={x:0,y:0},g()},[e,x,s,g,r,o,JSON.stringify(v),JSON.stringify(p),w,u,_,d,JSON.stringify(f)])}const w2={x:{[St.Backward]:!1,[St.Forward]:!1},y:{[St.Backward]:!1,[St.Forward]:!1}};function b2(n){let{delta:e,disabled:t}=n;const s=L0(e);return Ff(i=>{if(t||!s||!i)return w2;const r={x:Math.sign(e.x-s.x),y:Math.sign(e.y-s.y)};return{x:{[St.Backward]:i.x[St.Backward]||r.x===-1,[St.Forward]:i.x[St.Forward]||r.x===1},y:{[St.Backward]:i.y[St.Backward]||r.y===-1,[St.Forward]:i.y[St.Forward]||r.y===1}}},[t,e,s])}function A2(n,e){const t=e!=null?n.get(e):void 0,s=t?t.node.current:null;return Ff(i=>{var r;return e==null?null:(r=s??i)!=null?r:null},[s,e])}function S2(n,e){return R.useMemo(()=>n.reduce((t,s)=>{const{sensor:i}=s,r=i.activators.map(o=>({eventName:o.eventName,handler:e(o.handler,s)}));return[...t,...r]},[]),[n,e])}var Xd;(function(n){n[n.Always=0]="Always",n[n.BeforeDragging=1]="BeforeDragging",n[n.WhileDragging=2]="WhileDragging"})(Xd||(Xd={}));var I0;(function(n){n.Optimized="optimized"})(I0||(I0={}));const iS=new Map;function E2(n,e){let{dragging:t,dependencies:s,config:i}=e;const[r,o]=R.useState(null),{frequency:a,measure:c,strategy:u}=i,d=R.useRef(n),h=E(),f=Dg(h),p=R.useCallback(function(m){m===void 0&&(m=[]),!f.current&&o(v=>v===null?m:v.concat(m.filter(b=>!v.includes(b))))},[f]),w=R.useRef(null),g=Ff(m=>{if(h&&!t)return iS;if(!m||m===iS||d.current!==n||r!=null){const v=new Map;for(let b of n){if(!b)continue;if(r&&r.length>0&&!r.includes(b.id)&&b.rect.current){v.set(b.id,b.rect.current);continue}const x=b.node.current,_=x?new Qw(c(x),x):null;b.rect.current=_,_&&v.set(b.id,_)}return v}return m},[n,r,t,h,c]);return R.useEffect(()=>{d.current=n},[n]),R.useEffect(()=>{h||p()},[t,h]),R.useEffect(()=>{r&&r.length>0&&o(null)},[JSON.stringify(r)]),R.useEffect(()=>{h||typeof a!="number"||w.current!==null||(w.current=setTimeout(()=>{p(),w.current=null},a))},[a,h,p,...s]),{droppableRects:g,measureDroppableContainers:p,measuringScheduled:r!=null};function E(){switch(u){case Xd.Always:return!1;case Xd.BeforeDragging:return t;default:return!t}}}function yC(n,e){return Ff(t=>n?t||(typeof e=="function"?e(n):n):null,[e,n])}function x2(n,e){return yC(n,e)}function _2(n){let{callback:e,disabled:t}=n;const s=Yw(e),i=R.useMemo(()=>{if(t||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:r}=window;return new r(s)},[s,t]);return R.useEffect(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function Pm(n){let{callback:e,disabled:t}=n;const s=Yw(e),i=R.useMemo(()=>{if(t||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:r}=window;return new r(s)},[t]);return R.useEffect(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function C2(n){return new Qw(jf(n),n)}function rS(n,e,t){e===void 0&&(e=C2);const[s,i]=R.useState(null);function r(){i(c=>{if(!n)return null;if(n.isConnected===!1){var u;return(u=c??t)!=null?u:null}const d=e(n);return JSON.stringify(c)===JSON.stringify(d)?c:d})}const o=_2({callback(c){if(n)for(const u of c){const{type:d,target:h}=u;if(d==="childList"&&h instanceof HTMLElement&&h.contains(n)){r();break}}}}),a=Pm({callback:r});return gl(()=>{r(),n?(a==null||a.observe(n),o==null||o.observe(document.body,{childList:!0,subtree:!0})):(a==null||a.disconnect(),o==null||o.disconnect())},[n]),s}function k2(n){const e=yC(n);return lC(n,e)}const oS=[];function T2(n){const e=R.useRef(n),t=Ff(s=>n?s&&s!==oS&&n&&e.current&&n.parentNode===e.current.parentNode?s:Kw(n):oS,[n]);return R.useEffect(()=>{e.current=n},[n]),t}function R2(n){const[e,t]=R.useState(null),s=R.useRef(n),i=R.useCallback(r=>{const o=vy(r.target);o&&t(a=>a?(a.set(o,D0(o)),new Map(a)):null)},[]);return R.useEffect(()=>{const r=s.current;if(n!==r){o(r);const a=n.map(c=>{const u=vy(c);return u?(u.addEventListener("scroll",i,{passive:!0}),[u,D0(u)]):null}).filter(c=>c!=null);t(a.length?new Map(a):null),s.current=n}return()=>{o(n),o(r)};function o(a){a.forEach(c=>{const u=vy(c);u==null||u.removeEventListener("scroll",i)})}},[i,n]),R.useMemo(()=>n.length?e?Array.from(e.values()).reduce((r,o)=>nc(r,o),Xs):pC(n):Xs,[n,e])}function aS(n,e){e===void 0&&(e=[]);const t=R.useRef(null);return R.useEffect(()=>{t.current=null},e),R.useEffect(()=>{const s=n!==Xs;s&&!t.current&&(t.current=n),!s&&t.current&&(t.current=null)},[n]),t.current?Ng(n,t.current):Xs}function P2(n){R.useEffect(()=>{if(!Rm)return;const e=n.map(t=>{let{sensor:s}=t;return s.setup==null?void 0:s.setup()});return()=>{for(const t of e)t==null||t()}},n.map(e=>{let{sensor:t}=e;return t}))}function vC(n){return R.useMemo(()=>n?t2(n):null,[n])}const lS=[];function L2(n,e){e===void 0&&(e=jf);const[t]=n,s=vC(t?En(t):null),[i,r]=R.useState(lS);function o(){r(()=>n.length?n.map(c=>hC(c)?s:new Qw(e(c),c)):lS)}const a=Pm({callback:o});return gl(()=>{a==null||a.disconnect(),o(),n.forEach(c=>a==null?void 0:a.observe(c))},[n]),i}function M2(n){if(!n)return null;if(n.children.length>1)return n;const e=n.children[0];return Of(e)?e:n}function D2(n){let{measure:e}=n;const[t,s]=R.useState(null),i=R.useCallback(u=>{for(const{target:d}of u)if(Of(d)){s(h=>{const f=e(d);return h?{...h,width:f.width,height:f.height}:f});break}},[e]),r=Pm({callback:i}),o=R.useCallback(u=>{const d=M2(u);r==null||r.disconnect(),d&&(r==null||r.observe(d)),s(d?e(d):null)},[e,r]),[a,c]=iC(o);return R.useMemo(()=>({nodeRef:a,rect:t,setRef:c}),[t,a,c])}const N2=[{sensor:Zw,options:{}},{sensor:mC,options:{}}],I2={current:{}},Zp={draggable:{measure:eS},droppable:{measure:eS,strategy:Xd.WhileDragging,frequency:I0.Optimized},dragOverlay:{measure:jf}};class Sd extends Map{get(e){var t;return e!=null&&(t=super.get(e))!=null?t:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:t}=e;return!t})}getNodeFor(e){var t,s;return(t=(s=this.get(e))==null?void 0:s.node.current)!=null?t:void 0}}const O2={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Sd,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Ig},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Zp,measureDroppableContainers:Ig,windowRect:null,measuringScheduled:!1},F2={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Ig,draggableNodes:new Map,over:null,measureDroppableContainers:Ig},eb=R.createContext(F2),j2=R.createContext(O2);function z2(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Sd}}}function B2(n,e){switch(e.type){case dt.DragStart:return{...n,draggable:{...n.draggable,initialCoordinates:e.initialCoordinates,active:e.active}};case dt.DragMove:return n.draggable.active==null?n:{...n,draggable:{...n.draggable,translate:{x:e.coordinates.x-n.draggable.initialCoordinates.x,y:e.coordinates.y-n.draggable.initialCoordinates.y}}};case dt.DragEnd:case dt.DragCancel:return{...n,draggable:{...n.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case dt.RegisterDroppable:{const{element:t}=e,{id:s}=t,i=new Sd(n.droppable.containers);return i.set(s,t),{...n,droppable:{...n.droppable,containers:i}}}case dt.SetDroppableDisabled:{const{id:t,key:s,disabled:i}=e,r=n.droppable.containers.get(t);if(!r||s!==r.key)return n;const o=new Sd(n.droppable.containers);return o.set(t,{...r,disabled:i}),{...n,droppable:{...n.droppable,containers:o}}}case dt.UnregisterDroppable:{const{id:t,key:s}=e,i=n.droppable.containers.get(t);if(!i||s!==i.key)return n;const r=new Sd(n.droppable.containers);return r.delete(t),{...n,droppable:{...n.droppable,containers:r}}}default:return n}}function $2(n){let{disabled:e}=n;const{active:t,activatorEvent:s,draggableNodes:i}=R.useContext(eb),r=L0(s),o=L0(t==null?void 0:t.id);return R.useEffect(()=>{if(!e&&!s&&r&&o!=null){if(!oC(r)||document.activeElement===r.target)return;const a=i.get(o);if(!a)return;const{activatorNode:c,node:u}=a;if(!c.current&&!u.current)return;requestAnimationFrame(()=>{for(const d of[c.current,u.current]){if(!d)continue;const h=DM(d);if(h){h.focus();break}}})}},[s,e,i,o,r]),null}function H2(n,e){let{transform:t,...s}=e;return n!=null&&n.length?n.reduce((i,r)=>r({transform:i,...s}),t):t}function U2(n){return R.useMemo(()=>({draggable:{...Zp.draggable,...n==null?void 0:n.draggable},droppable:{...Zp.droppable,...n==null?void 0:n.droppable},dragOverlay:{...Zp.dragOverlay,...n==null?void 0:n.dragOverlay}}),[n==null?void 0:n.draggable,n==null?void 0:n.droppable,n==null?void 0:n.dragOverlay])}function V2(n){let{activeNode:e,measure:t,initialRect:s,config:i=!0}=n;const r=R.useRef(!1),{x:o,y:a}=typeof i=="boolean"?{x:i,y:i}:i;gl(()=>{if(!o&&!a||!e){r.current=!1;return}if(r.current||!s)return;const u=e==null?void 0:e.node.current;if(!u||u.isConnected===!1)return;const d=t(u),h=lC(d,s);if(o||(h.x=0),a||(h.y=0),r.current=!0,Math.abs(h.x)>0||Math.abs(h.y)>0){const f=cC(u);f&&f.scrollBy({top:h.y,left:h.x})}},[e,o,a,s,t])}const G2=R.createContext({...Xs,scaleX:1,scaleY:1});var Ir;(function(n){n[n.Uninitialized=0]="Uninitialized",n[n.Initializing=1]="Initializing",n[n.Initialized=2]="Initialized"})(Ir||(Ir={}));const W2=R.memo(function(e){var t,s,i,r;let{id:o,accessibility:a,autoScroll:c=!0,children:u,sensors:d=N2,collisionDetection:h=YM,measuring:f,modifiers:p,...w}=e;const g=R.useReducer(B2,void 0,z2),[E,m]=g,[v,b]=zM(),[x,_]=R.useState(Ir.Uninitialized),k=x===Ir.Initialized,{draggable:{active:C,nodes:T,translate:L},droppable:{containers:M}}=E,D=C!=null?T.get(C):null,q=R.useRef({initial:null,translated:null}),K=R.useMemo(()=>{var jt;return C!=null?{id:C,data:(jt=D==null?void 0:D.data)!=null?jt:I2,rect:q}:null},[C,D]),G=R.useRef(null),[ee,j]=R.useState(null),[O,I]=R.useState(null),$=Dg(w,Object.values(w)),X=qw("DndDescribedBy",o),re=R.useMemo(()=>M.getEnabled(),[M]),Q=U2(f),{droppableRects:oe,measureDroppableContainers:Re,measuringScheduled:We}=E2(re,{dragging:k,dependencies:[L.x,L.y],config:Q.droppable}),he=A2(T,C),fe=R.useMemo(()=>O?M0(O):null,[O]),xn=_C(),_n=x2(he,Q.draggable.measure);V2({activeNode:C!=null?T.get(C):null,config:xn.layoutShiftCompensation,initialRect:_n,measure:Q.draggable.measure});const ue=rS(he,Q.draggable.measure,_n),Cn=rS(he?he.parentElement:null),_t=R.useRef({activatorEvent:null,active:null,activeNode:he,collisionRect:null,collisions:null,droppableRects:oe,draggableNodes:T,draggingNode:null,draggingNodeRect:null,droppableContainers:M,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),pt=M.getNodeFor((t=_t.current.over)==null?void 0:t.id),pe=D2({measure:Q.dragOverlay.measure}),Be=(s=pe.nodeRef.current)!=null?s:he,Se=k?(i=pe.rect)!=null?i:ue:null,Ss=!!(pe.nodeRef.current&&pe.rect),ki=k2(Ss?null:ue),Ti=vC(Be?En(Be):null),qs=T2(k?pt??he:null),Ri=L2(qs),bl=H2(p,{transform:{x:L.x-ki.x,y:L.y-ki.y,scaleX:1,scaleY:1},activatorEvent:O,active:K,activeNodeRect:ue,containerNodeRect:Cn,draggingNodeRect:Se,over:_t.current.over,overlayNodeRect:pe.rect,scrollableAncestors:qs,scrollableAncestorRects:Ri,windowRect:Ti}),zf=fe?nc(fe,L):null,Bf=R2(qs),Lm=aS(Bf),Mm=aS(Bf,[ue]),kn=nc(bl,Lm),Es=Se?QM(Se,bl):null,Ks=K&&Es?h({active:K,collisionRect:Es,droppableRects:oe,droppableContainers:re,pointerCoordinates:zf}):null,Al=WM(Ks,"id"),[kr,rb]=R.useState(null),bC=Ss?bl:nc(bl,Mm),AC=qM(bC,(r=kr==null?void 0:kr.rect)!=null?r:null,ue),Dm=R.useRef(null),ob=R.useCallback((jt,Tn)=>{let{sensor:Rn,options:Tr}=Tn;if(G.current==null)return;const ts=T.get(G.current);if(!ts)return;const Pn=jt.nativeEvent,Qs=new Rn({active:G.current,activeNode:ts,event:Pn,options:Tr,context:_t,onAbort(Ct){if(!T.get(Ct))return;const{onDragAbort:Js}=$.current,Pi={id:Ct};Js==null||Js(Pi),v({type:"onDragAbort",event:Pi})},onPending(Ct,Rr,Js,Pi){if(!T.get(Ct))return;const{onDragPending:ku}=$.current,Pr={id:Ct,constraint:Rr,initialCoordinates:Js,offset:Pi};ku==null||ku(Pr),v({type:"onDragPending",event:Pr})},onStart(Ct){const Rr=G.current;if(Rr==null)return;const Js=T.get(Rr);if(!Js)return;const{onDragStart:Pi}=$.current,Cu={activatorEvent:Pn,active:{id:Rr,data:Js.data,rect:q}};Ul.unstable_batchedUpdates(()=>{Pi==null||Pi(Cu),_(Ir.Initializing),m({type:dt.DragStart,initialCoordinates:Ct,active:Rr}),v({type:"onDragStart",event:Cu}),j(Dm.current),I(Pn)})},onMove(Ct){m({type:dt.DragMove,coordinates:Ct})},onEnd:Sl(dt.DragEnd),onCancel:Sl(dt.DragCancel)});Dm.current=Qs;function Sl(Ct){return async function(){const{active:Js,collisions:Pi,over:Cu,scrollAdjustedTranslate:ku}=_t.current;let Pr=null;if(Js&&ku){const{cancelDrop:Tu}=$.current;Pr={activatorEvent:Pn,active:Js,collisions:Pi,delta:ku,over:Cu},Ct===dt.DragEnd&&typeof Tu=="function"&&await Promise.resolve(Tu(Pr))&&(Ct=dt.DragCancel)}G.current=null,Ul.unstable_batchedUpdates(()=>{m({type:Ct}),_(Ir.Uninitialized),rb(null),j(null),I(null),Dm.current=null;const Tu=Ct===dt.DragEnd?"onDragEnd":"onDragCancel";if(Pr){const Nm=$.current[Tu];Nm==null||Nm(Pr),v({type:Tu,event:Pr})}})}}},[T]),SC=R.useCallback((jt,Tn)=>(Rn,Tr)=>{const ts=Rn.nativeEvent,Pn=T.get(Tr);if(G.current!==null||!Pn||ts.dndKit||ts.defaultPrevented)return;const Qs={active:Pn};jt(Rn,Tn.options,Qs)===!0&&(ts.dndKit={capturedBy:Tn.sensor},G.current=Tr,ob(Rn,Tn))},[T,ob]),ab=S2(d,SC);P2(d),gl(()=>{ue&&x===Ir.Initializing&&_(Ir.Initialized)},[ue,x]),R.useEffect(()=>{const{onDragMove:jt}=$.current,{active:Tn,activatorEvent:Rn,collisions:Tr,over:ts}=_t.current;if(!Tn||!Rn)return;const Pn={active:Tn,activatorEvent:Rn,collisions:Tr,delta:{x:kn.x,y:kn.y},over:ts};Ul.unstable_batchedUpdates(()=>{jt==null||jt(Pn),v({type:"onDragMove",event:Pn})})},[kn.x,kn.y]),R.useEffect(()=>{const{active:jt,activatorEvent:Tn,collisions:Rn,droppableContainers:Tr,scrollAdjustedTranslate:ts}=_t.current;if(!jt||G.current==null||!Tn||!ts)return;const{onDragOver:Pn}=$.current,Qs=Tr.get(Al),Sl=Qs&&Qs.rect.current?{id:Qs.id,rect:Qs.rect.current,data:Qs.data,disabled:Qs.disabled}:null,Ct={active:jt,activatorEvent:Tn,collisions:Rn,delta:{x:ts.x,y:ts.y},over:Sl};Ul.unstable_batchedUpdates(()=>{rb(Sl),Pn==null||Pn(Ct),v({type:"onDragOver",event:Ct})})},[Al]),gl(()=>{_t.current={activatorEvent:O,active:K,activeNode:he,collisionRect:Es,collisions:Ks,droppableRects:oe,draggableNodes:T,draggingNode:Be,draggingNodeRect:Se,droppableContainers:M,over:kr,scrollableAncestors:qs,scrollAdjustedTranslate:kn},q.current={initial:Se,translated:Es}},[K,he,Ks,Es,T,Be,Se,oe,M,kr,qs,kn]),v2({...xn,delta:L,draggingRect:Es,pointerCoordinates:zf,scrollableAncestors:qs,scrollableAncestorRects:Ri});const EC=R.useMemo(()=>({active:K,activeNode:he,activeNodeRect:ue,activatorEvent:O,collisions:Ks,containerNodeRect:Cn,dragOverlay:pe,draggableNodes:T,droppableContainers:M,droppableRects:oe,over:kr,measureDroppableContainers:Re,scrollableAncestors:qs,scrollableAncestorRects:Ri,measuringConfiguration:Q,measuringScheduled:We,windowRect:Ti}),[K,he,ue,O,Ks,Cn,pe,T,M,oe,kr,Re,qs,Ri,Q,We,Ti]),xC=R.useMemo(()=>({activatorEvent:O,activators:ab,active:K,activeNodeRect:ue,ariaDescribedById:{draggable:X},dispatch:m,draggableNodes:T,over:kr,measureDroppableContainers:Re}),[O,ab,K,ue,m,X,T,kr,Re]);return on.createElement(aC.Provider,{value:b},on.createElement(eb.Provider,{value:xC},on.createElement(j2.Provider,{value:EC},on.createElement(G2.Provider,{value:AC},u)),on.createElement($2,{disabled:(a==null?void 0:a.restoreFocus)===!1})),on.createElement(HM,{...a,hiddenTextDescribedById:X}));function _C(){const jt=(ee==null?void 0:ee.autoScrollEnabled)===!1,Tn=typeof c=="object"?c.enabled===!1:c===!1,Rn=k&&!jt&&!Tn;return typeof c=="object"?{...c,enabled:Rn}:{enabled:Rn}}}),X2="Droppable",Y2={timeout:25};function q2(n){let{data:e,disabled:t=!1,id:s,resizeObserverConfig:i}=n;const r=qw(X2),{active:o,dispatch:a,over:c,measureDroppableContainers:u}=R.useContext(eb),d=R.useRef({disabled:t}),h=R.useRef(!1),f=R.useRef(null),p=R.useRef(null),{disabled:w,updateMeasurementsFor:g,timeout:E}={...Y2,...i},m=Dg(g??s),v=R.useCallback(()=>{if(!h.current){h.current=!0;return}p.current!=null&&clearTimeout(p.current),p.current=setTimeout(()=>{u(Array.isArray(m.current)?m.current:[m.current]),p.current=null},E)},[E]),b=Pm({callback:v,disabled:w||!o}),x=R.useCallback((T,L)=>{b&&(L&&(b.unobserve(L),h.current=!1),T&&b.observe(T))},[b]),[_,k]=iC(x),C=Dg(e);return R.useEffect(()=>{!b||!_.current||(b.disconnect(),h.current=!1,b.observe(_.current))},[_,b]),R.useEffect(()=>(a({type:dt.RegisterDroppable,element:{id:s,key:r,disabled:t,node:_,rect:f,data:C}}),()=>a({type:dt.UnregisterDroppable,key:r,id:s})),[s]),R.useEffect(()=>{t!==d.current.disabled&&(a({type:dt.SetDroppableDisabled,id:s,key:r,disabled:t}),d.current.disabled=t)},[s,r,t,a]),{active:o,rect:f,isOver:(c==null?void 0:c.id)===s,node:_,over:c,setNodeRef:k}}const K2=()=>{const n=se(g=>g.activeDatasheet),e=se(g=>g.setActiveDatasheet),{addUpload:t,updateUpload:s,setRoute:i,addStatusMessage:r}=se(),{setNodeRef:o}=q2({id:"component-canvas-area"}),a=R.useRef(null),c=R.useCallback(async g=>{const E=`temp-${Date.now()}`;t({id:E,name:g.name,size:g.size,mime:g.type,progress:0,assetType:"component",parsed_at:null,parsing_status:null,parsing_error:null,is_human_verified:!1});try{const m=await CR(g,b=>s(E,{progress:b}));s(m.id,{...m,parsing_status:"processing"}),i("components"),gv(m.id).catch(b=>{s(m.id,{parsing_status:"failed",parsing_error:b.message})});const v=setInterval(async()=>{try{const b=await xg(m.id);if(b.parsing_status==="success"){clearInterval(v),s(m.id,{parsing_status:"success",parsing_error:null});const x=`${ut}/files/${b.id}/file`;e({id:b.id,url:x,payload:b.parsed_payload})}else b.parsing_status==="failed"&&(clearInterval(v),s(m.id,{parsing_status:"failed",parsing_error:b.parsing_error}))}catch(b){clearInterval(v),s(m.id,{parsing_status:"failed",parsing_error:b.message||"Failed to fetch status"})}},2e3)}catch(m){console.error(m),s(E,{parsing_status:"failed",parsing_error:"Upload or parse failed"})}},[t,s,e,i]),u=R.useCallback(g=>{if(g.preventDefault(),g.dataTransfer.files&&g.dataTransfer.files[0]){const E=g.dataTransfer.files[0];E.type==="application/pdf"&&c(E)}},[c]),d=g=>g.preventDefault(),h=(g,E)=>{AA(g,E,!1).then(m=>{const v=`${ut}/files/${m.id}/file`;e({id:m.id,url:v,payload:m.parsed_payload}),r("Changes saved","success")}).catch(m=>{console.error("Failed to save datasheet",m),r("Failed to save datasheet","error")})},f=(g,E)=>{AA(g,E,!0).then(m=>{const v=`${ut}/files/${m.id}/file`;e({id:m.id,url:v,payload:m.parsed_payload}),r("Datasheet confirmed","success")}).catch(m=>{console.error("Failed to confirm datasheet",m),r("Failed to confirm datasheet","error")})},p=g=>{a.current||(r("Re-analyzing datasheet...","info"),gv(g).catch(E=>{console.error("Re-Analyze failed",E),r("Re-Analyze failed","error"),a.current&&(clearInterval(a.current),a.current=null)}),a.current=setInterval(async()=>{try{const E=await xg(g);if(E.parsing_status==="success"){clearInterval(a.current),a.current=null,s(g,{parsing_status:"success",parsing_error:null});const m=`${ut}/files/${E.id}/file`;e({id:E.id,url:m,payload:E.parsed_payload}),r("Datasheet parsed successfully","success")}else E.parsing_status==="failed"&&(clearInterval(a.current),a.current=null,s(g,{parsing_status:"failed",parsing_error:E.parsing_error}),r("Datasheet parsing failed","error"))}catch(E){clearInterval(a.current),a.current=null,s(g,{parsing_status:"failed",parsing_error:E.message||"Failed to fetch status"}),r("Datasheet parsing failed","error")}},2e3))},w=()=>e(null);return P.jsx("div",{ref:o,className:"w-full h-full flex flex-col",onDrop:u,onDragOver:d,children:n?P.jsx(RM,{assetId:n.id,pdfUrl:n.url,initialParsedData:n.payload,onSave:h,onConfirm:f,onAnalyze:p,onClose:w}):P.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-400 border-2 border-dashed rounded-lg pointer-events-none",children:P.jsx("p",{children:"Drop a component from the library or a PDF from your computer to begin."})})})},Q2=()=>{const n=se(o=>o.useRuleBased),e=se(o=>o.useTableExtraction),t=se(o=>o.useAiExtraction),s=se(o=>o.useOcrFallback),i=se(o=>o.setExtractionSetting),r=(o,a,c)=>P.jsxs("div",{className:"flex items-center justify-between py-2",children:[P.jsx("span",{className:"text-sm font-medium text-gray-700",children:a}),P.jsx("label",{className:"inline-flex items-center cursor-pointer",children:P.jsx("input",{type:"checkbox",className:"form-checkbox h-4 w-4 text-blue-600",checked:c,onChange:u=>i(o,u.target.checked)})})]});return P.jsxs("div",{className:"flex flex-col h-full p-4 overflow-auto bg-gray-50 text-black",children:[P.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Settings"}),P.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Configure how datasheets are parsed. These options control the backend extraction pipeline. You can enable or disable rule-based parsing, table extraction, AI extraction and OCR fallback. Changes take effect immediately for future parses."}),r("useRuleBased","Use rule-based parsing",n),r("useTableExtraction","Use table extraction",e),r("useAiExtraction","Use AI extraction",t),r("useOcrFallback","Use OCR fallback",s)]})},J2=()=>{const n=se(e=>e.route);return se(e=>e.activeDatasheet),P.jsxs("main",{className:"grid-in-main flex flex-col bg-gray-50 text-black h-full w-full p-2 overflow-hidden",children:[n==="projects"&&P.jsx(ZR,{}),n==="components"&&P.jsx(K2,{}),n==="settings"&&P.jsx(Q2,{})]})},Z2=()=>{const{stagedFiles:n}=se(),e=(t,s)=>{t.dataTransfer.setData("application/json",JSON.stringify({type:"file",name:s.name}))};return n.length===0?null:P.jsxs("div",{className:"p-4 border-t border-gray-200",children:[P.jsx("h3",{className:"text-md font-semibold mb-2",children:"Staged Files"}),P.jsx("div",{className:"space-y-2",children:n.map((t,s)=>P.jsxs("div",{className:"flex items-center p-2 bg-white rounded-md shadow-sm cursor-grab",draggable:"true",onDragStart:i=>e(i,t),children:[P.jsx(BR,{className:"h-5 w-5 mr-2 text-gray-500"}),P.jsx("span",{className:"text-sm truncate",children:t.name})]},s))})]})},eD=[{name:"projects",label:"Projects",icon:NR},{name:"components",label:"Components",icon:jR},{name:"settings",label:"Settings",icon:L1}],tD=({isCollapsed:n})=>{const e=se(i=>i.route),t=se(i=>i.setRoute),s=se(i=>i.fileStagingAreaVisible);return P.jsx("div",{className:"grid-in-sidebar flex flex-col bg-white text-black border-r border-gray-200",children:P.jsxs("nav",{className:"flex-1 py-4 px-2 mt-2","aria-label":"Sidebar navigation",children:[P.jsx("ul",{className:"space-y-1",children:eD.map(i=>P.jsx("li",{children:P.jsxs("button",{onClick:()=>t(i.name),className:`flex w-full items-center gap-3 p-3 rounded-r-lg transition-colors ${n?"justify-center":""} ${e===i.name?"bg-blue-100 text-blue-600":"hover:bg-blue-50"}`,"aria-current":e===i.name?"page":void 0,title:n?i.label:void 0,children:[P.jsx(i.icon,{className:"h-5 w-5"}),!n&&P.jsx("span",{children:i.label})]})},i.name))}),!n&&s&&P.jsx(Z2,{})]})})},nD=({isCollapsed:n})=>P.jsx("div",{className:`grid-in-sidebar-header flex items-center p-4 h-16 border-b border-r border-gray-200 ${n?"justify-center":"justify-start"}`,children:P.jsxs("a",{href:"/",className:"flex items-center gap-2",children:[P.jsx("span",{className:"text-2xl",children:"🌀"}),!n&&P.jsx("h1",{className:"text-xl font-bold",children:"OriginFlow"})]})}),sD=({isCollapsed:n})=>P.jsx("div",{className:"grid-in-sidebar-footer p-2 border-t border-r border-gray-200 bg-white flex items-center",children:P.jsxs("a",{href:"#",className:"flex items-center gap-3 px-4 py-2 text-sm font-medium rounded-md hover:bg-gray-100",children:[P.jsx(HR,{size:20}),!n&&P.jsx("span",{children:"Help & Support"})]})}),iD={info:"text-blue-600",success:"text-green-600",error:"text-red-600"},rD=()=>{const n=se(s=>s.statusMessages),e=n[n.length-1],t=e!=null&&e.icon?iD[e.icon]??"text-gray-600":"text-gray-600";return P.jsx("footer",{role:"status","aria-live":"polite",className:`grid-in-status flex items-center px-4 py-2 bg-white text-black border-t border-gray-200 text-sm ${t}`,children:(e==null?void 0:e.message)??"Ready"})},oD=()=>{const n=se(e=>e.analyzeAndExecute);return P.jsxs("section",{className:"grid-in-toolbar h-12 flex items-center justify-between px-6 border-b bg-white shadow-sm",role:"region","aria-label":"Sub Navigation",children:[P.jsxs("div",{className:"flex items-center gap-3",children:[P.jsx("button",{onClick:()=>n("validate my design"),className:"px-3 py-1 text-sm rounded bg-blue-600 text-white hover:bg-blue-700",children:"Analyze"}),P.jsx("button",{className:"px-3 py-1 text-sm rounded bg-gray-100 hover:bg-gray-200",children:"Filter"}),P.jsx("button",{className:"px-3 py-1 text-sm rounded bg-gray-100 hover:bg-gray-200",children:"Export"})]}),P.jsx("div",{className:"text-xs text-gray-500 italic",children:"Sub-nav active"})]})},aD=({message:n})=>{const e=n.author==="User";return P.jsx("div",{className:Oo("w-full flex",e?"justify-end":"justify-start"),children:P.jsx("div",{className:Oo("max-w-[80%] rounded-2xl px-4 py-2 text-sm whitespace-pre-wrap",{"bg-blue-600 text-white":e,"bg-gray-200 text-gray-800":!e}),children:n.text})})},lD=()=>{const n=se(e=>e.messages);return P.jsx("div",{className:"grid-in-chat-history flex flex-col h-full bg-white overflow-y-auto min-h-0",style:{borderLeft:"1px solid #e5e7eb"},children:P.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:n.map((e,t)=>P.jsx(aD,{message:e},t))})})},wC=on.forwardRef(({className:n,...e},t)=>P.jsx("textarea",{ref:t,className:Oo("w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",n),...e}));wC.displayName="Textarea";const Ay=({variant:n="default",size:e="default",className:t,...s})=>{const i={default:"bg-blue-600 text-white hover:bg-blue-700",ghost:"bg-transparent hover:bg-gray-100 text-gray-700",destructive:"bg-red-600 text-white hover:bg-red-700"}[n],r=e==="icon"?"p-2":"px-4 py-2";return P.jsx("button",{className:Oo("rounded-md focus:outline-none",i,r,t),...s})},cD=()=>{const n=se(m=>m.chatDraft),e=se(m=>m.setChatDraft),t=se(m=>m.analyzeAndExecute),s=se(m=>m.clearChatDraft),i=se(m=>m.voiceMode),r=se(m=>m.startListening),o=se(m=>m.stopListening),a=se(m=>m.toggleFileStagingArea),c=se(m=>m.addStagedFiles),u=se(m=>m.voiceTranscript),d=R.useRef(null),h=()=>{n.trim()&&(t(n),s())},f=()=>{g?o():r()},p=m=>{var v;m.preventDefault(),(v=d.current)==null||v.click(),a()},w=m=>{m.target.files&&c(Array.from(m.target.files))},g=i==="listening",E=i==="speaking";return P.jsx("div",{className:"grid-in-chat-input p-3 bg-white border-t border-white",style:{borderLeft:"1px solid #e5e7eb"},children:P.jsxs("div",{className:"relative",children:[P.jsx(wC,{value:g?u:n,onChange:m=>e(m.target.value),onKeyDown:m=>{m.key==="Enter"&&!m.shiftKey&&(m.preventDefault(),n.trim()&&(t(n),s()))},placeholder:g?"Listening...":E?"Echo is speaking...":"Ask Echo to do something...",className:"w-full h-full resize-none pr-20",rows:2,readOnly:g||E}),P.jsxs("div",{className:"absolute right-2 bottom-2 flex gap-2",children:[P.jsx(Ay,{onClick:p,size:"icon",variant:"ghost",disabled:g||E,"aria-label":"Attach file",children:P.jsx(YR,{className:"h-5 w-5"})}),P.jsx(Ay,{onClick:f,size:"icon",variant:g?"destructive":"ghost",disabled:E,"aria-label":"Record voice command",children:E?P.jsx(OR,{className:"h-5 w-5 animate-pulse"}):P.jsx(VR,{className:"h-5 w-5"})}),P.jsx(Ay,{onClick:h,disabled:g||E,size:"icon","aria-label":"Send message",children:P.jsx(KR,{className:"h-5 w-5"})}),P.jsx("input",{type:"file",ref:d,onChange:w,className:"hidden",multiple:!0})]})]})})},uD=()=>{const{voiceOutputEnabled:n,toggleVoiceOutput:e,isContinuousConversation:t,toggleContinuousConversation:s}=se();return P.jsxs("div",{className:"p-4 border-t border-gray-200",children:[P.jsxs("div",{className:"flex justify-between items-center gap-4",children:[P.jsxs("div",{className:"flex items-center space-x-2",children:[P.jsx("input",{id:"voice-output",type:"checkbox",className:"form-checkbox",checked:n,onChange:e}),P.jsx("label",{htmlFor:"voice-output",className:"text-sm font-medium",children:"Voice Output"})]}),P.jsxs("div",{className:"flex items-center space-x-2",children:[P.jsx("input",{id:"continuous-conversation",type:"checkbox",className:"form-checkbox",checked:t,onChange:s}),P.jsx("label",{htmlFor:"continuous-conversation",className:"text-sm font-medium",children:"Continuous Conversation"})]})]}),P.jsx("p",{className:"mt-4 text-xs text-gray-500",children:"OriginFlow is a prototype. Responses may be inaccurate."})]})},dD=()=>{const n=se(s=>s.voiceMode),e=se(s=>s.stopListening),t=se(s=>s.updateVoiceTranscript);return R.useEffect(()=>{const s=window.SpeechRecognition||window.webkitSpeechRecognition;if(!s){console.warn("SpeechRecognition API not supported in this browser.");return}const i=new s;if(i.continuous=!0,i.interimResults=!0,i.lang="en-US",i.onresult=r=>{let o="",a="";for(let c=r.resultIndex;c<r.results.length;++c){const u=r.results[c][0].transcript;r.results[c].isFinal?o+=u:a+=u}if(a&&t(a),o){const c=o.trim().toLowerCase();if(c==="stop listening"||c==="stop"){e();return}e(c)}},i.onerror=()=>{n==="listening"&&e()},n==="listening")try{i.start()}catch{}else i.stop();return()=>{i.stop()}},[n,e,t]),null},hD=()=>{const n=se(a=>a.messages),e=se(a=>a.voiceOutputEnabled),t=se(a=>a.isContinuousConversation),s=se(a=>a.startListening),i=se(a=>a.stopListening),r=se(a=>a.setVoiceMode),o=R.useRef(null);return R.useEffect(()=>{if(!e||n.length===0)return;const a=n[n.length-1];if(a.author!=="AI"||o.current===a.id)return;const c=window.speechSynthesis;if(!c)return;i(),r("speaking");const u=a.summary||a.text,d=new SpeechSynthesisUtterance(u);d.onend=()=>{t?s():r("idle")},c.speak(d),o.current=a.id},[n,e,t,s,i,r]),null},fD=()=>{const[n,e]=R.useState(!1),t=se(i=>i.isSubNavVisible),s=se(i=>i.toggleSubNav);return P.jsxs(P.Fragment,{children:[P.jsx(dD,{}),P.jsx(hD,{}),P.jsxs("div",{className:"grid h-screen w-screen min-h-0 transition-all duration-300 ease-in-out",style:{gridTemplateColumns:`${n?"64px":"250px"} 1fr 350px`,gridTemplateRows:`64px ${t?"48px":"0px"} 1fr auto 48px`,gridTemplateAreas:`
          "sidebar-header header      chat-history"
          "sidebar        toolbar     chat-history"
          "sidebar        main        chat-history"
          "sidebar        main        chat-input"
          "sidebar-footer status      chat-footer"
        `},children:[P.jsx(nD,{isCollapsed:n}),P.jsx(JR,{toggleSidebar:()=>e(!n),toggleToolbar:s}),t&&P.jsx(oD,{}),P.jsx(tD,{isCollapsed:n}),P.jsx("div",{className:"grid-in-main relative min-h-0 overflow-auto bg-gray-50",children:P.jsx(J2,{})}),P.jsx(lD,{}),P.jsx(cD,{}),P.jsx(uD,{}),P.jsx(sD,{isCollapsed:n}),P.jsx(rD,{})]})]})},pD=({items:n,onClose:e})=>P.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center",children:P.jsxs("div",{className:"bg-white p-4 rounded",children:[P.jsx("h2",{className:"font-bold mb-2",children:"Bill of Materials"}),P.jsx("ul",{className:"list-disc pl-6 max-h-60 overflow-auto",children:n.map(t=>P.jsx("li",{children:t},t))}),P.jsx("button",{className:"mt-4 btn",onClick:e,children:"Close"})]})}),gD=()=>{const{bomItems:n,setBom:e,loadUploads:t,addComponent:s,updateComponentPosition:i,updateUpload:r,setActiveDatasheet:o,setRoute:a,addStatusMessage:c}=se(),u=VM(UM(Zw)),d=h=>{var g,E,m;const{active:f,over:p,delta:w}=h;if(p){if(p.id==="canvas-area"&&((g=f.data.current)==null?void 0:g.type)==="file-asset"){const v=f.data.current.asset;s({name:v.name,type:v.mime,standard_code:v.id});return}if(p.id==="component-canvas-area"&&((E=f.data.current)==null?void 0:E.type)==="file-asset"){const v=f.data.current.asset;if(v.parsing_status==="success"){a("components"),(async()=>{try{const x=await xg(v.id),_=`${ut}/files/${x.id}/file`;o({id:x.id,url:_,payload:x.parsed_payload})}catch(x){console.error("Failed to load parsed datasheet:",x),r(v.id,{parsing_status:"failed",parsing_error:x.message||"Failed to fetch status"}),c("Failed to load datasheet","error")}})();return}r(v.id,{parsing_status:"processing"}),a("components"),c("Parsing datasheet...","info"),gv(v.id).catch(x=>{r(v.id,{parsing_status:"failed",parsing_error:x.message}),c("Datasheet parsing failed","error")});const b=setInterval(async()=>{try{const x=await xg(v.id);if(x.parsing_status==="success"){clearInterval(b),r(v.id,{parsing_status:"success",parsing_error:null});const _=`${ut}/files/${x.id}/file`;o({id:x.id,url:_,payload:x.parsed_payload}),c("Datasheet parsed successfully","success")}else x.parsing_status==="failed"&&(clearInterval(b),r(v.id,{parsing_status:"failed",parsing_error:x.parsing_error}),c("Datasheet parsing failed","error"))}catch(x){clearInterval(b),r(v.id,{parsing_status:"failed",parsing_error:x.message||"Failed to fetch status"}),c("Datasheet parsing failed","error")}},2e3);return}((m=f.data.current)==null?void 0:m.type)==="canvas-card"&&i(f.id,{x:w.x,y:w.y})}};return R.useEffect(()=>{t()},[t]),P.jsx(W2,{sensors:u,onDragEnd:d,children:P.jsxs("div",{className:"App h-full",children:[P.jsx(fD,{}),n&&P.jsx(pD,{items:n,onClose:()=>e(null)})]})})},mD="/assets/pdf.worker.min-CsnNCGNt.mjs";ps.workerSrc=mD;const cS=document.getElementById("root"),uS=cS?Sy.createRoot(cS):null;uS&&uS.render(P.jsx(on.StrictMode,{children:P.jsx(gD,{})}));

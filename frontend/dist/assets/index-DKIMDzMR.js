var LC=Object.defineProperty;var cb=n=>{throw TypeError(n)};var MC=(n,e,t)=>e in n?LC(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var F=(n,e,t)=>MC(n,typeof e!="symbol"?e+"":e,t),Bm=(n,e,t)=>e.has(n)||cb("Cannot "+t);var l=(n,e,t)=>(Bm(n,e,"read from private field"),t?t.call(n):e.get(n)),A=(n,e,t)=>e.has(n)?cb("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),m=(n,e,t,s)=>(Bm(n,e,"write to private field"),s?s.call(n,t):e.set(n,t),t),S=(n,e,t)=>(Bm(n,e,"access private method"),t);var Qt=(n,e,t,s)=>({set _(i){m(n,e,i,t)},get _(){return l(n,e,s)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=t(i);fetch(i.href,r)}})();function z0(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var gS={exports:{}},rm={},mS={exports:{}},ce={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _f=Symbol.for("react.element"),DC=Symbol.for("react.portal"),NC=Symbol.for("react.fragment"),IC=Symbol.for("react.strict_mode"),OC=Symbol.for("react.profiler"),FC=Symbol.for("react.provider"),jC=Symbol.for("react.context"),zC=Symbol.for("react.forward_ref"),BC=Symbol.for("react.suspense"),$C=Symbol.for("react.memo"),HC=Symbol.for("react.lazy"),ub=Symbol.iterator;function UC(n){return n===null||typeof n!="object"?null:(n=ub&&n[ub]||n["@@iterator"],typeof n=="function"?n:null)}var yS={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},vS=Object.assign,wS={};function Au(n,e,t){this.props=n,this.context=e,this.refs=wS,this.updater=t||yS}Au.prototype.isReactComponent={};Au.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};Au.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function bS(){}bS.prototype=Au.prototype;function B0(n,e,t){this.props=n,this.context=e,this.refs=wS,this.updater=t||yS}var $0=B0.prototype=new bS;$0.constructor=B0;vS($0,Au.prototype);$0.isPureReactComponent=!0;var db=Array.isArray,AS=Object.prototype.hasOwnProperty,H0={current:null},SS={key:!0,ref:!0,__self:!0,__source:!0};function xS(n,e,t){var s,i={},r=null,o=null;if(e!=null)for(s in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(r=""+e.key),e)AS.call(e,s)&&!SS.hasOwnProperty(s)&&(i[s]=e[s]);var a=arguments.length-2;if(a===1)i.children=t;else if(1<a){for(var c=Array(a),u=0;u<a;u++)c[u]=arguments[u+2];i.children=c}if(n&&n.defaultProps)for(s in a=n.defaultProps,a)i[s]===void 0&&(i[s]=a[s]);return{$$typeof:_f,type:n,key:r,ref:o,props:i,_owner:H0.current}}function VC(n,e){return{$$typeof:_f,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function U0(n){return typeof n=="object"&&n!==null&&n.$$typeof===_f}function GC(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var hb=/\/+/g;function $m(n,e){return typeof n=="object"&&n!==null&&n.key!=null?GC(""+n.key):e.toString(36)}function pp(n,e,t,s,i){var r=typeof n;(r==="undefined"||r==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(r){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case _f:case DC:o=!0}}if(o)return o=n,i=i(o),n=s===""?"."+$m(o,0):s,db(i)?(t="",n!=null&&(t=n.replace(hb,"$&/")+"/"),pp(i,e,t,"",function(u){return u})):i!=null&&(U0(i)&&(i=VC(i,t+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(hb,"$&/")+"/")+n)),e.push(i)),1;if(o=0,s=s===""?".":s+":",db(n))for(var a=0;a<n.length;a++){r=n[a];var c=s+$m(r,a);o+=pp(r,e,t,c,i)}else if(c=UC(n),typeof c=="function")for(n=c.call(n),a=0;!(r=n.next()).done;)r=r.value,c=s+$m(r,a++),o+=pp(r,e,t,c,i);else if(r==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Vf(n,e,t){if(n==null)return n;var s=[],i=0;return pp(n,s,"","",function(r){return e.call(t,r,i++)}),s}function WC(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var cn={current:null},gp={transition:null},XC={ReactCurrentDispatcher:cn,ReactCurrentBatchConfig:gp,ReactCurrentOwner:H0};function ES(){throw Error("act(...) is not supported in production builds of React.")}ce.Children={map:Vf,forEach:function(n,e,t){Vf(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return Vf(n,function(){e++}),e},toArray:function(n){return Vf(n,function(e){return e})||[]},only:function(n){if(!U0(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};ce.Component=Au;ce.Fragment=NC;ce.Profiler=OC;ce.PureComponent=B0;ce.StrictMode=IC;ce.Suspense=BC;ce.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=XC;ce.act=ES;ce.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var s=vS({},n.props),i=n.key,r=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(r=e.ref,o=H0.current),e.key!==void 0&&(i=""+e.key),n.type&&n.type.defaultProps)var a=n.type.defaultProps;for(c in e)AS.call(e,c)&&!SS.hasOwnProperty(c)&&(s[c]=e[c]===void 0&&a!==void 0?a[c]:e[c])}var c=arguments.length-2;if(c===1)s.children=t;else if(1<c){a=Array(c);for(var u=0;u<c;u++)a[u]=arguments[u+2];s.children=a}return{$$typeof:_f,type:n.type,key:i,ref:r,props:s,_owner:o}};ce.createContext=function(n){return n={$$typeof:jC,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:FC,_context:n},n.Consumer=n};ce.createElement=xS;ce.createFactory=function(n){var e=xS.bind(null,n);return e.type=n,e};ce.createRef=function(){return{current:null}};ce.forwardRef=function(n){return{$$typeof:zC,render:n}};ce.isValidElement=U0;ce.lazy=function(n){return{$$typeof:HC,_payload:{_status:-1,_result:n},_init:WC}};ce.memo=function(n,e){return{$$typeof:$C,type:n,compare:e===void 0?null:e}};ce.startTransition=function(n){var e=gp.transition;gp.transition={};try{n()}finally{gp.transition=e}};ce.unstable_act=ES;ce.useCallback=function(n,e){return cn.current.useCallback(n,e)};ce.useContext=function(n){return cn.current.useContext(n)};ce.useDebugValue=function(){};ce.useDeferredValue=function(n){return cn.current.useDeferredValue(n)};ce.useEffect=function(n,e){return cn.current.useEffect(n,e)};ce.useId=function(){return cn.current.useId()};ce.useImperativeHandle=function(n,e,t){return cn.current.useImperativeHandle(n,e,t)};ce.useInsertionEffect=function(n,e){return cn.current.useInsertionEffect(n,e)};ce.useLayoutEffect=function(n,e){return cn.current.useLayoutEffect(n,e)};ce.useMemo=function(n,e){return cn.current.useMemo(n,e)};ce.useReducer=function(n,e,t){return cn.current.useReducer(n,e,t)};ce.useRef=function(n){return cn.current.useRef(n)};ce.useState=function(n){return cn.current.useState(n)};ce.useSyncExternalStore=function(n,e,t){return cn.current.useSyncExternalStore(n,e,t)};ce.useTransition=function(){return cn.current.useTransition()};ce.version="18.3.1";mS.exports=ce;var R=mS.exports;const yn=z0(R);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var YC=R,qC=Symbol.for("react.element"),KC=Symbol.for("react.fragment"),QC=Object.prototype.hasOwnProperty,JC=YC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ZC={key:!0,ref:!0,__self:!0,__source:!0};function _S(n,e,t){var s,i={},r=null,o=null;t!==void 0&&(r=""+t),e.key!==void 0&&(r=""+e.key),e.ref!==void 0&&(o=e.ref);for(s in e)QC.call(e,s)&&!ZC.hasOwnProperty(s)&&(i[s]=e[s]);if(n&&n.defaultProps)for(s in e=n.defaultProps,e)i[s]===void 0&&(i[s]=e[s]);return{$$typeof:qC,type:n,key:r,ref:o,props:i,_owner:JC.current}}rm.Fragment=KC;rm.jsx=_S;rm.jsxs=_S;gS.exports=rm;var T=gS.exports,Cy={},CS={exports:{}},Zn={},kS={exports:{}},TS={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(I,$){var X=I.length;I.push($);e:for(;0<X;){var re=X-1>>>1,J=I[re];if(0<i(J,$))I[re]=$,I[X]=J,X=re;else break e}}function t(I){return I.length===0?null:I[0]}function s(I){if(I.length===0)return null;var $=I[0],X=I.pop();if(X!==$){I[0]=X;e:for(var re=0,J=I.length,oe=J>>>1;re<oe;){var Pe=2*(re+1)-1,We=I[Pe],he=Pe+1,fe=I[he];if(0>i(We,X))he<J&&0>i(fe,We)?(I[re]=fe,I[he]=X,re=he):(I[re]=We,I[Pe]=X,re=Pe);else if(he<J&&0>i(fe,X))I[re]=fe,I[he]=X,re=he;else break e}}return $}function i(I,$){var X=I.sortIndex-$.sortIndex;return X!==0?X:I.id-$.id}if(typeof performance=="object"&&typeof performance.now=="function"){var r=performance;n.unstable_now=function(){return r.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var c=[],u=[],d=1,h=null,f=3,p=!1,v=!1,g=!1,x=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(I){for(var $=t(u);$!==null;){if($.callback===null)s(u);else if($.startTime<=I)s(u),$.sortIndex=$.expirationTime,e(c,$);else break;$=t(u)}}function E(I){if(g=!1,b(I),!v)if(t(c)!==null)v=!0,j(_);else{var $=t(u);$!==null&&O(E,$.startTime-I)}}function _(I,$){v=!1,g&&(g=!1,y(P),P=-1),p=!0;var X=f;try{for(b($),h=t(c);h!==null&&(!(h.expirationTime>$)||I&&!D());){var re=h.callback;if(typeof re=="function"){h.callback=null,f=h.priorityLevel;var J=re(h.expirationTime<=$);$=n.unstable_now(),typeof J=="function"?h.callback=J:h===t(c)&&s(c),b($)}else s(c);h=t(c)}if(h!==null)var oe=!0;else{var Pe=t(u);Pe!==null&&O(E,Pe.startTime-$),oe=!1}return oe}finally{h=null,f=X,p=!1}}var k=!1,C=null,P=-1,L=5,M=-1;function D(){return!(n.unstable_now()-M<L)}function K(){if(C!==null){var I=n.unstable_now();M=I;var $=!0;try{$=C(!0,I)}finally{$?Q():(k=!1,C=null)}}else k=!1}var Q;if(typeof w=="function")Q=function(){w(K)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,te=G.port2;G.port1.onmessage=K,Q=function(){te.postMessage(null)}}else Q=function(){x(K,0)};function j(I){C=I,k||(k=!0,Q())}function O(I,$){P=x(function(){I(n.unstable_now())},$)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(I){I.callback=null},n.unstable_continueExecution=function(){v||p||(v=!0,j(_))},n.unstable_forceFrameRate=function(I){0>I||125<I?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<I?Math.floor(1e3/I):5},n.unstable_getCurrentPriorityLevel=function(){return f},n.unstable_getFirstCallbackNode=function(){return t(c)},n.unstable_next=function(I){switch(f){case 1:case 2:case 3:var $=3;break;default:$=f}var X=f;f=$;try{return I()}finally{f=X}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(I,$){switch(I){case 1:case 2:case 3:case 4:case 5:break;default:I=3}var X=f;f=I;try{return $()}finally{f=X}},n.unstable_scheduleCallback=function(I,$,X){var re=n.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?re+X:re):X=re,I){case 1:var J=-1;break;case 2:J=250;break;case 5:J=1073741823;break;case 4:J=1e4;break;default:J=5e3}return J=X+J,I={id:d++,callback:$,priorityLevel:I,startTime:X,expirationTime:J,sortIndex:-1},X>re?(I.sortIndex=X,e(u,I),t(c)===null&&I===t(u)&&(g?(y(P),P=-1):g=!0,O(E,X-re))):(I.sortIndex=J,e(c,I),v||p||(v=!0,j(_))),I},n.unstable_shouldYield=D,n.unstable_wrapCallback=function(I){var $=f;return function(){var X=f;f=$;try{return I.apply(this,arguments)}finally{f=X}}}})(TS);kS.exports=TS;var ek=kS.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tk=R,Jn=ek;function N(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var PS=new Set,_d={};function ml(n,e){uu(n,e),uu(n+"Capture",e)}function uu(n,e){for(_d[n]=e,n=0;n<e.length;n++)PS.add(e[n])}var br=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ky=Object.prototype.hasOwnProperty,nk=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,fb={},pb={};function sk(n){return ky.call(pb,n)?!0:ky.call(fb,n)?!1:nk.test(n)?pb[n]=!0:(fb[n]=!0,!1)}function ik(n,e,t,s){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function rk(n,e,t,s){if(e===null||typeof e>"u"||ik(n,e,t,s))return!0;if(s)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function un(n,e,t,s,i,r,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=i,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=r,this.removeEmptyString=o}var Ft={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){Ft[n]=new un(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];Ft[e]=new un(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){Ft[n]=new un(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){Ft[n]=new un(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){Ft[n]=new un(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){Ft[n]=new un(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){Ft[n]=new un(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){Ft[n]=new un(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){Ft[n]=new un(n,5,!1,n.toLowerCase(),null,!1,!1)});var V0=/[\-:]([a-z])/g;function G0(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(V0,G0);Ft[e]=new un(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(V0,G0);Ft[e]=new un(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(V0,G0);Ft[e]=new un(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){Ft[n]=new un(n,1,!1,n.toLowerCase(),null,!1,!1)});Ft.xlinkHref=new un("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){Ft[n]=new un(n,1,!1,n.toLowerCase(),null,!0,!0)});function W0(n,e,t,s){var i=Ft.hasOwnProperty(e)?Ft[e]:null;(i!==null?i.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(rk(e,t,i,s)&&(t=null),s||i===null?sk(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):i.mustUseProperty?n[i.propertyName]=t===null?i.type===3?!1:"":t:(e=i.attributeName,s=i.attributeNamespace,t===null?n.removeAttribute(e):(i=i.type,t=i===3||i===4&&t===!0?"":""+t,s?n.setAttributeNS(s,e,t):n.setAttribute(e,t))))}var kr=tk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Gf=Symbol.for("react.element"),Ll=Symbol.for("react.portal"),Ml=Symbol.for("react.fragment"),X0=Symbol.for("react.strict_mode"),Ty=Symbol.for("react.profiler"),RS=Symbol.for("react.provider"),LS=Symbol.for("react.context"),Y0=Symbol.for("react.forward_ref"),Py=Symbol.for("react.suspense"),Ry=Symbol.for("react.suspense_list"),q0=Symbol.for("react.memo"),Nr=Symbol.for("react.lazy"),MS=Symbol.for("react.offscreen"),gb=Symbol.iterator;function Ru(n){return n===null||typeof n!="object"?null:(n=gb&&n[gb]||n["@@iterator"],typeof n=="function"?n:null)}var Ge=Object.assign,Hm;function Uu(n){if(Hm===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);Hm=e&&e[1]||""}return`
`+Hm+n}var Um=!1;function Vm(n,e){if(!n||Um)return"";Um=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var s=u}Reflect.construct(n,[],e)}else{try{e.call()}catch(u){s=u}n.call(e.prototype)}else{try{throw Error()}catch(u){s=u}n()}}catch(u){if(u&&s&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),r=s.stack.split(`
`),o=i.length-1,a=r.length-1;1<=o&&0<=a&&i[o]!==r[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==r[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==r[a]){var c=`
`+i[o].replace(" at new "," at ");return n.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",n.displayName)),c}while(1<=o&&0<=a);break}}}finally{Um=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?Uu(n):""}function ok(n){switch(n.tag){case 5:return Uu(n.type);case 16:return Uu("Lazy");case 13:return Uu("Suspense");case 19:return Uu("SuspenseList");case 0:case 2:case 15:return n=Vm(n.type,!1),n;case 11:return n=Vm(n.type.render,!1),n;case 1:return n=Vm(n.type,!0),n;default:return""}}function Ly(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Ml:return"Fragment";case Ll:return"Portal";case Ty:return"Profiler";case X0:return"StrictMode";case Py:return"Suspense";case Ry:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case LS:return(n.displayName||"Context")+".Consumer";case RS:return(n._context.displayName||"Context")+".Provider";case Y0:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case q0:return e=n.displayName||null,e!==null?e:Ly(n.type)||"Memo";case Nr:e=n._payload,n=n._init;try{return Ly(n(e))}catch{}}return null}function ak(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ly(e);case 8:return e===X0?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Do(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function DS(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function lk(n){var e=DS(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),s=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var i=t.get,r=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){s=""+o,r.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return s},setValue:function(o){s=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function Wf(n){n._valueTracker||(n._valueTracker=lk(n))}function NS(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),s="";return n&&(s=DS(n)?n.checked?"true":"false":n.value),n=s,n!==t?(e.setValue(n),!0):!1}function sg(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function My(n,e){var t=e.checked;return Ge({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function mb(n,e){var t=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;t=Do(e.value!=null?e.value:t),n._wrapperState={initialChecked:s,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function IS(n,e){e=e.checked,e!=null&&W0(n,"checked",e,!1)}function Dy(n,e){IS(n,e);var t=Do(e.value),s=e.type;if(t!=null)s==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(s==="submit"||s==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?Ny(n,e.type,t):e.hasOwnProperty("defaultValue")&&Ny(n,e.type,Do(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function yb(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function Ny(n,e,t){(e!=="number"||sg(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var Vu=Array.isArray;function Xl(n,e,t,s){if(n=n.options,e){e={};for(var i=0;i<t.length;i++)e["$"+t[i]]=!0;for(t=0;t<n.length;t++)i=e.hasOwnProperty("$"+n[t].value),n[t].selected!==i&&(n[t].selected=i),i&&s&&(n[t].defaultSelected=!0)}else{for(t=""+Do(t),e=null,i=0;i<n.length;i++){if(n[i].value===t){n[i].selected=!0,s&&(n[i].defaultSelected=!0);return}e!==null||n[i].disabled||(e=n[i])}e!==null&&(e.selected=!0)}}function Iy(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(N(91));return Ge({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function vb(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(N(92));if(Vu(t)){if(1<t.length)throw Error(N(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:Do(t)}}function OS(n,e){var t=Do(e.value),s=Do(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),s!=null&&(n.defaultValue=""+s)}function wb(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function FS(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Oy(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?FS(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Xf,jS=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,s,i){MSApp.execUnsafeLocalFunction(function(){return n(e,t,s,i)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(Xf=Xf||document.createElement("div"),Xf.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Xf.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function Cd(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var hd={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ck=["Webkit","ms","Moz","O"];Object.keys(hd).forEach(function(n){ck.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),hd[e]=hd[n]})});function zS(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||hd.hasOwnProperty(n)&&hd[n]?(""+e).trim():e+"px"}function BS(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var s=t.indexOf("--")===0,i=zS(t,e[t],s);t==="float"&&(t="cssFloat"),s?n.setProperty(t,i):n[t]=i}}var uk=Ge({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Fy(n,e){if(e){if(uk[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(N(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(N(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(N(61))}if(e.style!=null&&typeof e.style!="object")throw Error(N(62))}}function jy(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var zy=null;function K0(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var By=null,Yl=null,ql=null;function bb(n){if(n=Tf(n)){if(typeof By!="function")throw Error(N(280));var e=n.stateNode;e&&(e=um(e),By(n.stateNode,n.type,e))}}function $S(n){Yl?ql?ql.push(n):ql=[n]:Yl=n}function HS(){if(Yl){var n=Yl,e=ql;if(ql=Yl=null,bb(n),e)for(n=0;n<e.length;n++)bb(e[n])}}function US(n,e){return n(e)}function VS(){}var Gm=!1;function GS(n,e,t){if(Gm)return n(e,t);Gm=!0;try{return US(n,e,t)}finally{Gm=!1,(Yl!==null||ql!==null)&&(VS(),HS())}}function kd(n,e){var t=n.stateNode;if(t===null)return null;var s=um(t);if(s===null)return null;t=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(n=n.type,s=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!s;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(N(231,e,typeof t));return t}var $y=!1;if(br)try{var Lu={};Object.defineProperty(Lu,"passive",{get:function(){$y=!0}}),window.addEventListener("test",Lu,Lu),window.removeEventListener("test",Lu,Lu)}catch{$y=!1}function dk(n,e,t,s,i,r,o,a,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(t,u)}catch(d){this.onError(d)}}var fd=!1,ig=null,rg=!1,Hy=null,hk={onError:function(n){fd=!0,ig=n}};function fk(n,e,t,s,i,r,o,a,c){fd=!1,ig=null,dk.apply(hk,arguments)}function pk(n,e,t,s,i,r,o,a,c){if(fk.apply(this,arguments),fd){if(fd){var u=ig;fd=!1,ig=null}else throw Error(N(198));rg||(rg=!0,Hy=u)}}function yl(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function WS(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function Ab(n){if(yl(n)!==n)throw Error(N(188))}function gk(n){var e=n.alternate;if(!e){if(e=yl(n),e===null)throw Error(N(188));return e!==n?null:n}for(var t=n,s=e;;){var i=t.return;if(i===null)break;var r=i.alternate;if(r===null){if(s=i.return,s!==null){t=s;continue}break}if(i.child===r.child){for(r=i.child;r;){if(r===t)return Ab(i),n;if(r===s)return Ab(i),e;r=r.sibling}throw Error(N(188))}if(t.return!==s.return)t=i,s=r;else{for(var o=!1,a=i.child;a;){if(a===t){o=!0,t=i,s=r;break}if(a===s){o=!0,s=i,t=r;break}a=a.sibling}if(!o){for(a=r.child;a;){if(a===t){o=!0,t=r,s=i;break}if(a===s){o=!0,s=r,t=i;break}a=a.sibling}if(!o)throw Error(N(189))}}if(t.alternate!==s)throw Error(N(190))}if(t.tag!==3)throw Error(N(188));return t.stateNode.current===t?n:e}function XS(n){return n=gk(n),n!==null?YS(n):null}function YS(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=YS(n);if(e!==null)return e;n=n.sibling}return null}var qS=Jn.unstable_scheduleCallback,Sb=Jn.unstable_cancelCallback,mk=Jn.unstable_shouldYield,yk=Jn.unstable_requestPaint,tt=Jn.unstable_now,vk=Jn.unstable_getCurrentPriorityLevel,Q0=Jn.unstable_ImmediatePriority,KS=Jn.unstable_UserBlockingPriority,og=Jn.unstable_NormalPriority,wk=Jn.unstable_LowPriority,QS=Jn.unstable_IdlePriority,om=null,xi=null;function bk(n){if(xi&&typeof xi.onCommitFiberRoot=="function")try{xi.onCommitFiberRoot(om,n,void 0,(n.current.flags&128)===128)}catch{}}var Us=Math.clz32?Math.clz32:xk,Ak=Math.log,Sk=Math.LN2;function xk(n){return n>>>=0,n===0?32:31-(Ak(n)/Sk|0)|0}var Yf=64,qf=4194304;function Gu(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function ag(n,e){var t=n.pendingLanes;if(t===0)return 0;var s=0,i=n.suspendedLanes,r=n.pingedLanes,o=t&268435455;if(o!==0){var a=o&~i;a!==0?s=Gu(a):(r&=o,r!==0&&(s=Gu(r)))}else o=t&~i,o!==0?s=Gu(o):r!==0&&(s=Gu(r));if(s===0)return 0;if(e!==0&&e!==s&&!(e&i)&&(i=s&-s,r=e&-e,i>=r||i===16&&(r&4194240)!==0))return e;if(s&4&&(s|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=s;0<e;)t=31-Us(e),i=1<<t,s|=n[t],e&=~i;return s}function Ek(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _k(n,e){for(var t=n.suspendedLanes,s=n.pingedLanes,i=n.expirationTimes,r=n.pendingLanes;0<r;){var o=31-Us(r),a=1<<o,c=i[o];c===-1?(!(a&t)||a&s)&&(i[o]=Ek(a,e)):c<=e&&(n.expiredLanes|=a),r&=~a}}function Uy(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function JS(){var n=Yf;return Yf<<=1,!(Yf&4194240)&&(Yf=64),n}function Wm(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function Cf(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-Us(e),n[e]=t}function Ck(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var s=n.eventTimes;for(n=n.expirationTimes;0<t;){var i=31-Us(t),r=1<<i;e[i]=0,s[i]=-1,n[i]=-1,t&=~r}}function J0(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var s=31-Us(t),i=1<<s;i&e|n[s]&e&&(n[s]|=e),t&=~i}}var Ae=0;function ZS(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var ex,Z0,tx,nx,sx,Vy=!1,Kf=[],_o=null,Co=null,ko=null,Td=new Map,Pd=new Map,Fr=[],kk="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function xb(n,e){switch(n){case"focusin":case"focusout":_o=null;break;case"dragenter":case"dragleave":Co=null;break;case"mouseover":case"mouseout":ko=null;break;case"pointerover":case"pointerout":Td.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pd.delete(e.pointerId)}}function Mu(n,e,t,s,i,r){return n===null||n.nativeEvent!==r?(n={blockedOn:e,domEventName:t,eventSystemFlags:s,nativeEvent:r,targetContainers:[i]},e!==null&&(e=Tf(e),e!==null&&Z0(e)),n):(n.eventSystemFlags|=s,e=n.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),n)}function Tk(n,e,t,s,i){switch(e){case"focusin":return _o=Mu(_o,n,e,t,s,i),!0;case"dragenter":return Co=Mu(Co,n,e,t,s,i),!0;case"mouseover":return ko=Mu(ko,n,e,t,s,i),!0;case"pointerover":var r=i.pointerId;return Td.set(r,Mu(Td.get(r)||null,n,e,t,s,i)),!0;case"gotpointercapture":return r=i.pointerId,Pd.set(r,Mu(Pd.get(r)||null,n,e,t,s,i)),!0}return!1}function ix(n){var e=Jo(n.target);if(e!==null){var t=yl(e);if(t!==null){if(e=t.tag,e===13){if(e=WS(t),e!==null){n.blockedOn=e,sx(n.priority,function(){tx(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function mp(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=Gy(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var s=new t.constructor(t.type,t);zy=s,t.target.dispatchEvent(s),zy=null}else return e=Tf(t),e!==null&&Z0(e),n.blockedOn=t,!1;e.shift()}return!0}function Eb(n,e,t){mp(n)&&t.delete(e)}function Pk(){Vy=!1,_o!==null&&mp(_o)&&(_o=null),Co!==null&&mp(Co)&&(Co=null),ko!==null&&mp(ko)&&(ko=null),Td.forEach(Eb),Pd.forEach(Eb)}function Du(n,e){n.blockedOn===e&&(n.blockedOn=null,Vy||(Vy=!0,Jn.unstable_scheduleCallback(Jn.unstable_NormalPriority,Pk)))}function Rd(n){function e(i){return Du(i,n)}if(0<Kf.length){Du(Kf[0],n);for(var t=1;t<Kf.length;t++){var s=Kf[t];s.blockedOn===n&&(s.blockedOn=null)}}for(_o!==null&&Du(_o,n),Co!==null&&Du(Co,n),ko!==null&&Du(ko,n),Td.forEach(e),Pd.forEach(e),t=0;t<Fr.length;t++)s=Fr[t],s.blockedOn===n&&(s.blockedOn=null);for(;0<Fr.length&&(t=Fr[0],t.blockedOn===null);)ix(t),t.blockedOn===null&&Fr.shift()}var Kl=kr.ReactCurrentBatchConfig,lg=!0;function Rk(n,e,t,s){var i=Ae,r=Kl.transition;Kl.transition=null;try{Ae=1,ew(n,e,t,s)}finally{Ae=i,Kl.transition=r}}function Lk(n,e,t,s){var i=Ae,r=Kl.transition;Kl.transition=null;try{Ae=4,ew(n,e,t,s)}finally{Ae=i,Kl.transition=r}}function ew(n,e,t,s){if(lg){var i=Gy(n,e,t,s);if(i===null)ny(n,e,s,cg,t),xb(n,s);else if(Tk(i,n,e,t,s))s.stopPropagation();else if(xb(n,s),e&4&&-1<kk.indexOf(n)){for(;i!==null;){var r=Tf(i);if(r!==null&&ex(r),r=Gy(n,e,t,s),r===null&&ny(n,e,s,cg,t),r===i)break;i=r}i!==null&&s.stopPropagation()}else ny(n,e,s,null,t)}}var cg=null;function Gy(n,e,t,s){if(cg=null,n=K0(s),n=Jo(n),n!==null)if(e=yl(n),e===null)n=null;else if(t=e.tag,t===13){if(n=WS(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return cg=n,null}function rx(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(vk()){case Q0:return 1;case KS:return 4;case og:case wk:return 16;case QS:return 536870912;default:return 16}default:return 16}}var xo=null,tw=null,yp=null;function ox(){if(yp)return yp;var n,e=tw,t=e.length,s,i="value"in xo?xo.value:xo.textContent,r=i.length;for(n=0;n<t&&e[n]===i[n];n++);var o=t-n;for(s=1;s<=o&&e[t-s]===i[r-s];s++);return yp=i.slice(n,1<s?1-s:void 0)}function vp(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function Qf(){return!0}function _b(){return!1}function es(n){function e(t,s,i,r,o){this._reactName=t,this._targetInst=i,this.type=s,this.nativeEvent=r,this.target=o,this.currentTarget=null;for(var a in n)n.hasOwnProperty(a)&&(t=n[a],this[a]=t?t(r):r[a]);return this.isDefaultPrevented=(r.defaultPrevented!=null?r.defaultPrevented:r.returnValue===!1)?Qf:_b,this.isPropagationStopped=_b,this}return Ge(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Qf)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Qf)},persist:function(){},isPersistent:Qf}),e}var Su={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},nw=es(Su),kf=Ge({},Su,{view:0,detail:0}),Mk=es(kf),Xm,Ym,Nu,am=Ge({},kf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:sw,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Nu&&(Nu&&n.type==="mousemove"?(Xm=n.screenX-Nu.screenX,Ym=n.screenY-Nu.screenY):Ym=Xm=0,Nu=n),Xm)},movementY:function(n){return"movementY"in n?n.movementY:Ym}}),Cb=es(am),Dk=Ge({},am,{dataTransfer:0}),Nk=es(Dk),Ik=Ge({},kf,{relatedTarget:0}),qm=es(Ik),Ok=Ge({},Su,{animationName:0,elapsedTime:0,pseudoElement:0}),Fk=es(Ok),jk=Ge({},Su,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),zk=es(jk),Bk=Ge({},Su,{data:0}),kb=es(Bk),$k={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Hk={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Uk={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Vk(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=Uk[n])?!!e[n]:!1}function sw(){return Vk}var Gk=Ge({},kf,{key:function(n){if(n.key){var e=$k[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=vp(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Hk[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:sw,charCode:function(n){return n.type==="keypress"?vp(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?vp(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Wk=es(Gk),Xk=Ge({},am,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Tb=es(Xk),Yk=Ge({},kf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:sw}),qk=es(Yk),Kk=Ge({},Su,{propertyName:0,elapsedTime:0,pseudoElement:0}),Qk=es(Kk),Jk=Ge({},am,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Zk=es(Jk),eT=[9,13,27,32],iw=br&&"CompositionEvent"in window,pd=null;br&&"documentMode"in document&&(pd=document.documentMode);var tT=br&&"TextEvent"in window&&!pd,ax=br&&(!iw||pd&&8<pd&&11>=pd),Pb=" ",Rb=!1;function lx(n,e){switch(n){case"keyup":return eT.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function cx(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Dl=!1;function nT(n,e){switch(n){case"compositionend":return cx(e);case"keypress":return e.which!==32?null:(Rb=!0,Pb);case"textInput":return n=e.data,n===Pb&&Rb?null:n;default:return null}}function sT(n,e){if(Dl)return n==="compositionend"||!iw&&lx(n,e)?(n=ox(),yp=tw=xo=null,Dl=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return ax&&e.locale!=="ko"?null:e.data;default:return null}}var iT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Lb(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!iT[n.type]:e==="textarea"}function ux(n,e,t,s){$S(s),e=ug(e,"onChange"),0<e.length&&(t=new nw("onChange","change",null,t,s),n.push({event:t,listeners:e}))}var gd=null,Ld=null;function rT(n){Ax(n,0)}function lm(n){var e=Ol(n);if(NS(e))return n}function oT(n,e){if(n==="change")return e}var dx=!1;if(br){var Km;if(br){var Qm="oninput"in document;if(!Qm){var Mb=document.createElement("div");Mb.setAttribute("oninput","return;"),Qm=typeof Mb.oninput=="function"}Km=Qm}else Km=!1;dx=Km&&(!document.documentMode||9<document.documentMode)}function Db(){gd&&(gd.detachEvent("onpropertychange",hx),Ld=gd=null)}function hx(n){if(n.propertyName==="value"&&lm(Ld)){var e=[];ux(e,Ld,n,K0(n)),GS(rT,e)}}function aT(n,e,t){n==="focusin"?(Db(),gd=e,Ld=t,gd.attachEvent("onpropertychange",hx)):n==="focusout"&&Db()}function lT(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return lm(Ld)}function cT(n,e){if(n==="click")return lm(e)}function uT(n,e){if(n==="input"||n==="change")return lm(e)}function dT(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var Gs=typeof Object.is=="function"?Object.is:dT;function Md(n,e){if(Gs(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),s=Object.keys(e);if(t.length!==s.length)return!1;for(s=0;s<t.length;s++){var i=t[s];if(!ky.call(e,i)||!Gs(n[i],e[i]))return!1}return!0}function Nb(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Ib(n,e){var t=Nb(n);n=0;for(var s;t;){if(t.nodeType===3){if(s=n+t.textContent.length,n<=e&&s>=e)return{node:t,offset:e-n};n=s}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=Nb(t)}}function fx(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?fx(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function px(){for(var n=window,e=sg();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=sg(n.document)}return e}function rw(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function hT(n){var e=px(),t=n.focusedElem,s=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&fx(t.ownerDocument.documentElement,t)){if(s!==null&&rw(t)){if(e=s.start,n=s.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var i=t.textContent.length,r=Math.min(s.start,i);s=s.end===void 0?r:Math.min(s.end,i),!n.extend&&r>s&&(i=s,s=r,r=i),i=Ib(t,r);var o=Ib(t,s);i&&o&&(n.rangeCount!==1||n.anchorNode!==i.node||n.anchorOffset!==i.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),n.removeAllRanges(),r>s?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var fT=br&&"documentMode"in document&&11>=document.documentMode,Nl=null,Wy=null,md=null,Xy=!1;function Ob(n,e,t){var s=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;Xy||Nl==null||Nl!==sg(s)||(s=Nl,"selectionStart"in s&&rw(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),md&&Md(md,s)||(md=s,s=ug(Wy,"onSelect"),0<s.length&&(e=new nw("onSelect","select",null,e,t),n.push({event:e,listeners:s}),e.target=Nl)))}function Jf(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var Il={animationend:Jf("Animation","AnimationEnd"),animationiteration:Jf("Animation","AnimationIteration"),animationstart:Jf("Animation","AnimationStart"),transitionend:Jf("Transition","TransitionEnd")},Jm={},gx={};br&&(gx=document.createElement("div").style,"AnimationEvent"in window||(delete Il.animationend.animation,delete Il.animationiteration.animation,delete Il.animationstart.animation),"TransitionEvent"in window||delete Il.transitionend.transition);function cm(n){if(Jm[n])return Jm[n];if(!Il[n])return n;var e=Il[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in gx)return Jm[n]=e[t];return n}var mx=cm("animationend"),yx=cm("animationiteration"),vx=cm("animationstart"),wx=cm("transitionend"),bx=new Map,Fb="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function $o(n,e){bx.set(n,e),ml(e,[n])}for(var Zm=0;Zm<Fb.length;Zm++){var ey=Fb[Zm],pT=ey.toLowerCase(),gT=ey[0].toUpperCase()+ey.slice(1);$o(pT,"on"+gT)}$o(mx,"onAnimationEnd");$o(yx,"onAnimationIteration");$o(vx,"onAnimationStart");$o("dblclick","onDoubleClick");$o("focusin","onFocus");$o("focusout","onBlur");$o(wx,"onTransitionEnd");uu("onMouseEnter",["mouseout","mouseover"]);uu("onMouseLeave",["mouseout","mouseover"]);uu("onPointerEnter",["pointerout","pointerover"]);uu("onPointerLeave",["pointerout","pointerover"]);ml("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ml("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ml("onBeforeInput",["compositionend","keypress","textInput","paste"]);ml("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ml("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ml("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Wu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mT=new Set("cancel close invalid load scroll toggle".split(" ").concat(Wu));function jb(n,e,t){var s=n.type||"unknown-event";n.currentTarget=t,pk(s,e,void 0,n),n.currentTarget=null}function Ax(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var s=n[t],i=s.event;s=s.listeners;e:{var r=void 0;if(e)for(var o=s.length-1;0<=o;o--){var a=s[o],c=a.instance,u=a.currentTarget;if(a=a.listener,c!==r&&i.isPropagationStopped())break e;jb(i,a,u),r=c}else for(o=0;o<s.length;o++){if(a=s[o],c=a.instance,u=a.currentTarget,a=a.listener,c!==r&&i.isPropagationStopped())break e;jb(i,a,u),r=c}}}if(rg)throw n=Hy,rg=!1,Hy=null,n}function De(n,e){var t=e[Jy];t===void 0&&(t=e[Jy]=new Set);var s=n+"__bubble";t.has(s)||(Sx(e,n,2,!1),t.add(s))}function ty(n,e,t){var s=0;e&&(s|=4),Sx(t,n,s,e)}var Zf="_reactListening"+Math.random().toString(36).slice(2);function Dd(n){if(!n[Zf]){n[Zf]=!0,PS.forEach(function(t){t!=="selectionchange"&&(mT.has(t)||ty(t,!1,n),ty(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[Zf]||(e[Zf]=!0,ty("selectionchange",!1,e))}}function Sx(n,e,t,s){switch(rx(e)){case 1:var i=Rk;break;case 4:i=Lk;break;default:i=ew}t=i.bind(null,e,t,n),i=void 0,!$y||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),s?i!==void 0?n.addEventListener(e,t,{capture:!0,passive:i}):n.addEventListener(e,t,!0):i!==void 0?n.addEventListener(e,t,{passive:i}):n.addEventListener(e,t,!1)}function ny(n,e,t,s,i){var r=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var o=s.tag;if(o===3||o===4){var a=s.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=s.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Jo(a),o===null)return;if(c=o.tag,c===5||c===6){s=r=o;continue e}a=a.parentNode}}s=s.return}GS(function(){var u=r,d=K0(t),h=[];e:{var f=bx.get(n);if(f!==void 0){var p=nw,v=n;switch(n){case"keypress":if(vp(t)===0)break e;case"keydown":case"keyup":p=Wk;break;case"focusin":v="focus",p=qm;break;case"focusout":v="blur",p=qm;break;case"beforeblur":case"afterblur":p=qm;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=Cb;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=Nk;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=qk;break;case mx:case yx:case vx:p=Fk;break;case wx:p=Qk;break;case"scroll":p=Mk;break;case"wheel":p=Zk;break;case"copy":case"cut":case"paste":p=zk;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Tb}var g=(e&4)!==0,x=!g&&n==="scroll",y=g?f!==null?f+"Capture":null:f;g=[];for(var w=u,b;w!==null;){b=w;var E=b.stateNode;if(b.tag===5&&E!==null&&(b=E,y!==null&&(E=kd(w,y),E!=null&&g.push(Nd(w,E,b)))),x)break;w=w.return}0<g.length&&(f=new p(f,v,null,t,d),h.push({event:f,listeners:g}))}}if(!(e&7)){e:{if(f=n==="mouseover"||n==="pointerover",p=n==="mouseout"||n==="pointerout",f&&t!==zy&&(v=t.relatedTarget||t.fromElement)&&(Jo(v)||v[Ar]))break e;if((p||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,p?(v=t.relatedTarget||t.toElement,p=u,v=v?Jo(v):null,v!==null&&(x=yl(v),v!==x||v.tag!==5&&v.tag!==6)&&(v=null)):(p=null,v=u),p!==v)){if(g=Cb,E="onMouseLeave",y="onMouseEnter",w="mouse",(n==="pointerout"||n==="pointerover")&&(g=Tb,E="onPointerLeave",y="onPointerEnter",w="pointer"),x=p==null?f:Ol(p),b=v==null?f:Ol(v),f=new g(E,w+"leave",p,t,d),f.target=x,f.relatedTarget=b,E=null,Jo(d)===u&&(g=new g(y,w+"enter",v,t,d),g.target=b,g.relatedTarget=x,E=g),x=E,p&&v)t:{for(g=p,y=v,w=0,b=g;b;b=xl(b))w++;for(b=0,E=y;E;E=xl(E))b++;for(;0<w-b;)g=xl(g),w--;for(;0<b-w;)y=xl(y),b--;for(;w--;){if(g===y||y!==null&&g===y.alternate)break t;g=xl(g),y=xl(y)}g=null}else g=null;p!==null&&zb(h,f,p,g,!1),v!==null&&x!==null&&zb(h,x,v,g,!0)}}e:{if(f=u?Ol(u):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var _=oT;else if(Lb(f))if(dx)_=uT;else{_=lT;var k=aT}else(p=f.nodeName)&&p.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(_=cT);if(_&&(_=_(n,u))){ux(h,_,t,d);break e}k&&k(n,f,u),n==="focusout"&&(k=f._wrapperState)&&k.controlled&&f.type==="number"&&Ny(f,"number",f.value)}switch(k=u?Ol(u):window,n){case"focusin":(Lb(k)||k.contentEditable==="true")&&(Nl=k,Wy=u,md=null);break;case"focusout":md=Wy=Nl=null;break;case"mousedown":Xy=!0;break;case"contextmenu":case"mouseup":case"dragend":Xy=!1,Ob(h,t,d);break;case"selectionchange":if(fT)break;case"keydown":case"keyup":Ob(h,t,d)}var C;if(iw)e:{switch(n){case"compositionstart":var P="onCompositionStart";break e;case"compositionend":P="onCompositionEnd";break e;case"compositionupdate":P="onCompositionUpdate";break e}P=void 0}else Dl?lx(n,t)&&(P="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(P="onCompositionStart");P&&(ax&&t.locale!=="ko"&&(Dl||P!=="onCompositionStart"?P==="onCompositionEnd"&&Dl&&(C=ox()):(xo=d,tw="value"in xo?xo.value:xo.textContent,Dl=!0)),k=ug(u,P),0<k.length&&(P=new kb(P,n,null,t,d),h.push({event:P,listeners:k}),C?P.data=C:(C=cx(t),C!==null&&(P.data=C)))),(C=tT?nT(n,t):sT(n,t))&&(u=ug(u,"onBeforeInput"),0<u.length&&(d=new kb("onBeforeInput","beforeinput",null,t,d),h.push({event:d,listeners:u}),d.data=C))}Ax(h,e)})}function Nd(n,e,t){return{instance:n,listener:e,currentTarget:t}}function ug(n,e){for(var t=e+"Capture",s=[];n!==null;){var i=n,r=i.stateNode;i.tag===5&&r!==null&&(i=r,r=kd(n,t),r!=null&&s.unshift(Nd(n,r,i)),r=kd(n,e),r!=null&&s.push(Nd(n,r,i))),n=n.return}return s}function xl(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function zb(n,e,t,s,i){for(var r=e._reactName,o=[];t!==null&&t!==s;){var a=t,c=a.alternate,u=a.stateNode;if(c!==null&&c===s)break;a.tag===5&&u!==null&&(a=u,i?(c=kd(t,r),c!=null&&o.unshift(Nd(t,c,a))):i||(c=kd(t,r),c!=null&&o.push(Nd(t,c,a)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var yT=/\r\n?/g,vT=/\u0000|\uFFFD/g;function Bb(n){return(typeof n=="string"?n:""+n).replace(yT,`
`).replace(vT,"")}function ep(n,e,t){if(e=Bb(e),Bb(n)!==e&&t)throw Error(N(425))}function dg(){}var Yy=null,qy=null;function Ky(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Qy=typeof setTimeout=="function"?setTimeout:void 0,wT=typeof clearTimeout=="function"?clearTimeout:void 0,$b=typeof Promise=="function"?Promise:void 0,bT=typeof queueMicrotask=="function"?queueMicrotask:typeof $b<"u"?function(n){return $b.resolve(null).then(n).catch(AT)}:Qy;function AT(n){setTimeout(function(){throw n})}function sy(n,e){var t=e,s=0;do{var i=t.nextSibling;if(n.removeChild(t),i&&i.nodeType===8)if(t=i.data,t==="/$"){if(s===0){n.removeChild(i),Rd(e);return}s--}else t!=="$"&&t!=="$?"&&t!=="$!"||s++;t=i}while(t);Rd(e)}function To(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function Hb(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var xu=Math.random().toString(36).slice(2),bi="__reactFiber$"+xu,Id="__reactProps$"+xu,Ar="__reactContainer$"+xu,Jy="__reactEvents$"+xu,ST="__reactListeners$"+xu,xT="__reactHandles$"+xu;function Jo(n){var e=n[bi];if(e)return e;for(var t=n.parentNode;t;){if(e=t[Ar]||t[bi]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=Hb(n);n!==null;){if(t=n[bi])return t;n=Hb(n)}return e}n=t,t=n.parentNode}return null}function Tf(n){return n=n[bi]||n[Ar],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function Ol(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(N(33))}function um(n){return n[Id]||null}var Zy=[],Fl=-1;function Ho(n){return{current:n}}function Ie(n){0>Fl||(n.current=Zy[Fl],Zy[Fl]=null,Fl--)}function Le(n,e){Fl++,Zy[Fl]=n.current,n.current=e}var No={},Kt=Ho(No),bn=Ho(!1),cl=No;function du(n,e){var t=n.type.contextTypes;if(!t)return No;var s=n.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var i={},r;for(r in t)i[r]=e[r];return s&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=i),i}function An(n){return n=n.childContextTypes,n!=null}function hg(){Ie(bn),Ie(Kt)}function Ub(n,e,t){if(Kt.current!==No)throw Error(N(168));Le(Kt,e),Le(bn,t)}function xx(n,e,t){var s=n.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return t;s=s.getChildContext();for(var i in s)if(!(i in e))throw Error(N(108,ak(n)||"Unknown",i));return Ge({},t,s)}function fg(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||No,cl=Kt.current,Le(Kt,n),Le(bn,bn.current),!0}function Vb(n,e,t){var s=n.stateNode;if(!s)throw Error(N(169));t?(n=xx(n,e,cl),s.__reactInternalMemoizedMergedChildContext=n,Ie(bn),Ie(Kt),Le(Kt,n)):Ie(bn),Le(bn,t)}var zi=null,dm=!1,iy=!1;function Ex(n){zi===null?zi=[n]:zi.push(n)}function ET(n){dm=!0,Ex(n)}function Uo(){if(!iy&&zi!==null){iy=!0;var n=0,e=Ae;try{var t=zi;for(Ae=1;n<t.length;n++){var s=t[n];do s=s(!0);while(s!==null)}zi=null,dm=!1}catch(i){throw zi!==null&&(zi=zi.slice(n+1)),qS(Q0,Uo),i}finally{Ae=e,iy=!1}}return null}var jl=[],zl=0,pg=null,gg=0,hs=[],fs=0,ul=null,gr=1,mr="";function Go(n,e){jl[zl++]=gg,jl[zl++]=pg,pg=n,gg=e}function _x(n,e,t){hs[fs++]=gr,hs[fs++]=mr,hs[fs++]=ul,ul=n;var s=gr;n=mr;var i=32-Us(s)-1;s&=~(1<<i),t+=1;var r=32-Us(e)+i;if(30<r){var o=i-i%5;r=(s&(1<<o)-1).toString(32),s>>=o,i-=o,gr=1<<32-Us(e)+i|t<<i|s,mr=r+n}else gr=1<<r|t<<i|s,mr=n}function ow(n){n.return!==null&&(Go(n,1),_x(n,1,0))}function aw(n){for(;n===pg;)pg=jl[--zl],jl[zl]=null,gg=jl[--zl],jl[zl]=null;for(;n===ul;)ul=hs[--fs],hs[fs]=null,mr=hs[--fs],hs[fs]=null,gr=hs[--fs],hs[fs]=null}var Kn=null,qn=null,ze=!1,$s=null;function Cx(n,e){var t=ms(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function Gb(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,Kn=n,qn=To(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,Kn=n,qn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=ul!==null?{id:gr,overflow:mr}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=ms(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,Kn=n,qn=null,!0):!1;default:return!1}}function ev(n){return(n.mode&1)!==0&&(n.flags&128)===0}function tv(n){if(ze){var e=qn;if(e){var t=e;if(!Gb(n,e)){if(ev(n))throw Error(N(418));e=To(t.nextSibling);var s=Kn;e&&Gb(n,e)?Cx(s,t):(n.flags=n.flags&-4097|2,ze=!1,Kn=n)}}else{if(ev(n))throw Error(N(418));n.flags=n.flags&-4097|2,ze=!1,Kn=n}}}function Wb(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Kn=n}function tp(n){if(n!==Kn)return!1;if(!ze)return Wb(n),ze=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!Ky(n.type,n.memoizedProps)),e&&(e=qn)){if(ev(n))throw kx(),Error(N(418));for(;e;)Cx(n,e),e=To(e.nextSibling)}if(Wb(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(N(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){qn=To(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}qn=null}}else qn=Kn?To(n.stateNode.nextSibling):null;return!0}function kx(){for(var n=qn;n;)n=To(n.nextSibling)}function hu(){qn=Kn=null,ze=!1}function lw(n){$s===null?$s=[n]:$s.push(n)}var _T=kr.ReactCurrentBatchConfig;function Iu(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(N(309));var s=t.stateNode}if(!s)throw Error(N(147,n));var i=s,r=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===r?e.ref:(e=function(o){var a=i.refs;o===null?delete a[r]:a[r]=o},e._stringRef=r,e)}if(typeof n!="string")throw Error(N(284));if(!t._owner)throw Error(N(290,n))}return n}function np(n,e){throw n=Object.prototype.toString.call(e),Error(N(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function Xb(n){var e=n._init;return e(n._payload)}function Tx(n){function e(y,w){if(n){var b=y.deletions;b===null?(y.deletions=[w],y.flags|=16):b.push(w)}}function t(y,w){if(!n)return null;for(;w!==null;)e(y,w),w=w.sibling;return null}function s(y,w){for(y=new Map;w!==null;)w.key!==null?y.set(w.key,w):y.set(w.index,w),w=w.sibling;return y}function i(y,w){return y=Mo(y,w),y.index=0,y.sibling=null,y}function r(y,w,b){return y.index=b,n?(b=y.alternate,b!==null?(b=b.index,b<w?(y.flags|=2,w):b):(y.flags|=2,w)):(y.flags|=1048576,w)}function o(y){return n&&y.alternate===null&&(y.flags|=2),y}function a(y,w,b,E){return w===null||w.tag!==6?(w=dy(b,y.mode,E),w.return=y,w):(w=i(w,b),w.return=y,w)}function c(y,w,b,E){var _=b.type;return _===Ml?d(y,w,b.props.children,E,b.key):w!==null&&(w.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===Nr&&Xb(_)===w.type)?(E=i(w,b.props),E.ref=Iu(y,w,b),E.return=y,E):(E=_p(b.type,b.key,b.props,null,y.mode,E),E.ref=Iu(y,w,b),E.return=y,E)}function u(y,w,b,E){return w===null||w.tag!==4||w.stateNode.containerInfo!==b.containerInfo||w.stateNode.implementation!==b.implementation?(w=hy(b,y.mode,E),w.return=y,w):(w=i(w,b.children||[]),w.return=y,w)}function d(y,w,b,E,_){return w===null||w.tag!==7?(w=ll(b,y.mode,E,_),w.return=y,w):(w=i(w,b),w.return=y,w)}function h(y,w,b){if(typeof w=="string"&&w!==""||typeof w=="number")return w=dy(""+w,y.mode,b),w.return=y,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Gf:return b=_p(w.type,w.key,w.props,null,y.mode,b),b.ref=Iu(y,null,w),b.return=y,b;case Ll:return w=hy(w,y.mode,b),w.return=y,w;case Nr:var E=w._init;return h(y,E(w._payload),b)}if(Vu(w)||Ru(w))return w=ll(w,y.mode,b,null),w.return=y,w;np(y,w)}return null}function f(y,w,b,E){var _=w!==null?w.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return _!==null?null:a(y,w,""+b,E);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Gf:return b.key===_?c(y,w,b,E):null;case Ll:return b.key===_?u(y,w,b,E):null;case Nr:return _=b._init,f(y,w,_(b._payload),E)}if(Vu(b)||Ru(b))return _!==null?null:d(y,w,b,E,null);np(y,b)}return null}function p(y,w,b,E,_){if(typeof E=="string"&&E!==""||typeof E=="number")return y=y.get(b)||null,a(w,y,""+E,_);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Gf:return y=y.get(E.key===null?b:E.key)||null,c(w,y,E,_);case Ll:return y=y.get(E.key===null?b:E.key)||null,u(w,y,E,_);case Nr:var k=E._init;return p(y,w,b,k(E._payload),_)}if(Vu(E)||Ru(E))return y=y.get(b)||null,d(w,y,E,_,null);np(w,E)}return null}function v(y,w,b,E){for(var _=null,k=null,C=w,P=w=0,L=null;C!==null&&P<b.length;P++){C.index>P?(L=C,C=null):L=C.sibling;var M=f(y,C,b[P],E);if(M===null){C===null&&(C=L);break}n&&C&&M.alternate===null&&e(y,C),w=r(M,w,P),k===null?_=M:k.sibling=M,k=M,C=L}if(P===b.length)return t(y,C),ze&&Go(y,P),_;if(C===null){for(;P<b.length;P++)C=h(y,b[P],E),C!==null&&(w=r(C,w,P),k===null?_=C:k.sibling=C,k=C);return ze&&Go(y,P),_}for(C=s(y,C);P<b.length;P++)L=p(C,y,P,b[P],E),L!==null&&(n&&L.alternate!==null&&C.delete(L.key===null?P:L.key),w=r(L,w,P),k===null?_=L:k.sibling=L,k=L);return n&&C.forEach(function(D){return e(y,D)}),ze&&Go(y,P),_}function g(y,w,b,E){var _=Ru(b);if(typeof _!="function")throw Error(N(150));if(b=_.call(b),b==null)throw Error(N(151));for(var k=_=null,C=w,P=w=0,L=null,M=b.next();C!==null&&!M.done;P++,M=b.next()){C.index>P?(L=C,C=null):L=C.sibling;var D=f(y,C,M.value,E);if(D===null){C===null&&(C=L);break}n&&C&&D.alternate===null&&e(y,C),w=r(D,w,P),k===null?_=D:k.sibling=D,k=D,C=L}if(M.done)return t(y,C),ze&&Go(y,P),_;if(C===null){for(;!M.done;P++,M=b.next())M=h(y,M.value,E),M!==null&&(w=r(M,w,P),k===null?_=M:k.sibling=M,k=M);return ze&&Go(y,P),_}for(C=s(y,C);!M.done;P++,M=b.next())M=p(C,y,P,M.value,E),M!==null&&(n&&M.alternate!==null&&C.delete(M.key===null?P:M.key),w=r(M,w,P),k===null?_=M:k.sibling=M,k=M);return n&&C.forEach(function(K){return e(y,K)}),ze&&Go(y,P),_}function x(y,w,b,E){if(typeof b=="object"&&b!==null&&b.type===Ml&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case Gf:e:{for(var _=b.key,k=w;k!==null;){if(k.key===_){if(_=b.type,_===Ml){if(k.tag===7){t(y,k.sibling),w=i(k,b.props.children),w.return=y,y=w;break e}}else if(k.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===Nr&&Xb(_)===k.type){t(y,k.sibling),w=i(k,b.props),w.ref=Iu(y,k,b),w.return=y,y=w;break e}t(y,k);break}else e(y,k);k=k.sibling}b.type===Ml?(w=ll(b.props.children,y.mode,E,b.key),w.return=y,y=w):(E=_p(b.type,b.key,b.props,null,y.mode,E),E.ref=Iu(y,w,b),E.return=y,y=E)}return o(y);case Ll:e:{for(k=b.key;w!==null;){if(w.key===k)if(w.tag===4&&w.stateNode.containerInfo===b.containerInfo&&w.stateNode.implementation===b.implementation){t(y,w.sibling),w=i(w,b.children||[]),w.return=y,y=w;break e}else{t(y,w);break}else e(y,w);w=w.sibling}w=hy(b,y.mode,E),w.return=y,y=w}return o(y);case Nr:return k=b._init,x(y,w,k(b._payload),E)}if(Vu(b))return v(y,w,b,E);if(Ru(b))return g(y,w,b,E);np(y,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,w!==null&&w.tag===6?(t(y,w.sibling),w=i(w,b),w.return=y,y=w):(t(y,w),w=dy(b,y.mode,E),w.return=y,y=w),o(y)):t(y,w)}return x}var fu=Tx(!0),Px=Tx(!1),mg=Ho(null),yg=null,Bl=null,cw=null;function uw(){cw=Bl=yg=null}function dw(n){var e=mg.current;Ie(mg),n._currentValue=e}function nv(n,e,t){for(;n!==null;){var s=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),n===t)break;n=n.return}}function Ql(n,e){yg=n,cw=Bl=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(wn=!0),n.firstContext=null)}function ws(n){var e=n._currentValue;if(cw!==n)if(n={context:n,memoizedValue:e,next:null},Bl===null){if(yg===null)throw Error(N(308));Bl=n,yg.dependencies={lanes:0,firstContext:n}}else Bl=Bl.next=n;return e}var Zo=null;function hw(n){Zo===null?Zo=[n]:Zo.push(n)}function Rx(n,e,t,s){var i=e.interleaved;return i===null?(t.next=t,hw(e)):(t.next=i.next,i.next=t),e.interleaved=t,Sr(n,s)}function Sr(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var Ir=!1;function fw(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Lx(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function yr(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function Po(n,e,t){var s=n.updateQueue;if(s===null)return null;if(s=s.shared,ge&2){var i=s.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),s.pending=e,Sr(n,t)}return i=s.interleaved,i===null?(e.next=e,hw(s)):(e.next=i.next,i.next=e),s.interleaved=e,Sr(n,t)}function wp(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var s=e.lanes;s&=n.pendingLanes,t|=s,e.lanes=t,J0(n,t)}}function Yb(n,e){var t=n.updateQueue,s=n.alternate;if(s!==null&&(s=s.updateQueue,t===s)){var i=null,r=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};r===null?i=r=o:r=r.next=o,t=t.next}while(t!==null);r===null?i=r=e:r=r.next=e}else i=r=e;t={baseState:s.baseState,firstBaseUpdate:i,lastBaseUpdate:r,shared:s.shared,effects:s.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function vg(n,e,t,s){var i=n.updateQueue;Ir=!1;var r=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var c=a,u=c.next;c.next=null,o===null?r=u:o.next=u,o=c;var d=n.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=u:a.next=u,d.lastBaseUpdate=c))}if(r!==null){var h=i.baseState;o=0,d=u=c=null,a=r;do{var f=a.lane,p=a.eventTime;if((s&f)===f){d!==null&&(d=d.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var v=n,g=a;switch(f=e,p=t,g.tag){case 1:if(v=g.payload,typeof v=="function"){h=v.call(p,h,f);break e}h=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=g.payload,f=typeof v=="function"?v.call(p,h,f):v,f==null)break e;h=Ge({},h,f);break e;case 2:Ir=!0}}a.callback!==null&&a.lane!==0&&(n.flags|=64,f=i.effects,f===null?i.effects=[a]:f.push(a))}else p={eventTime:p,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(u=d=p,c=h):d=d.next=p,o|=f;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;f=a,a=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(!0);if(d===null&&(c=h),i.baseState=c,i.firstBaseUpdate=u,i.lastBaseUpdate=d,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else r===null&&(i.shared.lanes=0);hl|=o,n.lanes=o,n.memoizedState=h}}function qb(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var s=n[e],i=s.callback;if(i!==null){if(s.callback=null,s=t,typeof i!="function")throw Error(N(191,i));i.call(s)}}}var Pf={},Ei=Ho(Pf),Od=Ho(Pf),Fd=Ho(Pf);function ea(n){if(n===Pf)throw Error(N(174));return n}function pw(n,e){switch(Le(Fd,e),Le(Od,n),Le(Ei,Pf),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Oy(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=Oy(e,n)}Ie(Ei),Le(Ei,e)}function pu(){Ie(Ei),Ie(Od),Ie(Fd)}function Mx(n){ea(Fd.current);var e=ea(Ei.current),t=Oy(e,n.type);e!==t&&(Le(Od,n),Le(Ei,t))}function gw(n){Od.current===n&&(Ie(Ei),Ie(Od))}var Ue=Ho(0);function wg(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var ry=[];function mw(){for(var n=0;n<ry.length;n++)ry[n]._workInProgressVersionPrimary=null;ry.length=0}var bp=kr.ReactCurrentDispatcher,oy=kr.ReactCurrentBatchConfig,dl=0,Ve=null,ut=null,At=null,bg=!1,yd=!1,jd=0,CT=0;function zt(){throw Error(N(321))}function yw(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!Gs(n[t],e[t]))return!1;return!0}function vw(n,e,t,s,i,r){if(dl=r,Ve=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,bp.current=n===null||n.memoizedState===null?RT:LT,n=t(s,i),yd){r=0;do{if(yd=!1,jd=0,25<=r)throw Error(N(301));r+=1,At=ut=null,e.updateQueue=null,bp.current=MT,n=t(s,i)}while(yd)}if(bp.current=Ag,e=ut!==null&&ut.next!==null,dl=0,At=ut=Ve=null,bg=!1,e)throw Error(N(300));return n}function ww(){var n=jd!==0;return jd=0,n}function si(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return At===null?Ve.memoizedState=At=n:At=At.next=n,At}function bs(){if(ut===null){var n=Ve.alternate;n=n!==null?n.memoizedState:null}else n=ut.next;var e=At===null?Ve.memoizedState:At.next;if(e!==null)At=e,ut=n;else{if(n===null)throw Error(N(310));ut=n,n={memoizedState:ut.memoizedState,baseState:ut.baseState,baseQueue:ut.baseQueue,queue:ut.queue,next:null},At===null?Ve.memoizedState=At=n:At=At.next=n}return At}function zd(n,e){return typeof e=="function"?e(n):e}function ay(n){var e=bs(),t=e.queue;if(t===null)throw Error(N(311));t.lastRenderedReducer=n;var s=ut,i=s.baseQueue,r=t.pending;if(r!==null){if(i!==null){var o=i.next;i.next=r.next,r.next=o}s.baseQueue=i=r,t.pending=null}if(i!==null){r=i.next,s=s.baseState;var a=o=null,c=null,u=r;do{var d=u.lane;if((dl&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),s=u.hasEagerState?u.eagerState:n(s,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(a=c=h,o=s):c=c.next=h,Ve.lanes|=d,hl|=d}u=u.next}while(u!==null&&u!==r);c===null?o=s:c.next=a,Gs(s,e.memoizedState)||(wn=!0),e.memoizedState=s,e.baseState=o,e.baseQueue=c,t.lastRenderedState=s}if(n=t.interleaved,n!==null){i=n;do r=i.lane,Ve.lanes|=r,hl|=r,i=i.next;while(i!==n)}else i===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function ly(n){var e=bs(),t=e.queue;if(t===null)throw Error(N(311));t.lastRenderedReducer=n;var s=t.dispatch,i=t.pending,r=e.memoizedState;if(i!==null){t.pending=null;var o=i=i.next;do r=n(r,o.action),o=o.next;while(o!==i);Gs(r,e.memoizedState)||(wn=!0),e.memoizedState=r,e.baseQueue===null&&(e.baseState=r),t.lastRenderedState=r}return[r,s]}function Dx(){}function Nx(n,e){var t=Ve,s=bs(),i=e(),r=!Gs(s.memoizedState,i);if(r&&(s.memoizedState=i,wn=!0),s=s.queue,bw(Fx.bind(null,t,s,n),[n]),s.getSnapshot!==e||r||At!==null&&At.memoizedState.tag&1){if(t.flags|=2048,Bd(9,Ox.bind(null,t,s,i,e),void 0,null),xt===null)throw Error(N(349));dl&30||Ix(t,e,i)}return i}function Ix(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=Ve.updateQueue,e===null?(e={lastEffect:null,stores:null},Ve.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function Ox(n,e,t,s){e.value=t,e.getSnapshot=s,jx(e)&&zx(n)}function Fx(n,e,t){return t(function(){jx(e)&&zx(n)})}function jx(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!Gs(n,t)}catch{return!0}}function zx(n){var e=Sr(n,1);e!==null&&Vs(e,n,1,-1)}function Kb(n){var e=si();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:zd,lastRenderedState:n},e.queue=n,n=n.dispatch=PT.bind(null,Ve,n),[e.memoizedState,n]}function Bd(n,e,t,s){return n={tag:n,create:e,destroy:t,deps:s,next:null},e=Ve.updateQueue,e===null?(e={lastEffect:null,stores:null},Ve.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(s=t.next,t.next=n,n.next=s,e.lastEffect=n)),n}function Bx(){return bs().memoizedState}function Ap(n,e,t,s){var i=si();Ve.flags|=n,i.memoizedState=Bd(1|e,t,void 0,s===void 0?null:s)}function hm(n,e,t,s){var i=bs();s=s===void 0?null:s;var r=void 0;if(ut!==null){var o=ut.memoizedState;if(r=o.destroy,s!==null&&yw(s,o.deps)){i.memoizedState=Bd(e,t,r,s);return}}Ve.flags|=n,i.memoizedState=Bd(1|e,t,r,s)}function Qb(n,e){return Ap(8390656,8,n,e)}function bw(n,e){return hm(2048,8,n,e)}function $x(n,e){return hm(4,2,n,e)}function Hx(n,e){return hm(4,4,n,e)}function Ux(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function Vx(n,e,t){return t=t!=null?t.concat([n]):null,hm(4,4,Ux.bind(null,e,n),t)}function Aw(){}function Gx(n,e){var t=bs();e=e===void 0?null:e;var s=t.memoizedState;return s!==null&&e!==null&&yw(e,s[1])?s[0]:(t.memoizedState=[n,e],n)}function Wx(n,e){var t=bs();e=e===void 0?null:e;var s=t.memoizedState;return s!==null&&e!==null&&yw(e,s[1])?s[0]:(n=n(),t.memoizedState=[n,e],n)}function Xx(n,e,t){return dl&21?(Gs(t,e)||(t=JS(),Ve.lanes|=t,hl|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,wn=!0),n.memoizedState=t)}function kT(n,e){var t=Ae;Ae=t!==0&&4>t?t:4,n(!0);var s=oy.transition;oy.transition={};try{n(!1),e()}finally{Ae=t,oy.transition=s}}function Yx(){return bs().memoizedState}function TT(n,e,t){var s=Lo(n);if(t={lane:s,action:t,hasEagerState:!1,eagerState:null,next:null},qx(n))Kx(e,t);else if(t=Rx(n,e,t,s),t!==null){var i=an();Vs(t,n,s,i),Qx(t,e,s)}}function PT(n,e,t){var s=Lo(n),i={lane:s,action:t,hasEagerState:!1,eagerState:null,next:null};if(qx(n))Kx(e,i);else{var r=n.alternate;if(n.lanes===0&&(r===null||r.lanes===0)&&(r=e.lastRenderedReducer,r!==null))try{var o=e.lastRenderedState,a=r(o,t);if(i.hasEagerState=!0,i.eagerState=a,Gs(a,o)){var c=e.interleaved;c===null?(i.next=i,hw(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}t=Rx(n,e,i,s),t!==null&&(i=an(),Vs(t,n,s,i),Qx(t,e,s))}}function qx(n){var e=n.alternate;return n===Ve||e!==null&&e===Ve}function Kx(n,e){yd=bg=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function Qx(n,e,t){if(t&4194240){var s=e.lanes;s&=n.pendingLanes,t|=s,e.lanes=t,J0(n,t)}}var Ag={readContext:ws,useCallback:zt,useContext:zt,useEffect:zt,useImperativeHandle:zt,useInsertionEffect:zt,useLayoutEffect:zt,useMemo:zt,useReducer:zt,useRef:zt,useState:zt,useDebugValue:zt,useDeferredValue:zt,useTransition:zt,useMutableSource:zt,useSyncExternalStore:zt,useId:zt,unstable_isNewReconciler:!1},RT={readContext:ws,useCallback:function(n,e){return si().memoizedState=[n,e===void 0?null:e],n},useContext:ws,useEffect:Qb,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,Ap(4194308,4,Ux.bind(null,e,n),t)},useLayoutEffect:function(n,e){return Ap(4194308,4,n,e)},useInsertionEffect:function(n,e){return Ap(4,2,n,e)},useMemo:function(n,e){var t=si();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var s=si();return e=t!==void 0?t(e):e,s.memoizedState=s.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},s.queue=n,n=n.dispatch=TT.bind(null,Ve,n),[s.memoizedState,n]},useRef:function(n){var e=si();return n={current:n},e.memoizedState=n},useState:Kb,useDebugValue:Aw,useDeferredValue:function(n){return si().memoizedState=n},useTransition:function(){var n=Kb(!1),e=n[0];return n=kT.bind(null,n[1]),si().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var s=Ve,i=si();if(ze){if(t===void 0)throw Error(N(407));t=t()}else{if(t=e(),xt===null)throw Error(N(349));dl&30||Ix(s,e,t)}i.memoizedState=t;var r={value:t,getSnapshot:e};return i.queue=r,Qb(Fx.bind(null,s,r,n),[n]),s.flags|=2048,Bd(9,Ox.bind(null,s,r,t,e),void 0,null),t},useId:function(){var n=si(),e=xt.identifierPrefix;if(ze){var t=mr,s=gr;t=(s&~(1<<32-Us(s)-1)).toString(32)+t,e=":"+e+"R"+t,t=jd++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=CT++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},LT={readContext:ws,useCallback:Gx,useContext:ws,useEffect:bw,useImperativeHandle:Vx,useInsertionEffect:$x,useLayoutEffect:Hx,useMemo:Wx,useReducer:ay,useRef:Bx,useState:function(){return ay(zd)},useDebugValue:Aw,useDeferredValue:function(n){var e=bs();return Xx(e,ut.memoizedState,n)},useTransition:function(){var n=ay(zd)[0],e=bs().memoizedState;return[n,e]},useMutableSource:Dx,useSyncExternalStore:Nx,useId:Yx,unstable_isNewReconciler:!1},MT={readContext:ws,useCallback:Gx,useContext:ws,useEffect:bw,useImperativeHandle:Vx,useInsertionEffect:$x,useLayoutEffect:Hx,useMemo:Wx,useReducer:ly,useRef:Bx,useState:function(){return ly(zd)},useDebugValue:Aw,useDeferredValue:function(n){var e=bs();return ut===null?e.memoizedState=n:Xx(e,ut.memoizedState,n)},useTransition:function(){var n=ly(zd)[0],e=bs().memoizedState;return[n,e]},useMutableSource:Dx,useSyncExternalStore:Nx,useId:Yx,unstable_isNewReconciler:!1};function Cs(n,e){if(n&&n.defaultProps){e=Ge({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function sv(n,e,t,s){e=n.memoizedState,t=t(s,e),t=t==null?e:Ge({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var fm={isMounted:function(n){return(n=n._reactInternals)?yl(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var s=an(),i=Lo(n),r=yr(s,i);r.payload=e,t!=null&&(r.callback=t),e=Po(n,r,i),e!==null&&(Vs(e,n,i,s),wp(e,n,i))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var s=an(),i=Lo(n),r=yr(s,i);r.tag=1,r.payload=e,t!=null&&(r.callback=t),e=Po(n,r,i),e!==null&&(Vs(e,n,i,s),wp(e,n,i))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=an(),s=Lo(n),i=yr(t,s);i.tag=2,e!=null&&(i.callback=e),e=Po(n,i,s),e!==null&&(Vs(e,n,s,t),wp(e,n,s))}};function Jb(n,e,t,s,i,r,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(s,r,o):e.prototype&&e.prototype.isPureReactComponent?!Md(t,s)||!Md(i,r):!0}function Jx(n,e,t){var s=!1,i=No,r=e.contextType;return typeof r=="object"&&r!==null?r=ws(r):(i=An(e)?cl:Kt.current,s=e.contextTypes,r=(s=s!=null)?du(n,i):No),e=new e(t,r),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=fm,n.stateNode=e,e._reactInternals=n,s&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=i,n.__reactInternalMemoizedMaskedChildContext=r),e}function Zb(n,e,t,s){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,s),e.state!==n&&fm.enqueueReplaceState(e,e.state,null)}function iv(n,e,t,s){var i=n.stateNode;i.props=t,i.state=n.memoizedState,i.refs={},fw(n);var r=e.contextType;typeof r=="object"&&r!==null?i.context=ws(r):(r=An(e)?cl:Kt.current,i.context=du(n,r)),i.state=n.memoizedState,r=e.getDerivedStateFromProps,typeof r=="function"&&(sv(n,e,r,t),i.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&fm.enqueueReplaceState(i,i.state,null),vg(n,t,i,s),i.state=n.memoizedState),typeof i.componentDidMount=="function"&&(n.flags|=4194308)}function gu(n,e){try{var t="",s=e;do t+=ok(s),s=s.return;while(s);var i=t}catch(r){i=`
Error generating stack: `+r.message+`
`+r.stack}return{value:n,source:e,stack:i,digest:null}}function cy(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function rv(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var DT=typeof WeakMap=="function"?WeakMap:Map;function Zx(n,e,t){t=yr(-1,t),t.tag=3,t.payload={element:null};var s=e.value;return t.callback=function(){xg||(xg=!0,gv=s),rv(n,e)},t}function eE(n,e,t){t=yr(-1,t),t.tag=3;var s=n.type.getDerivedStateFromError;if(typeof s=="function"){var i=e.value;t.payload=function(){return s(i)},t.callback=function(){rv(n,e)}}var r=n.stateNode;return r!==null&&typeof r.componentDidCatch=="function"&&(t.callback=function(){rv(n,e),typeof s!="function"&&(Ro===null?Ro=new Set([this]):Ro.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function eA(n,e,t){var s=n.pingCache;if(s===null){s=n.pingCache=new DT;var i=new Set;s.set(e,i)}else i=s.get(e),i===void 0&&(i=new Set,s.set(e,i));i.has(t)||(i.add(t),n=XT.bind(null,n,e,t),e.then(n,n))}function tA(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function nA(n,e,t,s,i){return n.mode&1?(n.flags|=65536,n.lanes=i,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=yr(-1,1),e.tag=2,Po(t,e,1))),t.lanes|=1),n)}var NT=kr.ReactCurrentOwner,wn=!1;function rn(n,e,t,s){e.child=n===null?Px(e,null,t,s):fu(e,n.child,t,s)}function sA(n,e,t,s,i){t=t.render;var r=e.ref;return Ql(e,i),s=vw(n,e,t,s,r,i),t=ww(),n!==null&&!wn?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,xr(n,e,i)):(ze&&t&&ow(e),e.flags|=1,rn(n,e,s,i),e.child)}function iA(n,e,t,s,i){if(n===null){var r=t.type;return typeof r=="function"&&!Pw(r)&&r.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=r,tE(n,e,r,s,i)):(n=_p(t.type,null,s,e,e.mode,i),n.ref=e.ref,n.return=e,e.child=n)}if(r=n.child,!(n.lanes&i)){var o=r.memoizedProps;if(t=t.compare,t=t!==null?t:Md,t(o,s)&&n.ref===e.ref)return xr(n,e,i)}return e.flags|=1,n=Mo(r,s),n.ref=e.ref,n.return=e,e.child=n}function tE(n,e,t,s,i){if(n!==null){var r=n.memoizedProps;if(Md(r,s)&&n.ref===e.ref)if(wn=!1,e.pendingProps=s=r,(n.lanes&i)!==0)n.flags&131072&&(wn=!0);else return e.lanes=n.lanes,xr(n,e,i)}return ov(n,e,t,s,i)}function nE(n,e,t){var s=e.pendingProps,i=s.children,r=n!==null?n.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Le(Hl,Wn),Wn|=t;else{if(!(t&1073741824))return n=r!==null?r.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,Le(Hl,Wn),Wn|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=r!==null?r.baseLanes:t,Le(Hl,Wn),Wn|=s}else r!==null?(s=r.baseLanes|t,e.memoizedState=null):s=t,Le(Hl,Wn),Wn|=s;return rn(n,e,i,t),e.child}function sE(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function ov(n,e,t,s,i){var r=An(t)?cl:Kt.current;return r=du(e,r),Ql(e,i),t=vw(n,e,t,s,r,i),s=ww(),n!==null&&!wn?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,xr(n,e,i)):(ze&&s&&ow(e),e.flags|=1,rn(n,e,t,i),e.child)}function rA(n,e,t,s,i){if(An(t)){var r=!0;fg(e)}else r=!1;if(Ql(e,i),e.stateNode===null)Sp(n,e),Jx(e,t,s),iv(e,t,s,i),s=!0;else if(n===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var c=o.context,u=t.contextType;typeof u=="object"&&u!==null?u=ws(u):(u=An(t)?cl:Kt.current,u=du(e,u));var d=t.getDerivedStateFromProps,h=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==s||c!==u)&&Zb(e,o,s,u),Ir=!1;var f=e.memoizedState;o.state=f,vg(e,s,o,i),c=e.memoizedState,a!==s||f!==c||bn.current||Ir?(typeof d=="function"&&(sv(e,t,d,s),c=e.memoizedState),(a=Ir||Jb(e,t,a,s,f,c,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=c),o.props=s,o.state=c,o.context=u,s=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{o=e.stateNode,Lx(n,e),a=e.memoizedProps,u=e.type===e.elementType?a:Cs(e.type,a),o.props=u,h=e.pendingProps,f=o.context,c=t.contextType,typeof c=="object"&&c!==null?c=ws(c):(c=An(t)?cl:Kt.current,c=du(e,c));var p=t.getDerivedStateFromProps;(d=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||f!==c)&&Zb(e,o,s,c),Ir=!1,f=e.memoizedState,o.state=f,vg(e,s,o,i);var v=e.memoizedState;a!==h||f!==v||bn.current||Ir?(typeof p=="function"&&(sv(e,t,p,s),v=e.memoizedState),(u=Ir||Jb(e,t,u,s,f,v,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(s,v,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(s,v,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&f===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&f===n.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=v),o.props=s,o.state=v,o.context=c,s=u):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&f===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&f===n.memoizedState||(e.flags|=1024),s=!1)}return av(n,e,t,s,r,i)}function av(n,e,t,s,i,r){sE(n,e);var o=(e.flags&128)!==0;if(!s&&!o)return i&&Vb(e,t,!1),xr(n,e,r);s=e.stateNode,NT.current=e;var a=o&&typeof t.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,n!==null&&o?(e.child=fu(e,n.child,null,r),e.child=fu(e,null,a,r)):rn(n,e,a,r),e.memoizedState=s.state,i&&Vb(e,t,!0),e.child}function iE(n){var e=n.stateNode;e.pendingContext?Ub(n,e.pendingContext,e.pendingContext!==e.context):e.context&&Ub(n,e.context,!1),pw(n,e.containerInfo)}function oA(n,e,t,s,i){return hu(),lw(i),e.flags|=256,rn(n,e,t,s),e.child}var lv={dehydrated:null,treeContext:null,retryLane:0};function cv(n){return{baseLanes:n,cachePool:null,transitions:null}}function rE(n,e,t){var s=e.pendingProps,i=Ue.current,r=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=n!==null&&n.memoizedState===null?!1:(i&2)!==0),a?(r=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(i|=1),Le(Ue,i&1),n===null)return tv(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=s.children,n=s.fallback,r?(s=e.mode,r=e.child,o={mode:"hidden",children:o},!(s&1)&&r!==null?(r.childLanes=0,r.pendingProps=o):r=mm(o,s,0,null),n=ll(n,s,t,null),r.return=e,n.return=e,r.sibling=n,e.child=r,e.child.memoizedState=cv(t),e.memoizedState=lv,n):Sw(e,o));if(i=n.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return IT(n,e,o,s,a,i,t);if(r){r=s.fallback,o=e.mode,i=n.child,a=i.sibling;var c={mode:"hidden",children:s.children};return!(o&1)&&e.child!==i?(s=e.child,s.childLanes=0,s.pendingProps=c,e.deletions=null):(s=Mo(i,c),s.subtreeFlags=i.subtreeFlags&14680064),a!==null?r=Mo(a,r):(r=ll(r,o,t,null),r.flags|=2),r.return=e,s.return=e,s.sibling=r,e.child=s,s=r,r=e.child,o=n.child.memoizedState,o=o===null?cv(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},r.memoizedState=o,r.childLanes=n.childLanes&~t,e.memoizedState=lv,s}return r=n.child,n=r.sibling,s=Mo(r,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=t),s.return=e,s.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=s,e.memoizedState=null,s}function Sw(n,e){return e=mm({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function sp(n,e,t,s){return s!==null&&lw(s),fu(e,n.child,null,t),n=Sw(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function IT(n,e,t,s,i,r,o){if(t)return e.flags&256?(e.flags&=-257,s=cy(Error(N(422))),sp(n,e,o,s)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(r=s.fallback,i=e.mode,s=mm({mode:"visible",children:s.children},i,0,null),r=ll(r,i,o,null),r.flags|=2,s.return=e,r.return=e,s.sibling=r,e.child=s,e.mode&1&&fu(e,n.child,null,o),e.child.memoizedState=cv(o),e.memoizedState=lv,r);if(!(e.mode&1))return sp(n,e,o,null);if(i.data==="$!"){if(s=i.nextSibling&&i.nextSibling.dataset,s)var a=s.dgst;return s=a,r=Error(N(419)),s=cy(r,s,void 0),sp(n,e,o,s)}if(a=(o&n.childLanes)!==0,wn||a){if(s=xt,s!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(s.suspendedLanes|o)?0:i,i!==0&&i!==r.retryLane&&(r.retryLane=i,Sr(n,i),Vs(s,n,i,-1))}return Tw(),s=cy(Error(N(421))),sp(n,e,o,s)}return i.data==="$?"?(e.flags|=128,e.child=n.child,e=YT.bind(null,n),i._reactRetry=e,null):(n=r.treeContext,qn=To(i.nextSibling),Kn=e,ze=!0,$s=null,n!==null&&(hs[fs++]=gr,hs[fs++]=mr,hs[fs++]=ul,gr=n.id,mr=n.overflow,ul=e),e=Sw(e,s.children),e.flags|=4096,e)}function aA(n,e,t){n.lanes|=e;var s=n.alternate;s!==null&&(s.lanes|=e),nv(n.return,e,t)}function uy(n,e,t,s,i){var r=n.memoizedState;r===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:t,tailMode:i}:(r.isBackwards=e,r.rendering=null,r.renderingStartTime=0,r.last=s,r.tail=t,r.tailMode=i)}function oE(n,e,t){var s=e.pendingProps,i=s.revealOrder,r=s.tail;if(rn(n,e,s.children,t),s=Ue.current,s&2)s=s&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&aA(n,t,e);else if(n.tag===19)aA(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}s&=1}if(Le(Ue,s),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(t=e.child,i=null;t!==null;)n=t.alternate,n!==null&&wg(n)===null&&(i=t),t=t.sibling;t=i,t===null?(i=e.child,e.child=null):(i=t.sibling,t.sibling=null),uy(e,!1,i,t,r);break;case"backwards":for(t=null,i=e.child,e.child=null;i!==null;){if(n=i.alternate,n!==null&&wg(n)===null){e.child=i;break}n=i.sibling,i.sibling=t,t=i,i=n}uy(e,!0,t,null,r);break;case"together":uy(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Sp(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function xr(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),hl|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(N(153));if(e.child!==null){for(n=e.child,t=Mo(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=Mo(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function OT(n,e,t){switch(e.tag){case 3:iE(e),hu();break;case 5:Mx(e);break;case 1:An(e.type)&&fg(e);break;case 4:pw(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,i=e.memoizedProps.value;Le(mg,s._currentValue),s._currentValue=i;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(Le(Ue,Ue.current&1),e.flags|=128,null):t&e.child.childLanes?rE(n,e,t):(Le(Ue,Ue.current&1),n=xr(n,e,t),n!==null?n.sibling:null);Le(Ue,Ue.current&1);break;case 19:if(s=(t&e.childLanes)!==0,n.flags&128){if(s)return oE(n,e,t);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Le(Ue,Ue.current),s)break;return null;case 22:case 23:return e.lanes=0,nE(n,e,t)}return xr(n,e,t)}var aE,uv,lE,cE;aE=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};uv=function(){};lE=function(n,e,t,s){var i=n.memoizedProps;if(i!==s){n=e.stateNode,ea(Ei.current);var r=null;switch(t){case"input":i=My(n,i),s=My(n,s),r=[];break;case"select":i=Ge({},i,{value:void 0}),s=Ge({},s,{value:void 0}),r=[];break;case"textarea":i=Iy(n,i),s=Iy(n,s),r=[];break;default:typeof i.onClick!="function"&&typeof s.onClick=="function"&&(n.onclick=dg)}Fy(t,s);var o;t=null;for(u in i)if(!s.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(o in a)a.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(_d.hasOwnProperty(u)?r||(r=[]):(r=r||[]).push(u,null));for(u in s){var c=s[u];if(a=i!=null?i[u]:void 0,s.hasOwnProperty(u)&&c!==a&&(c!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in c)c.hasOwnProperty(o)&&a[o]!==c[o]&&(t||(t={}),t[o]=c[o])}else t||(r||(r=[]),r.push(u,t)),t=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(r=r||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(r=r||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(_d.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&De("scroll",n),r||a===c||(r=[])):(r=r||[]).push(u,c))}t&&(r=r||[]).push("style",t);var u=r;(e.updateQueue=u)&&(e.flags|=4)}};cE=function(n,e,t,s){t!==s&&(e.flags|=4)};function Ou(n,e){if(!ze)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var s=null;t!==null;)t.alternate!==null&&(s=t),t=t.sibling;s===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:s.sibling=null}}function Bt(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,s=0;if(e)for(var i=n.child;i!==null;)t|=i.lanes|i.childLanes,s|=i.subtreeFlags&14680064,s|=i.flags&14680064,i.return=n,i=i.sibling;else for(i=n.child;i!==null;)t|=i.lanes|i.childLanes,s|=i.subtreeFlags,s|=i.flags,i.return=n,i=i.sibling;return n.subtreeFlags|=s,n.childLanes=t,e}function FT(n,e,t){var s=e.pendingProps;switch(aw(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Bt(e),null;case 1:return An(e.type)&&hg(),Bt(e),null;case 3:return s=e.stateNode,pu(),Ie(bn),Ie(Kt),mw(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(n===null||n.child===null)&&(tp(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,$s!==null&&(vv($s),$s=null))),uv(n,e),Bt(e),null;case 5:gw(e);var i=ea(Fd.current);if(t=e.type,n!==null&&e.stateNode!=null)lE(n,e,t,s,i),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(N(166));return Bt(e),null}if(n=ea(Ei.current),tp(e)){s=e.stateNode,t=e.type;var r=e.memoizedProps;switch(s[bi]=e,s[Id]=r,n=(e.mode&1)!==0,t){case"dialog":De("cancel",s),De("close",s);break;case"iframe":case"object":case"embed":De("load",s);break;case"video":case"audio":for(i=0;i<Wu.length;i++)De(Wu[i],s);break;case"source":De("error",s);break;case"img":case"image":case"link":De("error",s),De("load",s);break;case"details":De("toggle",s);break;case"input":mb(s,r),De("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!r.multiple},De("invalid",s);break;case"textarea":vb(s,r),De("invalid",s)}Fy(t,r),i=null;for(var o in r)if(r.hasOwnProperty(o)){var a=r[o];o==="children"?typeof a=="string"?s.textContent!==a&&(r.suppressHydrationWarning!==!0&&ep(s.textContent,a,n),i=["children",a]):typeof a=="number"&&s.textContent!==""+a&&(r.suppressHydrationWarning!==!0&&ep(s.textContent,a,n),i=["children",""+a]):_d.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&De("scroll",s)}switch(t){case"input":Wf(s),yb(s,r,!0);break;case"textarea":Wf(s),wb(s);break;case"select":case"option":break;default:typeof r.onClick=="function"&&(s.onclick=dg)}s=i,e.updateQueue=s,s!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=FS(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof s.is=="string"?n=o.createElement(t,{is:s.is}):(n=o.createElement(t),t==="select"&&(o=n,s.multiple?o.multiple=!0:s.size&&(o.size=s.size))):n=o.createElementNS(n,t),n[bi]=e,n[Id]=s,aE(n,e,!1,!1),e.stateNode=n;e:{switch(o=jy(t,s),t){case"dialog":De("cancel",n),De("close",n),i=s;break;case"iframe":case"object":case"embed":De("load",n),i=s;break;case"video":case"audio":for(i=0;i<Wu.length;i++)De(Wu[i],n);i=s;break;case"source":De("error",n),i=s;break;case"img":case"image":case"link":De("error",n),De("load",n),i=s;break;case"details":De("toggle",n),i=s;break;case"input":mb(n,s),i=My(n,s),De("invalid",n);break;case"option":i=s;break;case"select":n._wrapperState={wasMultiple:!!s.multiple},i=Ge({},s,{value:void 0}),De("invalid",n);break;case"textarea":vb(n,s),i=Iy(n,s),De("invalid",n);break;default:i=s}Fy(t,i),a=i;for(r in a)if(a.hasOwnProperty(r)){var c=a[r];r==="style"?BS(n,c):r==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&jS(n,c)):r==="children"?typeof c=="string"?(t!=="textarea"||c!=="")&&Cd(n,c):typeof c=="number"&&Cd(n,""+c):r!=="suppressContentEditableWarning"&&r!=="suppressHydrationWarning"&&r!=="autoFocus"&&(_d.hasOwnProperty(r)?c!=null&&r==="onScroll"&&De("scroll",n):c!=null&&W0(n,r,c,o))}switch(t){case"input":Wf(n),yb(n,s,!1);break;case"textarea":Wf(n),wb(n);break;case"option":s.value!=null&&n.setAttribute("value",""+Do(s.value));break;case"select":n.multiple=!!s.multiple,r=s.value,r!=null?Xl(n,!!s.multiple,r,!1):s.defaultValue!=null&&Xl(n,!!s.multiple,s.defaultValue,!0);break;default:typeof i.onClick=="function"&&(n.onclick=dg)}switch(t){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Bt(e),null;case 6:if(n&&e.stateNode!=null)cE(n,e,n.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(N(166));if(t=ea(Fd.current),ea(Ei.current),tp(e)){if(s=e.stateNode,t=e.memoizedProps,s[bi]=e,(r=s.nodeValue!==t)&&(n=Kn,n!==null))switch(n.tag){case 3:ep(s.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&ep(s.nodeValue,t,(n.mode&1)!==0)}r&&(e.flags|=4)}else s=(t.nodeType===9?t:t.ownerDocument).createTextNode(s),s[bi]=e,e.stateNode=s}return Bt(e),null;case 13:if(Ie(Ue),s=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(ze&&qn!==null&&e.mode&1&&!(e.flags&128))kx(),hu(),e.flags|=98560,r=!1;else if(r=tp(e),s!==null&&s.dehydrated!==null){if(n===null){if(!r)throw Error(N(318));if(r=e.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(N(317));r[bi]=e}else hu(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Bt(e),r=!1}else $s!==null&&(vv($s),$s=null),r=!0;if(!r)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(s=s!==null,s!==(n!==null&&n.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(n===null||Ue.current&1?ht===0&&(ht=3):Tw())),e.updateQueue!==null&&(e.flags|=4),Bt(e),null);case 4:return pu(),uv(n,e),n===null&&Dd(e.stateNode.containerInfo),Bt(e),null;case 10:return dw(e.type._context),Bt(e),null;case 17:return An(e.type)&&hg(),Bt(e),null;case 19:if(Ie(Ue),r=e.memoizedState,r===null)return Bt(e),null;if(s=(e.flags&128)!==0,o=r.rendering,o===null)if(s)Ou(r,!1);else{if(ht!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(o=wg(n),o!==null){for(e.flags|=128,Ou(r,!1),s=o.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=t,t=e.child;t!==null;)r=t,n=s,r.flags&=14680066,o=r.alternate,o===null?(r.childLanes=0,r.lanes=n,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=o.childLanes,r.lanes=o.lanes,r.child=o.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=o.memoizedProps,r.memoizedState=o.memoizedState,r.updateQueue=o.updateQueue,r.type=o.type,n=o.dependencies,r.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return Le(Ue,Ue.current&1|2),e.child}n=n.sibling}r.tail!==null&&tt()>mu&&(e.flags|=128,s=!0,Ou(r,!1),e.lanes=4194304)}else{if(!s)if(n=wg(o),n!==null){if(e.flags|=128,s=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),Ou(r,!0),r.tail===null&&r.tailMode==="hidden"&&!o.alternate&&!ze)return Bt(e),null}else 2*tt()-r.renderingStartTime>mu&&t!==1073741824&&(e.flags|=128,s=!0,Ou(r,!1),e.lanes=4194304);r.isBackwards?(o.sibling=e.child,e.child=o):(t=r.last,t!==null?t.sibling=o:e.child=o,r.last=o)}return r.tail!==null?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=tt(),e.sibling=null,t=Ue.current,Le(Ue,s?t&1|2:t&1),e):(Bt(e),null);case 22:case 23:return kw(),s=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?Wn&1073741824&&(Bt(e),e.subtreeFlags&6&&(e.flags|=8192)):Bt(e),null;case 24:return null;case 25:return null}throw Error(N(156,e.tag))}function jT(n,e){switch(aw(e),e.tag){case 1:return An(e.type)&&hg(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return pu(),Ie(bn),Ie(Kt),mw(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return gw(e),null;case 13:if(Ie(Ue),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(N(340));hu()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return Ie(Ue),null;case 4:return pu(),null;case 10:return dw(e.type._context),null;case 22:case 23:return kw(),null;case 24:return null;default:return null}}var ip=!1,Yt=!1,zT=typeof WeakSet=="function"?WeakSet:Set,U=null;function $l(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(s){qe(n,e,s)}else t.current=null}function dv(n,e,t){try{t()}catch(s){qe(n,e,s)}}var lA=!1;function BT(n,e){if(Yy=lg,n=px(),rw(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var s=t.getSelection&&t.getSelection();if(s&&s.rangeCount!==0){t=s.anchorNode;var i=s.anchorOffset,r=s.focusNode;s=s.focusOffset;try{t.nodeType,r.nodeType}catch{t=null;break e}var o=0,a=-1,c=-1,u=0,d=0,h=n,f=null;t:for(;;){for(var p;h!==t||i!==0&&h.nodeType!==3||(a=o+i),h!==r||s!==0&&h.nodeType!==3||(c=o+s),h.nodeType===3&&(o+=h.nodeValue.length),(p=h.firstChild)!==null;)f=h,h=p;for(;;){if(h===n)break t;if(f===t&&++u===i&&(a=o),f===r&&++d===s&&(c=o),(p=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=p}t=a===-1||c===-1?null:{start:a,end:c}}else t=null}t=t||{start:0,end:0}}else t=null;for(qy={focusedElem:n,selectionRange:t},lg=!1,U=e;U!==null;)if(e=U,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,U=n;else for(;U!==null;){e=U;try{var v=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var g=v.memoizedProps,x=v.memoizedState,y=e.stateNode,w=y.getSnapshotBeforeUpdate(e.elementType===e.type?g:Cs(e.type,g),x);y.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(N(163))}}catch(E){qe(e,e.return,E)}if(n=e.sibling,n!==null){n.return=e.return,U=n;break}U=e.return}return v=lA,lA=!1,v}function vd(n,e,t){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var i=s=s.next;do{if((i.tag&n)===n){var r=i.destroy;i.destroy=void 0,r!==void 0&&dv(e,t,r)}i=i.next}while(i!==s)}}function pm(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var s=t.create;t.destroy=s()}t=t.next}while(t!==e)}}function hv(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function uE(n){var e=n.alternate;e!==null&&(n.alternate=null,uE(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[bi],delete e[Id],delete e[Jy],delete e[ST],delete e[xT])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function dE(n){return n.tag===5||n.tag===3||n.tag===4}function cA(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||dE(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function fv(n,e,t){var s=n.tag;if(s===5||s===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=dg));else if(s!==4&&(n=n.child,n!==null))for(fv(n,e,t),n=n.sibling;n!==null;)fv(n,e,t),n=n.sibling}function pv(n,e,t){var s=n.tag;if(s===5||s===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(s!==4&&(n=n.child,n!==null))for(pv(n,e,t),n=n.sibling;n!==null;)pv(n,e,t),n=n.sibling}var Mt=null,Bs=!1;function Mr(n,e,t){for(t=t.child;t!==null;)hE(n,e,t),t=t.sibling}function hE(n,e,t){if(xi&&typeof xi.onCommitFiberUnmount=="function")try{xi.onCommitFiberUnmount(om,t)}catch{}switch(t.tag){case 5:Yt||$l(t,e);case 6:var s=Mt,i=Bs;Mt=null,Mr(n,e,t),Mt=s,Bs=i,Mt!==null&&(Bs?(n=Mt,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):Mt.removeChild(t.stateNode));break;case 18:Mt!==null&&(Bs?(n=Mt,t=t.stateNode,n.nodeType===8?sy(n.parentNode,t):n.nodeType===1&&sy(n,t),Rd(n)):sy(Mt,t.stateNode));break;case 4:s=Mt,i=Bs,Mt=t.stateNode.containerInfo,Bs=!0,Mr(n,e,t),Mt=s,Bs=i;break;case 0:case 11:case 14:case 15:if(!Yt&&(s=t.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){i=s=s.next;do{var r=i,o=r.destroy;r=r.tag,o!==void 0&&(r&2||r&4)&&dv(t,e,o),i=i.next}while(i!==s)}Mr(n,e,t);break;case 1:if(!Yt&&($l(t,e),s=t.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=t.memoizedProps,s.state=t.memoizedState,s.componentWillUnmount()}catch(a){qe(t,e,a)}Mr(n,e,t);break;case 21:Mr(n,e,t);break;case 22:t.mode&1?(Yt=(s=Yt)||t.memoizedState!==null,Mr(n,e,t),Yt=s):Mr(n,e,t);break;default:Mr(n,e,t)}}function uA(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new zT),e.forEach(function(s){var i=qT.bind(null,n,s);t.has(s)||(t.add(s),s.then(i,i))})}}function Es(n,e){var t=e.deletions;if(t!==null)for(var s=0;s<t.length;s++){var i=t[s];try{var r=n,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Mt=a.stateNode,Bs=!1;break e;case 3:Mt=a.stateNode.containerInfo,Bs=!0;break e;case 4:Mt=a.stateNode.containerInfo,Bs=!0;break e}a=a.return}if(Mt===null)throw Error(N(160));hE(r,o,i),Mt=null,Bs=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(u){qe(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)fE(e,n),e=e.sibling}function fE(n,e){var t=n.alternate,s=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Es(e,n),Zs(n),s&4){try{vd(3,n,n.return),pm(3,n)}catch(g){qe(n,n.return,g)}try{vd(5,n,n.return)}catch(g){qe(n,n.return,g)}}break;case 1:Es(e,n),Zs(n),s&512&&t!==null&&$l(t,t.return);break;case 5:if(Es(e,n),Zs(n),s&512&&t!==null&&$l(t,t.return),n.flags&32){var i=n.stateNode;try{Cd(i,"")}catch(g){qe(n,n.return,g)}}if(s&4&&(i=n.stateNode,i!=null)){var r=n.memoizedProps,o=t!==null?t.memoizedProps:r,a=n.type,c=n.updateQueue;if(n.updateQueue=null,c!==null)try{a==="input"&&r.type==="radio"&&r.name!=null&&IS(i,r),jy(a,o);var u=jy(a,r);for(o=0;o<c.length;o+=2){var d=c[o],h=c[o+1];d==="style"?BS(i,h):d==="dangerouslySetInnerHTML"?jS(i,h):d==="children"?Cd(i,h):W0(i,d,h,u)}switch(a){case"input":Dy(i,r);break;case"textarea":OS(i,r);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!r.multiple;var p=r.value;p!=null?Xl(i,!!r.multiple,p,!1):f!==!!r.multiple&&(r.defaultValue!=null?Xl(i,!!r.multiple,r.defaultValue,!0):Xl(i,!!r.multiple,r.multiple?[]:"",!1))}i[Id]=r}catch(g){qe(n,n.return,g)}}break;case 6:if(Es(e,n),Zs(n),s&4){if(n.stateNode===null)throw Error(N(162));i=n.stateNode,r=n.memoizedProps;try{i.nodeValue=r}catch(g){qe(n,n.return,g)}}break;case 3:if(Es(e,n),Zs(n),s&4&&t!==null&&t.memoizedState.isDehydrated)try{Rd(e.containerInfo)}catch(g){qe(n,n.return,g)}break;case 4:Es(e,n),Zs(n);break;case 13:Es(e,n),Zs(n),i=n.child,i.flags&8192&&(r=i.memoizedState!==null,i.stateNode.isHidden=r,!r||i.alternate!==null&&i.alternate.memoizedState!==null||(_w=tt())),s&4&&uA(n);break;case 22:if(d=t!==null&&t.memoizedState!==null,n.mode&1?(Yt=(u=Yt)||d,Es(e,n),Yt=u):Es(e,n),Zs(n),s&8192){if(u=n.memoizedState!==null,(n.stateNode.isHidden=u)&&!d&&n.mode&1)for(U=n,d=n.child;d!==null;){for(h=U=d;U!==null;){switch(f=U,p=f.child,f.tag){case 0:case 11:case 14:case 15:vd(4,f,f.return);break;case 1:$l(f,f.return);var v=f.stateNode;if(typeof v.componentWillUnmount=="function"){s=f,t=f.return;try{e=s,v.props=e.memoizedProps,v.state=e.memoizedState,v.componentWillUnmount()}catch(g){qe(s,t,g)}}break;case 5:$l(f,f.return);break;case 22:if(f.memoizedState!==null){hA(h);continue}}p!==null?(p.return=f,U=p):hA(h)}d=d.sibling}e:for(d=null,h=n;;){if(h.tag===5){if(d===null){d=h;try{i=h.stateNode,u?(r=i.style,typeof r.setProperty=="function"?r.setProperty("display","none","important"):r.display="none"):(a=h.stateNode,c=h.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=zS("display",o))}catch(g){qe(n,n.return,g)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(g){qe(n,n.return,g)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===n)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===n)break e;for(;h.sibling===null;){if(h.return===null||h.return===n)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Es(e,n),Zs(n),s&4&&uA(n);break;case 21:break;default:Es(e,n),Zs(n)}}function Zs(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(dE(t)){var s=t;break e}t=t.return}throw Error(N(160))}switch(s.tag){case 5:var i=s.stateNode;s.flags&32&&(Cd(i,""),s.flags&=-33);var r=cA(n);pv(n,r,i);break;case 3:case 4:var o=s.stateNode.containerInfo,a=cA(n);fv(n,a,o);break;default:throw Error(N(161))}}catch(c){qe(n,n.return,c)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function $T(n,e,t){U=n,pE(n)}function pE(n,e,t){for(var s=(n.mode&1)!==0;U!==null;){var i=U,r=i.child;if(i.tag===22&&s){var o=i.memoizedState!==null||ip;if(!o){var a=i.alternate,c=a!==null&&a.memoizedState!==null||Yt;a=ip;var u=Yt;if(ip=o,(Yt=c)&&!u)for(U=i;U!==null;)o=U,c=o.child,o.tag===22&&o.memoizedState!==null?fA(i):c!==null?(c.return=o,U=c):fA(i);for(;r!==null;)U=r,pE(r),r=r.sibling;U=i,ip=a,Yt=u}dA(n)}else i.subtreeFlags&8772&&r!==null?(r.return=i,U=r):dA(n)}}function dA(n){for(;U!==null;){var e=U;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Yt||pm(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!Yt)if(t===null)s.componentDidMount();else{var i=e.elementType===e.type?t.memoizedProps:Cs(e.type,t.memoizedProps);s.componentDidUpdate(i,t.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var r=e.updateQueue;r!==null&&qb(e,r,s);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}qb(e,o,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&t.focus();break;case"img":c.src&&(t.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&Rd(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(N(163))}Yt||e.flags&512&&hv(e)}catch(f){qe(e,e.return,f)}}if(e===n){U=null;break}if(t=e.sibling,t!==null){t.return=e.return,U=t;break}U=e.return}}function hA(n){for(;U!==null;){var e=U;if(e===n){U=null;break}var t=e.sibling;if(t!==null){t.return=e.return,U=t;break}U=e.return}}function fA(n){for(;U!==null;){var e=U;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{pm(4,e)}catch(c){qe(e,t,c)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var i=e.return;try{s.componentDidMount()}catch(c){qe(e,i,c)}}var r=e.return;try{hv(e)}catch(c){qe(e,r,c)}break;case 5:var o=e.return;try{hv(e)}catch(c){qe(e,o,c)}}}catch(c){qe(e,e.return,c)}if(e===n){U=null;break}var a=e.sibling;if(a!==null){a.return=e.return,U=a;break}U=e.return}}var HT=Math.ceil,Sg=kr.ReactCurrentDispatcher,xw=kr.ReactCurrentOwner,ys=kr.ReactCurrentBatchConfig,ge=0,xt=null,it=null,Ot=0,Wn=0,Hl=Ho(0),ht=0,$d=null,hl=0,gm=0,Ew=0,wd=null,vn=null,_w=0,mu=1/0,Oi=null,xg=!1,gv=null,Ro=null,rp=!1,Eo=null,Eg=0,bd=0,mv=null,xp=-1,Ep=0;function an(){return ge&6?tt():xp!==-1?xp:xp=tt()}function Lo(n){return n.mode&1?ge&2&&Ot!==0?Ot&-Ot:_T.transition!==null?(Ep===0&&(Ep=JS()),Ep):(n=Ae,n!==0||(n=window.event,n=n===void 0?16:rx(n.type)),n):1}function Vs(n,e,t,s){if(50<bd)throw bd=0,mv=null,Error(N(185));Cf(n,t,s),(!(ge&2)||n!==xt)&&(n===xt&&(!(ge&2)&&(gm|=t),ht===4&&jr(n,Ot)),Sn(n,s),t===1&&ge===0&&!(e.mode&1)&&(mu=tt()+500,dm&&Uo()))}function Sn(n,e){var t=n.callbackNode;_k(n,e);var s=ag(n,n===xt?Ot:0);if(s===0)t!==null&&Sb(t),n.callbackNode=null,n.callbackPriority=0;else if(e=s&-s,n.callbackPriority!==e){if(t!=null&&Sb(t),e===1)n.tag===0?ET(pA.bind(null,n)):Ex(pA.bind(null,n)),bT(function(){!(ge&6)&&Uo()}),t=null;else{switch(ZS(s)){case 1:t=Q0;break;case 4:t=KS;break;case 16:t=og;break;case 536870912:t=QS;break;default:t=og}t=SE(t,gE.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function gE(n,e){if(xp=-1,Ep=0,ge&6)throw Error(N(327));var t=n.callbackNode;if(Jl()&&n.callbackNode!==t)return null;var s=ag(n,n===xt?Ot:0);if(s===0)return null;if(s&30||s&n.expiredLanes||e)e=_g(n,s);else{e=s;var i=ge;ge|=2;var r=yE();(xt!==n||Ot!==e)&&(Oi=null,mu=tt()+500,al(n,e));do try{GT();break}catch(a){mE(n,a)}while(!0);uw(),Sg.current=r,ge=i,it!==null?e=0:(xt=null,Ot=0,e=ht)}if(e!==0){if(e===2&&(i=Uy(n),i!==0&&(s=i,e=yv(n,i))),e===1)throw t=$d,al(n,0),jr(n,s),Sn(n,tt()),t;if(e===6)jr(n,s);else{if(i=n.current.alternate,!(s&30)&&!UT(i)&&(e=_g(n,s),e===2&&(r=Uy(n),r!==0&&(s=r,e=yv(n,r))),e===1))throw t=$d,al(n,0),jr(n,s),Sn(n,tt()),t;switch(n.finishedWork=i,n.finishedLanes=s,e){case 0:case 1:throw Error(N(345));case 2:Wo(n,vn,Oi);break;case 3:if(jr(n,s),(s&130023424)===s&&(e=_w+500-tt(),10<e)){if(ag(n,0)!==0)break;if(i=n.suspendedLanes,(i&s)!==s){an(),n.pingedLanes|=n.suspendedLanes&i;break}n.timeoutHandle=Qy(Wo.bind(null,n,vn,Oi),e);break}Wo(n,vn,Oi);break;case 4:if(jr(n,s),(s&4194240)===s)break;for(e=n.eventTimes,i=-1;0<s;){var o=31-Us(s);r=1<<o,o=e[o],o>i&&(i=o),s&=~r}if(s=i,s=tt()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*HT(s/1960))-s,10<s){n.timeoutHandle=Qy(Wo.bind(null,n,vn,Oi),s);break}Wo(n,vn,Oi);break;case 5:Wo(n,vn,Oi);break;default:throw Error(N(329))}}}return Sn(n,tt()),n.callbackNode===t?gE.bind(null,n):null}function yv(n,e){var t=wd;return n.current.memoizedState.isDehydrated&&(al(n,e).flags|=256),n=_g(n,e),n!==2&&(e=vn,vn=t,e!==null&&vv(e)),n}function vv(n){vn===null?vn=n:vn.push.apply(vn,n)}function UT(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var s=0;s<t.length;s++){var i=t[s],r=i.getSnapshot;i=i.value;try{if(!Gs(r(),i))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function jr(n,e){for(e&=~Ew,e&=~gm,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-Us(e),s=1<<t;n[t]=-1,e&=~s}}function pA(n){if(ge&6)throw Error(N(327));Jl();var e=ag(n,0);if(!(e&1))return Sn(n,tt()),null;var t=_g(n,e);if(n.tag!==0&&t===2){var s=Uy(n);s!==0&&(e=s,t=yv(n,s))}if(t===1)throw t=$d,al(n,0),jr(n,e),Sn(n,tt()),t;if(t===6)throw Error(N(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,Wo(n,vn,Oi),Sn(n,tt()),null}function Cw(n,e){var t=ge;ge|=1;try{return n(e)}finally{ge=t,ge===0&&(mu=tt()+500,dm&&Uo())}}function fl(n){Eo!==null&&Eo.tag===0&&!(ge&6)&&Jl();var e=ge;ge|=1;var t=ys.transition,s=Ae;try{if(ys.transition=null,Ae=1,n)return n()}finally{Ae=s,ys.transition=t,ge=e,!(ge&6)&&Uo()}}function kw(){Wn=Hl.current,Ie(Hl)}function al(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,wT(t)),it!==null)for(t=it.return;t!==null;){var s=t;switch(aw(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&hg();break;case 3:pu(),Ie(bn),Ie(Kt),mw();break;case 5:gw(s);break;case 4:pu();break;case 13:Ie(Ue);break;case 19:Ie(Ue);break;case 10:dw(s.type._context);break;case 22:case 23:kw()}t=t.return}if(xt=n,it=n=Mo(n.current,null),Ot=Wn=e,ht=0,$d=null,Ew=gm=hl=0,vn=wd=null,Zo!==null){for(e=0;e<Zo.length;e++)if(t=Zo[e],s=t.interleaved,s!==null){t.interleaved=null;var i=s.next,r=t.pending;if(r!==null){var o=r.next;r.next=i,s.next=o}t.pending=s}Zo=null}return n}function mE(n,e){do{var t=it;try{if(uw(),bp.current=Ag,bg){for(var s=Ve.memoizedState;s!==null;){var i=s.queue;i!==null&&(i.pending=null),s=s.next}bg=!1}if(dl=0,At=ut=Ve=null,yd=!1,jd=0,xw.current=null,t===null||t.return===null){ht=1,$d=e,it=null;break}e:{var r=n,o=t.return,a=t,c=e;if(e=Ot,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=a,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=tA(o);if(p!==null){p.flags&=-257,nA(p,o,a,r,e),p.mode&1&&eA(r,u,e),e=p,c=u;var v=e.updateQueue;if(v===null){var g=new Set;g.add(c),e.updateQueue=g}else v.add(c);break e}else{if(!(e&1)){eA(r,u,e),Tw();break e}c=Error(N(426))}}else if(ze&&a.mode&1){var x=tA(o);if(x!==null){!(x.flags&65536)&&(x.flags|=256),nA(x,o,a,r,e),lw(gu(c,a));break e}}r=c=gu(c,a),ht!==4&&(ht=2),wd===null?wd=[r]:wd.push(r),r=o;do{switch(r.tag){case 3:r.flags|=65536,e&=-e,r.lanes|=e;var y=Zx(r,c,e);Yb(r,y);break e;case 1:a=c;var w=r.type,b=r.stateNode;if(!(r.flags&128)&&(typeof w.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Ro===null||!Ro.has(b)))){r.flags|=65536,e&=-e,r.lanes|=e;var E=eE(r,a,e);Yb(r,E);break e}}r=r.return}while(r!==null)}wE(t)}catch(_){e=_,it===t&&t!==null&&(it=t=t.return);continue}break}while(!0)}function yE(){var n=Sg.current;return Sg.current=Ag,n===null?Ag:n}function Tw(){(ht===0||ht===3||ht===2)&&(ht=4),xt===null||!(hl&268435455)&&!(gm&268435455)||jr(xt,Ot)}function _g(n,e){var t=ge;ge|=2;var s=yE();(xt!==n||Ot!==e)&&(Oi=null,al(n,e));do try{VT();break}catch(i){mE(n,i)}while(!0);if(uw(),ge=t,Sg.current=s,it!==null)throw Error(N(261));return xt=null,Ot=0,ht}function VT(){for(;it!==null;)vE(it)}function GT(){for(;it!==null&&!mk();)vE(it)}function vE(n){var e=AE(n.alternate,n,Wn);n.memoizedProps=n.pendingProps,e===null?wE(n):it=e,xw.current=null}function wE(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=jT(t,e),t!==null){t.flags&=32767,it=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{ht=6,it=null;return}}else if(t=FT(t,e,Wn),t!==null){it=t;return}if(e=e.sibling,e!==null){it=e;return}it=e=n}while(e!==null);ht===0&&(ht=5)}function Wo(n,e,t){var s=Ae,i=ys.transition;try{ys.transition=null,Ae=1,WT(n,e,t,s)}finally{ys.transition=i,Ae=s}return null}function WT(n,e,t,s){do Jl();while(Eo!==null);if(ge&6)throw Error(N(327));t=n.finishedWork;var i=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(N(177));n.callbackNode=null,n.callbackPriority=0;var r=t.lanes|t.childLanes;if(Ck(n,r),n===xt&&(it=xt=null,Ot=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||rp||(rp=!0,SE(og,function(){return Jl(),null})),r=(t.flags&15990)!==0,t.subtreeFlags&15990||r){r=ys.transition,ys.transition=null;var o=Ae;Ae=1;var a=ge;ge|=4,xw.current=null,BT(n,t),fE(t,n),hT(qy),lg=!!Yy,qy=Yy=null,n.current=t,$T(t),yk(),ge=a,Ae=o,ys.transition=r}else n.current=t;if(rp&&(rp=!1,Eo=n,Eg=i),r=n.pendingLanes,r===0&&(Ro=null),bk(t.stateNode),Sn(n,tt()),e!==null)for(s=n.onRecoverableError,t=0;t<e.length;t++)i=e[t],s(i.value,{componentStack:i.stack,digest:i.digest});if(xg)throw xg=!1,n=gv,gv=null,n;return Eg&1&&n.tag!==0&&Jl(),r=n.pendingLanes,r&1?n===mv?bd++:(bd=0,mv=n):bd=0,Uo(),null}function Jl(){if(Eo!==null){var n=ZS(Eg),e=ys.transition,t=Ae;try{if(ys.transition=null,Ae=16>n?16:n,Eo===null)var s=!1;else{if(n=Eo,Eo=null,Eg=0,ge&6)throw Error(N(331));var i=ge;for(ge|=4,U=n.current;U!==null;){var r=U,o=r.child;if(U.flags&16){var a=r.deletions;if(a!==null){for(var c=0;c<a.length;c++){var u=a[c];for(U=u;U!==null;){var d=U;switch(d.tag){case 0:case 11:case 15:vd(8,d,r)}var h=d.child;if(h!==null)h.return=d,U=h;else for(;U!==null;){d=U;var f=d.sibling,p=d.return;if(uE(d),d===u){U=null;break}if(f!==null){f.return=p,U=f;break}U=p}}}var v=r.alternate;if(v!==null){var g=v.child;if(g!==null){v.child=null;do{var x=g.sibling;g.sibling=null,g=x}while(g!==null)}}U=r}}if(r.subtreeFlags&2064&&o!==null)o.return=r,U=o;else e:for(;U!==null;){if(r=U,r.flags&2048)switch(r.tag){case 0:case 11:case 15:vd(9,r,r.return)}var y=r.sibling;if(y!==null){y.return=r.return,U=y;break e}U=r.return}}var w=n.current;for(U=w;U!==null;){o=U;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,U=b;else e:for(o=w;U!==null;){if(a=U,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:pm(9,a)}}catch(_){qe(a,a.return,_)}if(a===o){U=null;break e}var E=a.sibling;if(E!==null){E.return=a.return,U=E;break e}U=a.return}}if(ge=i,Uo(),xi&&typeof xi.onPostCommitFiberRoot=="function")try{xi.onPostCommitFiberRoot(om,n)}catch{}s=!0}return s}finally{Ae=t,ys.transition=e}}return!1}function gA(n,e,t){e=gu(t,e),e=Zx(n,e,1),n=Po(n,e,1),e=an(),n!==null&&(Cf(n,1,e),Sn(n,e))}function qe(n,e,t){if(n.tag===3)gA(n,n,t);else for(;e!==null;){if(e.tag===3){gA(e,n,t);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(Ro===null||!Ro.has(s))){n=gu(t,n),n=eE(e,n,1),e=Po(e,n,1),n=an(),e!==null&&(Cf(e,1,n),Sn(e,n));break}}e=e.return}}function XT(n,e,t){var s=n.pingCache;s!==null&&s.delete(e),e=an(),n.pingedLanes|=n.suspendedLanes&t,xt===n&&(Ot&t)===t&&(ht===4||ht===3&&(Ot&130023424)===Ot&&500>tt()-_w?al(n,0):Ew|=t),Sn(n,e)}function bE(n,e){e===0&&(n.mode&1?(e=qf,qf<<=1,!(qf&130023424)&&(qf=4194304)):e=1);var t=an();n=Sr(n,e),n!==null&&(Cf(n,e,t),Sn(n,t))}function YT(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),bE(n,t)}function qT(n,e){var t=0;switch(n.tag){case 13:var s=n.stateNode,i=n.memoizedState;i!==null&&(t=i.retryLane);break;case 19:s=n.stateNode;break;default:throw Error(N(314))}s!==null&&s.delete(e),bE(n,t)}var AE;AE=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||bn.current)wn=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return wn=!1,OT(n,e,t);wn=!!(n.flags&131072)}else wn=!1,ze&&e.flags&1048576&&_x(e,gg,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;Sp(n,e),n=e.pendingProps;var i=du(e,Kt.current);Ql(e,t),i=vw(null,e,s,n,i,t);var r=ww();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,An(s)?(r=!0,fg(e)):r=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,fw(e),i.updater=fm,e.stateNode=i,i._reactInternals=e,iv(e,s,n,t),e=av(null,e,s,!0,r,t)):(e.tag=0,ze&&r&&ow(e),rn(null,e,i,t),e=e.child),e;case 16:s=e.elementType;e:{switch(Sp(n,e),n=e.pendingProps,i=s._init,s=i(s._payload),e.type=s,i=e.tag=QT(s),n=Cs(s,n),i){case 0:e=ov(null,e,s,n,t);break e;case 1:e=rA(null,e,s,n,t);break e;case 11:e=sA(null,e,s,n,t);break e;case 14:e=iA(null,e,s,Cs(s.type,n),t);break e}throw Error(N(306,s,""))}return e;case 0:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:Cs(s,i),ov(n,e,s,i,t);case 1:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:Cs(s,i),rA(n,e,s,i,t);case 3:e:{if(iE(e),n===null)throw Error(N(387));s=e.pendingProps,r=e.memoizedState,i=r.element,Lx(n,e),vg(e,s,null,t);var o=e.memoizedState;if(s=o.element,r.isDehydrated)if(r={element:s,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=r,e.memoizedState=r,e.flags&256){i=gu(Error(N(423)),e),e=oA(n,e,s,t,i);break e}else if(s!==i){i=gu(Error(N(424)),e),e=oA(n,e,s,t,i);break e}else for(qn=To(e.stateNode.containerInfo.firstChild),Kn=e,ze=!0,$s=null,t=Px(e,null,s,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(hu(),s===i){e=xr(n,e,t);break e}rn(n,e,s,t)}e=e.child}return e;case 5:return Mx(e),n===null&&tv(e),s=e.type,i=e.pendingProps,r=n!==null?n.memoizedProps:null,o=i.children,Ky(s,i)?o=null:r!==null&&Ky(s,r)&&(e.flags|=32),sE(n,e),rn(n,e,o,t),e.child;case 6:return n===null&&tv(e),null;case 13:return rE(n,e,t);case 4:return pw(e,e.stateNode.containerInfo),s=e.pendingProps,n===null?e.child=fu(e,null,s,t):rn(n,e,s,t),e.child;case 11:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:Cs(s,i),sA(n,e,s,i,t);case 7:return rn(n,e,e.pendingProps,t),e.child;case 8:return rn(n,e,e.pendingProps.children,t),e.child;case 12:return rn(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(s=e.type._context,i=e.pendingProps,r=e.memoizedProps,o=i.value,Le(mg,s._currentValue),s._currentValue=o,r!==null)if(Gs(r.value,o)){if(r.children===i.children&&!bn.current){e=xr(n,e,t);break e}}else for(r=e.child,r!==null&&(r.return=e);r!==null;){var a=r.dependencies;if(a!==null){o=r.child;for(var c=a.firstContext;c!==null;){if(c.context===s){if(r.tag===1){c=yr(-1,t&-t),c.tag=2;var u=r.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}r.lanes|=t,c=r.alternate,c!==null&&(c.lanes|=t),nv(r.return,t,e),a.lanes|=t;break}c=c.next}}else if(r.tag===10)o=r.type===e.type?null:r.child;else if(r.tag===18){if(o=r.return,o===null)throw Error(N(341));o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),nv(o,t,e),o=r.sibling}else o=r.child;if(o!==null)o.return=r;else for(o=r;o!==null;){if(o===e){o=null;break}if(r=o.sibling,r!==null){r.return=o.return,o=r;break}o=o.return}r=o}rn(n,e,i.children,t),e=e.child}return e;case 9:return i=e.type,s=e.pendingProps.children,Ql(e,t),i=ws(i),s=s(i),e.flags|=1,rn(n,e,s,t),e.child;case 14:return s=e.type,i=Cs(s,e.pendingProps),i=Cs(s.type,i),iA(n,e,s,i,t);case 15:return tE(n,e,e.type,e.pendingProps,t);case 17:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:Cs(s,i),Sp(n,e),e.tag=1,An(s)?(n=!0,fg(e)):n=!1,Ql(e,t),Jx(e,s,i),iv(e,s,i,t),av(null,e,s,!0,n,t);case 19:return oE(n,e,t);case 22:return nE(n,e,t)}throw Error(N(156,e.tag))};function SE(n,e){return qS(n,e)}function KT(n,e,t,s){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ms(n,e,t,s){return new KT(n,e,t,s)}function Pw(n){return n=n.prototype,!(!n||!n.isReactComponent)}function QT(n){if(typeof n=="function")return Pw(n)?1:0;if(n!=null){if(n=n.$$typeof,n===Y0)return 11;if(n===q0)return 14}return 2}function Mo(n,e){var t=n.alternate;return t===null?(t=ms(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function _p(n,e,t,s,i,r){var o=2;if(s=n,typeof n=="function")Pw(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case Ml:return ll(t.children,i,r,e);case X0:o=8,i|=8;break;case Ty:return n=ms(12,t,e,i|2),n.elementType=Ty,n.lanes=r,n;case Py:return n=ms(13,t,e,i),n.elementType=Py,n.lanes=r,n;case Ry:return n=ms(19,t,e,i),n.elementType=Ry,n.lanes=r,n;case MS:return mm(t,i,r,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case RS:o=10;break e;case LS:o=9;break e;case Y0:o=11;break e;case q0:o=14;break e;case Nr:o=16,s=null;break e}throw Error(N(130,n==null?n:typeof n,""))}return e=ms(o,t,e,i),e.elementType=n,e.type=s,e.lanes=r,e}function ll(n,e,t,s){return n=ms(7,n,s,e),n.lanes=t,n}function mm(n,e,t,s){return n=ms(22,n,s,e),n.elementType=MS,n.lanes=t,n.stateNode={isHidden:!1},n}function dy(n,e,t){return n=ms(6,n,null,e),n.lanes=t,n}function hy(n,e,t){return e=ms(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function JT(n,e,t,s,i){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Wm(0),this.expirationTimes=Wm(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Wm(0),this.identifierPrefix=s,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Rw(n,e,t,s,i,r,o,a,c){return n=new JT(n,e,t,a,c),e===1?(e=1,r===!0&&(e|=8)):e=0,r=ms(3,null,null,e),n.current=r,r.stateNode=n,r.memoizedState={element:s,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},fw(r),n}function ZT(n,e,t){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ll,key:s==null?null:""+s,children:n,containerInfo:e,implementation:t}}function xE(n){if(!n)return No;n=n._reactInternals;e:{if(yl(n)!==n||n.tag!==1)throw Error(N(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(An(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(N(171))}if(n.tag===1){var t=n.type;if(An(t))return xx(n,t,e)}return e}function EE(n,e,t,s,i,r,o,a,c){return n=Rw(t,s,!0,n,i,r,o,a,c),n.context=xE(null),t=n.current,s=an(),i=Lo(t),r=yr(s,i),r.callback=e??null,Po(t,r,i),n.current.lanes=i,Cf(n,i,s),Sn(n,s),n}function ym(n,e,t,s){var i=e.current,r=an(),o=Lo(i);return t=xE(t),e.context===null?e.context=t:e.pendingContext=t,e=yr(r,o),e.payload={element:n},s=s===void 0?null:s,s!==null&&(e.callback=s),n=Po(i,e,o),n!==null&&(Vs(n,i,o,r),wp(n,i,o)),o}function Cg(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function mA(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function Lw(n,e){mA(n,e),(n=n.alternate)&&mA(n,e)}function eP(){return null}var _E=typeof reportError=="function"?reportError:function(n){console.error(n)};function Mw(n){this._internalRoot=n}vm.prototype.render=Mw.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(N(409));ym(n,e,null,null)};vm.prototype.unmount=Mw.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;fl(function(){ym(null,n,null,null)}),e[Ar]=null}};function vm(n){this._internalRoot=n}vm.prototype.unstable_scheduleHydration=function(n){if(n){var e=nx();n={blockedOn:null,target:n,priority:e};for(var t=0;t<Fr.length&&e!==0&&e<Fr[t].priority;t++);Fr.splice(t,0,n),t===0&&ix(n)}};function Dw(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function wm(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function yA(){}function tP(n,e,t,s,i){if(i){if(typeof s=="function"){var r=s;s=function(){var u=Cg(o);r.call(u)}}var o=EE(e,s,n,0,null,!1,!1,"",yA);return n._reactRootContainer=o,n[Ar]=o.current,Dd(n.nodeType===8?n.parentNode:n),fl(),o}for(;i=n.lastChild;)n.removeChild(i);if(typeof s=="function"){var a=s;s=function(){var u=Cg(c);a.call(u)}}var c=Rw(n,0,!1,null,null,!1,!1,"",yA);return n._reactRootContainer=c,n[Ar]=c.current,Dd(n.nodeType===8?n.parentNode:n),fl(function(){ym(e,c,t,s)}),c}function bm(n,e,t,s,i){var r=t._reactRootContainer;if(r){var o=r;if(typeof i=="function"){var a=i;i=function(){var c=Cg(o);a.call(c)}}ym(e,o,n,i)}else o=tP(t,e,n,i,s);return Cg(o)}ex=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=Gu(e.pendingLanes);t!==0&&(J0(e,t|1),Sn(e,tt()),!(ge&6)&&(mu=tt()+500,Uo()))}break;case 13:fl(function(){var s=Sr(n,1);if(s!==null){var i=an();Vs(s,n,1,i)}}),Lw(n,1)}};Z0=function(n){if(n.tag===13){var e=Sr(n,134217728);if(e!==null){var t=an();Vs(e,n,134217728,t)}Lw(n,134217728)}};tx=function(n){if(n.tag===13){var e=Lo(n),t=Sr(n,e);if(t!==null){var s=an();Vs(t,n,e,s)}Lw(n,e)}};nx=function(){return Ae};sx=function(n,e){var t=Ae;try{return Ae=n,e()}finally{Ae=t}};By=function(n,e,t){switch(e){case"input":if(Dy(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var s=t[e];if(s!==n&&s.form===n.form){var i=um(s);if(!i)throw Error(N(90));NS(s),Dy(s,i)}}}break;case"textarea":OS(n,t);break;case"select":e=t.value,e!=null&&Xl(n,!!t.multiple,e,!1)}};US=Cw;VS=fl;var nP={usingClientEntryPoint:!1,Events:[Tf,Ol,um,$S,HS,Cw]},Fu={findFiberByHostInstance:Jo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},sP={bundleType:Fu.bundleType,version:Fu.version,rendererPackageName:Fu.rendererPackageName,rendererConfig:Fu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:kr.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=XS(n),n===null?null:n.stateNode},findFiberByHostInstance:Fu.findFiberByHostInstance||eP,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var op=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!op.isDisabled&&op.supportsFiber)try{om=op.inject(sP),xi=op}catch{}}Zn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=nP;Zn.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Dw(e))throw Error(N(200));return ZT(n,e,null,t)};Zn.createRoot=function(n,e){if(!Dw(n))throw Error(N(299));var t=!1,s="",i=_E;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Rw(n,1,!1,null,null,t,!1,s,i),n[Ar]=e.current,Dd(n.nodeType===8?n.parentNode:n),new Mw(e)};Zn.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(N(188)):(n=Object.keys(n).join(","),Error(N(268,n)));return n=XS(e),n=n===null?null:n.stateNode,n};Zn.flushSync=function(n){return fl(n)};Zn.hydrate=function(n,e,t){if(!wm(e))throw Error(N(200));return bm(null,n,e,!0,t)};Zn.hydrateRoot=function(n,e,t){if(!Dw(n))throw Error(N(405));var s=t!=null&&t.hydratedSources||null,i=!1,r="",o=_E;if(t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=EE(e,null,n,1,t??null,i,!1,r,o),n[Ar]=e.current,Dd(n),s)for(n=0;n<s.length;n++)t=s[n],i=t._getVersion,i=i(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,i]:e.mutableSourceEagerHydrationData.push(t,i);return new vm(e)};Zn.render=function(n,e,t){if(!wm(e))throw Error(N(200));return bm(null,n,e,!1,t)};Zn.unmountComponentAtNode=function(n){if(!wm(n))throw Error(N(40));return n._reactRootContainer?(fl(function(){bm(null,null,n,!1,function(){n._reactRootContainer=null,n[Ar]=null})}),!0):!1};Zn.unstable_batchedUpdates=Cw;Zn.unstable_renderSubtreeIntoContainer=function(n,e,t,s){if(!wm(t))throw Error(N(200));if(n==null||n._reactInternals===void 0)throw Error(N(38));return bm(n,e,t,!1,s)};Zn.version="18.3.1-next-f1338f8080-20240426";function CE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(CE)}catch(n){console.error(n)}}CE(),CS.exports=Zn;var Ul=CS.exports,vA=Ul;Cy.createRoot=vA.createRoot,Cy.hydrateRoot=vA.hydrateRoot;const iP={},wA=n=>{let e;const t=new Set,s=(d,h)=>{const f=typeof d=="function"?d(e):d;if(!Object.is(f,e)){const p=e;e=h??(typeof f!="object"||f===null)?f:Object.assign({},e,f),t.forEach(v=>v(e,p))}},i=()=>e,c={setState:s,getState:i,getInitialState:()=>u,subscribe:d=>(t.add(d),()=>t.delete(d)),destroy:()=>{(iP?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},u=e=n(s,i,c);return c},rP=n=>n?wA(n):wA;var kE={exports:{}},TE={},PE={exports:{}},RE={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yu=R;function oP(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var aP=typeof Object.is=="function"?Object.is:oP,lP=yu.useState,cP=yu.useEffect,uP=yu.useLayoutEffect,dP=yu.useDebugValue;function hP(n,e){var t=e(),s=lP({inst:{value:t,getSnapshot:e}}),i=s[0].inst,r=s[1];return uP(function(){i.value=t,i.getSnapshot=e,fy(i)&&r({inst:i})},[n,t,e]),cP(function(){return fy(i)&&r({inst:i}),n(function(){fy(i)&&r({inst:i})})},[n]),dP(t),t}function fy(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!aP(n,t)}catch{return!0}}function fP(n,e){return e()}var pP=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?fP:hP;RE.useSyncExternalStore=yu.useSyncExternalStore!==void 0?yu.useSyncExternalStore:pP;PE.exports=RE;var gP=PE.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Am=R,mP=gP;function yP(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var vP=typeof Object.is=="function"?Object.is:yP,wP=mP.useSyncExternalStore,bP=Am.useRef,AP=Am.useEffect,SP=Am.useMemo,xP=Am.useDebugValue;TE.useSyncExternalStoreWithSelector=function(n,e,t,s,i){var r=bP(null);if(r.current===null){var o={hasValue:!1,value:null};r.current=o}else o=r.current;r=SP(function(){function c(p){if(!u){if(u=!0,d=p,p=s(p),i!==void 0&&o.hasValue){var v=o.value;if(i(v,p))return h=v}return h=p}if(v=h,vP(d,p))return v;var g=s(p);return i!==void 0&&i(v,g)?(d=p,v):(d=p,h=g)}var u=!1,d,h,f=t===void 0?null:t;return[function(){return c(e())},f===null?void 0:function(){return c(f())}]},[e,t,s,i]);var a=wP(n,r[0],r[1]);return AP(function(){o.hasValue=!0,o.value=a},[a]),xP(a),a};kE.exports=TE;var EP=kE.exports;const _P=z0(EP),LE={},{useDebugValue:CP}=yn,{useSyncExternalStoreWithSelector:kP}=_P;let bA=!1;const TP=n=>n;function PP(n,e=TP,t){(LE?"production":void 0)!=="production"&&t&&!bA&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),bA=!0);const s=kP(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return CP(s),s}const AA=n=>{(LE?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?rP(n):n,t=(s,i)=>PP(e,s,i);return Object.assign(t,e),t},RP=n=>n?AA(n):AA,Ze="http://localhost:8000/api/v1",Mi={async getComponents(){const n=await fetch(`${Ze}/components/`);if(!n.ok)throw new Error("Failed to fetch components");return n.json()},async getLinks(){const n=await fetch(`${Ze}/links/`);if(!n.ok)throw new Error("Failed to fetch links");return n.json()},async createComponent(n){const e=await fetch(`${Ze}/components/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!e.ok)throw new Error("Failed to create component");return e.json()},async createLink(n){const e=await fetch(`${Ze}/links/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!e.ok)throw new Error("Failed to create link");return e.json()},async updateComponent(n,e){const t=await fetch(`${Ze}/components/${n}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw new Error("Failed to update component");return t.json()},async deleteComponent(n){if(!(await fetch(`${Ze}/components/${n}`,{method:"DELETE"})).ok)throw new Error("Failed to delete component")},async analyzeDesign(n,e){const t=await fetch(`${Ze}/ai/analyze-design`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({command:e,snapshot:n})});if(!t.ok)throw new Error(`Analyze failed: ${t.status}`);return t.json()},async sendCommandToAI(n){const e=await fetch(`${Ze}/ai/command`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({command:n})});if(!e.ok){const t=await e.text();throw new Error(`AI endpoint error ${e.status}: ${t.slice(0,120)}`)}return e.json()}};async function ME(n,e){return new Promise((t,s)=>{const i=new XMLHttpRequest,r=new FormData;r.append("file",n),i.upload.onprogress=o=>{o.lengthComputable&&e(Math.round(o.loaded/o.total*100))},i.onload=()=>{i.status>=200&&i.status<300?t(JSON.parse(i.responseText)):s(i)},i.onerror=()=>s(i),i.open("POST",`${Ze}/files/upload`),i.send(r)})}async function LP(){const n=await fetch(`${Ze}/files/`);if(!n.ok)throw new Error("Failed to fetch files");return n.json()}async function kg(n){const e=await fetch(`${Ze}/files/${n}/parse`,{method:"POST"});if(!e.ok){const t=await e.json();throw new Error(t.detail||"Failed to parse datasheet")}return e.json()}async function vu(n){const e=await fetch(`${Ze}/files/${n}`);if(!e.ok){const t=await e.json();throw new Error(t.detail||"Failed to fetch status")}return e.json()}async function SA(n,e,t){const s={parsed_payload:e};typeof t=="boolean"&&(s.is_human_verified=t);const i=await fetch(`${Ze}/files/${n}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!i.ok){const r=await i.json();throw new Error(r.detail||"Failed to save datasheet")}return i.json()}const q=RP((n,e)=>({canvasComponents:[],links:[],ghostLinks:[],bomItems:null,selectedComponentId:null,messages:[],status:"loading",statusMessages:[],chatMode:"default",isAiProcessing:!1,route:"projects",isSubNavVisible:!0,uploads:[],useRuleBased:!0,useTableExtraction:!0,useAiExtraction:!0,useOcrFallback:!1,layers:["Single-Line Diagram","High-Level Overview","Civil/Structural","Networking/Monitoring"],currentLayer:"Single-Line Diagram",pendingActions:[],setCurrentLayer:t=>n({currentLayer:t}),addPendingActions:t=>n(s=>({pendingActions:[...s.pendingActions,...t]})),approvePendingAction:async t=>{const i=e().pendingActions[t];i&&(await e().executeAiActions([i]),n(r=>({pendingActions:r.pendingActions.filter((o,a)=>a!==t)})))},rejectPendingAction:t=>n(s=>({pendingActions:s.pendingActions.filter((i,r)=>r!==t)})),voiceMode:"idle",isContinuousConversation:!1,voiceTranscript:"",voiceOutputEnabled:!1,chatDraft:"",activeDatasheet:null,setActiveDatasheet:t=>n({activeDatasheet:t}),setVoiceMode:t=>n({voiceMode:t}),toggleContinuousConversation:()=>n(t=>({isContinuousConversation:!t.isContinuousConversation})),startListening:()=>{n({voiceTranscript:"",voiceMode:"listening"})},stopListening:t=>{n({voiceMode:"idle",voiceTranscript:""}),t&&t.trim()&&e().analyzeAndExecute(t.trim())},updateVoiceTranscript:t=>n({voiceTranscript:t}),toggleVoiceOutput:()=>n(t=>({voiceOutputEnabled:!t.voiceOutputEnabled})),setChatDraft:t=>n({chatDraft:t}),clearChatDraft:()=>n({chatDraft:""}),toggleSubNav:()=>n(t=>({isSubNavVisible:!t.isSubNavVisible})),setExtractionSetting:(t,s)=>n(i=>({...i,[t]:s})),addStatusMessage:(t,s)=>n(i=>({statusMessages:[...i.statusMessages,{id:crypto.randomUUID(),message:t,icon:s}]})),removeStatusMessage:t=>n(s=>({statusMessages:s.statusMessages.filter(i=>i.id!==t)})),addMessage:t=>n(s=>({messages:[...s.messages,t]})),selectComponent:t=>n({selectedComponentId:t}),async fetchProject(){n({status:"loading"}),e().addStatusMessage("Loading project...","info");try{const[t,s]=await Promise.all([Mi.getComponents(),Mi.getLinks()]),i=t.map(r=>({...r,layer:r.layer??"Single-Line Diagram",ports:[{id:"input",type:"in"},{id:"output",type:"out"}]}));n({canvasComponents:i,links:s,status:"ready"}),e().addStatusMessage("Project loaded","success")}catch(t){console.error("Failed to load project:",t),n({status:"Error: Could not load project"}),e().addStatusMessage("Failed to load project","error")}},async addComponent(t){n({status:`Adding ${t.type}...`}),e().addStatusMessage(`Adding ${t.type}...`,"info");try{const s=await Mi.createComponent(t),i={...s,ports:[{id:"input",type:"in"},{id:"output",type:"out"}],layer:e().currentLayer};n(r=>({canvasComponents:[...r.canvasComponents,i],status:`Component ${s.name} added`})),e().addStatusMessage(`Component ${s.name} added`,"success")}catch(s){console.error("Failed to add component:",s),n({status:"Error: Could not add component"}),e().addStatusMessage("Failed to add component","error")}},async updateComponentName(t,s){const i=e().canvasComponents,r=i.map(o=>o.id===t?{...o,name:s}:o);n({canvasComponents:r});try{await Mi.updateComponent(t,{name:s})}catch(o){console.error("Failed to update component name:",o),n({canvasComponents:i})}},async updateComponentPosition(t,s){const i=e().canvasComponents,r=i.find(u=>u.id===t);if(!r)return;const o=Math.round(r.x+s.x),a=Math.round(r.y+s.y),c={...r,x:o,y:a};n({canvasComponents:i.map(u=>u.id===t?c:u)});try{await Mi.updateComponent(t,{x:o,y:a})}catch(u){console.error("Failed to save new position:",u),n({canvasComponents:i})}},async deleteComponent(t){n(s=>({canvasComponents:s.canvasComponents.filter(i=>i.id!==t),links:s.links.filter(i=>i.source_id!==t&&i.target_id!==t),selectedComponentId:null}));try{await Mi.deleteComponent(t)}catch(s){console.error("Failed to delete component:",s),e().fetchProject()}},async addLink({source_id:t,target_id:s}){if(!(e().links.some(r=>r.source_id===t&&r.target_id===s)||t===s)){n({status:"Creating link..."}),e().addStatusMessage("Creating link...","info");try{const r=await Mi.createLink({source_id:t,target_id:s});n(o=>({links:[...o.links,r],status:"Link created"})),e().addStatusMessage("Link created","success")}catch(r){console.error("Failed to add link:",r),n({status:"Error: Could not create link"}),e().addStatusMessage("Failed to create link","error")}}},async executeAiActions(t){for(const s of t)switch(s.action){case"addComponent":await e().addComponent(s.payload);break;case"removeComponent":await e().deleteComponent(s.payload.id);break;case"addLink":await Mi.createLink(s.payload);break;case"suggestLink":n(i=>({ghostLinks:[...i.ghostLinks,s.payload]}));break;case"updatePosition":n(i=>({canvasComponents:i.canvasComponents.map(r=>r.id===s.payload.id?{...r,x:s.payload.x,y:s.payload.y}:r)}));break;case"report":e().setBom(s.payload.items);break;default:console.warn("AI action not implemented",s)}},async analyzeAndExecute(t){const{addMessage:s,setIsAiProcessing:i,executeAiActions:r,canvasComponents:o,links:a}=e();s({id:crypto.randomUUID(),author:"User",text:t}),i(!0),e().addStatusMessage("Processing command","info");try{const c={components:o,links:a},u=await Mi.analyzeDesign(c,t);await r(u);const d=`I have successfully executed ${u.length} action(s).`;s({id:crypto.randomUUID(),author:"AI",text:d}),e().addStatusMessage("AI actions executed","success")}catch(c){console.error("AI command failed:",c),s({id:crypto.randomUUID(),author:"AI",text:"Sorry, I ran into an error trying to do that."}),n({status:"Error: AI command failed"}),e().addStatusMessage("AI command failed","error")}finally{i(!1)}},setBom(t){n({bomItems:t})},setChatMode(t){n({chatMode:t})},setIsAiProcessing(t){n({isAiProcessing:t})},setRoute(t){n({route:t})},addUpload(t){n(s=>({uploads:[...s.uploads,t]}))},updateUpload(t,s){n(i=>({uploads:i.uploads.map(r=>r.id===t?{...r,...s}:r)}))},async loadUploads(){try{const t=await LP();n({uploads:t.map(s=>({id:s.id,name:s.filename,size:s.size,mime:s.mime,progress:101,assetType:"component",parsed_at:s.parsed_at,parsing_status:s.parsing_status??null,parsing_error:s.parsing_error??null,is_human_verified:s.is_human_verified??!1}))})}catch(t){console.error("Failed to load uploads",t)}}}));/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MP=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),DP=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase()),xA=n=>{const e=DP(n);return e.charAt(0).toUpperCase()+e.slice(1)},DE=(...n)=>n.filter((e,t,s)=>!!e&&e.trim()!==""&&s.indexOf(e)===t).join(" ").trim(),NP=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var IP={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OP=R.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:s,className:i="",children:r,iconNode:o,...a},c)=>R.createElement("svg",{ref:c,...IP,width:e,height:e,stroke:n,strokeWidth:s?Number(t)*24/Number(e):t,className:DE("lucide",i),...!r&&!NP(a)&&{"aria-hidden":"true"},...a},[...o.map(([u,d])=>R.createElement(u,d)),...Array.isArray(r)?r:[r]]));/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ki=(n,e)=>{const t=R.forwardRef(({className:s,...i},r)=>R.createElement(OP,{ref:r,iconNode:e,className:DE(`lucide-${MP(xA(n))}`,`lucide-${n}`,s),...i}));return t.displayName=xA(n),t};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FP=[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]],jP=ki("book",FP);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zP=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],BP=ki("bot",zP);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $P=[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]],HP=ki("box",$P);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UP=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.93 4.93 4.24 4.24",key:"1ymg45"}],["path",{d:"m14.83 9.17 4.24-4.24",key:"1cb5xl"}],["path",{d:"m14.83 14.83 4.24 4.24",key:"q42g0n"}],["path",{d:"m9.17 14.83-4.24 4.24",key:"bqpfvv"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}]],VP=ki("life-buoy",UP);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GP=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],NE=ki("loader-circle",GP);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WP=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["rect",{x:"9",y:"2",width:"6",height:"13",rx:"3",key:"s6n7sd"}]],XP=ki("mic",WP);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YP=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"m16 15-3-3 3-3",key:"14y99z"}]],qP=ki("panel-left-close",YP);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KP=[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]],QP=ki("paperclip",KP);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JP=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],ZP=ki("send",JP);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eR=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],IE=ki("settings",eR),tR=({toggleSidebar:n,toggleToolbar:e})=>T.jsxs("header",{className:"grid-in-header h-16 flex items-center justify-between px-4 bg-white text-black border-b border-gray-200",children:[T.jsx("div",{className:"flex items-center gap-2",children:T.jsx("button",{onClick:n,className:"p-2 rounded-md hover:bg-gray-100 focus:ring-2 focus:ring-blue-500","aria-label":"Toggle sidebar",children:T.jsx(qP,{size:24})})}),T.jsxs("div",{className:"flex items-center gap-4",children:[T.jsx("nav",{role:"tablist","aria-label":"Primary navigation",className:"flex gap-2",children:["GlobalNav_1","GlobalNav_2","GlobalNav_3"].map(t=>T.jsx("button",{role:"tab",className:"px-4 py-2 rounded-md hover:bg-gray-100 aria-selected:bg-blue-100","aria-selected":t==="GlobalNav_1",children:t},t))}),T.jsx("button",{onClick:e,className:"p-2 rounded-full hover:bg-gray-100","aria-label":"Toggle sub-navigation",title:"Toggle Sub-Nav",children:T.jsx(IE,{className:"h-5 w-5"})})]}),T.jsxs("div",{className:"flex gap-1",children:[T.jsx("span",{className:"h-6 w-6 rounded-full bg-blue-200 text-xs flex items-center justify-center",children:"AI_1"}),T.jsx("span",{className:"h-6 w-6 rounded-full bg-gray-300 text-xs flex items-center justify-center",children:"Eng_1"})]})]}),Sm=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Eu(n){const e=Object.prototype.toString.call(n);return e==="[object Window]"||e==="[object global]"}function Nw(n){return"nodeType"in n}function xn(n){var e,t;return n?Eu(n)?n:Nw(n)&&(e=(t=n.ownerDocument)==null?void 0:t.defaultView)!=null?e:window:window}function Iw(n){const{Document:e}=xn(n);return n instanceof e}function Rf(n){return Eu(n)?!1:n instanceof xn(n).HTMLElement}function OE(n){return n instanceof xn(n).SVGElement}function _u(n){return n?Eu(n)?n.document:Nw(n)?Iw(n)?n:Rf(n)||OE(n)?n.ownerDocument:document:document:document}const Io=Sm?R.useLayoutEffect:R.useEffect;function Ow(n){const e=R.useRef(n);return Io(()=>{e.current=n}),R.useCallback(function(){for(var t=arguments.length,s=new Array(t),i=0;i<t;i++)s[i]=arguments[i];return e.current==null?void 0:e.current(...s)},[])}function nR(){const n=R.useRef(null),e=R.useCallback((s,i)=>{n.current=setInterval(s,i)},[]),t=R.useCallback(()=>{n.current!==null&&(clearInterval(n.current),n.current=null)},[]);return[e,t]}function Hd(n,e){e===void 0&&(e=[n]);const t=R.useRef(n);return Io(()=>{t.current!==n&&(t.current=n)},e),t}function Lf(n,e){const t=R.useRef();return R.useMemo(()=>{const s=n(t.current);return t.current=s,s},[...e])}function Tg(n){const e=Ow(n),t=R.useRef(null),s=R.useCallback(i=>{i!==t.current&&(e==null||e(i,t.current)),t.current=i},[]);return[t,s]}function wv(n){const e=R.useRef();return R.useEffect(()=>{e.current=n},[n]),e.current}let py={};function xm(n,e){return R.useMemo(()=>{if(e)return e;const t=py[n]==null?0:py[n]+1;return py[n]=t,n+"-"+t},[n,e])}function FE(n){return function(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),i=1;i<t;i++)s[i-1]=arguments[i];return s.reduce((r,o)=>{const a=Object.entries(o);for(const[c,u]of a){const d=r[c];d!=null&&(r[c]=d+n*u)}return r},{...e})}}const Zl=FE(1),Pg=FE(-1);function sR(n){return"clientX"in n&&"clientY"in n}function jE(n){if(!n)return!1;const{KeyboardEvent:e}=xn(n.target);return e&&n instanceof e}function iR(n){if(!n)return!1;const{TouchEvent:e}=xn(n.target);return e&&n instanceof e}function bv(n){if(iR(n)){if(n.touches&&n.touches.length){const{clientX:e,clientY:t}=n.touches[0];return{x:e,y:t}}else if(n.changedTouches&&n.changedTouches.length){const{clientX:e,clientY:t}=n.changedTouches[0];return{x:e,y:t}}}return sR(n)?{x:n.clientX,y:n.clientY}:null}const EA="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function rR(n){return n.matches(EA)?n:n.querySelector(EA)}const oR={display:"none"};function aR(n){let{id:e,value:t}=n;return yn.createElement("div",{id:e,style:oR},t)}function lR(n){let{id:e,announcement:t,ariaLiveType:s="assertive"}=n;const i={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return yn.createElement("div",{id:e,style:i,role:"status","aria-live":s,"aria-atomic":!0},t)}function cR(){const[n,e]=R.useState("");return{announce:R.useCallback(s=>{s!=null&&e(s)},[]),announcement:n}}const zE=R.createContext(null);function uR(n){const e=R.useContext(zE);R.useEffect(()=>{if(!e)throw new Error("useDndMonitor must be used within a children of <DndContext>");return e(n)},[n,e])}function dR(){const[n]=R.useState(()=>new Set),e=R.useCallback(s=>(n.add(s),()=>n.delete(s)),[n]);return[R.useCallback(s=>{let{type:i,event:r}=s;n.forEach(o=>{var a;return(a=o[i])==null?void 0:a.call(o,r)})},[n]),e]}const hR={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},fR={onDragStart(n){let{active:e}=n;return"Picked up draggable item "+e.id+"."},onDragOver(n){let{active:e,over:t}=n;return t?"Draggable item "+e.id+" was moved over droppable area "+t.id+".":"Draggable item "+e.id+" is no longer over a droppable area."},onDragEnd(n){let{active:e,over:t}=n;return t?"Draggable item "+e.id+" was dropped over droppable area "+t.id:"Draggable item "+e.id+" was dropped."},onDragCancel(n){let{active:e}=n;return"Dragging was cancelled. Draggable item "+e.id+" was dropped."}};function pR(n){let{announcements:e=fR,container:t,hiddenTextDescribedById:s,screenReaderInstructions:i=hR}=n;const{announce:r,announcement:o}=cR(),a=xm("DndLiveRegion"),[c,u]=R.useState(!1);if(R.useEffect(()=>{u(!0)},[]),uR(R.useMemo(()=>({onDragStart(h){let{active:f}=h;r(e.onDragStart({active:f}))},onDragMove(h){let{active:f,over:p}=h;e.onDragMove&&r(e.onDragMove({active:f,over:p}))},onDragOver(h){let{active:f,over:p}=h;r(e.onDragOver({active:f,over:p}))},onDragEnd(h){let{active:f,over:p}=h;r(e.onDragEnd({active:f,over:p}))},onDragCancel(h){let{active:f,over:p}=h;r(e.onDragCancel({active:f,over:p}))}}),[r,e])),!c)return null;const d=yn.createElement(yn.Fragment,null,yn.createElement(aR,{id:s,value:i.draggable}),yn.createElement(lR,{id:a,announcement:o}));return t?Ul.createPortal(d,t):d}var dt;(function(n){n.DragStart="dragStart",n.DragMove="dragMove",n.DragEnd="dragEnd",n.DragCancel="dragCancel",n.DragOver="dragOver",n.RegisterDroppable="registerDroppable",n.SetDroppableDisabled="setDroppableDisabled",n.UnregisterDroppable="unregisterDroppable"})(dt||(dt={}));function Rg(){}function gR(n,e){return R.useMemo(()=>({sensor:n,options:{}}),[n,e])}function mR(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return R.useMemo(()=>[...e].filter(s=>s!=null),[...e])}const Ws=Object.freeze({x:0,y:0});function yR(n,e){let{data:{value:t}}=n,{data:{value:s}}=e;return s-t}function vR(n,e){if(!n||n.length===0)return null;const[t]=n;return t[e]}function wR(n,e){const t=Math.max(e.top,n.top),s=Math.max(e.left,n.left),i=Math.min(e.left+e.width,n.left+n.width),r=Math.min(e.top+e.height,n.top+n.height),o=i-s,a=r-t;if(s<i&&t<r){const c=e.width*e.height,u=n.width*n.height,d=o*a,h=d/(c+u-d);return Number(h.toFixed(4))}return 0}const bR=n=>{let{collisionRect:e,droppableRects:t,droppableContainers:s}=n;const i=[];for(const r of s){const{id:o}=r,a=t.get(o);if(a){const c=wR(a,e);c>0&&i.push({id:o,data:{droppableContainer:r,value:c}})}}return i.sort(yR)};function AR(n,e,t){return{...n,scaleX:e&&t?e.width/t.width:1,scaleY:e&&t?e.height/t.height:1}}function BE(n,e){return n&&e?{x:n.left-e.left,y:n.top-e.top}:Ws}function SR(n){return function(t){for(var s=arguments.length,i=new Array(s>1?s-1:0),r=1;r<s;r++)i[r-1]=arguments[r];return i.reduce((o,a)=>({...o,top:o.top+n*a.y,bottom:o.bottom+n*a.y,left:o.left+n*a.x,right:o.right+n*a.x}),{...t})}}const xR=SR(1);function ER(n){if(n.startsWith("matrix3d(")){const e=n.slice(9,-1).split(/, /);return{x:+e[12],y:+e[13],scaleX:+e[0],scaleY:+e[5]}}else if(n.startsWith("matrix(")){const e=n.slice(7,-1).split(/, /);return{x:+e[4],y:+e[5],scaleX:+e[0],scaleY:+e[3]}}return null}function _R(n,e,t){const s=ER(e);if(!s)return n;const{scaleX:i,scaleY:r,x:o,y:a}=s,c=n.left-o-(1-i)*parseFloat(t),u=n.top-a-(1-r)*parseFloat(t.slice(t.indexOf(" ")+1)),d=i?n.width/i:n.width,h=r?n.height/r:n.height;return{width:d,height:h,top:u,right:c+d,bottom:u+h,left:c}}const CR={ignoreTransform:!1};function Mf(n,e){e===void 0&&(e=CR);let t=n.getBoundingClientRect();if(e.ignoreTransform){const{transform:u,transformOrigin:d}=xn(n).getComputedStyle(n);u&&(t=_R(t,u,d))}const{top:s,left:i,width:r,height:o,bottom:a,right:c}=t;return{top:s,left:i,width:r,height:o,bottom:a,right:c}}function _A(n){return Mf(n,{ignoreTransform:!0})}function kR(n){const e=n.innerWidth,t=n.innerHeight;return{top:0,left:0,right:e,bottom:t,width:e,height:t}}function TR(n,e){return e===void 0&&(e=xn(n).getComputedStyle(n)),e.position==="fixed"}function PR(n,e){e===void 0&&(e=xn(n).getComputedStyle(n));const t=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(i=>{const r=e[i];return typeof r=="string"?t.test(r):!1})}function Fw(n,e){const t=[];function s(i){if(e!=null&&t.length>=e||!i)return t;if(Iw(i)&&i.scrollingElement!=null&&!t.includes(i.scrollingElement))return t.push(i.scrollingElement),t;if(!Rf(i)||OE(i)||t.includes(i))return t;const r=xn(n).getComputedStyle(i);return i!==n&&PR(i,r)&&t.push(i),TR(i,r)?t:s(i.parentNode)}return n?s(n):t}function $E(n){const[e]=Fw(n,1);return e??null}function gy(n){return!Sm||!n?null:Eu(n)?n:Nw(n)?Iw(n)||n===_u(n).scrollingElement?window:Rf(n)?n:null:null}function HE(n){return Eu(n)?n.scrollX:n.scrollLeft}function UE(n){return Eu(n)?n.scrollY:n.scrollTop}function Av(n){return{x:HE(n),y:UE(n)}}var St;(function(n){n[n.Forward=1]="Forward",n[n.Backward=-1]="Backward"})(St||(St={}));function VE(n){return!Sm||!n?!1:n===document.scrollingElement}function GE(n){const e={x:0,y:0},t=VE(n)?{height:window.innerHeight,width:window.innerWidth}:{height:n.clientHeight,width:n.clientWidth},s={x:n.scrollWidth-t.width,y:n.scrollHeight-t.height},i=n.scrollTop<=e.y,r=n.scrollLeft<=e.x,o=n.scrollTop>=s.y,a=n.scrollLeft>=s.x;return{isTop:i,isLeft:r,isBottom:o,isRight:a,maxScroll:s,minScroll:e}}const RR={x:.2,y:.2};function LR(n,e,t,s,i){let{top:r,left:o,right:a,bottom:c}=t;s===void 0&&(s=10),i===void 0&&(i=RR);const{isTop:u,isBottom:d,isLeft:h,isRight:f}=GE(n),p={x:0,y:0},v={x:0,y:0},g={height:e.height*i.y,width:e.width*i.x};return!u&&r<=e.top+g.height?(p.y=St.Backward,v.y=s*Math.abs((e.top+g.height-r)/g.height)):!d&&c>=e.bottom-g.height&&(p.y=St.Forward,v.y=s*Math.abs((e.bottom-g.height-c)/g.height)),!f&&a>=e.right-g.width?(p.x=St.Forward,v.x=s*Math.abs((e.right-g.width-a)/g.width)):!h&&o<=e.left+g.width&&(p.x=St.Backward,v.x=s*Math.abs((e.left+g.width-o)/g.width)),{direction:p,speed:v}}function MR(n){if(n===document.scrollingElement){const{innerWidth:r,innerHeight:o}=window;return{top:0,left:0,right:r,bottom:o,width:r,height:o}}const{top:e,left:t,right:s,bottom:i}=n.getBoundingClientRect();return{top:e,left:t,right:s,bottom:i,width:n.clientWidth,height:n.clientHeight}}function WE(n){return n.reduce((e,t)=>Zl(e,Av(t)),Ws)}function DR(n){return n.reduce((e,t)=>e+HE(t),0)}function NR(n){return n.reduce((e,t)=>e+UE(t),0)}function IR(n,e){if(e===void 0&&(e=Mf),!n)return;const{top:t,left:s,bottom:i,right:r}=e(n);$E(n)&&(i<=0||r<=0||t>=window.innerHeight||s>=window.innerWidth)&&n.scrollIntoView({block:"center",inline:"center"})}const OR=[["x",["left","right"],DR],["y",["top","bottom"],NR]];class jw{constructor(e,t){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const s=Fw(t),i=WE(s);this.rect={...e},this.width=e.width,this.height=e.height;for(const[r,o,a]of OR)for(const c of o)Object.defineProperty(this,c,{get:()=>{const u=a(s),d=i[r]-u;return this.rect[c]+d},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Ad{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(t=>{var s;return(s=this.target)==null?void 0:s.removeEventListener(...t)})},this.target=e}add(e,t,s){var i;(i=this.target)==null||i.addEventListener(e,t,s),this.listeners.push([e,t,s])}}function FR(n){const{EventTarget:e}=xn(n);return n instanceof e?n:_u(n)}function my(n,e){const t=Math.abs(n.x),s=Math.abs(n.y);return typeof e=="number"?Math.sqrt(t**2+s**2)>e:"x"in e&&"y"in e?t>e.x&&s>e.y:"x"in e?t>e.x:"y"in e?s>e.y:!1}var ds;(function(n){n.Click="click",n.DragStart="dragstart",n.Keydown="keydown",n.ContextMenu="contextmenu",n.Resize="resize",n.SelectionChange="selectionchange",n.VisibilityChange="visibilitychange"})(ds||(ds={}));function CA(n){n.preventDefault()}function jR(n){n.stopPropagation()}var ke;(function(n){n.Space="Space",n.Down="ArrowDown",n.Right="ArrowRight",n.Left="ArrowLeft",n.Up="ArrowUp",n.Esc="Escape",n.Enter="Enter",n.Tab="Tab"})(ke||(ke={}));const XE={start:[ke.Space,ke.Enter],cancel:[ke.Esc],end:[ke.Space,ke.Enter,ke.Tab]},zR=(n,e)=>{let{currentCoordinates:t}=e;switch(n.code){case ke.Right:return{...t,x:t.x+25};case ke.Left:return{...t,x:t.x-25};case ke.Down:return{...t,y:t.y+25};case ke.Up:return{...t,y:t.y-25}}};class YE{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:t}}=e;this.props=e,this.listeners=new Ad(_u(t)),this.windowListeners=new Ad(xn(t)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(ds.Resize,this.handleCancel),this.windowListeners.add(ds.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(ds.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:e,onStart:t}=this.props,s=e.node.current;s&&IR(s),t(Ws)}handleKeyDown(e){if(jE(e)){const{active:t,context:s,options:i}=this.props,{keyboardCodes:r=XE,coordinateGetter:o=zR,scrollBehavior:a="smooth"}=i,{code:c}=e;if(r.end.includes(c)){this.handleEnd(e);return}if(r.cancel.includes(c)){this.handleCancel(e);return}const{collisionRect:u}=s.current,d=u?{x:u.left,y:u.top}:Ws;this.referenceCoordinates||(this.referenceCoordinates=d);const h=o(e,{active:t,context:s.current,currentCoordinates:d});if(h){const f=Pg(h,d),p={x:0,y:0},{scrollableAncestors:v}=s.current;for(const g of v){const x=e.code,{isTop:y,isRight:w,isLeft:b,isBottom:E,maxScroll:_,minScroll:k}=GE(g),C=MR(g),P={x:Math.min(x===ke.Right?C.right-C.width/2:C.right,Math.max(x===ke.Right?C.left:C.left+C.width/2,h.x)),y:Math.min(x===ke.Down?C.bottom-C.height/2:C.bottom,Math.max(x===ke.Down?C.top:C.top+C.height/2,h.y))},L=x===ke.Right&&!w||x===ke.Left&&!b,M=x===ke.Down&&!E||x===ke.Up&&!y;if(L&&P.x!==h.x){const D=g.scrollLeft+f.x,K=x===ke.Right&&D<=_.x||x===ke.Left&&D>=k.x;if(K&&!f.y){g.scrollTo({left:D,behavior:a});return}K?p.x=g.scrollLeft-D:p.x=x===ke.Right?g.scrollLeft-_.x:g.scrollLeft-k.x,p.x&&g.scrollBy({left:-p.x,behavior:a});break}else if(M&&P.y!==h.y){const D=g.scrollTop+f.y,K=x===ke.Down&&D<=_.y||x===ke.Up&&D>=k.y;if(K&&!f.x){g.scrollTo({top:D,behavior:a});return}K?p.y=g.scrollTop-D:p.y=x===ke.Down?g.scrollTop-_.y:g.scrollTop-k.y,p.y&&g.scrollBy({top:-p.y,behavior:a});break}}this.handleMove(e,Zl(Pg(h,this.referenceCoordinates),p))}}}handleMove(e,t){const{onMove:s}=this.props;e.preventDefault(),s(t)}handleEnd(e){const{onEnd:t}=this.props;e.preventDefault(),this.detach(),t()}handleCancel(e){const{onCancel:t}=this.props;e.preventDefault(),this.detach(),t()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}YE.activators=[{eventName:"onKeyDown",handler:(n,e,t)=>{let{keyboardCodes:s=XE,onActivation:i}=e,{active:r}=t;const{code:o}=n.nativeEvent;if(s.start.includes(o)){const a=r.activatorNode.current;return a&&n.target!==a?!1:(n.preventDefault(),i==null||i({event:n.nativeEvent}),!0)}return!1}}];function kA(n){return!!(n&&"distance"in n)}function TA(n){return!!(n&&"delay"in n)}class zw{constructor(e,t,s){var i;s===void 0&&(s=FR(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=t;const{event:r}=e,{target:o}=r;this.props=e,this.events=t,this.document=_u(o),this.documentListeners=new Ad(this.document),this.listeners=new Ad(s),this.windowListeners=new Ad(xn(o)),this.initialCoordinates=(i=bv(r))!=null?i:Ws,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:t,bypassActivationConstraint:s}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(ds.Resize,this.handleCancel),this.windowListeners.add(ds.DragStart,CA),this.windowListeners.add(ds.VisibilityChange,this.handleCancel),this.windowListeners.add(ds.ContextMenu,CA),this.documentListeners.add(ds.Keydown,this.handleKeydown),t){if(s!=null&&s({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(TA(t)){this.timeoutId=setTimeout(this.handleStart,t.delay),this.handlePending(t);return}if(kA(t)){this.handlePending(t);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,t){const{active:s,onPending:i}=this.props;i(s,e,this.initialCoordinates,t)}handleStart(){const{initialCoordinates:e}=this,{onStart:t}=this.props;e&&(this.activated=!0,this.documentListeners.add(ds.Click,jR,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(ds.SelectionChange,this.removeTextSelection),t(e))}handleMove(e){var t;const{activated:s,initialCoordinates:i,props:r}=this,{onMove:o,options:{activationConstraint:a}}=r;if(!i)return;const c=(t=bv(e))!=null?t:Ws,u=Pg(i,c);if(!s&&a){if(kA(a)){if(a.tolerance!=null&&my(u,a.tolerance))return this.handleCancel();if(my(u,a.distance))return this.handleStart()}if(TA(a)&&my(u,a.tolerance))return this.handleCancel();this.handlePending(a,u);return}e.cancelable&&e.preventDefault(),o(c)}handleEnd(){const{onAbort:e,onEnd:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleCancel(){const{onAbort:e,onCancel:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleKeydown(e){e.code===ke.Esc&&this.handleCancel()}removeTextSelection(){var e;(e=this.document.getSelection())==null||e.removeAllRanges()}}const BR={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class Bw extends zw{constructor(e){const{event:t}=e,s=_u(t.target);super(e,BR,s)}}Bw.activators=[{eventName:"onPointerDown",handler:(n,e)=>{let{nativeEvent:t}=n,{onActivation:s}=e;return!t.isPrimary||t.button!==0?!1:(s==null||s({event:t}),!0)}}];const $R={move:{name:"mousemove"},end:{name:"mouseup"}};var Sv;(function(n){n[n.RightClick=2]="RightClick"})(Sv||(Sv={}));class HR extends zw{constructor(e){super(e,$R,_u(e.event.target))}}HR.activators=[{eventName:"onMouseDown",handler:(n,e)=>{let{nativeEvent:t}=n,{onActivation:s}=e;return t.button===Sv.RightClick?!1:(s==null||s({event:t}),!0)}}];const yy={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class UR extends zw{constructor(e){super(e,yy)}static setup(){return window.addEventListener(yy.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(yy.move.name,e)};function e(){}}}UR.activators=[{eventName:"onTouchStart",handler:(n,e)=>{let{nativeEvent:t}=n,{onActivation:s}=e;const{touches:i}=t;return i.length>1?!1:(s==null||s({event:t}),!0)}}];var Sd;(function(n){n[n.Pointer=0]="Pointer",n[n.DraggableRect=1]="DraggableRect"})(Sd||(Sd={}));var Lg;(function(n){n[n.TreeOrder=0]="TreeOrder",n[n.ReversedTreeOrder=1]="ReversedTreeOrder"})(Lg||(Lg={}));function VR(n){let{acceleration:e,activator:t=Sd.Pointer,canScroll:s,draggingRect:i,enabled:r,interval:o=5,order:a=Lg.TreeOrder,pointerCoordinates:c,scrollableAncestors:u,scrollableAncestorRects:d,delta:h,threshold:f}=n;const p=WR({delta:h,disabled:!r}),[v,g]=nR(),x=R.useRef({x:0,y:0}),y=R.useRef({x:0,y:0}),w=R.useMemo(()=>{switch(t){case Sd.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case Sd.DraggableRect:return i}},[t,i,c]),b=R.useRef(null),E=R.useCallback(()=>{const k=b.current;if(!k)return;const C=x.current.x*y.current.x,P=x.current.y*y.current.y;k.scrollBy(C,P)},[]),_=R.useMemo(()=>a===Lg.TreeOrder?[...u].reverse():u,[a,u]);R.useEffect(()=>{if(!r||!u.length||!w){g();return}for(const k of _){if((s==null?void 0:s(k))===!1)continue;const C=u.indexOf(k),P=d[C];if(!P)continue;const{direction:L,speed:M}=LR(k,P,w,e,f);for(const D of["x","y"])p[D][L[D]]||(M[D]=0,L[D]=0);if(M.x>0||M.y>0){g(),b.current=k,v(E,o),x.current=M,y.current=L;return}}x.current={x:0,y:0},y.current={x:0,y:0},g()},[e,E,s,g,r,o,JSON.stringify(w),JSON.stringify(p),v,u,_,d,JSON.stringify(f)])}const GR={x:{[St.Backward]:!1,[St.Forward]:!1},y:{[St.Backward]:!1,[St.Forward]:!1}};function WR(n){let{delta:e,disabled:t}=n;const s=wv(e);return Lf(i=>{if(t||!s||!i)return GR;const r={x:Math.sign(e.x-s.x),y:Math.sign(e.y-s.y)};return{x:{[St.Backward]:i.x[St.Backward]||r.x===-1,[St.Forward]:i.x[St.Forward]||r.x===1},y:{[St.Backward]:i.y[St.Backward]||r.y===-1,[St.Forward]:i.y[St.Forward]||r.y===1}}},[t,e,s])}function XR(n,e){const t=e!=null?n.get(e):void 0,s=t?t.node.current:null;return Lf(i=>{var r;return e==null?null:(r=s??i)!=null?r:null},[s,e])}function YR(n,e){return R.useMemo(()=>n.reduce((t,s)=>{const{sensor:i}=s,r=i.activators.map(o=>({eventName:o.eventName,handler:e(o.handler,s)}));return[...t,...r]},[]),[n,e])}var Ud;(function(n){n[n.Always=0]="Always",n[n.BeforeDragging=1]="BeforeDragging",n[n.WhileDragging=2]="WhileDragging"})(Ud||(Ud={}));var xv;(function(n){n.Optimized="optimized"})(xv||(xv={}));const PA=new Map;function qR(n,e){let{dragging:t,dependencies:s,config:i}=e;const[r,o]=R.useState(null),{frequency:a,measure:c,strategy:u}=i,d=R.useRef(n),h=x(),f=Hd(h),p=R.useCallback(function(y){y===void 0&&(y=[]),!f.current&&o(w=>w===null?y:w.concat(y.filter(b=>!w.includes(b))))},[f]),v=R.useRef(null),g=Lf(y=>{if(h&&!t)return PA;if(!y||y===PA||d.current!==n||r!=null){const w=new Map;for(let b of n){if(!b)continue;if(r&&r.length>0&&!r.includes(b.id)&&b.rect.current){w.set(b.id,b.rect.current);continue}const E=b.node.current,_=E?new jw(c(E),E):null;b.rect.current=_,_&&w.set(b.id,_)}return w}return y},[n,r,t,h,c]);return R.useEffect(()=>{d.current=n},[n]),R.useEffect(()=>{h||p()},[t,h]),R.useEffect(()=>{r&&r.length>0&&o(null)},[JSON.stringify(r)]),R.useEffect(()=>{h||typeof a!="number"||v.current!==null||(v.current=setTimeout(()=>{p(),v.current=null},a))},[a,h,p,...s]),{droppableRects:g,measureDroppableContainers:p,measuringScheduled:r!=null};function x(){switch(u){case Ud.Always:return!1;case Ud.BeforeDragging:return t;default:return!t}}}function qE(n,e){return Lf(t=>n?t||(typeof e=="function"?e(n):n):null,[e,n])}function KR(n,e){return qE(n,e)}function QR(n){let{callback:e,disabled:t}=n;const s=Ow(e),i=R.useMemo(()=>{if(t||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:r}=window;return new r(s)},[s,t]);return R.useEffect(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function Em(n){let{callback:e,disabled:t}=n;const s=Ow(e),i=R.useMemo(()=>{if(t||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:r}=window;return new r(s)},[t]);return R.useEffect(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function JR(n){return new jw(Mf(n),n)}function RA(n,e,t){e===void 0&&(e=JR);const[s,i]=R.useState(null);function r(){i(c=>{if(!n)return null;if(n.isConnected===!1){var u;return(u=c??t)!=null?u:null}const d=e(n);return JSON.stringify(c)===JSON.stringify(d)?c:d})}const o=QR({callback(c){if(n)for(const u of c){const{type:d,target:h}=u;if(d==="childList"&&h instanceof HTMLElement&&h.contains(n)){r();break}}}}),a=Em({callback:r});return Io(()=>{r(),n?(a==null||a.observe(n),o==null||o.observe(document.body,{childList:!0,subtree:!0})):(a==null||a.disconnect(),o==null||o.disconnect())},[n]),s}function ZR(n){const e=qE(n);return BE(n,e)}const LA=[];function eL(n){const e=R.useRef(n),t=Lf(s=>n?s&&s!==LA&&n&&e.current&&n.parentNode===e.current.parentNode?s:Fw(n):LA,[n]);return R.useEffect(()=>{e.current=n},[n]),t}function tL(n){const[e,t]=R.useState(null),s=R.useRef(n),i=R.useCallback(r=>{const o=gy(r.target);o&&t(a=>a?(a.set(o,Av(o)),new Map(a)):null)},[]);return R.useEffect(()=>{const r=s.current;if(n!==r){o(r);const a=n.map(c=>{const u=gy(c);return u?(u.addEventListener("scroll",i,{passive:!0}),[u,Av(u)]):null}).filter(c=>c!=null);t(a.length?new Map(a):null),s.current=n}return()=>{o(n),o(r)};function o(a){a.forEach(c=>{const u=gy(c);u==null||u.removeEventListener("scroll",i)})}},[i,n]),R.useMemo(()=>n.length?e?Array.from(e.values()).reduce((r,o)=>Zl(r,o),Ws):WE(n):Ws,[n,e])}function MA(n,e){e===void 0&&(e=[]);const t=R.useRef(null);return R.useEffect(()=>{t.current=null},e),R.useEffect(()=>{const s=n!==Ws;s&&!t.current&&(t.current=n),!s&&t.current&&(t.current=null)},[n]),t.current?Pg(n,t.current):Ws}function nL(n){R.useEffect(()=>{if(!Sm)return;const e=n.map(t=>{let{sensor:s}=t;return s.setup==null?void 0:s.setup()});return()=>{for(const t of e)t==null||t()}},n.map(e=>{let{sensor:t}=e;return t}))}function sL(n,e){return R.useMemo(()=>n.reduce((t,s)=>{let{eventName:i,handler:r}=s;return t[i]=o=>{r(o,e)},t},{}),[n,e])}function KE(n){return R.useMemo(()=>n?kR(n):null,[n])}const DA=[];function iL(n,e){e===void 0&&(e=Mf);const[t]=n,s=KE(t?xn(t):null),[i,r]=R.useState(DA);function o(){r(()=>n.length?n.map(c=>VE(c)?s:new jw(e(c),c)):DA)}const a=Em({callback:o});return Io(()=>{a==null||a.disconnect(),o(),n.forEach(c=>a==null?void 0:a.observe(c))},[n]),i}function rL(n){if(!n)return null;if(n.children.length>1)return n;const e=n.children[0];return Rf(e)?e:n}function oL(n){let{measure:e}=n;const[t,s]=R.useState(null),i=R.useCallback(u=>{for(const{target:d}of u)if(Rf(d)){s(h=>{const f=e(d);return h?{...h,width:f.width,height:f.height}:f});break}},[e]),r=Em({callback:i}),o=R.useCallback(u=>{const d=rL(u);r==null||r.disconnect(),d&&(r==null||r.observe(d)),s(d?e(d):null)},[e,r]),[a,c]=Tg(o);return R.useMemo(()=>({nodeRef:a,rect:t,setRef:c}),[t,a,c])}const aL=[{sensor:Bw,options:{}},{sensor:YE,options:{}}],lL={current:{}},Cp={draggable:{measure:_A},droppable:{measure:_A,strategy:Ud.WhileDragging,frequency:xv.Optimized},dragOverlay:{measure:Mf}};class xd extends Map{get(e){var t;return e!=null&&(t=super.get(e))!=null?t:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:t}=e;return!t})}getNodeFor(e){var t,s;return(t=(s=this.get(e))==null?void 0:s.node.current)!=null?t:void 0}}const cL={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new xd,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Rg},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Cp,measureDroppableContainers:Rg,windowRect:null,measuringScheduled:!1},uL={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Rg,draggableNodes:new Map,over:null,measureDroppableContainers:Rg},_m=R.createContext(uL),dL=R.createContext(cL);function hL(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new xd}}}function fL(n,e){switch(e.type){case dt.DragStart:return{...n,draggable:{...n.draggable,initialCoordinates:e.initialCoordinates,active:e.active}};case dt.DragMove:return n.draggable.active==null?n:{...n,draggable:{...n.draggable,translate:{x:e.coordinates.x-n.draggable.initialCoordinates.x,y:e.coordinates.y-n.draggable.initialCoordinates.y}}};case dt.DragEnd:case dt.DragCancel:return{...n,draggable:{...n.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case dt.RegisterDroppable:{const{element:t}=e,{id:s}=t,i=new xd(n.droppable.containers);return i.set(s,t),{...n,droppable:{...n.droppable,containers:i}}}case dt.SetDroppableDisabled:{const{id:t,key:s,disabled:i}=e,r=n.droppable.containers.get(t);if(!r||s!==r.key)return n;const o=new xd(n.droppable.containers);return o.set(t,{...r,disabled:i}),{...n,droppable:{...n.droppable,containers:o}}}case dt.UnregisterDroppable:{const{id:t,key:s}=e,i=n.droppable.containers.get(t);if(!i||s!==i.key)return n;const r=new xd(n.droppable.containers);return r.delete(t),{...n,droppable:{...n.droppable,containers:r}}}default:return n}}function pL(n){let{disabled:e}=n;const{active:t,activatorEvent:s,draggableNodes:i}=R.useContext(_m),r=wv(s),o=wv(t==null?void 0:t.id);return R.useEffect(()=>{if(!e&&!s&&r&&o!=null){if(!jE(r)||document.activeElement===r.target)return;const a=i.get(o);if(!a)return;const{activatorNode:c,node:u}=a;if(!c.current&&!u.current)return;requestAnimationFrame(()=>{for(const d of[c.current,u.current]){if(!d)continue;const h=rR(d);if(h){h.focus();break}}})}},[s,e,i,o,r]),null}function gL(n,e){let{transform:t,...s}=e;return n!=null&&n.length?n.reduce((i,r)=>r({transform:i,...s}),t):t}function mL(n){return R.useMemo(()=>({draggable:{...Cp.draggable,...n==null?void 0:n.draggable},droppable:{...Cp.droppable,...n==null?void 0:n.droppable},dragOverlay:{...Cp.dragOverlay,...n==null?void 0:n.dragOverlay}}),[n==null?void 0:n.draggable,n==null?void 0:n.droppable,n==null?void 0:n.dragOverlay])}function yL(n){let{activeNode:e,measure:t,initialRect:s,config:i=!0}=n;const r=R.useRef(!1),{x:o,y:a}=typeof i=="boolean"?{x:i,y:i}:i;Io(()=>{if(!o&&!a||!e){r.current=!1;return}if(r.current||!s)return;const u=e==null?void 0:e.node.current;if(!u||u.isConnected===!1)return;const d=t(u),h=BE(d,s);if(o||(h.x=0),a||(h.y=0),r.current=!0,Math.abs(h.x)>0||Math.abs(h.y)>0){const f=$E(u);f&&f.scrollBy({top:h.y,left:h.x})}},[e,o,a,s,t])}const QE=R.createContext({...Ws,scaleX:1,scaleY:1});var Or;(function(n){n[n.Uninitialized=0]="Uninitialized",n[n.Initializing=1]="Initializing",n[n.Initialized=2]="Initialized"})(Or||(Or={}));const vL=R.memo(function(e){var t,s,i,r;let{id:o,accessibility:a,autoScroll:c=!0,children:u,sensors:d=aL,collisionDetection:h=bR,measuring:f,modifiers:p,...v}=e;const g=R.useReducer(fL,void 0,hL),[x,y]=g,[w,b]=dR(),[E,_]=R.useState(Or.Uninitialized),k=E===Or.Initialized,{draggable:{active:C,nodes:P,translate:L},droppable:{containers:M}}=x,D=C!=null?P.get(C):null,K=R.useRef({initial:null,translated:null}),Q=R.useMemo(()=>{var jt;return C!=null?{id:C,data:(jt=D==null?void 0:D.data)!=null?jt:lL,rect:K}:null},[C,D]),G=R.useRef(null),[te,j]=R.useState(null),[O,I]=R.useState(null),$=Hd(v,Object.values(v)),X=xm("DndDescribedBy",o),re=R.useMemo(()=>M.getEnabled(),[M]),J=mL(f),{droppableRects:oe,measureDroppableContainers:Pe,measuringScheduled:We}=qR(re,{dragging:k,dependencies:[L.x,L.y],config:J.droppable}),he=XR(P,C),fe=R.useMemo(()=>O?bv(O):null,[O]),En=RC(),_n=KR(he,J.draggable.measure);yL({activeNode:C!=null?P.get(C):null,config:En.layoutShiftCompensation,initialRect:_n,measure:J.draggable.measure});const ue=RA(he,J.draggable.measure,_n),Cn=RA(he?he.parentElement:null),_t=R.useRef({activatorEvent:null,active:null,activeNode:he,collisionRect:null,collisions:null,droppableRects:oe,draggableNodes:P,draggingNode:null,draggingNodeRect:null,droppableContainers:M,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),pt=M.getNodeFor((t=_t.current.over)==null?void 0:t.id),pe=oL({measure:J.dragOverlay.measure}),Be=(s=pe.nodeRef.current)!=null?s:he,Se=k?(i=pe.rect)!=null?i:ue:null,Ss=!!(pe.nodeRef.current&&pe.rect),Ti=ZR(Ss?null:ue),Pi=KE(Be?xn(Be):null),qs=eL(k?pt??he:null),Ri=iL(qs),bl=gL(p,{transform:{x:L.x-Ti.x,y:L.y-Ti.y,scaleX:1,scaleY:1},activatorEvent:O,active:Q,activeNodeRect:ue,containerNodeRect:Cn,draggingNodeRect:Se,over:_t.current.over,overlayNodeRect:pe.rect,scrollableAncestors:qs,scrollableAncestorRects:Ri,windowRect:Pi}),Hf=fe?Zl(fe,L):null,Uf=tL(qs),Om=MA(Uf),Fm=MA(Uf,[ue]),kn=Zl(bl,Om),xs=Se?xR(Se,bl):null,Ks=Q&&xs?h({active:Q,collisionRect:xs,droppableRects:oe,droppableContainers:re,pointerCoordinates:Hf}):null,Al=vR(Ks,"id"),[Tr,ob]=R.useState(null),_C=Ss?bl:Zl(bl,Fm),CC=AR(_C,(r=Tr==null?void 0:Tr.rect)!=null?r:null,ue),jm=R.useRef(null),ab=R.useCallback((jt,Tn)=>{let{sensor:Pn,options:Pr}=Tn;if(G.current==null)return;const ts=P.get(G.current);if(!ts)return;const Rn=jt.nativeEvent,Qs=new Pn({active:G.current,activeNode:ts,event:Rn,options:Pr,context:_t,onAbort(Ct){if(!P.get(Ct))return;const{onDragAbort:Js}=$.current,Li={id:Ct};Js==null||Js(Li),w({type:"onDragAbort",event:Li})},onPending(Ct,Rr,Js,Li){if(!P.get(Ct))return;const{onDragPending:Tu}=$.current,Lr={id:Ct,constraint:Rr,initialCoordinates:Js,offset:Li};Tu==null||Tu(Lr),w({type:"onDragPending",event:Lr})},onStart(Ct){const Rr=G.current;if(Rr==null)return;const Js=P.get(Rr);if(!Js)return;const{onDragStart:Li}=$.current,ku={activatorEvent:Rn,active:{id:Rr,data:Js.data,rect:K}};Ul.unstable_batchedUpdates(()=>{Li==null||Li(ku),_(Or.Initializing),y({type:dt.DragStart,initialCoordinates:Ct,active:Rr}),w({type:"onDragStart",event:ku}),j(jm.current),I(Rn)})},onMove(Ct){y({type:dt.DragMove,coordinates:Ct})},onEnd:Sl(dt.DragEnd),onCancel:Sl(dt.DragCancel)});jm.current=Qs;function Sl(Ct){return async function(){const{active:Js,collisions:Li,over:ku,scrollAdjustedTranslate:Tu}=_t.current;let Lr=null;if(Js&&Tu){const{cancelDrop:Pu}=$.current;Lr={activatorEvent:Rn,active:Js,collisions:Li,delta:Tu,over:ku},Ct===dt.DragEnd&&typeof Pu=="function"&&await Promise.resolve(Pu(Lr))&&(Ct=dt.DragCancel)}G.current=null,Ul.unstable_batchedUpdates(()=>{y({type:Ct}),_(Or.Uninitialized),ob(null),j(null),I(null),jm.current=null;const Pu=Ct===dt.DragEnd?"onDragEnd":"onDragCancel";if(Lr){const zm=$.current[Pu];zm==null||zm(Lr),w({type:Pu,event:Lr})}})}}},[P]),kC=R.useCallback((jt,Tn)=>(Pn,Pr)=>{const ts=Pn.nativeEvent,Rn=P.get(Pr);if(G.current!==null||!Rn||ts.dndKit||ts.defaultPrevented)return;const Qs={active:Rn};jt(Pn,Tn.options,Qs)===!0&&(ts.dndKit={capturedBy:Tn.sensor},G.current=Pr,ab(Pn,Tn))},[P,ab]),lb=YR(d,kC);nL(d),Io(()=>{ue&&E===Or.Initializing&&_(Or.Initialized)},[ue,E]),R.useEffect(()=>{const{onDragMove:jt}=$.current,{active:Tn,activatorEvent:Pn,collisions:Pr,over:ts}=_t.current;if(!Tn||!Pn)return;const Rn={active:Tn,activatorEvent:Pn,collisions:Pr,delta:{x:kn.x,y:kn.y},over:ts};Ul.unstable_batchedUpdates(()=>{jt==null||jt(Rn),w({type:"onDragMove",event:Rn})})},[kn.x,kn.y]),R.useEffect(()=>{const{active:jt,activatorEvent:Tn,collisions:Pn,droppableContainers:Pr,scrollAdjustedTranslate:ts}=_t.current;if(!jt||G.current==null||!Tn||!ts)return;const{onDragOver:Rn}=$.current,Qs=Pr.get(Al),Sl=Qs&&Qs.rect.current?{id:Qs.id,rect:Qs.rect.current,data:Qs.data,disabled:Qs.disabled}:null,Ct={active:jt,activatorEvent:Tn,collisions:Pn,delta:{x:ts.x,y:ts.y},over:Sl};Ul.unstable_batchedUpdates(()=>{ob(Sl),Rn==null||Rn(Ct),w({type:"onDragOver",event:Ct})})},[Al]),Io(()=>{_t.current={activatorEvent:O,active:Q,activeNode:he,collisionRect:xs,collisions:Ks,droppableRects:oe,draggableNodes:P,draggingNode:Be,draggingNodeRect:Se,droppableContainers:M,over:Tr,scrollableAncestors:qs,scrollAdjustedTranslate:kn},K.current={initial:Se,translated:xs}},[Q,he,Ks,xs,P,Be,Se,oe,M,Tr,qs,kn]),VR({...En,delta:L,draggingRect:xs,pointerCoordinates:Hf,scrollableAncestors:qs,scrollableAncestorRects:Ri});const TC=R.useMemo(()=>({active:Q,activeNode:he,activeNodeRect:ue,activatorEvent:O,collisions:Ks,containerNodeRect:Cn,dragOverlay:pe,draggableNodes:P,droppableContainers:M,droppableRects:oe,over:Tr,measureDroppableContainers:Pe,scrollableAncestors:qs,scrollableAncestorRects:Ri,measuringConfiguration:J,measuringScheduled:We,windowRect:Pi}),[Q,he,ue,O,Ks,Cn,pe,P,M,oe,Tr,Pe,qs,Ri,J,We,Pi]),PC=R.useMemo(()=>({activatorEvent:O,activators:lb,active:Q,activeNodeRect:ue,ariaDescribedById:{draggable:X},dispatch:y,draggableNodes:P,over:Tr,measureDroppableContainers:Pe}),[O,lb,Q,ue,y,X,P,Tr,Pe]);return yn.createElement(zE.Provider,{value:b},yn.createElement(_m.Provider,{value:PC},yn.createElement(dL.Provider,{value:TC},yn.createElement(QE.Provider,{value:CC},u)),yn.createElement(pL,{disabled:(a==null?void 0:a.restoreFocus)===!1})),yn.createElement(pR,{...a,hiddenTextDescribedById:X}));function RC(){const jt=(te==null?void 0:te.autoScrollEnabled)===!1,Tn=typeof c=="object"?c.enabled===!1:c===!1,Pn=k&&!jt&&!Tn;return typeof c=="object"?{...c,enabled:Pn}:{enabled:Pn}}}),wL=R.createContext(null),NA="button",bL="Draggable";function JE(n){let{id:e,data:t,disabled:s=!1,attributes:i}=n;const r=xm(bL),{activators:o,activatorEvent:a,active:c,activeNodeRect:u,ariaDescribedById:d,draggableNodes:h,over:f}=R.useContext(_m),{role:p=NA,roleDescription:v="draggable",tabIndex:g=0}=i??{},x=(c==null?void 0:c.id)===e,y=R.useContext(x?QE:wL),[w,b]=Tg(),[E,_]=Tg(),k=sL(o,e),C=Hd(t);Io(()=>(h.set(e,{id:e,key:r,node:w,activatorNode:E,data:C}),()=>{const L=h.get(e);L&&L.key===r&&h.delete(e)}),[h,e]);const P=R.useMemo(()=>({role:p,tabIndex:g,"aria-disabled":s,"aria-pressed":x&&p===NA?!0:void 0,"aria-roledescription":v,"aria-describedby":d.draggable}),[s,p,g,x,v,d.draggable]);return{active:c,activatorEvent:a,activeNodeRect:u,attributes:P,isDragging:x,listeners:s?void 0:k,node:w,over:f,setNodeRef:b,setActivatorNodeRef:_,transform:y}}const AL="Droppable",SL={timeout:25};function ZE(n){let{data:e,disabled:t=!1,id:s,resizeObserverConfig:i}=n;const r=xm(AL),{active:o,dispatch:a,over:c,measureDroppableContainers:u}=R.useContext(_m),d=R.useRef({disabled:t}),h=R.useRef(!1),f=R.useRef(null),p=R.useRef(null),{disabled:v,updateMeasurementsFor:g,timeout:x}={...SL,...i},y=Hd(g??s),w=R.useCallback(()=>{if(!h.current){h.current=!0;return}p.current!=null&&clearTimeout(p.current),p.current=setTimeout(()=>{u(Array.isArray(y.current)?y.current:[y.current]),p.current=null},x)},[x]),b=Em({callback:w,disabled:v||!o}),E=R.useCallback((P,L)=>{b&&(L&&(b.unobserve(L),h.current=!1),P&&b.observe(P))},[b]),[_,k]=Tg(E),C=Hd(e);return R.useEffect(()=>{!b||!_.current||(b.disconnect(),h.current=!1,b.observe(_.current))},[_,b]),R.useEffect(()=>(a({type:dt.RegisterDroppable,element:{id:s,key:r,disabled:t,node:_,rect:f,data:C}}),()=>a({type:dt.UnregisterDroppable,key:r,id:s})),[s]),R.useEffect(()=>{t!==d.current.disabled&&(a({type:dt.SetDroppableDisabled,id:s,key:r,disabled:t}),d.current.disabled=t)},[s,r,t,a]),{active:o,rect:f,isOver:(c==null?void 0:c.id)===s,node:_,over:c,setNodeRef:k}}const ju=(n,e)=>{const t=document.getElementById(`port_${n}_${e}`);if(!t)return null;const s=t.closest(".canvas-area-container");if(!s)return null;const i=s.getBoundingClientRect(),r=t.getBoundingClientRect();return{x:r.left-i.left+r.width/2,y:r.top-i.top+r.height/2}},xL=({pendingLink:n,mousePos:e})=>{const t=q(c=>c.links),s=q(c=>c.ghostLinks||[]),i=q(c=>c.canvasComponents),[,r]=R.useState(0);R.useLayoutEffect(()=>{r(c=>c+1)},[t,i]);const o=t.map(c=>{const u=ju(c.source_id,"output"),d=ju(c.target_id,"input");return!u||!d?null:T.jsx("line",{x1:u.x,y1:u.y,x2:d.x,y2:d.y,className:"stroke-gray-500 stroke-2"},c.id)}).filter(Boolean);let a=null;if(n){const c=ju(n.sourceId,n.portId);c&&(a=T.jsx("line",{x1:c.x,y1:c.y,x2:e.x,y2:e.y,className:"stroke-blue-500 stroke-2 stroke-dasharray-4"}))}return T.jsxs("svg",{className:"absolute top-0 left-0 w-full h-full pointer-events-none",children:[o,s.map(c=>{const u=ju(c.source_id,"output"),d=ju(c.target_id,"input");return!u||!d?null:T.jsx("line",{x1:u.x,y1:u.y,x2:d.x,y2:d.y,className:"stroke-blue-500 stroke-2",strokeDasharray:"4 4"},c.source_id+c.target_id)}),a]})},EL=()=>{const n=q(s=>s.layers),e=q(s=>s.currentLayer),t=q(s=>s.setCurrentLayer);return T.jsx("div",{className:"flex space-x-2 mb-2","aria-label":"Layer selector",children:n.map(s=>T.jsx("button",{onClick:()=>t(s),className:"px-3 py-1 rounded-md text-sm "+(e===s?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:s},s))})},_L=()=>{const n=q(r=>r.pendingActions),e=q(r=>r.approvePendingAction),t=q(r=>r.rejectPendingAction);if(!n.length)return null;const s=q(r=>r.canvasComponents),i=r=>{switch(r.action){case"addComponent":return`Add ${r.payload.type} ${r.payload.name}`;case"removeComponent":{const o=s.find(c=>c.id===r.payload.id);return`Remove ${o?o.name:r.payload.id}`}case"addLink":{const o=s.find(d=>d.id===r.payload.source_id),a=s.find(d=>d.id===r.payload.target_id),c=o?o.name:r.payload.source_id,u=a?a.name:r.payload.target_id;return`Connect ${c} to ${u}`}case"updatePosition":{const o=s.find(c=>c.id===r.payload.id);return`Move ${o?o.name:r.payload.id} to (${r.payload.x}, ${r.payload.y})`}case"report":return"Show bill of materials";case"validation":return r.payload.message||"Validation message";default:return JSON.stringify(r)}};return T.jsxs("div",{className:"p-4 bg-white border border-gray-300 rounded-md shadow-sm mb-4",children:[T.jsx("h3",{className:"font-semibold mb-2",children:"Pending AI Actions"}),T.jsx("ul",{className:"space-y-2",children:n.map((r,o)=>T.jsxs("li",{className:"flex items-center justify-between",children:[T.jsx("span",{className:"text-sm mr-2 flex-1",children:i(r)}),T.jsxs("div",{className:"flex space-x-2",children:[T.jsx("button",{onClick:()=>e(o),className:"px-2 py-1 text-xs rounded-md bg-green-500 text-white hover:bg-green-600",children:"Approve"}),T.jsx("button",{onClick:()=>t(o),className:"px-2 py-1 text-xs rounded-md bg-red-500 text-white hover:bg-red-600",children:"Reject"})]})]},o))})]})};function e1(n){var e,t,s="";if(typeof n=="string"||typeof n=="number")s+=n;else if(typeof n=="object")if(Array.isArray(n)){var i=n.length;for(e=0;e<i;e++)n[e]&&(t=e1(n[e]))&&(s&&(s+=" "),s+=t)}else for(t in n)n[t]&&(s&&(s+=" "),s+=t);return s}function _i(){for(var n,e,t=0,s="",i=arguments.length;t<i;t++)(n=arguments[t])&&(e=e1(n))&&(s&&(s+=" "),s+=e);return s}const CL=({id:n,port:e,isPending:t,onMouseDown:s,onMouseUp:i})=>{const r=e.type==="in";return T.jsx("div",{id:n,onMouseDown:o=>{o.stopPropagation(),s(e.id,o)},onMouseUp:o=>{o.stopPropagation(),i(e.id,o)},className:_i("absolute top-1/2 -translate-y-1/2 w-4 h-4 rounded-full border-2 border-white cursor-crosshair z-10 transition-transform",{" -left-2 bg-green-400":r," -right-2 bg-red-400":!r,"transform scale-150 shadow-lg":t})})},kL=({component:n,isPendingLinkSource:e,onStartLink:t,onEndLink:s})=>{const{selectedComponentId:i,selectComponent:r,deleteComponent:o}=q(),a=i===n.id,{attributes:c,listeners:u,setNodeRef:d,transform:h}=JE({id:n.id,data:{type:"canvas-card"}}),f={top:n.y,left:n.x,transform:h?`translate3d(${h.x}px, ${h.y}px, 0)`:void 0,position:"absolute"};return T.jsxs("div",{id:`component-card-${n.id}`,ref:d,style:f,onClick:()=>r(n.id),onContextMenu:p=>{p.preventDefault(),window.confirm(`Are you sure you want to delete "${n.name}"?`)&&o(n.id)},className:_i("absolute h-24 w-32 bg-white border-2 rounded-lg shadow-sm flex flex-col items-center justify-center p-2 cursor-grab",{"border-blue-500 ring-2 ring-blue-500":a,"border-gray-300":!a}),children:[T.jsx("div",{...u,...c,className:"w-full h-full cursor-grab"}),T.jsxs("div",{className:"absolute top-0 left-0 w-full h-full flex flex-col items-center justify-center pointer-events-none",children:[T.jsx("span",{className:"text-sm font-bold",children:n.name}),T.jsx("span",{className:"text-xs text-gray-500",children:n.type})]}),n.ports.map(p=>T.jsx(CL,{id:`port_${n.id}_${p.id}`,port:p,isPending:e&&p.id==="output",onMouseDown:v=>t(n.id,v),onMouseUp:v=>s(n.id,v)},p.id))]})},TL=({pendingLinkSourceId:n,onStartLink:e,onEndLink:t})=>{const{setNodeRef:s}=ZE({id:"canvas-area"}),i=q(a=>a.currentLayer),o=q(a=>a.canvasComponents).filter(a=>!a.layer||a.layer===i);return T.jsx("div",{className:"flex-grow h-full relative",children:T.jsx("div",{ref:s,className:"canvas-area-container w-full h-full border-2 border-dashed border-gray-300 rounded-lg",children:o.map(a=>T.jsx(kL,{component:a,isPendingLinkSource:n===a.id,onStartLink:e,onEndLink:t},a.id))})})},PL=()=>{const{addComponent:n,updateComponentPosition:e,addLink:t,fetchProject:s,selectedComponentId:i,deleteComponent:r}=q();R.useEffect(()=>{s()},[s]),R.useEffect(()=>{const v=g=>{(g.key==="Delete"||g.key==="Backspace")&&i&&r(i)};return window.addEventListener("keydown",v),()=>window.removeEventListener("keydown",v)},[i,r]);const[o,a]=R.useState(null),[c,u]=R.useState({x:0,y:0}),d=(v,g)=>{g==="output"&&a({sourceId:v,portId:g})},h=async(v,g)=>{o&&g==="input"&&o.sourceId!==v&&await t({source_id:o.sourceId,target_id:v}),a(null)},f=v=>{if(o){const g=v.currentTarget.getBoundingClientRect();u({x:v.clientX-g.left,y:v.clientY-g.top})}},p=()=>{a(null)};return T.jsxs("div",{className:"flex-grow h-full relative flex flex-col",onMouseMove:f,onMouseUp:p,children:[T.jsxs("div",{className:"p-2",children:[T.jsx(EL,{}),T.jsx(_L,{})]}),T.jsxs("div",{className:"flex-grow relative",children:[T.jsx(xL,{pendingLink:o,mousePos:c}),T.jsx(TL,{pendingLinkSourceId:(o==null?void 0:o.sourceId)??null,onStartLink:d,onEndLink:h})]})]})},sn=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),Ev=[.001,0,0,.001,0,0],vy=1.35,Gn={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Ai={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},RL="pdfjs_internal_editor_",ee={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,SIGNATURE:101},de={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},t1={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},$t={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Ed={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Ke={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},El={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Df={ERRORS:0,WARNINGS:1,INFOS:5},Vd={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},ap={moveTo:0,lineTo:1,curveTo:2,closePath:3},n1={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Cm=Df.WARNINGS;function LL(n){Number.isInteger(n)&&(Cm=n)}function ML(){return Cm}function km(n){Cm>=Df.INFOS&&console.log(`Info: ${n}`)}function ne(n){Cm>=Df.WARNINGS&&console.log(`Warning: ${n}`)}function _e(n){throw new Error(n)}function rt(n,e){n||_e(e)}function DL(n){switch(n==null?void 0:n.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function $w(n,e=null,t=null){if(!n)return null;if(t&&typeof n=="string"){if(t.addDefaultProtocol&&n.startsWith("www.")){const i=n.match(/\./g);(i==null?void 0:i.length)>=2&&(n=`http://${n}`)}if(t.tryConvertEncoding)try{n=jL(n)}catch{}}const s=e?URL.parse(n,e):URL.parse(n);return DL(s)?s:null}function Hw(n,e,t=!1){const s=URL.parse(n);return s?(s.hash=e,s.href):t&&$w(n,"http://example.com")?n.split("#",1)[0]+`${e?`#${e}`:""}`:""}function le(n,e,t,s=!1){return Object.defineProperty(n,e,{value:t,enumerable:!s,configurable:!0,writable:!1}),t}const vl=function(){function e(t,s){this.message=t,this.name=s}return e.prototype=new Error,e.constructor=e,e}();class IA extends vl{constructor(e,t){super(e,"PasswordException"),this.code=t}}class wy extends vl{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class Mg extends vl{constructor(e){super(e,"InvalidPDFException")}}class Gd extends vl{constructor(e,t,s){super(e,"ResponseException"),this.status=t,this.missing=s}}class NL extends vl{constructor(e){super(e,"FormatError")}}class Er extends vl{constructor(e){super(e,"AbortException")}}function s1(n){(typeof n!="object"||(n==null?void 0:n.length)===void 0)&&_e("Invalid argument for bytesToString");const e=n.length,t=8192;if(e<t)return String.fromCharCode.apply(null,n);const s=[];for(let i=0;i<e;i+=t){const r=Math.min(i+t,e),o=n.subarray(i,r);s.push(String.fromCharCode.apply(null,o))}return s.join("")}function Nf(n){typeof n!="string"&&_e("Invalid argument for stringToBytes");const e=n.length,t=new Uint8Array(e);for(let s=0;s<e;++s)t[s]=n.charCodeAt(s)&255;return t}function IL(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function OL(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function FL(){try{return new Function(""),!0}catch{return!1}}class Et{static get isLittleEndian(){return le(this,"isLittleEndian",OL())}static get isEvalSupported(){return le(this,"isEvalSupported",FL())}static get isOffscreenCanvasSupported(){return le(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return le(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return le(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){var e,t;return le(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const by=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));var vr,kp,_v;class Y{static makeHexColor(e,t,s){return`#${by[e]}${by[t]}${by[s]}`}static scaleMinMax(e,t){let s;e[0]?(e[0]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[3],t[3]*=e[3]):(s=t[0],t[0]=t[1],t[1]=s,s=t[2],t[2]=t[3],t[3]=s,e[1]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t,s=0){const i=e[s],r=e[s+1];e[s]=i*t[0]+r*t[2]+t[4],e[s+1]=i*t[1]+r*t[3]+t[5]}static applyTransformToBezier(e,t,s=0){const i=t[0],r=t[1],o=t[2],a=t[3],c=t[4],u=t[5];for(let d=0;d<6;d+=2){const h=e[s+d],f=e[s+d+1];e[s+d]=h*i+f*o+c,e[s+d+1]=h*r+f*a+u}}static applyInverseTransform(e,t){const s=e[0],i=e[1],r=t[0]*t[3]-t[1]*t[2];e[0]=(s*t[3]-i*t[2]+t[2]*t[5]-t[4]*t[3])/r,e[1]=(-s*t[1]+i*t[0]+t[4]*t[1]-t[5]*t[0])/r}static axialAlignedBoundingBox(e,t,s){const i=t[0],r=t[1],o=t[2],a=t[3],c=t[4],u=t[5],d=e[0],h=e[1],f=e[2],p=e[3];let v=i*d+c,g=v,x=i*f+c,y=x,w=a*h+u,b=w,E=a*p+u,_=E;if(r!==0||o!==0){const k=r*d,C=r*f,P=o*h,L=o*p;v+=P,y+=P,x+=L,g+=L,w+=k,_+=k,E+=C,b+=C}s[0]=Math.min(s[0],v,x,g,y),s[1]=Math.min(s[1],w,E,b,_),s[2]=Math.max(s[2],v,x,g,y),s[3]=Math.max(s[3],w,E,b,_)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const s=e[0],i=e[1],r=e[2],o=e[3],a=s**2+i**2,c=s*r+i*o,u=r**2+o**2,d=(a+u)/2,h=Math.sqrt(d**2-(a*u-c**2));t[0]=Math.sqrt(d+h||1),t[1]=Math.sqrt(d-h||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const s=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),i=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(s>i)return null;const r=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),o=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return r>o?null:[s,r,i,o]}static pointBoundingBox(e,t,s){s[0]=Math.min(s[0],e),s[1]=Math.min(s[1],t),s[2]=Math.max(s[2],e),s[3]=Math.max(s[3],t)}static rectBoundingBox(e,t,s,i,r){r[0]=Math.min(r[0],e,s),r[1]=Math.min(r[1],t,i),r[2]=Math.max(r[2],e,s),r[3]=Math.max(r[3],t,i)}static bezierBoundingBox(e,t,s,i,r,o,a,c,u){u[0]=Math.min(u[0],e,a),u[1]=Math.min(u[1],t,c),u[2]=Math.max(u[2],e,a),u[3]=Math.max(u[3],t,c),S(this,vr,_v).call(this,e,s,r,a,t,i,o,c,3*(-e+3*(s-r)+a),6*(e-2*s+r),3*(s-e),u),S(this,vr,_v).call(this,e,s,r,a,t,i,o,c,3*(-t+3*(i-o)+c),6*(t-2*i+o),3*(i-t),u)}}vr=new WeakSet,kp=function(e,t,s,i,r,o,a,c,u,d){if(u<=0||u>=1)return;const h=1-u,f=u*u,p=f*u,v=h*(h*(h*e+3*u*t)+3*f*s)+p*i,g=h*(h*(h*r+3*u*o)+3*f*a)+p*c;d[0]=Math.min(d[0],v),d[1]=Math.min(d[1],g),d[2]=Math.max(d[2],v),d[3]=Math.max(d[3],g)},_v=function(e,t,s,i,r,o,a,c,u,d,h,f){if(Math.abs(u)<1e-12){Math.abs(d)>=1e-12&&S(this,vr,kp).call(this,e,t,s,i,r,o,a,c,-h/d,f);return}const p=d**2-4*h*u;if(p<0)return;const v=Math.sqrt(p),g=2*u;S(this,vr,kp).call(this,e,t,s,i,r,o,a,c,(-d+v)/g,f),S(this,vr,kp).call(this,e,t,s,i,r,o,a,c,(-d-v)/g,f)},A(Y,vr);function jL(n){return decodeURIComponent(escape(n))}let Ay=null,OA=null;function i1(n){return Ay||(Ay=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,OA=new Map([["","t"]])),n.replaceAll(Ay,(e,t,s)=>t?t.normalize("NFKC"):OA.get(s))}function Uw(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),s1(n)}const Vw="pdfjs_internal_id_";function zL(n,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[s,i,...r]=t;if(!n(s)&&!Number.isInteger(s)||!e(i))return!1;const o=r.length;let a=!0;switch(i.name){case"XYZ":if(o<2||o>3)return!1;break;case"Fit":case"FitB":return o===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(o>1)return!1;break;case"FitR":if(o!==4)return!1;a=!1;break;default:return!1}for(const c of r)if(!(typeof c=="number"||a&&c===null))return!1;return!0}function Xt(n,e,t){return Math.min(Math.max(n,e),t)}function r1(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(s1(n))}function BL(n){return Uint8Array.fromBase64?Uint8Array.fromBase64(n):Nf(atob(n))}typeof Promise.try!="function"&&(Promise.try=function(n,...e){return new Promise(t=>{t(n(...e))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(n){return n.reduce((e,t)=>e+t,0)});const Di="http://www.w3.org/2000/svg",Ko=class Ko{};F(Ko,"CSS",96),F(Ko,"PDF",72),F(Ko,"PDF_TO_CSS_UNITS",Ko.CSS/Ko.PDF);let _r=Ko;async function Cu(n,e="text"){if(Xu(n,document.baseURI)){const t=await fetch(n);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,s)=>{const i=new XMLHttpRequest;i.open("GET",n,!0),i.responseType=e,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){if(i.status===200||i.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(i.response);return}t(i.responseText);return}s(new Error(i.statusText))}},i.send(null)})}class If{constructor({viewBox:e,userUnit:t,scale:s,rotation:i,offsetX:r=0,offsetY:o=0,dontFlip:a=!1}){this.viewBox=e,this.userUnit=t,this.scale=s,this.rotation=i,this.offsetX=r,this.offsetY=o,s*=t;const c=(e[2]+e[0])/2,u=(e[3]+e[1])/2;let d,h,f,p;switch(i%=360,i<0&&(i+=360),i){case 180:d=-1,h=0,f=0,p=1;break;case 90:d=0,h=1,f=1,p=0;break;case 270:d=0,h=-1,f=-1,p=0;break;case 0:d=1,h=0,f=0,p=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}a&&(f=-f,p=-p);let v,g,x,y;d===0?(v=Math.abs(u-e[1])*s+r,g=Math.abs(c-e[0])*s+o,x=(e[3]-e[1])*s,y=(e[2]-e[0])*s):(v=Math.abs(c-e[0])*s+r,g=Math.abs(u-e[1])*s+o,x=(e[2]-e[0])*s,y=(e[3]-e[1])*s),this.transform=[d*s,h*s,f*s,p*s,v-d*s*c-f*s*u,g-h*s*c-p*s*u],this.width=x,this.height=y}get rawDims(){const e=this.viewBox;return le(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:s=this.offsetX,offsetY:i=this.offsetY,dontFlip:r=!1}={}){return new If({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:s,offsetY:i,dontFlip:r})}convertToViewportPoint(e,t){const s=[e,t];return Y.applyTransform(s,this.transform),s}convertToViewportRectangle(e){const t=[e[0],e[1]];Y.applyTransform(t,this.transform);const s=[e[2],e[3]];return Y.applyTransform(s,this.transform),[t[0],t[1],s[0],s[1]]}convertToPdfPoint(e,t){const s=[e,t];return Y.applyInverseTransform(s,this.transform),s}}class Tm extends vl{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function Of(n){const e=n.length;let t=0;for(;t<e&&n[t].trim()==="";)t++;return n.substring(t,t+5).toLowerCase()==="data:"}function Pm(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function o1(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function a1(n,e="document.pdf"){if(typeof n!="string")return e;if(Of(n))return ne('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const t=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,s=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,i=t.exec(n);let r=s.exec(i[1])||s.exec(i[2])||s.exec(i[3]);if(r&&(r=r[0],r.includes("%")))try{r=s.exec(decodeURIComponent(r))[0]}catch{}return r||e}class FA{constructor(){F(this,"started",Object.create(null));F(this,"times",[])}time(e){e in this.started&&ne(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||ne(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:s}of this.times)t=Math.max(s.length,t);for(const{name:s,start:i,end:r}of this.times)e.push(`${s.padEnd(t)} ${r-i}ms
`);return e.join("")}}function Xu(n,e){const t=e?URL.parse(n,e):URL.parse(n);return(t==null?void 0:t.protocol)==="http:"||(t==null?void 0:t.protocol)==="https:"}function As(n){n.preventDefault()}function et(n){n.preventDefault(),n.stopPropagation()}function $L(n){console.log("Deprecated API usage: "+n)}var Qd;class Rm{static toDateObject(e){if(!e||typeof e!="string")return null;l(this,Qd)||m(this,Qd,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=l(this,Qd).exec(e);if(!t)return null;const s=parseInt(t[1],10);let i=parseInt(t[2],10);i=i>=1&&i<=12?i-1:0;let r=parseInt(t[3],10);r=r>=1&&r<=31?r:1;let o=parseInt(t[4],10);o=o>=0&&o<=23?o:0;let a=parseInt(t[5],10);a=a>=0&&a<=59?a:0;let c=parseInt(t[6],10);c=c>=0&&c<=59?c:0;const u=t[7]||"Z";let d=parseInt(t[8],10);d=d>=0&&d<=23?d:0;let h=parseInt(t[9],10)||0;return h=h>=0&&h<=59?h:0,u==="-"?(o+=d,a+=h):u==="+"&&(o-=d,a-=h),new Date(Date.UTC(s,i,r,o,a,c))}}Qd=new WeakMap,A(Rm,Qd);function l1(n,{scale:e=1,rotation:t=0}){const{width:s,height:i}=n.attributes.style,r=[0,0,parseInt(s),parseInt(i)];return new If({viewBox:r,userUnit:1,scale:e,rotation:t})}function Gw(n){if(n.startsWith("#")){const e=parseInt(n.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(e=>parseInt(e)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(ne(`Not a valid color format: "${n}"`),[0,0,0])}function HL(n){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of n.keys()){e.style.color=t;const s=window.getComputedStyle(e).color;n.set(t,Gw(s))}e.remove()}function He(n){const{a:e,b:t,c:s,d:i,e:r,f:o}=n.getTransform();return[e,t,s,i,r,o]}function ei(n){const{a:e,b:t,c:s,d:i,e:r,f:o}=n.getTransform().invertSelf();return[e,t,s,i,r,o]}function Oo(n,e,t=!1,s=!0){if(e instanceof If){const{pageWidth:i,pageHeight:r}=e.rawDims,{style:o}=n,a=Et.isCSSRoundSupported,c=`var(--total-scale-factor) * ${i}px`,u=`var(--total-scale-factor) * ${r}px`,d=a?`round(down, ${c}, var(--scale-round-x))`:`calc(${c})`,h=a?`round(down, ${u}, var(--scale-round-y))`:`calc(${u})`;!t||e.rotation%180===0?(o.width=d,o.height=h):(o.width=h,o.height=d)}s&&n.setAttribute("data-main-rotation",e.rotation)}class Xs{constructor(){const{pixelRatio:e}=Xs;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,s,i,r=-1){let o=1/0,a=1/0,c=1/0;s=Xs.capPixels(s,r),s>0&&(o=Math.sqrt(s/(e*t))),i!==-1&&(a=i/e,c=i/t);const u=Math.min(o,a,c);return this.sx>u||this.sy>u?(this.sx=u,this.sy=u,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const s=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,s):s}return e}}const Dg=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];var zr,ta,ss,Br,Jd,sc,Zd,Bg,c1,It,u1,d1,Yu,h1,Tp;const Fi=class Fi{constructor(e){A(this,It);A(this,zr,null);A(this,ta,null);A(this,ss);A(this,Br,null);A(this,Jd,null);A(this,sc,null);m(this,ss,e),l(Fi,Zd)||m(Fi,Zd,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const e=m(this,zr,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=l(this,ss)._uiManager._signal;e.addEventListener("contextmenu",As,{signal:t}),e.addEventListener("pointerdown",S(Fi,Bg,c1),{signal:t});const s=m(this,Br,document.createElement("div"));s.className="buttons",e.append(s);const i=l(this,ss).toolbarPosition;if(i){const{style:r}=e,o=l(this,ss)._uiManager.direction==="ltr"?1-i[0]:i[0];r.insetInlineEnd=`${100*o}%`,r.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return S(this,It,h1).call(this),e}get div(){return l(this,zr)}hide(){var e;l(this,zr).classList.add("hidden"),(e=l(this,ta))==null||e.hideDropdown()}show(){var e;l(this,zr).classList.remove("hidden"),(e=l(this,Jd))==null||e.shown()}async addAltText(e){const t=await e.render();S(this,It,Yu).call(this,t),l(this,Br).prepend(t,l(this,It,Tp)),m(this,Jd,e)}addColorPicker(e){m(this,ta,e);const t=e.renderButton();S(this,It,Yu).call(this,t),l(this,Br).prepend(t,l(this,It,Tp))}async addEditSignatureButton(e){const t=m(this,sc,await e.renderEditButton(l(this,ss)));S(this,It,Yu).call(this,t),l(this,Br).prepend(t,l(this,It,Tp))}updateEditSignatureButton(e){l(this,sc)&&(l(this,sc).title=e)}remove(){var e;l(this,zr).remove(),(e=l(this,ta))==null||e.destroy(),m(this,ta,null)}};zr=new WeakMap,ta=new WeakMap,ss=new WeakMap,Br=new WeakMap,Jd=new WeakMap,sc=new WeakMap,Zd=new WeakMap,Bg=new WeakSet,c1=function(e){e.stopPropagation()},It=new WeakSet,u1=function(e){l(this,ss)._focusEventsAllowed=!1,et(e)},d1=function(e){l(this,ss)._focusEventsAllowed=!0,et(e)},Yu=function(e){const t=l(this,ss)._uiManager._signal;e.addEventListener("focusin",S(this,It,u1).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",S(this,It,d1).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",As,{signal:t})},h1=function(){const{editorType:e,_uiManager:t}=l(this,ss),s=document.createElement("button");s.className="delete",s.tabIndex=0,s.setAttribute("data-l10n-id",l(Fi,Zd)[e]),S(this,It,Yu).call(this,s),s.addEventListener("click",i=>{t.delete()},{signal:t._signal}),l(this,Br).append(s)},Tp=function(){const e=document.createElement("div");return e.className="divider",e},A(Fi,Bg),A(Fi,Zd,null);let Cv=Fi;var eh,na,sa,jo,f1,p1,g1;class UL{constructor(e){A(this,jo);A(this,eh,null);A(this,na,null);A(this,sa);m(this,sa,e)}show(e,t,s){const[i,r]=S(this,jo,p1).call(this,t,s),{style:o}=l(this,na)||m(this,na,S(this,jo,f1).call(this));e.append(l(this,na)),o.insetInlineEnd=`${100*i}%`,o.top=`calc(${100*r}% + var(--editor-toolbar-vert-offset))`}hide(){l(this,na).remove()}}eh=new WeakMap,na=new WeakMap,sa=new WeakMap,jo=new WeakSet,f1=function(){const e=m(this,na,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",As,{signal:l(this,sa)._signal});const t=m(this,eh,document.createElement("div"));return t.className="buttons",e.append(t),S(this,jo,g1).call(this),e},p1=function(e,t){let s=0,i=0;for(const r of e){const o=r.y+r.height;if(o<s)continue;const a=r.x+(t?r.width:0);if(o>s){i=a,s=o;continue}t?a>i&&(i=a):a<i&&(i=a)}return[t?1-i:i,s]},g1=function(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const s=l(this,sa)._signal;e.addEventListener("contextmenu",As,{signal:s}),e.addEventListener("click",()=>{l(this,sa).highlightSelection("floating_button")},{signal:s}),l(this,eh).append(e)};function m1(n,e,t){for(const s of t)e.addEventListener(s,n[s].bind(n))}var $g;class VL{constructor(){A(this,$g,0)}get id(){return`${RL}${Qt(this,$g)._++}`}}$g=new WeakMap;var ic,th,Ut,rc,Pp;const nb=class nb{constructor(){A(this,rc);A(this,ic,Uw());A(this,th,0);A(this,Ut,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',s=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),i=new Image;i.src=e;const r=i.decode().then(()=>(s.drawImage(i,0,0,1,1,0,0,1,3),new Uint32Array(s.getImageData(0,0,1,1).data.buffer)[0]===0));return le(this,"_isSVGFittingCanvas",r)}async getFromFile(e){const{lastModified:t,name:s,size:i,type:r}=e;return S(this,rc,Pp).call(this,`${t}_${s}_${i}_${r}`,e)}async getFromUrl(e){return S(this,rc,Pp).call(this,e,e)}async getFromBlob(e,t){const s=await t;return S(this,rc,Pp).call(this,e,s)}async getFromId(e){l(this,Ut)||m(this,Ut,new Map);const t=l(this,Ut).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:s}=t;return delete t.blobPromise,this.getFromBlob(t.id,s)}return this.getFromUrl(t.url)}getFromCanvas(e,t){l(this,Ut)||m(this,Ut,new Map);let s=l(this,Ut).get(e);if(s!=null&&s.bitmap)return s.refCounter+=1,s;const i=new OffscreenCanvas(t.width,t.height);return i.getContext("2d").drawImage(t,0,0),s={bitmap:i.transferToImageBitmap(),id:`image_${l(this,ic)}_${Qt(this,th)._++}`,refCounter:1,isSvg:!1},l(this,Ut).set(e,s),l(this,Ut).set(s.id,s),s}getSvgUrl(e){const t=l(this,Ut).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var i;l(this,Ut)||m(this,Ut,new Map);const t=l(this,Ut).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:s}=t;if(!t.url&&!t.file){const r=new OffscreenCanvas(s.width,s.height);r.getContext("bitmaprenderer").transferFromImageBitmap(s),t.blobPromise=r.convertToBlob()}(i=s.close)==null||i.call(s),t.bitmap=null}isValidId(e){return e.startsWith(`image_${l(this,ic)}_`)}};ic=new WeakMap,th=new WeakMap,Ut=new WeakMap,rc=new WeakSet,Pp=async function(e,t){l(this,Ut)||m(this,Ut,new Map);let s=l(this,Ut).get(e);if(s===null)return null;if(s!=null&&s.bitmap)return s.refCounter+=1,s;try{s||(s={bitmap:null,id:`image_${l(this,ic)}_${Qt(this,th)._++}`,refCounter:0,isSvg:!1});let i;if(typeof t=="string"?(s.url=t,i=await Cu(t,"blob")):t instanceof File?i=s.file=t:t instanceof Blob&&(i=t),i.type==="image/svg+xml"){const r=nb._isSVGFittingCanvas,o=new FileReader,a=new Image,c=new Promise((u,d)=>{a.onload=()=>{s.bitmap=a,s.isSvg=!0,u()},o.onload=async()=>{const h=s.svgUrl=o.result;a.src=await r?`${h}#svgView(preserveAspectRatio(none))`:h},a.onerror=o.onerror=d});o.readAsDataURL(i),await c}else s.bitmap=await createImageBitmap(i);s.refCounter=1}catch(i){ne(i),s=null}return l(this,Ut).set(e,s),s&&l(this,Ut).set(s.id,s),s};let kv=nb;var Qe,$r,nh,$e;class GL{constructor(e=128){A(this,Qe,[]);A(this,$r,!1);A(this,nh);A(this,$e,-1);m(this,nh,e)}add({cmd:e,undo:t,post:s,mustExec:i,type:r=NaN,overwriteIfSameType:o=!1,keepUndo:a=!1}){if(i&&e(),l(this,$r))return;const c={cmd:e,undo:t,post:s,type:r};if(l(this,$e)===-1){l(this,Qe).length>0&&(l(this,Qe).length=0),m(this,$e,0),l(this,Qe).push(c);return}if(o&&l(this,Qe)[l(this,$e)].type===r){a&&(c.undo=l(this,Qe)[l(this,$e)].undo),l(this,Qe)[l(this,$e)]=c;return}const u=l(this,$e)+1;u===l(this,nh)?l(this,Qe).splice(0,1):(m(this,$e,u),u<l(this,Qe).length&&l(this,Qe).splice(u)),l(this,Qe).push(c)}undo(){if(l(this,$e)===-1)return;m(this,$r,!0);const{undo:e,post:t}=l(this,Qe)[l(this,$e)];e(),t==null||t(),m(this,$r,!1),m(this,$e,l(this,$e)-1)}redo(){if(l(this,$e)<l(this,Qe).length-1){m(this,$e,l(this,$e)+1),m(this,$r,!0);const{cmd:e,post:t}=l(this,Qe)[l(this,$e)];e(),t==null||t(),m(this,$r,!1)}}hasSomethingToUndo(){return l(this,$e)!==-1}hasSomethingToRedo(){return l(this,$e)<l(this,Qe).length-1}cleanType(e){if(l(this,$e)!==-1){for(let t=l(this,$e);t>=0;t--)if(l(this,Qe)[t].type!==e){l(this,Qe).splice(t+1,l(this,$e)-t),m(this,$e,t);return}l(this,Qe).length=0,m(this,$e,-1)}}destroy(){m(this,Qe,null)}}Qe=new WeakMap,$r=new WeakMap,nh=new WeakMap,$e=new WeakMap;var Hg,y1;class Ff{constructor(e){A(this,Hg);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=Et.platform;for(const[s,i,r={}]of e)for(const o of s){const a=o.startsWith("mac+");t&&a?(this.callbacks.set(o.slice(4),{callback:i,options:r}),this.allKeys.add(o.split("+").at(-1))):!t&&!a&&(this.callbacks.set(o,{callback:i,options:r}),this.allKeys.add(o.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const s=this.callbacks.get(S(this,Hg,y1).call(this,t));if(!s)return;const{callback:i,options:{bubbles:r=!1,args:o=[],checker:a=null}}=s;a&&!a(e,t)||(i.bind(e,...o,t)(),r||et(t))}}Hg=new WeakSet,y1=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const Ug=class Ug{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return HL(e),le(this,"_colors",e)}convert(e){const t=Gw(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[s,i]of this._colors)if(i.every((r,o)=>r===t[o]))return Ug._colorsMapping.get(s);return t}getHexCode(e){const t=this._colors.get(e);return t?Y.makeHexColor(...t):e}};F(Ug,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let Tv=Ug;var oc,Mn,lt,kt,ac,Bi,lc,is,Hr,Ur,cc,ia,ii,ks,ra,sh,ih,uc,rh,ri,Vr,dc,Gr,oi,Vg,Wr,oh,Xr,oa,aa,Yr,ah,gt,be,$i,qr,la,lh,ch,Kr,ai,Hi,uh,rs,z,Rp,Pv,v1,w1,Lp,b1,A1,S1,Rv,x1,Lv,Mv,E1,Jt,Ni,_1,C1,Dv,k1,qu,Nv;const Gl=class Gl{constructor(e,t,s,i,r,o,a,c,u,d,h,f,p,v){A(this,z);A(this,oc,new AbortController);A(this,Mn,null);A(this,lt,new Map);A(this,kt,new Map);A(this,ac,null);A(this,Bi,null);A(this,lc,null);A(this,is,new GL);A(this,Hr,null);A(this,Ur,null);A(this,cc,0);A(this,ia,new Set);A(this,ii,null);A(this,ks,null);A(this,ra,new Set);F(this,"_editorUndoBar",null);A(this,sh,!1);A(this,ih,!1);A(this,uc,!1);A(this,rh,null);A(this,ri,null);A(this,Vr,null);A(this,dc,null);A(this,Gr,!1);A(this,oi,null);A(this,Vg,new VL);A(this,Wr,!1);A(this,oh,!1);A(this,Xr,null);A(this,oa,null);A(this,aa,null);A(this,Yr,null);A(this,ah,null);A(this,gt,ee.NONE);A(this,be,new Set);A(this,$i,null);A(this,qr,null);A(this,la,null);A(this,lh,null);A(this,ch,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});A(this,Kr,[0,0]);A(this,ai,null);A(this,Hi,null);A(this,uh,null);A(this,rs,null);const g=this._signal=l(this,oc).signal;m(this,Hi,e),m(this,uh,t),m(this,ac,s),m(this,qr,i),this._eventBus=r,r._on("editingaction",this.onEditingAction.bind(this),{signal:g}),r._on("pagechanging",this.onPageChanging.bind(this),{signal:g}),r._on("scalechanging",this.onScaleChanging.bind(this),{signal:g}),r._on("rotationchanging",this.onRotationChanging.bind(this),{signal:g}),r._on("setpreference",this.onSetPreference.bind(this),{signal:g}),r._on("switchannotationeditorparams",x=>this.updateParams(x.type,x.value),{signal:g}),S(this,z,b1).call(this),S(this,z,E1).call(this),S(this,z,Rv).call(this),m(this,Bi,o.annotationStorage),m(this,rh,o.filterFactory),m(this,la,a),m(this,dc,c||null),m(this,sh,u),m(this,ih,d),m(this,uc,h),m(this,ah,f||null),this.viewParameters={realScale:_r.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=p||null,this._supportsPinchToZoom=v!==!1}static get _keyboardManager(){const e=Gl.prototype,t=o=>l(o,Hi).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&o.hasSomethingToControl(),s=(o,{target:a})=>{if(a instanceof HTMLInputElement){const{type:c}=a;return c!=="text"&&c!=="number"}return!0},i=this.TRANSLATE_SMALL,r=this.TRANSLATE_BIG;return le(this,"_keyboardManager",new Ff([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],e.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:s}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(o,{target:a})=>!(a instanceof HTMLButtonElement)&&l(o,Hi).contains(a)&&!o.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(o,{target:a})=>!(a instanceof HTMLButtonElement)&&l(o,Hi).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-r,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[r,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-r],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,r],checker:t}]]))}destroy(){var e,t,s,i,r,o,a,c;(e=l(this,rs))==null||e.resolve(),m(this,rs,null),(t=l(this,oc))==null||t.abort(),m(this,oc,null),this._signal=null;for(const u of l(this,kt).values())u.destroy();l(this,kt).clear(),l(this,lt).clear(),l(this,ra).clear(),(s=l(this,Yr))==null||s.clear(),m(this,Mn,null),l(this,be).clear(),l(this,is).destroy(),(i=l(this,ac))==null||i.destroy(),(r=l(this,qr))==null||r.destroy(),(o=l(this,oi))==null||o.hide(),m(this,oi,null),(a=l(this,aa))==null||a.destroy(),m(this,aa,null),l(this,ri)&&(clearTimeout(l(this,ri)),m(this,ri,null)),l(this,ai)&&(clearTimeout(l(this,ai)),m(this,ai,null)),(c=this._editorUndoBar)==null||c.destroy()}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return l(this,ah)}get useNewAltTextFlow(){return l(this,ih)}get useNewAltTextWhenAddingImage(){return l(this,uc)}get hcmFilter(){return le(this,"hcmFilter",l(this,la)?l(this,rh).addHCMFilter(l(this,la).foreground,l(this,la).background):"none")}get direction(){return le(this,"direction",getComputedStyle(l(this,Hi)).direction)}get highlightColors(){return le(this,"highlightColors",l(this,dc)?new Map(l(this,dc).split(",").map(e=>e.split("=").map(t=>t.trim()))):null)}get highlightColorNames(){return le(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),m(this,Ur,e)}setMainHighlightColorPicker(e){m(this,aa,e)}editAltText(e,t=!1){var s;(s=l(this,ac))==null||s.editAltText(this,e,t)}getSignature(e){var t;(t=l(this,qr))==null||t.getSignature({uiManager:this,editor:e})}get signatureManager(){return l(this,qr)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":m(this,uc,t);break}}onPageChanging({pageNumber:e}){m(this,cc,e-1)}focusMainContainer(){l(this,Hi).focus()}findParent(e,t){for(const s of l(this,kt).values()){const{x:i,y:r,width:o,height:a}=s.div.getBoundingClientRect();if(e>=i&&e<=i+o&&t>=r&&t<=r+a)return s}return null}disableUserSelect(e=!1){l(this,uh).classList.toggle("noUserSelect",e)}addShouldRescale(e){l(this,ra).add(e)}removeShouldRescale(e){l(this,ra).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*_r.PDF_TO_CSS_UNITS;for(const s of l(this,ra))s.onScaleChanging();(t=l(this,Ur))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e=""){const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:s,anchorOffset:i,focusNode:r,focusOffset:o}=t,a=t.toString(),u=S(this,z,Rp).call(this,t).closest(".textLayer"),d=this.getSelectionBoxes(u);if(!d)return;t.empty();const h=S(this,z,Pv).call(this,u),f=l(this,gt)===ee.NONE,p=()=>{h==null||h.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:d,anchorNode:s,anchorOffset:i,focusNode:r,focusOffset:o,text:a}),f&&this.showAllEditors("highlight",!0,!0)};if(f){this.switchToMode(ee.HIGHLIGHT,p);return}p()}addToAnnotationStorage(e){!e.isEmpty()&&l(this,Bi)&&!l(this,Bi).has(e.id)&&l(this,Bi).setValue(e.id,e)}blur(){if(this.isShiftKeyDown=!1,l(this,Gr)&&(m(this,Gr,!1),S(this,z,Lp).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of l(this,be))if(t.div.contains(e)){m(this,oa,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!l(this,oa))return;const[e,t]=l(this,oa);m(this,oa,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){S(this,z,Rv).call(this),S(this,z,Lv).call(this)}removeEditListeners(){S(this,z,x1).call(this),S(this,z,Mv).call(this)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const s of l(this,ks))if(s.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const s of l(this,ks))if(s.isHandlingMimeForPasting(t.type)){s.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var s;if(e.preventDefault(),(s=l(this,Mn))==null||s.commitOrRemove(),!this.hasSelection)return;const t=[];for(const i of l(this,be)){const r=i.serialize(!0);r&&t.push(r)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const r of t.items)for(const o of l(this,ks))if(o.isHandlingMimeForPasting(r.type)){o.paste(r,this.currentLayer);return}let s=t.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(r){ne(`paste: "${r.message}".`);return}if(!Array.isArray(s))return;this.unselectAll();const i=this.currentLayer;try{const r=[];for(const c of s){const u=await i.deserialize(c);if(!u)return;r.push(u)}const o=()=>{for(const c of r)S(this,z,Dv).call(this,c);S(this,z,Nv).call(this,r)},a=()=>{for(const c of r)c.remove()};this.addCommands({cmd:o,undo:a,mustExec:!0})}catch(r){ne(`paste: "${r.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),l(this,gt)!==ee.NONE&&!this.isEditorHandlingKeyboard&&Gl._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,l(this,Gr)&&(m(this,Gr,!1),S(this,z,Lp).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(e){e?(S(this,z,A1).call(this),S(this,z,Lv).call(this),S(this,z,Jt).call(this,{isEditing:l(this,gt)!==ee.NONE,isEmpty:S(this,z,qu).call(this),hasSomethingToUndo:l(this,is).hasSomethingToUndo(),hasSomethingToRedo:l(this,is).hasSomethingToRedo(),hasSelectedEditor:!1})):(S(this,z,S1).call(this),S(this,z,Mv).call(this),S(this,z,Jt).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!l(this,ks)){m(this,ks,e);for(const t of l(this,ks))S(this,z,Ni).call(this,t.defaultPropertiesToUpdate)}}getId(){return l(this,Vg).id}get currentLayer(){return l(this,kt).get(l(this,cc))}getLayer(e){return l(this,kt).get(e)}get currentPageIndex(){return l(this,cc)}addLayer(e){l(this,kt).set(e.pageIndex,e),l(this,Wr)?e.enable():e.disable()}removeLayer(e){l(this,kt).delete(e.pageIndex)}async updateMode(e,t=null,s=!1){var i,r,o;if(l(this,gt)!==e&&!(l(this,rs)&&(await l(this,rs).promise,!l(this,rs)))){if(m(this,rs,Promise.withResolvers()),(i=l(this,Ur))==null||i.commitOrRemove(),m(this,gt,e),e===ee.NONE){this.setEditingState(!1),S(this,z,C1).call(this),(r=this._editorUndoBar)==null||r.hide(),l(this,rs).resolve();return}e===ee.SIGNATURE&&await((o=l(this,qr))==null?void 0:o.loadSignatures()),this.setEditingState(!0),await S(this,z,_1).call(this),this.unselectAll();for(const a of l(this,kt).values())a.updateMode(e);if(!t){s&&this.addNewEditorFromKeyboard(),l(this,rs).resolve();return}for(const a of l(this,lt).values())a.annotationElementId===t||a.id===t?(this.setSelected(a),a.enterInEditMode()):a.unselect();l(this,rs).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==l(this,gt)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){var s;if(l(this,ks)){switch(e){case de.CREATE:this.currentLayer.addNewEditor(t);return;case de.HIGHLIGHT_DEFAULT_COLOR:(s=l(this,aa))==null||s.updateColor(t);break;case de.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(l(this,lh)||m(this,lh,new Map)).set(e,t),this.showAllEditors("highlight",t);break}for(const i of l(this,be))i.updateParams(e,t);for(const i of l(this,ks))i.updateDefaultParams(e,t)}}showAllEditors(e,t,s=!1){var r;for(const o of l(this,lt).values())o.editorType===e&&o.show(t);(((r=l(this,lh))==null?void 0:r.get(de.HIGHLIGHT_SHOW_ALL))??!0)!==t&&S(this,z,Ni).call(this,[[de.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(l(this,oh)!==e){m(this,oh,e);for(const t of l(this,kt).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}getEditors(e){const t=[];for(const s of l(this,lt).values())s.pageIndex===e&&t.push(s);return t}getEditor(e){return l(this,lt).get(e)}addEditor(e){l(this,lt).set(e.id,e)}removeEditor(e){var t,s;e.div.contains(document.activeElement)&&(l(this,ri)&&clearTimeout(l(this,ri)),m(this,ri,setTimeout(()=>{this.focusMainContainer(),m(this,ri,null)},0))),l(this,lt).delete(e.id),e.annotationElementId&&((t=l(this,Yr))==null||t.delete(e.annotationElementId)),this.unselect(e),(!e.annotationElementId||!l(this,ia).has(e.annotationElementId))&&((s=l(this,Bi))==null||s.remove(e.id))}addDeletedAnnotationElement(e){l(this,ia).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return l(this,ia).has(e)}removeDeletedAnnotationElement(e){l(this,ia).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){l(this,Mn)!==e&&(m(this,Mn,e),e&&S(this,z,Ni).call(this,e.propertiesToUpdate))}updateUI(e){l(this,z,k1)===e&&S(this,z,Ni).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){S(this,z,Ni).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(l(this,be).has(e)){l(this,be).delete(e),e.unselect(),S(this,z,Jt).call(this,{hasSelectedEditor:this.hasSelection});return}l(this,be).add(e),e.select(),S(this,z,Ni).call(this,e.propertiesToUpdate),S(this,z,Jt).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;(t=l(this,Ur))==null||t.commitOrRemove();for(const s of l(this,be))s!==e&&s.unselect();l(this,be).clear(),l(this,be).add(e),e.select(),S(this,z,Ni).call(this,e.propertiesToUpdate),S(this,z,Jt).call(this,{hasSelectedEditor:!0})}isSelected(e){return l(this,be).has(e)}get firstSelectedEditor(){return l(this,be).values().next().value}unselect(e){e.unselect(),l(this,be).delete(e),S(this,z,Jt).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return l(this,be).size!==0}get isEnterHandled(){return l(this,be).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;l(this,is).undo(),S(this,z,Jt).call(this,{hasSomethingToUndo:l(this,is).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:S(this,z,qu).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){l(this,is).redo(),S(this,z,Jt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:l(this,is).hasSomethingToRedo(),isEmpty:S(this,z,qu).call(this)})}addCommands(e){l(this,is).add(e),S(this,z,Jt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:S(this,z,qu).call(this)})}cleanUndoStack(e){l(this,is).cleanType(e)}delete(){var r;this.commitOrRemove();const e=(r=this.currentLayer)==null?void 0:r.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...l(this,be)],s=()=>{var o;(o=this._editorUndoBar)==null||o.show(i,t.length===1?t[0].editorType:t.length);for(const a of t)a.remove()},i=()=>{for(const o of t)S(this,z,Dv).call(this,o)};this.addCommands({cmd:s,undo:i,mustExec:!0})}commitOrRemove(){var e;(e=l(this,Mn))==null||e.commitOrRemove()}hasSomethingToControl(){return l(this,Mn)||this.hasSelection}selectAll(){for(const e of l(this,be))e.commit();S(this,z,Nv).call(this,l(this,lt).values())}unselectAll(){var e;if(!(l(this,Mn)&&(l(this,Mn).commitOrRemove(),l(this,gt)!==ee.NONE))&&!((e=l(this,Ur))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of l(this,be))t.unselect();l(this,be).clear(),S(this,z,Jt).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,s=!1){if(s||this.commitOrRemove(),!this.hasSelection)return;l(this,Kr)[0]+=e,l(this,Kr)[1]+=t;const[i,r]=l(this,Kr),o=[...l(this,be)],a=1e3;l(this,ai)&&clearTimeout(l(this,ai)),m(this,ai,setTimeout(()=>{m(this,ai,null),l(this,Kr)[0]=l(this,Kr)[1]=0,this.addCommands({cmd:()=>{for(const c of o)l(this,lt).has(c.id)&&(c.translateInPage(i,r),c.translationDone())},undo:()=>{for(const c of o)l(this,lt).has(c.id)&&(c.translateInPage(-i,-r),c.translationDone())},mustExec:!1})},a));for(const c of o)c.translateInPage(e,t),c.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),m(this,ii,new Map);for(const e of l(this,be))l(this,ii).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!l(this,ii))return!1;this.disableUserSelect(!1);const e=l(this,ii);m(this,ii,null);let t=!1;for(const[{x:i,y:r,pageIndex:o},a]of e)a.newX=i,a.newY=r,a.newPageIndex=o,t||(t=i!==a.savedX||r!==a.savedY||o!==a.savedPageIndex);if(!t)return!1;const s=(i,r,o,a)=>{if(l(this,lt).has(i.id)){const c=l(this,kt).get(a);c?i._setParentAndPosition(c,r,o):(i.pageIndex=a,i.x=r,i.y=o)}};return this.addCommands({cmd:()=>{for(const[i,{newX:r,newY:o,newPageIndex:a}]of e)s(i,r,o,a)},undo:()=>{for(const[i,{savedX:r,savedY:o,savedPageIndex:a}]of e)s(i,r,o,a)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(l(this,ii))for(const s of l(this,ii).keys())s.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||l(this,be).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return l(this,Mn)===e}getActive(){return l(this,Mn)}getMode(){return l(this,gt)}get imageManager(){return le(this,"imageManager",new kv)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let u=0,d=t.rangeCount;u<d;u++)if(!e.contains(t.getRangeAt(u).commonAncestorContainer))return null;const{x:s,y:i,width:r,height:o}=e.getBoundingClientRect();let a;switch(e.getAttribute("data-main-rotation")){case"90":a=(u,d,h,f)=>({x:(d-i)/o,y:1-(u+h-s)/r,width:f/o,height:h/r});break;case"180":a=(u,d,h,f)=>({x:1-(u+h-s)/r,y:1-(d+f-i)/o,width:h/r,height:f/o});break;case"270":a=(u,d,h,f)=>({x:1-(d+f-i)/o,y:(u-s)/r,width:f/o,height:h/r});break;default:a=(u,d,h,f)=>({x:(u-s)/r,y:(d-i)/o,width:h/r,height:f/o});break}const c=[];for(let u=0,d=t.rangeCount;u<d;u++){const h=t.getRangeAt(u);if(!h.collapsed)for(const{x:f,y:p,width:v,height:g}of h.getClientRects())v===0||g===0||c.push(a(f,p,v,g))}return c.length===0?null:c}addChangedExistingAnnotation({annotationElementId:e,id:t}){(l(this,lc)||m(this,lc,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=l(this,lc))==null||t.delete(e)}renderAnnotationElement(e){var i;const t=(i=l(this,lc))==null?void 0:i.get(e.data.id);if(!t)return;const s=l(this,Bi).getRawValue(t);s&&(l(this,gt)===ee.NONE&&!s.hasBeenModified||s.renderAnnotationElement(e))}setMissingCanvas(e,t,s){var r;const i=(r=l(this,Yr))==null?void 0:r.get(e);i&&(i.setCanvas(t,s),l(this,Yr).delete(e))}addMissingCanvas(e,t){(l(this,Yr)||m(this,Yr,new Map)).set(e,t)}};oc=new WeakMap,Mn=new WeakMap,lt=new WeakMap,kt=new WeakMap,ac=new WeakMap,Bi=new WeakMap,lc=new WeakMap,is=new WeakMap,Hr=new WeakMap,Ur=new WeakMap,cc=new WeakMap,ia=new WeakMap,ii=new WeakMap,ks=new WeakMap,ra=new WeakMap,sh=new WeakMap,ih=new WeakMap,uc=new WeakMap,rh=new WeakMap,ri=new WeakMap,Vr=new WeakMap,dc=new WeakMap,Gr=new WeakMap,oi=new WeakMap,Vg=new WeakMap,Wr=new WeakMap,oh=new WeakMap,Xr=new WeakMap,oa=new WeakMap,aa=new WeakMap,Yr=new WeakMap,ah=new WeakMap,gt=new WeakMap,be=new WeakMap,$i=new WeakMap,qr=new WeakMap,la=new WeakMap,lh=new WeakMap,ch=new WeakMap,Kr=new WeakMap,ai=new WeakMap,Hi=new WeakMap,uh=new WeakMap,rs=new WeakMap,z=new WeakSet,Rp=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},Pv=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const s of l(this,kt).values())if(s.hasTextLayer(e))return s;return null},v1=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const s=S(this,z,Rp).call(this,e).closest(".textLayer"),i=this.getSelectionBoxes(s);i&&(l(this,oi)||m(this,oi,new UL(this)),l(this,oi).show(s,i,this.direction==="ltr"))},w1=function(){var r,o,a;const e=document.getSelection();if(!e||e.isCollapsed){l(this,$i)&&((r=l(this,oi))==null||r.hide(),m(this,$i,null),S(this,z,Jt).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===l(this,$i))return;const i=S(this,z,Rp).call(this,e).closest(".textLayer");if(!i){l(this,$i)&&((o=l(this,oi))==null||o.hide(),m(this,$i,null),S(this,z,Jt).call(this,{hasSelectedText:!1}));return}if((a=l(this,oi))==null||a.hide(),m(this,$i,t),S(this,z,Jt).call(this,{hasSelectedText:!0}),!(l(this,gt)!==ee.HIGHLIGHT&&l(this,gt)!==ee.NONE)&&(l(this,gt)===ee.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),m(this,Gr,this.isShiftKeyDown),!this.isShiftKeyDown)){const c=l(this,gt)===ee.HIGHLIGHT?S(this,z,Pv).call(this,i):null;c==null||c.toggleDrawing();const u=new AbortController,d=this.combinedSignal(u),h=f=>{f.type==="pointerup"&&f.button!==0||(u.abort(),c==null||c.toggleDrawing(!0),f.type==="pointerup"&&S(this,z,Lp).call(this,"main_toolbar"))};window.addEventListener("pointerup",h,{signal:d}),window.addEventListener("blur",h,{signal:d})}},Lp=function(e=""){l(this,gt)===ee.HIGHLIGHT?this.highlightSelection(e):l(this,sh)&&S(this,z,v1).call(this)},b1=function(){document.addEventListener("selectionchange",S(this,z,w1).bind(this),{signal:this._signal})},A1=function(){if(l(this,Vr))return;m(this,Vr,new AbortController);const e=this.combinedSignal(l(this,Vr));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},S1=function(){var e;(e=l(this,Vr))==null||e.abort(),m(this,Vr,null)},Rv=function(){if(l(this,Xr))return;m(this,Xr,new AbortController);const e=this.combinedSignal(l(this,Xr));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},x1=function(){var e;(e=l(this,Xr))==null||e.abort(),m(this,Xr,null)},Lv=function(){if(l(this,Hr))return;m(this,Hr,new AbortController);const e=this.combinedSignal(l(this,Hr));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},Mv=function(){var e;(e=l(this,Hr))==null||e.abort(),m(this,Hr,null)},E1=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},Jt=function(e){Object.entries(e).some(([s,i])=>l(this,ch)[s]!==i)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(l(this,ch),e)}),l(this,gt)===ee.HIGHLIGHT&&e.hasSelectedEditor===!1&&S(this,z,Ni).call(this,[[de.HIGHLIGHT_FREE,!0]]))},Ni=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},_1=async function(){if(!l(this,Wr)){m(this,Wr,!0);const e=[];for(const t of l(this,kt).values())e.push(t.enable());await Promise.all(e);for(const t of l(this,lt).values())t.enable()}},C1=function(){if(this.unselectAll(),l(this,Wr)){m(this,Wr,!1);for(const e of l(this,kt).values())e.disable();for(const e of l(this,lt).values())e.disable()}},Dv=function(e){const t=l(this,kt).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},k1=function(){let e=null;for(e of l(this,be));return e},qu=function(){if(l(this,lt).size===0)return!0;if(l(this,lt).size===1)for(const e of l(this,lt).values())return e.isEmpty();return!1},Nv=function(e){for(const t of l(this,be))t.unselect();l(this,be).clear();for(const t of e)t.isEmpty()||(l(this,be).add(t),t.select());S(this,z,Jt).call(this,{hasSelectedEditor:this.hasSelection})},F(Gl,"TRANSLATE_SMALL",1),F(Gl,"TRANSLATE_BIG",10);let Fo=Gl;var mt,li,Ts,hc,ci,Dn,fc,ui,fn,Ui,ca,di,Qr,Hs,Ku,Mp;const Zt=class Zt{constructor(e){A(this,Hs);A(this,mt,null);A(this,li,!1);A(this,Ts,null);A(this,hc,null);A(this,ci,null);A(this,Dn,null);A(this,fc,!1);A(this,ui,null);A(this,fn,null);A(this,Ui,null);A(this,ca,null);A(this,di,!1);m(this,fn,e),m(this,di,e._uiManager.useNewAltTextFlow),l(Zt,Qr)||m(Zt,Qr,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){Zt._l10n??(Zt._l10n=e)}async render(){const e=m(this,Ts,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=m(this,hc,document.createElement("span"));e.append(t),l(this,di)?(e.classList.add("new"),e.setAttribute("data-l10n-id",l(Zt,Qr).missing),t.setAttribute("data-l10n-id",l(Zt,Qr)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const s=l(this,fn)._uiManager._signal;e.addEventListener("contextmenu",As,{signal:s}),e.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:s});const i=r=>{r.preventDefault(),l(this,fn)._uiManager.editAltText(l(this,fn)),l(this,di)&&l(this,fn)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:l(this,Hs,Ku)}})};return e.addEventListener("click",i,{capture:!0,signal:s}),e.addEventListener("keydown",r=>{r.target===e&&r.key==="Enter"&&(m(this,fc,!0),i(r))},{signal:s}),await S(this,Hs,Mp).call(this),e}finish(){l(this,Ts)&&(l(this,Ts).focus({focusVisible:l(this,fc)}),m(this,fc,!1))}isEmpty(){return l(this,di)?l(this,mt)===null:!l(this,mt)&&!l(this,li)}hasData(){return l(this,di)?l(this,mt)!==null||!!l(this,Ui):this.isEmpty()}get guessedText(){return l(this,Ui)}async setGuessedText(e){l(this,mt)===null&&(m(this,Ui,e),m(this,ca,await Zt._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),S(this,Hs,Mp).call(this))}toggleAltTextBadge(e=!1){var t;if(!l(this,di)||l(this,mt)){(t=l(this,ui))==null||t.remove(),m(this,ui,null);return}if(!l(this,ui)){const s=m(this,ui,document.createElement("div"));s.className="noAltTextBadge",l(this,fn).div.append(s)}l(this,ui).classList.toggle("hidden",!e)}serialize(e){let t=l(this,mt);return!e&&l(this,Ui)===t&&(t=l(this,ca)),{altText:t,decorative:l(this,li),guessedText:l(this,Ui),textWithDisclaimer:l(this,ca)}}get data(){return{altText:l(this,mt),decorative:l(this,li)}}set data({altText:e,decorative:t,guessedText:s,textWithDisclaimer:i,cancel:r=!1}){s&&(m(this,Ui,s),m(this,ca,i)),!(l(this,mt)===e&&l(this,li)===t)&&(r||(m(this,mt,e),m(this,li,t)),S(this,Hs,Mp).call(this))}toggle(e=!1){l(this,Ts)&&(!e&&l(this,Dn)&&(clearTimeout(l(this,Dn)),m(this,Dn,null)),l(this,Ts).disabled=!e)}shown(){l(this,fn)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:l(this,Hs,Ku)}})}destroy(){var e,t;(e=l(this,Ts))==null||e.remove(),m(this,Ts,null),m(this,hc,null),m(this,ci,null),(t=l(this,ui))==null||t.remove(),m(this,ui,null)}};mt=new WeakMap,li=new WeakMap,Ts=new WeakMap,hc=new WeakMap,ci=new WeakMap,Dn=new WeakMap,fc=new WeakMap,ui=new WeakMap,fn=new WeakMap,Ui=new WeakMap,ca=new WeakMap,di=new WeakMap,Qr=new WeakMap,Hs=new WeakSet,Ku=function(){return l(this,mt)&&"added"||l(this,mt)===null&&this.guessedText&&"review"||"missing"},Mp=async function(){var i,r,o;const e=l(this,Ts);if(!e)return;if(l(this,di)){if(e.classList.toggle("done",!!l(this,mt)),e.setAttribute("data-l10n-id",l(Zt,Qr)[l(this,Hs,Ku)]),(i=l(this,hc))==null||i.setAttribute("data-l10n-id",l(Zt,Qr)[`${l(this,Hs,Ku)}-label`]),!l(this,mt)){(r=l(this,ci))==null||r.remove();return}}else{if(!l(this,mt)&&!l(this,li)){e.classList.remove("done"),(o=l(this,ci))==null||o.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=l(this,ci);if(!t){m(this,ci,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${l(this,fn).id}`;const a=100,c=l(this,fn)._uiManager._signal;c.addEventListener("abort",()=>{clearTimeout(l(this,Dn)),m(this,Dn,null)},{once:!0}),e.addEventListener("mouseenter",()=>{m(this,Dn,setTimeout(()=>{m(this,Dn,null),l(this,ci).classList.add("show"),l(this,fn)._reportTelemetry({action:"alt_text_tooltip"})},a))},{signal:c}),e.addEventListener("mouseleave",()=>{var u;l(this,Dn)&&(clearTimeout(l(this,Dn)),m(this,Dn,null)),(u=l(this,ci))==null||u.classList.remove("show")},{signal:c})}l(this,li)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=l(this,mt)),t.parentNode||e.append(t);const s=l(this,fn).getElementForAltText();s==null||s.setAttribute("aria-describedby",t.id)},A(Zt,Qr,null),F(Zt,"_l10n",null);let Ng=Zt;var pc,ua,dh,hh,fh,ph,gh,Vi,da,Gi,ha,Wi,zo,T1,P1,R1;const sb=class sb{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:s=null,onPinchStart:i=null,onPinching:r=null,onPinchEnd:o=null,signal:a}){A(this,zo);A(this,pc);A(this,ua,!1);A(this,dh,null);A(this,hh);A(this,fh);A(this,ph);A(this,gh);A(this,Vi,null);A(this,da);A(this,Gi,null);A(this,ha);A(this,Wi,null);m(this,pc,e),m(this,dh,s),m(this,hh,t),m(this,fh,i),m(this,ph,r),m(this,gh,o),m(this,ha,new AbortController),m(this,da,AbortSignal.any([a,l(this,ha).signal])),e.addEventListener("touchstart",S(this,zo,T1).bind(this),{passive:!1,signal:l(this,da)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Xs.pixelRatio}destroy(){var e,t;(e=l(this,ha))==null||e.abort(),m(this,ha,null),(t=l(this,Vi))==null||t.abort(),m(this,Vi,null)}};pc=new WeakMap,ua=new WeakMap,dh=new WeakMap,hh=new WeakMap,fh=new WeakMap,ph=new WeakMap,gh=new WeakMap,Vi=new WeakMap,da=new WeakMap,Gi=new WeakMap,ha=new WeakMap,Wi=new WeakMap,zo=new WeakSet,T1=function(e){var i,r,o;if((i=l(this,hh))!=null&&i.call(this))return;if(e.touches.length===1){if(l(this,Vi))return;const a=m(this,Vi,new AbortController),c=AbortSignal.any([l(this,da),a.signal]),u=l(this,pc),d={capture:!0,signal:c,passive:!1},h=f=>{var p;f.pointerType==="touch"&&((p=l(this,Vi))==null||p.abort(),m(this,Vi,null))};u.addEventListener("pointerdown",f=>{f.pointerType==="touch"&&(et(f),h(f))},d),u.addEventListener("pointerup",h,d),u.addEventListener("pointercancel",h,d);return}if(!l(this,Wi)){m(this,Wi,new AbortController);const a=AbortSignal.any([l(this,da),l(this,Wi).signal]),c=l(this,pc),u={signal:a,capture:!1,passive:!1};c.addEventListener("touchmove",S(this,zo,P1).bind(this),u);const d=S(this,zo,R1).bind(this);c.addEventListener("touchend",d,u),c.addEventListener("touchcancel",d,u),u.capture=!0,c.addEventListener("pointerdown",et,u),c.addEventListener("pointermove",et,u),c.addEventListener("pointercancel",et,u),c.addEventListener("pointerup",et,u),(r=l(this,fh))==null||r.call(this)}if(et(e),e.touches.length!==2||(o=l(this,dh))!=null&&o.call(this)){m(this,Gi,null);return}let[t,s]=e.touches;t.identifier>s.identifier&&([t,s]=[s,t]),m(this,Gi,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:s.screenX,touch1Y:s.screenY})},P1=function(e){var E;if(!l(this,Gi)||e.touches.length!==2)return;et(e);let[t,s]=e.touches;t.identifier>s.identifier&&([t,s]=[s,t]);const{screenX:i,screenY:r}=t,{screenX:o,screenY:a}=s,c=l(this,Gi),{touch0X:u,touch0Y:d,touch1X:h,touch1Y:f}=c,p=h-u,v=f-d,g=o-i,x=a-r,y=Math.hypot(g,x)||1,w=Math.hypot(p,v)||1;if(!l(this,ua)&&Math.abs(w-y)<=sb.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(c.touch0X=i,c.touch0Y=r,c.touch1X=o,c.touch1Y=a,!l(this,ua)){m(this,ua,!0);return}const b=[(i+o)/2,(r+a)/2];(E=l(this,ph))==null||E.call(this,b,w,y)},R1=function(e){var t;e.touches.length>=2||(l(this,Wi)&&(l(this,Wi).abort(),m(this,Wi,null),(t=l(this,gh))==null||t.call(this)),l(this,Gi)&&(et(e),m(this,Gi,null),m(this,ua,!1)))};let Wd=sb;var fa,Ps,Ne,gc,Jr,mh,pa,Tt,ga,Xi,Zr,yh,ma,Nn,vh,ya,Yi,hi,mc,yc,os,va,wh,Gg,Z,Iv,bh,Ov,Dp,L1,M1,Fv,Np,jv,D1,N1,I1,zv,O1,Bv,F1,j1,z1,$v,Qu;const ie=class ie{constructor(e){A(this,Z);A(this,fa,null);A(this,Ps,null);A(this,Ne,null);A(this,gc,!1);A(this,Jr,null);A(this,mh,"");A(this,pa,!1);A(this,Tt,null);A(this,ga,null);A(this,Xi,null);A(this,Zr,null);A(this,yh,"");A(this,ma,!1);A(this,Nn,null);A(this,vh,!1);A(this,ya,!1);A(this,Yi,!1);A(this,hi,null);A(this,mc,0);A(this,yc,0);A(this,os,null);A(this,va,null);F(this,"isSelected",!1);F(this,"_isCopy",!1);F(this,"_editToolbar",null);F(this,"_initialOptions",Object.create(null));F(this,"_initialData",null);F(this,"_isVisible",!0);F(this,"_uiManager",null);F(this,"_focusEventsAllowed",!0);A(this,wh,!1);A(this,Gg,ie._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null;const{rotation:t,rawDims:{pageWidth:s,pageHeight:i,pageX:r,pageY:o}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,i],this.pageTranslation=[r,o];const[a,c]=this.parentDimensions;this.x=e.x/a,this.y=e.y/c,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=ie.prototype._resizeWithKeyboard,t=Fo.TRANSLATE_SMALL,s=Fo.TRANSLATE_BIG;return le(this,"_resizerKeyboardManager",new Ff([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,s]}],[["Escape","mac+Escape"],ie.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return le(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new WL({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(ie._l10n??(ie._l10n=e),ie._l10nResizer||(ie._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),ie._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);ie._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){_e("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return l(this,wh)}set _isDraggable(e){var t;m(this,wh,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=l(this,Gg)}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):S(this,Z,Qu).call(this),this.parent=e}focusin(e){this._focusEventsAllowed&&(l(this,ma)?m(this,ma,!1):this.parent.setSelected(this))}focusout(e){var s;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(s=this.parent)!=null&&s.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,s,i){const[r,o]=this.parentDimensions;[s,i]=this.screenToPageTranslation(s,i),this.x=(e+s)/r,this.y=(t+i)/o,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[s,i]=this.parentDimensions;this.setAt(e*s,t*i,this.width*s,this.height*i),this._onTranslated()}translate(e,t){S(this,Z,Iv).call(this,this.parentDimensions,e,t)}translateInPage(e,t){l(this,Nn)||m(this,Nn,[this.x,this.y,this.width,this.height]),S(this,Z,Iv).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){l(this,Nn)||m(this,Nn,[this.x,this.y,this.width,this.height]);const{div:s,parentDimensions:[i,r]}=this;if(this.x+=e/i,this.y+=t/r,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:h,y:f}=this.div.getBoundingClientRect();this.parent.findNewParent(this,h,f)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:o,y:a}=this;const[c,u]=this.getBaseTranslation();o+=c,a+=u;const{style:d}=s;d.left=`${(100*o).toFixed(2)}%`,d.top=`${(100*a).toFixed(2)}%`,this._onTranslating(o,a),s.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!l(this,Nn)&&(l(this,Nn)[0]!==this.x||l(this,Nn)[1]!==this.y)}get _hasBeenResized(){return!!l(this,Nn)&&(l(this,Nn)[2]!==this.width||l(this,Nn)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:s}=ie,i=s/e,r=s/t;switch(this.rotation){case 90:return[-i,r];case 180:return[i,r];case 270:return[i,-r];default:return[-i,-r]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[s,i]}=this;let{x:r,y:o,width:a,height:c}=this;if(a*=s,c*=i,r*=s,o*=i,this._mustFixPosition)switch(e){case 0:r=Xt(r,0,s-a),o=Xt(o,0,i-c);break;case 90:r=Xt(r,0,s-c),o=Xt(o,a,i);break;case 180:r=Xt(r,a,s),o=Xt(o,c,i);break;case 270:r=Xt(r,c,s),o=Xt(o,0,i-a);break}this.x=r/=s,this.y=o/=i;const[u,d]=this.getBaseTranslation();r+=u,o+=d,t.left=`${(100*r).toFixed(2)}%`,t.top=`${(100*o).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var s;return S(s=ie,bh,Ov).call(s,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var s;return S(s=ie,bh,Ov).call(s,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,s]}=this;return[t*e,s*e]}setDims(e,t){const[s,i]=this.parentDimensions,{style:r}=this.div;r.width=`${(100*e/s).toFixed(2)}%`,l(this,pa)||(r.height=`${(100*t/i).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:s}=e,i=s.endsWith("%"),r=!l(this,pa)&&t.endsWith("%");if(i&&r)return;const[o,a]=this.parentDimensions;i||(e.width=`${(100*parseFloat(s)/o).toFixed(2)}%`),!l(this,pa)&&!r&&(e.height=`${(100*parseFloat(t)/a).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=l(this,Ne))==null||e.finish()}async addEditToolbar(){return this._editToolbar||l(this,ya)?this._editToolbar:(this._editToolbar=new Cv(this),this.div.append(this._editToolbar.render()),l(this,Ne)&&await this._editToolbar.addAltText(l(this,Ne)),this._editToolbar)}removeEditToolbar(){var e;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(e=l(this,Ne))==null||e.destroy())}addContainer(e){var s;const t=(s=this._editToolbar)==null?void 0:s.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){l(this,Ne)||(Ng.initialize(ie._l10n),m(this,Ne,new Ng(this)),l(this,fa)&&(l(this,Ne).data=l(this,fa),m(this,fa,null)),await this.addEditToolbar())}get altTextData(){var e;return(e=l(this,Ne))==null?void 0:e.data}set altTextData(e){l(this,Ne)&&(l(this,Ne).data=e)}get guessedAltText(){var e;return(e=l(this,Ne))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=l(this,Ne))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=l(this,Ne))==null?void 0:t.serialize(e)}hasAltText(){return!!l(this,Ne)&&!l(this,Ne).isEmpty()}hasAltTextData(){var e;return((e=l(this,Ne))==null?void 0:e.hasData())??!1}render(){var o;const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=l(this,gc)?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),S(this,Z,Bv).call(this);const[t,s]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*s/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/s).toFixed(2)}%`);const[i,r]=this.getInitialTranslation();return this.translate(i,r),m1(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(l(this,va)||m(this,va,new Wd({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:S(this,Z,D1).bind(this),onPinching:S(this,Z,N1).bind(this),onPinchEnd:S(this,Z,I1).bind(this),signal:this._uiManager._signal}))),(o=this._uiManager._editorUndoBar)==null||o.hide(),e}pointerdown(e){const{isMac:t}=Et.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(m(this,ma,!0),this._isDraggable){S(this,Z,O1).call(this,e);return}S(this,Z,zv).call(this,e)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){l(this,hi)&&clearTimeout(l(this,hi)),m(this,hi,setTimeout(()=>{var e;m(this,hi,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,s){e.changeParent(this),this.x=t,this.y=s,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,s=this.rotation){const i=this.parentScale,[r,o]=this.pageDimensions,[a,c]=this.pageTranslation,u=e/i,d=t/i,h=this.x*r,f=this.y*o,p=this.width*r,v=this.height*o;switch(s){case 0:return[h+u+a,o-f-d-v+c,h+u+p+a,o-f-d+c];case 90:return[h+d+a,o-f+u+c,h+d+v+a,o-f+u+p+c];case 180:return[h-u-p+a,o-f+d+c,h-u+a,o-f+d+v+c];case 270:return[h-d-v+a,o-f-u-p+c,h-d+a,o-f-u+c];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[s,i,r,o]=e,a=r-s,c=o-i;switch(this.rotation){case 0:return[s,t-o,a,c];case 90:return[s,t-i,c,a];case 180:return[r,t-i,a,c];case 270:return[r,t-o,c,a];default:throw new Error("Invalid rotation")}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),m(this,ya,!0),!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),m(this,ya,!1),!0):!1}isInEditMode(){return l(this,ya)}shouldGetKeyboardEvents(){return l(this,Yi)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:s,right:i}=this.getClientDimensions(),{innerHeight:r,innerWidth:o}=window;return t<o&&i>0&&e<r&&s>0}rebuild(){S(this,Z,Bv).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){_e("An editor must be serializable")}static async deserialize(e,t,s){const i=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:s});i.rotation=e.rotation,m(i,fa,e.accessibilityData),i._isCopy=e.isCopy||!1;const[r,o]=i.pageDimensions,[a,c,u,d]=i.getRectInCurrentCoords(e.rect,o);return i.x=a/r,i.y=c/o,i.width=u/r,i.height=d/o,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,t;if((e=l(this,Zr))==null||e.abort(),m(this,Zr,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),l(this,hi)&&(clearTimeout(l(this,hi)),m(this,hi,null)),S(this,Z,Qu).call(this),this.removeEditToolbar(),l(this,os)){for(const s of l(this,os).values())clearTimeout(s);m(this,os,null)}this.parent=null,(t=l(this,va))==null||t.destroy(),m(this,va,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(S(this,Z,L1).call(this),l(this,Tt).classList.remove("hidden"))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),m(this,Xi,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=l(this,Tt).children;if(!l(this,Ps)){m(this,Ps,Array.from(t));const o=S(this,Z,F1).bind(this),a=S(this,Z,j1).bind(this),c=this._uiManager._signal;for(const u of l(this,Ps)){const d=u.getAttribute("data-resizer-name");u.setAttribute("role","spinbutton"),u.addEventListener("keydown",o,{signal:c}),u.addEventListener("blur",a,{signal:c}),u.addEventListener("focus",S(this,Z,z1).bind(this,d),{signal:c}),u.setAttribute("data-l10n-id",ie._l10nResizer[d])}}const s=l(this,Ps)[0];let i=0;for(const o of t){if(o===s)break;i++}const r=(360-this.rotation+this.parentRotation)%360/90*(l(this,Ps).length/4);if(r!==i){if(r<i)for(let a=0;a<i-r;a++)l(this,Tt).append(l(this,Tt).firstChild);else if(r>i)for(let a=0;a<r-i;a++)l(this,Tt).firstChild.before(l(this,Tt).lastChild);let o=0;for(const a of t){const u=l(this,Ps)[o++].getAttribute("data-resizer-name");a.setAttribute("data-l10n-id",ie._l10nResizer[u])}}S(this,Z,$v).call(this,0),m(this,Yi,!0),l(this,Tt).firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){l(this,Yi)&&S(this,Z,jv).call(this,l(this,yh),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){S(this,Z,Qu).call(this),this.div.focus()}select(){var e,t,s;if(!(this.isSelected&&this._editToolbar)){if(this.isSelected=!0,this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var i,r;(i=this.div)!=null&&i.classList.contains("selectedEditor")&&((r=this._editToolbar)==null||r.show())});return}(t=this._editToolbar)==null||t.show(),(s=l(this,Ne))==null||s.toggleAltTextBadge(!1)}}unselect(){var e,t,s,i,r;this.isSelected&&(this.isSelected=!1,(e=l(this,Tt))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(s=this.div)!=null&&s.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(i=this._editToolbar)==null||i.hide(),(r=l(this,Ne))==null||r.toggleAltTextBadge(!0))}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id})}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return l(this,vh)}set isEditing(e){m(this,vh,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){m(this,pa,!0);const s=e/t,{style:i}=this.div;i.aspectRatio=s,i.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){l(this,os)||m(this,os,new Map);const{action:s}=e;let i=l(this,os).get(s);i&&clearTimeout(i),i=setTimeout(()=>{this._reportTelemetry(e),l(this,os).delete(s),l(this,os).size===0&&m(this,os,null)},ie._telemetryTimeout),l(this,os).set(s,i);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),m(this,gc,!1)}disable(){this.div&&(this.div.tabIndex=-1),m(this,gc,!0)}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const s=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),s.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};fa=new WeakMap,Ps=new WeakMap,Ne=new WeakMap,gc=new WeakMap,Jr=new WeakMap,mh=new WeakMap,pa=new WeakMap,Tt=new WeakMap,ga=new WeakMap,Xi=new WeakMap,Zr=new WeakMap,yh=new WeakMap,ma=new WeakMap,Nn=new WeakMap,vh=new WeakMap,ya=new WeakMap,Yi=new WeakMap,hi=new WeakMap,mc=new WeakMap,yc=new WeakMap,os=new WeakMap,va=new WeakMap,wh=new WeakMap,Gg=new WeakMap,Z=new WeakSet,Iv=function([e,t],s,i){[s,i]=this.screenToPageTranslation(s,i),this.x+=s/e,this.y+=i/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},bh=new WeakSet,Ov=function(e,t,s){switch(s){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},Dp=function(e){switch(e){case 90:{const[t,s]=this.pageDimensions;return[0,-t/s,s/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,s]=this.pageDimensions;return[0,t/s,-s/t,0]}default:return[1,0,0,1]}},L1=function(){if(l(this,Tt))return;m(this,Tt,document.createElement("div")),l(this,Tt).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const s of e){const i=document.createElement("div");l(this,Tt).append(i),i.classList.add("resizer",s),i.setAttribute("data-resizer-name",s),i.addEventListener("pointerdown",S(this,Z,M1).bind(this,s),{signal:t}),i.addEventListener("contextmenu",As,{signal:t}),i.tabIndex=-1}this.div.prepend(l(this,Tt))},M1=function(e,t){var d;t.preventDefault();const{isMac:s}=Et.platform;if(t.button!==0||t.ctrlKey&&s)return;(d=l(this,Ne))==null||d.toggle(!1);const i=this._isDraggable;this._isDraggable=!1,m(this,ga,[t.screenX,t.screenY]);const r=new AbortController,o=this._uiManager.combinedSignal(r);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",S(this,Z,jv).bind(this,e),{passive:!0,capture:!0,signal:o}),window.addEventListener("touchmove",et,{passive:!1,signal:o}),window.addEventListener("contextmenu",As,{signal:o}),m(this,Xi,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const a=this.parent.div.style.cursor,c=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const u=()=>{var h;r.abort(),this.parent.togglePointerEvents(!0),(h=l(this,Ne))==null||h.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=a,this.div.style.cursor=c,S(this,Z,Np).call(this)};window.addEventListener("pointerup",u,{signal:o}),window.addEventListener("blur",u,{signal:o})},Fv=function(e,t,s,i){this.width=s,this.height=i,this.x=e,this.y=t;const[r,o]=this.parentDimensions;this.setDims(r*s,o*i),this.fixAndSetPosition(),this._onResized()},Np=function(){if(!l(this,Xi))return;const{savedX:e,savedY:t,savedWidth:s,savedHeight:i}=l(this,Xi);m(this,Xi,null);const r=this.x,o=this.y,a=this.width,c=this.height;r===e&&o===t&&a===s&&c===i||this.addCommands({cmd:S(this,Z,Fv).bind(this,r,o,a,c),undo:S(this,Z,Fv).bind(this,e,t,s,i),mustExec:!0})},jv=function(e,t){const[s,i]=this.parentDimensions,r=this.x,o=this.y,a=this.width,c=this.height,u=ie.MIN_SIZE/s,d=ie.MIN_SIZE/i,h=S(this,Z,Dp).call(this,this.rotation),f=(j,O)=>[h[0]*j+h[2]*O,h[1]*j+h[3]*O],p=S(this,Z,Dp).call(this,360-this.rotation),v=(j,O)=>[p[0]*j+p[2]*O,p[1]*j+p[3]*O];let g,x,y=!1,w=!1;switch(e){case"topLeft":y=!0,g=(j,O)=>[0,0],x=(j,O)=>[j,O];break;case"topMiddle":g=(j,O)=>[j/2,0],x=(j,O)=>[j/2,O];break;case"topRight":y=!0,g=(j,O)=>[j,0],x=(j,O)=>[0,O];break;case"middleRight":w=!0,g=(j,O)=>[j,O/2],x=(j,O)=>[0,O/2];break;case"bottomRight":y=!0,g=(j,O)=>[j,O],x=(j,O)=>[0,0];break;case"bottomMiddle":g=(j,O)=>[j/2,O],x=(j,O)=>[j/2,0];break;case"bottomLeft":y=!0,g=(j,O)=>[0,O],x=(j,O)=>[j,0];break;case"middleLeft":w=!0,g=(j,O)=>[0,O/2],x=(j,O)=>[j,O/2];break}const b=g(a,c),E=x(a,c);let _=f(...E);const k=ie._round(r+_[0]),C=ie._round(o+_[1]);let P=1,L=1,M,D;if(t.fromKeyboard)({deltaX:M,deltaY:D}=t);else{const{screenX:j,screenY:O}=t,[I,$]=l(this,ga);[M,D]=this.screenToPageTranslation(j-I,O-$),l(this,ga)[0]=j,l(this,ga)[1]=O}if([M,D]=v(M/s,D/i),y){const j=Math.hypot(a,c);P=L=Math.max(Math.min(Math.hypot(E[0]-b[0]-M,E[1]-b[1]-D)/j,1/a,1/c),u/a,d/c)}else w?P=Xt(Math.abs(E[0]-b[0]-M),u,1)/a:L=Xt(Math.abs(E[1]-b[1]-D),d,1)/c;const K=ie._round(a*P),Q=ie._round(c*L);_=f(...x(K,Q));const G=k-_[0],te=C-_[1];l(this,Nn)||m(this,Nn,[this.x,this.y,this.width,this.height]),this.width=K,this.height=Q,this.x=G,this.y=te,this.setDims(s*K,i*Q),this.fixAndSetPosition(),this._onResizing()},D1=function(){var e;m(this,Xi,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=l(this,Ne))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},N1=function(e,t,s){let r=.7*(s/t)+1-.7;if(r===1)return;const o=S(this,Z,Dp).call(this,this.rotation),a=(k,C)=>[o[0]*k+o[2]*C,o[1]*k+o[3]*C],[c,u]=this.parentDimensions,d=this.x,h=this.y,f=this.width,p=this.height,v=ie.MIN_SIZE/c,g=ie.MIN_SIZE/u;r=Math.max(Math.min(r,1/f,1/p),v/f,g/p);const x=ie._round(f*r),y=ie._round(p*r);if(x===f&&y===p)return;l(this,Nn)||m(this,Nn,[d,h,f,p]);const w=a(f/2,p/2),b=ie._round(d+w[0]),E=ie._round(h+w[1]),_=a(x/2,y/2);this.x=b-_[0],this.y=E-_[1],this.width=x,this.height=y,this.setDims(c*x,u*y),this.fixAndSetPosition(),this._onResizing()},I1=function(){var e;(e=l(this,Ne))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),S(this,Z,Np).call(this)},zv=function(e){const{isMac:t}=Et.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},O1=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let s=!1;const i=new AbortController,r=this._uiManager.combinedSignal(i),o={capture:!0,passive:!1,signal:r},a=u=>{i.abort(),m(this,Jr,null),m(this,ma,!1),this._uiManager.endDragSession()||S(this,Z,zv).call(this,u),s&&this._onStopDragging()};t&&(m(this,mc,e.clientX),m(this,yc,e.clientY),m(this,Jr,e.pointerId),m(this,mh,e.pointerType),window.addEventListener("pointermove",u=>{s||(s=!0,this._onStartDragging());const{clientX:d,clientY:h,pointerId:f}=u;if(f!==l(this,Jr)){et(u);return}const[p,v]=this.screenToPageTranslation(d-l(this,mc),h-l(this,yc));m(this,mc,d),m(this,yc,h),this._uiManager.dragSelectedEditors(p,v)},o),window.addEventListener("touchmove",et,o),window.addEventListener("pointerdown",u=>{u.pointerType===l(this,mh)&&(l(this,va)||u.isPrimary)&&a(u),et(u)},o));const c=u=>{if(!l(this,Jr)||l(this,Jr)===u.pointerId){a(u);return}et(u)};window.addEventListener("pointerup",c,{signal:r}),window.addEventListener("blur",c,{signal:r})},Bv=function(){if(l(this,Zr)||!this.div)return;m(this,Zr,new AbortController);const e=this._uiManager.combinedSignal(l(this,Zr));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},F1=function(e){ie._resizerKeyboardManager.exec(this,e)},j1=function(e){var t;l(this,Yi)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==l(this,Tt)&&S(this,Z,Qu).call(this)},z1=function(e){m(this,yh,l(this,Yi)?e:"")},$v=function(e){if(l(this,Ps))for(const t of l(this,Ps))t.tabIndex=e},Qu=function(){m(this,Yi,!1),S(this,Z,$v).call(this,-1),S(this,Z,Np).call(this)},A(ie,bh),F(ie,"_l10n",null),F(ie,"_l10nResizer",null),F(ie,"_borderLineWidth",-1),F(ie,"_colorManager",new Tv),F(ie,"_zIndex",1),F(ie,"_telemetryTimeout",1e3);let Me=ie;class WL extends Me{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const jA=3285377520,ns=4294901760,ti=65535;class B1{constructor(e){this.h1=e?e&4294967295:jA,this.h2=e?e&4294967295:jA}update(e){let t,s;if(typeof e=="string"){t=new Uint8Array(e.length*2),s=0;for(let g=0,x=e.length;g<x;g++){const y=e.charCodeAt(g);y<=255?t[s++]=y:(t[s++]=y>>>8,t[s++]=y&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),s=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const i=s>>2,r=s-i*4,o=new Uint32Array(t.buffer,0,i);let a=0,c=0,u=this.h1,d=this.h2;const h=3432918353,f=461845907,p=h&ti,v=f&ti;for(let g=0;g<i;g++)g&1?(a=o[g],a=a*h&ns|a*p&ti,a=a<<15|a>>>17,a=a*f&ns|a*v&ti,u^=a,u=u<<13|u>>>19,u=u*5+3864292196):(c=o[g],c=c*h&ns|c*p&ti,c=c<<15|c>>>17,c=c*f&ns|c*v&ti,d^=c,d=d<<13|d>>>19,d=d*5+3864292196);switch(a=0,r){case 3:a^=t[i*4+2]<<16;case 2:a^=t[i*4+1]<<8;case 1:a^=t[i*4],a=a*h&ns|a*p&ti,a=a<<15|a>>>17,a=a*f&ns|a*v&ti,i&1?u^=a:d^=a}this.h1=u,this.h2=d}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&ns|e*36045&ti,t=t*4283543511&ns|((t<<16|e>>>16)*2950163797&ns)>>>16,e^=t>>>1,e=e*444984403&ns|e*60499&ti,t=t*3301882366&ns|((t<<16|e>>>16)*3120437893&ns)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const Hv=Object.freeze({map:null,hash:"",transfer:void 0});var wa,ba,Pt,Wg,$1;class Ww{constructor(){A(this,Wg);A(this,wa,!1);A(this,ba,null);A(this,Pt,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const s=l(this,Pt).get(e);return s===void 0?t:Object.assign(t,s)}getRawValue(e){return l(this,Pt).get(e)}remove(e){if(l(this,Pt).delete(e),l(this,Pt).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of l(this,Pt).values())if(t instanceof Me)return;this.onAnnotationEditor(null)}}setValue(e,t){const s=l(this,Pt).get(e);let i=!1;if(s!==void 0)for(const[r,o]of Object.entries(t))s[r]!==o&&(i=!0,s[r]=o);else i=!0,l(this,Pt).set(e,t);i&&S(this,Wg,$1).call(this),t instanceof Me&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return l(this,Pt).has(e)}get size(){return l(this,Pt).size}resetModified(){l(this,wa)&&(m(this,wa,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new H1(this)}get serializable(){if(l(this,Pt).size===0)return Hv;const e=new Map,t=new B1,s=[],i=Object.create(null);let r=!1;for(const[o,a]of l(this,Pt)){const c=a instanceof Me?a.serialize(!1,i):a;c&&(e.set(o,c),t.update(`${o}:${JSON.stringify(c)}`),r||(r=!!c.bitmap))}if(r)for(const o of e.values())o.bitmap&&s.push(o.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:s}:Hv}get editorStats(){let e=null;const t=new Map;for(const s of l(this,Pt).values()){if(!(s instanceof Me))continue;const i=s.telemetryFinalData;if(!i)continue;const{type:r}=i;t.has(r)||t.set(r,Object.getPrototypeOf(s).constructor),e||(e=Object.create(null));const o=e[r]||(e[r]=new Map);for(const[a,c]of Object.entries(i)){if(a==="type")continue;let u=o.get(a);u||(u=new Map,o.set(a,u));const d=u.get(c)??0;u.set(c,d+1)}}for(const[s,i]of t)e[s]=i.computeTelemetryFinalData(e[s]);return e}resetModifiedIds(){m(this,ba,null)}get modifiedIds(){if(l(this,ba))return l(this,ba);const e=[];for(const t of l(this,Pt).values())!(t instanceof Me)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return m(this,ba,{ids:new Set(e),hash:e.join(",")})}[Symbol.iterator](){return l(this,Pt).entries()}}wa=new WeakMap,ba=new WeakMap,Pt=new WeakMap,Wg=new WeakSet,$1=function(){l(this,wa)||(m(this,wa,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var Ah;class H1 extends Ww{constructor(t){super();A(this,Ah);const{map:s,hash:i,transfer:r}=t.serializable,o=structuredClone(s,r?{transfer:r}:null);m(this,Ah,{map:o,hash:i,transfer:r})}get print(){_e("Should not call PrintAnnotationStorage.print")}get serializable(){return l(this,Ah)}get modifiedIds(){return le(this,"modifiedIds",{ids:new Set,hash:""})}}Ah=new WeakMap;var vc;class XL{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){A(this,vc,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),l(this,vc).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:s}){if(!(!e||l(this,vc).has(e.loadedName))){if(rt(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:i,src:r,style:o}=e,a=new FontFace(i,r,o);this.addNativeFontFace(a);try{await a.load(),l(this,vc).add(i),s==null||s(e)}catch{ne(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(a)}return}_e("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const s=e.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(i){throw ne(`Failed to load font '${s.family}': '${i}'.`),e.disableFontFace=!0,i}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const i=this._queueLoadingCallback(s);this._prepareFontLoadEvent(e,i)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return le(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return le(this,"isSyncFontLoadingSupported",sn||Et.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(rt(!i.done,"completeRequest() cannot be called twice."),i.done=!0;s.length>0&&s[0].done;){const r=s.shift();setTimeout(r.callback,0)}}const{loadingRequests:s}=this,i={done:!1,complete:t,callback:e};return s.push(i),i}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return le(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function s(E,_){return E.charCodeAt(_)<<24|E.charCodeAt(_+1)<<16|E.charCodeAt(_+2)<<8|E.charCodeAt(_+3)&255}function i(E,_,k,C){const P=E.substring(0,_),L=E.substring(_+k);return P+C+L}let r,o;const a=this._document.createElement("canvas");a.width=1,a.height=1;const c=a.getContext("2d");let u=0;function d(E,_){if(++u>30){ne("Load test font never loaded."),_();return}if(c.font="30px "+E,c.fillText(".",0,20),c.getImageData(0,0,1,1).data[3]>0){_();return}setTimeout(d.bind(null,E,_))}const h=`lt${Date.now()}${this.loadTestFontId++}`;let f=this._loadTestFont;f=i(f,976,h.length,h);const v=16,g=1482184792;let x=s(f,v);for(r=0,o=h.length-3;r<o;r+=4)x=x-g+s(h,r)|0;r<h.length&&(x=x-g+s(h+"XXX",r)|0),f=i(f,v,4,IL(x));const y=`url(data:font/opentype;base64,${btoa(f)});`,w=`@font-face {font-family:"${h}";src:${y}}`;this.insertRule(w);const b=this._document.createElement("div");b.style.visibility="hidden",b.style.width=b.style.height="10px",b.style.position="absolute",b.style.top=b.style.left="0px";for(const E of[e.loadedName,h]){const _=this._document.createElement("span");_.textContent="Hi",_.style.fontFamily=E,b.append(_)}this._document.body.append(b),d(h,()=>{b.remove(),t.complete()})}}vc=new WeakMap;class YL{constructor(e,t=null){this.compiledGlyphs=Object.create(null);for(const s in e)this[s]=e[s];this._inspectFont=t}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const s={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(s.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,s)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var s;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${r1(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${e}}`}return(s=this._inspectFont)==null||s.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const s=this.loadedName+"_path_"+t;let i;try{i=e.get(s)}catch(o){ne(`getPathGenerator - ignoring character: "${o}".`)}const r=new Path2D(i||"");return this.fontExtraProperties||e.delete(s),this.compiledGlyphs[t]=r}}function qL(n){if(n instanceof URL)return n.href;if(typeof n=="string"){if(sn)return n;const e=URL.parse(n,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function KL(n){if(sn&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return Nf(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n==null?void 0:n.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function lp(n){if(typeof n!="string")return null;if(n.endsWith("/"))return n;throw new Error(`Invalid factory url: "${n}" must include trailing slash.`)}const Uv=n=>typeof n=="object"&&Number.isInteger(n==null?void 0:n.num)&&n.num>=0&&Number.isInteger(n==null?void 0:n.gen)&&n.gen>=0,QL=n=>typeof n=="object"&&typeof(n==null?void 0:n.name)=="string",U1=zL.bind(null,Uv,QL);var qi,Xg;class JL{constructor(){A(this,qi,new Map);A(this,Xg,Promise.resolve())}postMessage(e,t){const s={data:structuredClone(e,t?{transfer:t}:null)};l(this,Xg).then(()=>{for(const[i]of l(this,qi))i.call(this,s)})}addEventListener(e,t,s=null){let i=null;if((s==null?void 0:s.signal)instanceof AbortSignal){const{signal:r}=s;if(r.aborted){ne("LoopbackPort - cannot use an `aborted` signal.");return}const o=()=>this.removeEventListener(e,t);i=()=>r.removeEventListener("abort",o),r.addEventListener("abort",o)}l(this,qi).set(t,i)}removeEventListener(e,t){const s=l(this,qi).get(t);s==null||s(),l(this,qi).delete(t)}terminate(){for(const[,e]of l(this,qi))e==null||e();l(this,qi).clear()}}qi=new WeakMap,Xg=new WeakMap;const cp={DATA:1,ERROR:2},st={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function zA(){}function dn(n){if(n instanceof Er||n instanceof Mg||n instanceof IA||n instanceof Gd||n instanceof wy)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||_e('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new Er(n.message);case"InvalidPDFException":return new Mg(n.message);case"PasswordException":return new IA(n.message,n.code);case"ResponseException":return new Gd(n.message,n.status,n.missing);case"UnknownErrorException":return new wy(n.message,n.details)}return new wy(n.message,n.toString())}var wc,vs,V1,G1,W1,Ip;class Ju{constructor(e,t,s){A(this,vs);A(this,wc,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),s.addEventListener("message",S(this,vs,V1).bind(this),{signal:l(this,wc).signal})}on(e,t){const s=this.actionHandler;if(s[e])throw new Error(`There is already an actionName called "${e}"`);s[e]=t}send(e,t,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},s)}sendWithPromise(e,t,s){const i=this.callbackId++,r=Promise.withResolvers();this.callbackCapabilities[i]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:i,data:t},s)}catch(o){r.reject(o)}return r.promise}sendWithStream(e,t,s,i){const r=this.streamId++,o=this.sourceName,a=this.targetName,c=this.comObj;return new ReadableStream({start:u=>{const d=Promise.withResolvers();return this.streamControllers[r]={controller:u,startCall:d,pullCall:null,cancelCall:null,isClosed:!1},c.postMessage({sourceName:o,targetName:a,action:e,streamId:r,data:t,desiredSize:u.desiredSize},i),d.promise},pull:u=>{const d=Promise.withResolvers();return this.streamControllers[r].pullCall=d,c.postMessage({sourceName:o,targetName:a,stream:st.PULL,streamId:r,desiredSize:u.desiredSize}),d.promise},cancel:u=>{rt(u instanceof Error,"cancel must have a valid reason");const d=Promise.withResolvers();return this.streamControllers[r].cancelCall=d,this.streamControllers[r].isClosed=!0,c.postMessage({sourceName:o,targetName:a,stream:st.CANCEL,streamId:r,reason:dn(u)}),d.promise}},s)}destroy(){var e;(e=l(this,wc))==null||e.abort(),m(this,wc,null)}}wc=new WeakMap,vs=new WeakSet,V1=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){S(this,vs,W1).call(this,e);return}if(e.callback){const s=e.callbackId,i=this.callbackCapabilities[s];if(!i)throw new Error(`Cannot resolve callback ${s}`);if(delete this.callbackCapabilities[s],e.callback===cp.DATA)i.resolve(e.data);else if(e.callback===cp.ERROR)i.reject(dn(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const s=this.sourceName,i=e.sourceName,r=this.comObj;Promise.try(t,e.data).then(function(o){r.postMessage({sourceName:s,targetName:i,callback:cp.DATA,callbackId:e.callbackId,data:o})},function(o){r.postMessage({sourceName:s,targetName:i,callback:cp.ERROR,callbackId:e.callbackId,reason:dn(o)})});return}if(e.streamId){S(this,vs,G1).call(this,e);return}t(e.data)},G1=function(e){const t=e.streamId,s=this.sourceName,i=e.sourceName,r=this.comObj,o=this,a=this.actionHandler[e.action],c={enqueue(u,d=1,h){if(this.isCancelled)return;const f=this.desiredSize;this.desiredSize-=d,f>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),r.postMessage({sourceName:s,targetName:i,stream:st.ENQUEUE,streamId:t,chunk:u},h)},close(){this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:s,targetName:i,stream:st.CLOSE,streamId:t}),delete o.streamSinks[t])},error(u){rt(u instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,r.postMessage({sourceName:s,targetName:i,stream:st.ERROR,streamId:t,reason:dn(u)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};c.sinkCapability.resolve(),c.ready=c.sinkCapability.promise,this.streamSinks[t]=c,Promise.try(a,e.data,c).then(function(){r.postMessage({sourceName:s,targetName:i,stream:st.START_COMPLETE,streamId:t,success:!0})},function(u){r.postMessage({sourceName:s,targetName:i,stream:st.START_COMPLETE,streamId:t,reason:dn(u)})})},W1=function(e){const t=e.streamId,s=this.sourceName,i=e.sourceName,r=this.comObj,o=this.streamControllers[t],a=this.streamSinks[t];switch(e.stream){case st.START_COMPLETE:e.success?o.startCall.resolve():o.startCall.reject(dn(e.reason));break;case st.PULL_COMPLETE:e.success?o.pullCall.resolve():o.pullCall.reject(dn(e.reason));break;case st.PULL:if(!a){r.postMessage({sourceName:s,targetName:i,stream:st.PULL_COMPLETE,streamId:t,success:!0});break}a.desiredSize<=0&&e.desiredSize>0&&a.sinkCapability.resolve(),a.desiredSize=e.desiredSize,Promise.try(a.onPull||zA).then(function(){r.postMessage({sourceName:s,targetName:i,stream:st.PULL_COMPLETE,streamId:t,success:!0})},function(u){r.postMessage({sourceName:s,targetName:i,stream:st.PULL_COMPLETE,streamId:t,reason:dn(u)})});break;case st.ENQUEUE:if(rt(o,"enqueue should have stream controller"),o.isClosed)break;o.controller.enqueue(e.chunk);break;case st.CLOSE:if(rt(o,"close should have stream controller"),o.isClosed)break;o.isClosed=!0,o.controller.close(),S(this,vs,Ip).call(this,o,t);break;case st.ERROR:rt(o,"error should have stream controller"),o.controller.error(dn(e.reason)),S(this,vs,Ip).call(this,o,t);break;case st.CANCEL_COMPLETE:e.success?o.cancelCall.resolve():o.cancelCall.reject(dn(e.reason)),S(this,vs,Ip).call(this,o,t);break;case st.CANCEL:if(!a)break;const c=dn(e.reason);Promise.try(a.onCancel||zA,c).then(function(){r.postMessage({sourceName:s,targetName:i,stream:st.CANCEL_COMPLETE,streamId:t,success:!0})},function(u){r.postMessage({sourceName:s,targetName:i,stream:st.CANCEL_COMPLETE,streamId:t,reason:dn(u)})}),a.sinkCapability.reject(c),a.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},Ip=async function(e,t){var s,i,r;await Promise.allSettled([(s=e.startCall)==null?void 0:s.promise,(i=e.pullCall)==null?void 0:i.promise,(r=e.cancelCall)==null?void 0:r.promise]),delete this.streamControllers[t]};var Sh;class X1{constructor({enableHWA:e=!1}){A(this,Sh,!1);m(this,Sh,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(e,t);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!l(this,Sh)})}}reset(e,t,s){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||s<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=s}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){_e("Abstract method `_createCanvas` called.")}}Sh=new WeakMap;class ZL extends X1{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const s=this._document.createElement("canvas");return s.width=e,s.height=t,s}}class Y1{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(s=>({cMapData:s,isCompressed:this.isCompressed})).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){_e("Abstract method `_fetch` called.")}}class BA extends Y1{async _fetch(e){const t=await Cu(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):Nf(t)}}class q1{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,s,i,r){return"none"}destroy(e=!1){}}var Aa,bc,Ki,Qi,Vt,Sa,xa,B,Ht,Zu,_l,Op,Cl,K1,Vv,kl,ed,td,Gv,nd;class e2 extends q1{constructor({docId:t,ownerDocument:s=globalThis.document}){super();A(this,B);A(this,Aa);A(this,bc);A(this,Ki);A(this,Qi);A(this,Vt);A(this,Sa);A(this,xa,0);m(this,Qi,t),m(this,Vt,s)}addFilter(t){if(!t)return"none";let s=l(this,B,Ht).get(t);if(s)return s;const[i,r,o]=S(this,B,Op).call(this,t),a=t.length===1?i:`${i}${r}${o}`;if(s=l(this,B,Ht).get(a),s)return l(this,B,Ht).set(t,s),s;const c=`g_${l(this,Qi)}_transfer_map_${Qt(this,xa)._++}`,u=S(this,B,Cl).call(this,c);l(this,B,Ht).set(t,u),l(this,B,Ht).set(a,u);const d=S(this,B,kl).call(this,c);return S(this,B,td).call(this,i,r,o,d),u}addHCMFilter(t,s){var v;const i=`${t}-${s}`,r="base";let o=l(this,B,Zu).get(r);if((o==null?void 0:o.key)===i||(o?((v=o.filter)==null||v.remove(),o.key=i,o.url="none",o.filter=null):(o={key:i,url:"none",filter:null},l(this,B,Zu).set(r,o)),!t||!s))return o.url;const a=S(this,B,nd).call(this,t);t=Y.makeHexColor(...a);const c=S(this,B,nd).call(this,s);if(s=Y.makeHexColor(...c),l(this,B,_l).style.color="",t==="#000000"&&s==="#ffffff"||t===s)return o.url;const u=new Array(256);for(let g=0;g<=255;g++){const x=g/255;u[g]=x<=.03928?x/12.92:((x+.055)/1.055)**2.4}const d=u.join(","),h=`g_${l(this,Qi)}_hcm_filter`,f=o.filter=S(this,B,kl).call(this,h);S(this,B,td).call(this,d,d,d,f),S(this,B,Vv).call(this,f);const p=(g,x)=>{const y=a[g]/255,w=c[g]/255,b=new Array(x+1);for(let E=0;E<=x;E++)b[E]=y+E/x*(w-y);return b.join(",")};return S(this,B,td).call(this,p(0,5),p(1,5),p(2,5),f),o.url=S(this,B,Cl).call(this,h),o.url}addAlphaFilter(t){let s=l(this,B,Ht).get(t);if(s)return s;const[i]=S(this,B,Op).call(this,[t]),r=`alpha_${i}`;if(s=l(this,B,Ht).get(r),s)return l(this,B,Ht).set(t,s),s;const o=`g_${l(this,Qi)}_alpha_map_${Qt(this,xa)._++}`,a=S(this,B,Cl).call(this,o);l(this,B,Ht).set(t,a),l(this,B,Ht).set(r,a);const c=S(this,B,kl).call(this,o);return S(this,B,Gv).call(this,i,c),a}addLuminosityFilter(t){let s=l(this,B,Ht).get(t||"luminosity");if(s)return s;let i,r;if(t?([i]=S(this,B,Op).call(this,[t]),r=`luminosity_${i}`):r="luminosity",s=l(this,B,Ht).get(r),s)return l(this,B,Ht).set(t,s),s;const o=`g_${l(this,Qi)}_luminosity_map_${Qt(this,xa)._++}`,a=S(this,B,Cl).call(this,o);l(this,B,Ht).set(t,a),l(this,B,Ht).set(r,a);const c=S(this,B,kl).call(this,o);return S(this,B,K1).call(this,c),t&&S(this,B,Gv).call(this,i,c),a}addHighlightHCMFilter(t,s,i,r,o){var w;const a=`${s}-${i}-${r}-${o}`;let c=l(this,B,Zu).get(t);if((c==null?void 0:c.key)===a||(c?((w=c.filter)==null||w.remove(),c.key=a,c.url="none",c.filter=null):(c={key:a,url:"none",filter:null},l(this,B,Zu).set(t,c)),!s||!i))return c.url;const[u,d]=[s,i].map(S(this,B,nd).bind(this));let h=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),f=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),[p,v]=[r,o].map(S(this,B,nd).bind(this));f<h&&([h,f,p,v]=[f,h,v,p]),l(this,B,_l).style.color="";const g=(b,E,_)=>{const k=new Array(256),C=(f-h)/_,P=b/255,L=(E-b)/(255*_);let M=0;for(let D=0;D<=_;D++){const K=Math.round(h+D*C),Q=P+D*L;for(let G=M;G<=K;G++)k[G]=Q;M=K+1}for(let D=M;D<256;D++)k[D]=k[M-1];return k.join(",")},x=`g_${l(this,Qi)}_hcm_${t}_filter`,y=c.filter=S(this,B,kl).call(this,x);return S(this,B,Vv).call(this,y),S(this,B,td).call(this,g(p[0],v[0],5),g(p[1],v[1],5),g(p[2],v[2],5),y),c.url=S(this,B,Cl).call(this,x),c.url}destroy(t=!1){var s,i,r,o;t&&((s=l(this,Sa))!=null&&s.size)||((i=l(this,Ki))==null||i.parentNode.parentNode.remove(),m(this,Ki,null),(r=l(this,bc))==null||r.clear(),m(this,bc,null),(o=l(this,Sa))==null||o.clear(),m(this,Sa,null),m(this,xa,0))}}Aa=new WeakMap,bc=new WeakMap,Ki=new WeakMap,Qi=new WeakMap,Vt=new WeakMap,Sa=new WeakMap,xa=new WeakMap,B=new WeakSet,Ht=function(){return l(this,bc)||m(this,bc,new Map)},Zu=function(){return l(this,Sa)||m(this,Sa,new Map)},_l=function(){if(!l(this,Ki)){const t=l(this,Vt).createElement("div"),{style:s}=t;s.visibility="hidden",s.contain="strict",s.width=s.height=0,s.position="absolute",s.top=s.left=0,s.zIndex=-1;const i=l(this,Vt).createElementNS(Di,"svg");i.setAttribute("width",0),i.setAttribute("height",0),m(this,Ki,l(this,Vt).createElementNS(Di,"defs")),t.append(i),i.append(l(this,Ki)),l(this,Vt).body.append(t)}return l(this,Ki)},Op=function(t){if(t.length===1){const u=t[0],d=new Array(256);for(let f=0;f<256;f++)d[f]=u[f]/255;const h=d.join(",");return[h,h,h]}const[s,i,r]=t,o=new Array(256),a=new Array(256),c=new Array(256);for(let u=0;u<256;u++)o[u]=s[u]/255,a[u]=i[u]/255,c[u]=r[u]/255;return[o.join(","),a.join(","),c.join(",")]},Cl=function(t){if(l(this,Aa)===void 0){m(this,Aa,"");const s=l(this,Vt).URL;s!==l(this,Vt).baseURI&&(Of(s)?ne('#createUrl: ignore "data:"-URL for performance reasons.'):m(this,Aa,Hw(s,"")))}return`url(${l(this,Aa)}#${t})`},K1=function(t){const s=l(this,Vt).createElementNS(Di,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(s)},Vv=function(t){const s=l(this,Vt).createElementNS(Di,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(s)},kl=function(t){const s=l(this,Vt).createElementNS(Di,"filter");return s.setAttribute("color-interpolation-filters","sRGB"),s.setAttribute("id",t),l(this,B,_l).append(s),s},ed=function(t,s,i){const r=l(this,Vt).createElementNS(Di,s);r.setAttribute("type","discrete"),r.setAttribute("tableValues",i),t.append(r)},td=function(t,s,i,r){const o=l(this,Vt).createElementNS(Di,"feComponentTransfer");r.append(o),S(this,B,ed).call(this,o,"feFuncR",t),S(this,B,ed).call(this,o,"feFuncG",s),S(this,B,ed).call(this,o,"feFuncB",i)},Gv=function(t,s){const i=l(this,Vt).createElementNS(Di,"feComponentTransfer");s.append(i),S(this,B,ed).call(this,i,"feFuncA",t)},nd=function(t){return l(this,B,_l).style.color=t,Gw(getComputedStyle(l(this,B,_l)).getPropertyValue("color"))};class Q1{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(s=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){_e("Abstract method `_fetch` called.")}}class $A extends Q1{async _fetch(e){const t=await Cu(e,"arraybuffer");return new Uint8Array(t)}}class J1{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(s=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){_e("Abstract method `_fetch` called.")}}class HA extends J1{async _fetch(e){const t=await Cu(e,"arraybuffer");return new Uint8Array(t)}}sn&&ne("Please use the `legacy` build in Node.js environments.");async function Xw(n){const t=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(t)}class t2 extends q1{}class n2 extends X1{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class s2 extends Y1{async _fetch(e){return Xw(e)}}class i2 extends Q1{async _fetch(e){return Xw(e)}}class r2 extends J1{async _fetch(e){return Xw(e)}}const Dt={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Wv(n,e){if(!e)return;const t=e[2]-e[0],s=e[3]-e[1],i=new Path2D;i.rect(e[0],e[1],t,s),n.clip(i)}class Yw{isModifyingCurrentTransform(){return!1}getPattern(){_e("Abstract method `getPattern` called.")}}class o2 extends Yw{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const s of this._colorStops)t.addColorStop(s[0],s[1]);return t}getPattern(e,t,s,i){let r;if(i===Dt.STROKE||i===Dt.FILL){const o=t.current.getClippedPathBoundingBox(i,He(e))||[0,0,0,0],a=Math.ceil(o[2]-o[0])||1,c=Math.ceil(o[3]-o[1])||1,u=t.cachedCanvases.getCanvas("pattern",a,c),d=u.context;d.clearRect(0,0,d.canvas.width,d.canvas.height),d.beginPath(),d.rect(0,0,d.canvas.width,d.canvas.height),d.translate(-o[0],-o[1]),s=Y.transform(s,[1,0,0,1,o[0],o[1]]),d.transform(...t.baseTransform),this.matrix&&d.transform(...this.matrix),Wv(d,this._bbox),d.fillStyle=this._createGradient(d),d.fill(),r=e.createPattern(u.canvas,"no-repeat");const h=new DOMMatrix(s);r.setTransform(h)}else Wv(e,this._bbox),r=this._createGradient(e);return r}}function Sy(n,e,t,s,i,r,o,a){const c=e.coords,u=e.colors,d=n.data,h=n.width*4;let f;c[t+1]>c[s+1]&&(f=t,t=s,s=f,f=r,r=o,o=f),c[s+1]>c[i+1]&&(f=s,s=i,i=f,f=o,o=a,a=f),c[t+1]>c[s+1]&&(f=t,t=s,s=f,f=r,r=o,o=f);const p=(c[t]+e.offsetX)*e.scaleX,v=(c[t+1]+e.offsetY)*e.scaleY,g=(c[s]+e.offsetX)*e.scaleX,x=(c[s+1]+e.offsetY)*e.scaleY,y=(c[i]+e.offsetX)*e.scaleX,w=(c[i+1]+e.offsetY)*e.scaleY;if(v>=w)return;const b=u[r],E=u[r+1],_=u[r+2],k=u[o],C=u[o+1],P=u[o+2],L=u[a],M=u[a+1],D=u[a+2],K=Math.round(v),Q=Math.round(w);let G,te,j,O,I,$,X,re;for(let J=K;J<=Q;J++){if(J<x){const fe=J<v?0:(v-J)/(v-x);G=p-(p-g)*fe,te=b-(b-k)*fe,j=E-(E-C)*fe,O=_-(_-P)*fe}else{let fe;J>w?fe=1:x===w?fe=0:fe=(x-J)/(x-w),G=g-(g-y)*fe,te=k-(k-L)*fe,j=C-(C-M)*fe,O=P-(P-D)*fe}let oe;J<v?oe=0:J>w?oe=1:oe=(v-J)/(v-w),I=p-(p-y)*oe,$=b-(b-L)*oe,X=E-(E-M)*oe,re=_-(_-D)*oe;const Pe=Math.round(Math.min(G,I)),We=Math.round(Math.max(G,I));let he=h*J+Pe*4;for(let fe=Pe;fe<=We;fe++)oe=(G-fe)/(G-I),oe<0?oe=0:oe>1&&(oe=1),d[he++]=te-(te-$)*oe|0,d[he++]=j-(j-X)*oe|0,d[he++]=O-(O-re)*oe|0,d[he++]=255}}function a2(n,e,t){const s=e.coords,i=e.colors;let r,o;switch(e.type){case"lattice":const a=e.verticesPerRow,c=Math.floor(s.length/a)-1,u=a-1;for(r=0;r<c;r++){let d=r*a;for(let h=0;h<u;h++,d++)Sy(n,t,s[d],s[d+1],s[d+a],i[d],i[d+1],i[d+a]),Sy(n,t,s[d+a+1],s[d+1],s[d+a],i[d+a+1],i[d+1],i[d+a])}break;case"triangles":for(r=0,o=s.length;r<o;r+=3)Sy(n,t,s[r],s[r+1],s[r+2],i[r],i[r+1],i[r+2]);break;default:throw new Error("illegal figure")}}class l2 extends Yw{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,s){const a=Math.floor(this._bounds[0]),c=Math.floor(this._bounds[1]),u=Math.ceil(this._bounds[2])-a,d=Math.ceil(this._bounds[3])-c,h=Math.min(Math.ceil(Math.abs(u*e[0]*1.1)),3e3),f=Math.min(Math.ceil(Math.abs(d*e[1]*1.1)),3e3),p=u/h,v=d/f,g={coords:this._coords,colors:this._colors,offsetX:-a,offsetY:-c,scaleX:1/p,scaleY:1/v},x=h+2*2,y=f+2*2,w=s.getCanvas("mesh",x,y),b=w.context,E=b.createImageData(h,f);if(t){const k=E.data;for(let C=0,P=k.length;C<P;C+=4)k[C]=t[0],k[C+1]=t[1],k[C+2]=t[2],k[C+3]=255}for(const k of this._figures)a2(E,k,g);return b.putImageData(E,2,2),{canvas:w.canvas,offsetX:a-2*p,offsetY:c-2*v,scaleX:p,scaleY:v}}isModifyingCurrentTransform(){return!0}getPattern(e,t,s,i){Wv(e,this._bbox);const r=new Float32Array(2);if(i===Dt.SHADING)Y.singularValueDecompose2dScale(He(e),r);else if(this.matrix){Y.singularValueDecompose2dScale(this.matrix,r);const[a,c]=r;Y.singularValueDecompose2dScale(t.baseTransform,r),r[0]*=a,r[1]*=c}else Y.singularValueDecompose2dScale(t.baseTransform,r);const o=this._createMeshCanvas(r,i===Dt.SHADING?null:this._background,t.cachedCanvases);return i!==Dt.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(o.offsetX,o.offsetY),e.scale(o.scaleX,o.scaleY),e.createPattern(o.canvas,"no-repeat")}}class c2 extends Yw{getPattern(){return"hotpink"}}function u2(n){switch(n[0]){case"RadialAxial":return new o2(n);case"Mesh":return new l2(n);case"Dummy":return new c2}throw new Error(`Unknown IR type: ${n[0]}`)}const UA={COLORED:1,UNCOLORED:2},Yg=class Yg{constructor(e,t,s,i){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=s,this.baseTransform=i}createPatternCanvas(e){const{bbox:t,operatorList:s,paintType:i,tilingType:r,color:o,canvasGraphicsFactory:a}=this;let{xstep:c,ystep:u}=this;c=Math.abs(c),u=Math.abs(u),km("TilingType: "+r);const d=t[0],h=t[1],f=t[2],p=t[3],v=f-d,g=p-h,x=new Float32Array(2);Y.singularValueDecompose2dScale(this.matrix,x);const[y,w]=x;Y.singularValueDecompose2dScale(this.baseTransform,x);const b=y*x[0],E=w*x[1];let _=v,k=g,C=!1,P=!1;const L=Math.ceil(c*b),M=Math.ceil(u*E),D=Math.ceil(v*b),K=Math.ceil(g*E);L>=D?_=c:C=!0,M>=K?k=u:P=!0;const Q=this.getSizeAndScale(_,this.ctx.canvas.width,b),G=this.getSizeAndScale(k,this.ctx.canvas.height,E),te=e.cachedCanvases.getCanvas("pattern",Q.size,G.size),j=te.context,O=a.createCanvasGraphics(j);if(O.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(O,i,o),j.translate(-Q.scale*d,-G.scale*h),O.transform(Q.scale,0,0,G.scale,0,0),j.save(),this.clipBbox(O,d,h,f,p),O.baseTransform=He(O.ctx),O.executeOperatorList(s),O.endDrawing(),j.restore(),C||P){const I=te.canvas;C&&(_=c),P&&(k=u);const $=this.getSizeAndScale(_,this.ctx.canvas.width,b),X=this.getSizeAndScale(k,this.ctx.canvas.height,E),re=$.size,J=X.size,oe=e.cachedCanvases.getCanvas("pattern-workaround",re,J),Pe=oe.context,We=C?Math.floor(v/c):0,he=P?Math.floor(g/u):0;for(let fe=0;fe<=We;fe++)for(let En=0;En<=he;En++)Pe.drawImage(I,re*fe,J*En,re,J,0,0,re,J);return{canvas:oe.canvas,scaleX:$.scale,scaleY:X.scale,offsetX:d,offsetY:h}}return{canvas:te.canvas,scaleX:Q.scale,scaleY:G.scale,offsetX:d,offsetY:h}}getSizeAndScale(e,t,s){const i=Math.max(Yg.MAX_PATTERN_SIZE,t);let r=Math.ceil(e*s);return r>=i?r=i:s=r/e,{scale:s,size:r}}clipBbox(e,t,s,i,r){const o=i-t,a=r-s;e.ctx.rect(t,s,o,a),Y.axialAlignedBoundingBox([t,s,i,r],He(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,s){const i=e.ctx,r=e.current;switch(t){case UA.COLORED:const{fillStyle:o,strokeStyle:a}=this.ctx;i.fillStyle=r.fillColor=o,i.strokeStyle=r.strokeColor=a;break;case UA.UNCOLORED:i.fillStyle=i.strokeStyle=s,r.fillColor=r.strokeColor=s;break;default:throw new NL(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,s,i){let r=s;i!==Dt.SHADING&&(r=Y.transform(r,t.baseTransform),this.matrix&&(r=Y.transform(r,this.matrix)));const o=this.createPatternCanvas(t);let a=new DOMMatrix(r);a=a.translate(o.offsetX,o.offsetY),a=a.scale(1/o.scaleX,1/o.scaleY);const c=e.createPattern(o.canvas,"repeat");return c.setTransform(a),c}};F(Yg,"MAX_PATTERN_SIZE",3e3);let Xv=Yg;function d2({src:n,srcPos:e=0,dest:t,width:s,height:i,nonBlackColor:r=4294967295,inverseDecode:o=!1}){const a=Et.isLittleEndian?4278190080:255,[c,u]=o?[r,a]:[a,r],d=s>>3,h=s&7,f=n.length;t=new Uint32Array(t.buffer);let p=0;for(let v=0;v<i;v++){for(const x=e+d;e<x;e++){const y=e<f?n[e]:255;t[p++]=y&128?u:c,t[p++]=y&64?u:c,t[p++]=y&32?u:c,t[p++]=y&16?u:c,t[p++]=y&8?u:c,t[p++]=y&4?u:c,t[p++]=y&2?u:c,t[p++]=y&1?u:c}if(h===0)continue;const g=e<f?n[e++]:255;for(let x=0;x<h;x++)t[p++]=g&1<<7-x?u:c}return{srcPos:e,destPos:p}}const VA=16,GA=100,h2=15,WA=10,mn=16,xy=new DOMMatrix,Xn=new Float32Array(2),Vl=new Float32Array([1/0,1/0,-1/0,-1/0]);function f2(n,e){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){e.save(),this.__originalSave()},n.restore=function(){e.restore(),this.__originalRestore()},n.translate=function(t,s){e.translate(t,s),this.__originalTranslate(t,s)},n.scale=function(t,s){e.scale(t,s),this.__originalScale(t,s)},n.transform=function(t,s,i,r,o,a){e.transform(t,s,i,r,o,a),this.__originalTransform(t,s,i,r,o,a)},n.setTransform=function(t,s,i,r,o,a){e.setTransform(t,s,i,r,o,a),this.__originalSetTransform(t,s,i,r,o,a)},n.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},n.rotate=function(t){e.rotate(t),this.__originalRotate(t)},n.clip=function(t){e.clip(t),this.__originalClip(t)},n.moveTo=function(t,s){e.moveTo(t,s),this.__originalMoveTo(t,s)},n.lineTo=function(t,s){e.lineTo(t,s),this.__originalLineTo(t,s)},n.bezierCurveTo=function(t,s,i,r,o,a){e.bezierCurveTo(t,s,i,r,o,a),this.__originalBezierCurveTo(t,s,i,r,o,a)},n.rect=function(t,s,i,r){e.rect(t,s,i,r),this.__originalRect(t,s,i,r)},n.closePath=function(){e.closePath(),this.__originalClosePath()},n.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class p2{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,s){let i;return this.cache[e]!==void 0?(i=this.cache[e],this.canvasFactory.reset(i,t,s)):(i=this.canvasFactory.create(t,s),this.cache[e]=i),i}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function up(n,e,t,s,i,r,o,a,c,u){const[d,h,f,p,v,g]=He(n);if(h===0&&f===0){const w=o*d+v,b=Math.round(w),E=a*p+g,_=Math.round(E),k=(o+c)*d+v,C=Math.abs(Math.round(k)-b)||1,P=(a+u)*p+g,L=Math.abs(Math.round(P)-_)||1;return n.setTransform(Math.sign(d),0,0,Math.sign(p),b,_),n.drawImage(e,t,s,i,r,0,0,C,L),n.setTransform(d,h,f,p,v,g),[C,L]}if(d===0&&p===0){const w=a*f+v,b=Math.round(w),E=o*h+g,_=Math.round(E),k=(a+u)*f+v,C=Math.abs(Math.round(k)-b)||1,P=(o+c)*h+g,L=Math.abs(Math.round(P)-_)||1;return n.setTransform(0,Math.sign(h),Math.sign(f),0,b,_),n.drawImage(e,t,s,i,r,0,0,L,C),n.setTransform(d,h,f,p,v,g),[L,C]}n.drawImage(e,t,s,i,r,o,a,c,u);const x=Math.hypot(d,h),y=Math.hypot(f,p);return[x*c,y*u]}class XA{constructor(e,t){F(this,"alphaIsShape",!1);F(this,"fontSize",0);F(this,"fontSizeScale",1);F(this,"textMatrix",null);F(this,"textMatrixScale",1);F(this,"fontMatrix",Ev);F(this,"leading",0);F(this,"x",0);F(this,"y",0);F(this,"lineX",0);F(this,"lineY",0);F(this,"charSpacing",0);F(this,"wordSpacing",0);F(this,"textHScale",1);F(this,"textRenderingMode",$t.FILL);F(this,"textRise",0);F(this,"fillColor","#000000");F(this,"strokeColor","#000000");F(this,"patternFill",!1);F(this,"patternStroke",!1);F(this,"fillAlpha",1);F(this,"strokeAlpha",1);F(this,"lineWidth",1);F(this,"activeSMask",null);F(this,"transferMaps","none");this.clipBox=new Float32Array([0,0,e,t]),this.minMax=Vl.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=Dt.FILL,t=null){const s=this.minMax.slice();if(e===Dt.STROKE){t||_e("Stroke bounding box must include transform."),Y.singularValueDecompose2dScale(t,Xn);const i=Xn[0]*this.lineWidth/2,r=Xn[1]*this.lineWidth/2;s[0]-=i,s[1]-=r,s[2]+=i,s[3]+=r}return s}updateClipFromPath(){const e=Y.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(Vl,0)}getClippedPathBoundingBox(e=Dt.FILL,t=null){return Y.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function YA(n,e){if(e instanceof ImageData){n.putImageData(e,0,0);return}const t=e.height,s=e.width,i=t%mn,r=(t-i)/mn,o=i===0?r:r+1,a=n.createImageData(s,mn);let c=0,u;const d=e.data,h=a.data;let f,p,v,g;if(e.kind===Ed.GRAYSCALE_1BPP){const x=d.byteLength,y=new Uint32Array(h.buffer,0,h.byteLength>>2),w=y.length,b=s+7>>3,E=4294967295,_=Et.isLittleEndian?4278190080:255;for(f=0;f<o;f++){for(v=f<r?mn:i,u=0,p=0;p<v;p++){const k=x-c;let C=0;const P=k>b?s:k*8-7,L=P&-8;let M=0,D=0;for(;C<L;C+=8)D=d[c++],y[u++]=D&128?E:_,y[u++]=D&64?E:_,y[u++]=D&32?E:_,y[u++]=D&16?E:_,y[u++]=D&8?E:_,y[u++]=D&4?E:_,y[u++]=D&2?E:_,y[u++]=D&1?E:_;for(;C<P;C++)M===0&&(D=d[c++],M=128),y[u++]=D&M?E:_,M>>=1}for(;u<w;)y[u++]=0;n.putImageData(a,0,f*mn)}}else if(e.kind===Ed.RGBA_32BPP){for(p=0,g=s*mn*4,f=0;f<r;f++)h.set(d.subarray(c,c+g)),c+=g,n.putImageData(a,0,p),p+=mn;f<o&&(g=s*i*4,h.set(d.subarray(c,c+g)),n.putImageData(a,0,p))}else if(e.kind===Ed.RGB_24BPP)for(v=mn,g=s*v,f=0;f<o;f++){for(f>=r&&(v=i,g=s*v),u=0,p=g;p--;)h[u++]=d[c++],h[u++]=d[c++],h[u++]=d[c++],h[u++]=255;n.putImageData(a,0,f*mn)}else throw new Error(`bad image kind: ${e.kind}`)}function qA(n,e){if(e.bitmap){n.drawImage(e.bitmap,0,0);return}const t=e.height,s=e.width,i=t%mn,r=(t-i)/mn,o=i===0?r:r+1,a=n.createImageData(s,mn);let c=0;const u=e.data,d=a.data;for(let h=0;h<o;h++){const f=h<r?mn:i;({srcPos:c}=d2({src:u,srcPos:c,dest:d,width:s,height:f,nonBlackColor:0})),n.putImageData(a,0,h*mn)}}function zu(n,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of t)n[s]!==void 0&&(e[s]=n[s]);n.setLineDash!==void 0&&(e.setLineDash(n.getLineDash()),e.lineDashOffset=n.lineDashOffset)}function dp(n){n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0);const{filter:e}=n;e!=="none"&&e!==""&&(n.filter="none")}function KA(n,e){if(e)return!0;Y.singularValueDecompose2dScale(n,Xn);const t=Math.fround(Xs.pixelRatio*_r.PDF_TO_CSS_UNITS);return Xn[0]<=t&&Xn[1]<=t}const g2=["butt","round","square"],m2=["miter","round","bevel"],y2={},QA={};var Ys,Yv,qv,Kv;const ib=class ib{constructor(e,t,s,i,r,{optionalContentConfig:o,markedContentStack:a=null},c,u){A(this,Ys);this.ctx=e,this.current=new XA(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=s,this.canvasFactory=i,this.filterFactory=r,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=a||[],this.optionalContentConfig=o,this.cachedCanvases=new p2(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=c,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=u,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:s=!1,background:i=null}){const r=this.ctx.canvas.width,o=this.ctx.canvas.height,a=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,r,o),this.ctx.fillStyle=a,s){const c=this.cachedCanvases.getCanvas("transparent",r,o);this.compositeCtx=this.ctx,this.transparentCanvas=c.canvas,this.ctx=c.context,this.ctx.save(),this.ctx.transform(...He(this.compositeCtx))}this.ctx.save(),dp(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=He(this.ctx)}executeOperatorList(e,t,s,i){const r=e.argsArray,o=e.fnArray;let a=t||0;const c=r.length;if(c===a)return a;const u=c-a>WA&&typeof s=="function",d=u?Date.now()+h2:0;let h=0;const f=this.commonObjs,p=this.objs;let v;for(;;){if(i!==void 0&&a===i.nextBreakPoint)return i.breakIt(a,s),a;if(v=o[a],v!==Vd.dependency)this[v].apply(this,r[a]);else for(const g of r[a]){const x=g.startsWith("g_")?f:p;if(!x.has(g))return x.get(g,s),a}if(a++,a===c)return a;if(u&&++h>WA){if(Date.now()>d)return s(),a;h=0}}}endDrawing(){S(this,Ys,Yv).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),S(this,Ys,qv).call(this)}_scaleImage(e,t){const s=e.width??e.displayWidth,i=e.height??e.displayHeight;let r=Math.max(Math.hypot(t[0],t[1]),1),o=Math.max(Math.hypot(t[2],t[3]),1),a=s,c=i,u="prescale1",d,h;for(;r>2&&a>1||o>2&&c>1;){let f=a,p=c;r>2&&a>1&&(f=a>=16384?Math.floor(a/2)-1||1:Math.ceil(a/2),r/=a/f),o>2&&c>1&&(p=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c)/2,o/=c/p),d=this.cachedCanvases.getCanvas(u,f,p),h=d.context,h.clearRect(0,0,f,p),h.drawImage(e,0,0,a,c,0,0,f,p),e=d.canvas,a=f,c=p,u=u==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:a,paintHeight:c}}_createMaskCanvas(e){const t=this.ctx,{width:s,height:i}=e,r=this.current.fillColor,o=this.current.patternFill,a=He(t);let c,u,d,h;if((e.bitmap||e.data)&&e.count>1){const L=e.bitmap||e.data.buffer;u=JSON.stringify(o?a:[a.slice(0,4),r]),c=this._cachedBitmapsMap.get(L),c||(c=new Map,this._cachedBitmapsMap.set(L,c));const M=c.get(u);if(M&&!o){const D=Math.round(Math.min(a[0],a[2])+a[4]),K=Math.round(Math.min(a[1],a[3])+a[5]);return{canvas:M,offsetX:D,offsetY:K}}d=M}d||(h=this.cachedCanvases.getCanvas("maskCanvas",s,i),qA(h.context,e));let f=Y.transform(a,[1/s,0,0,-1/i,0,0]);f=Y.transform(f,[1,0,0,1,0,-i]);const p=Vl.slice();Y.axialAlignedBoundingBox([0,0,s,i],f,p);const[v,g,x,y]=p,w=Math.round(x-v)||1,b=Math.round(y-g)||1,E=this.cachedCanvases.getCanvas("fillCanvas",w,b),_=E.context,k=v,C=g;_.translate(-k,-C),_.transform(...f),d||(d=this._scaleImage(h.canvas,ei(_)),d=d.img,c&&o&&c.set(u,d)),_.imageSmoothingEnabled=KA(He(_),e.interpolate),up(_,d,0,0,d.width,d.height,0,0,s,i),_.globalCompositeOperation="source-in";const P=Y.transform(ei(_),[1,0,0,1,-k,-C]);return _.fillStyle=o?r.getPattern(t,this,P,Dt.FILL):r,_.fillRect(0,0,s,i),c&&!o&&(this.cachedCanvases.delete("fillCanvas"),c.set(u,E.canvas)),{canvas:E.canvas,offsetX:Math.round(k),offsetY:Math.round(C)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=g2[e]}setLineJoin(e){this.ctx.lineJoin=m2[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const s=this.ctx;s.setLineDash!==void 0&&(s.setLineDash(e),s.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,s]of e)switch(t){case"LW":this.setLineWidth(s);break;case"LC":this.setLineCap(s);break;case"LJ":this.setLineJoin(s);break;case"ML":this.setMiterLimit(s);break;case"D":this.setDash(s[0],s[1]);break;case"RI":this.setRenderingIntent(s);break;case"FL":this.setFlatness(s);break;case"Font":this.setFont(s[0],s[1]);break;case"CA":this.current.strokeAlpha=s;break;case"ca":this.ctx.globalAlpha=this.current.fillAlpha=s;break;case"BM":this.ctx.globalCompositeOperation=s;break;case"SMask":this.current.activeSMask=s?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(s);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(s,e,t);this.suspendedCtx=this.ctx;const r=this.ctx=i.context;r.setTransform(this.suspendedCtx.getTransform()),zu(this.suspendedCtx,r),f2(r,this.suspendedCtx),this.setGState([["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),zu(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,s,i){const r=i[0],o=i[1],a=i[2]-r,c=i[3]-o;a===0||c===0||(this.genericComposeSMask(t.context,s,a,c,t.subtype,t.backdrop,t.transferMap,r,o,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(s.canvas,0,0),e.restore())}genericComposeSMask(e,t,s,i,r,o,a,c,u,d,h){let f=e.canvas,p=c-d,v=u-h;if(o)if(p<0||v<0||p+s>f.width||v+i>f.height){const x=this.cachedCanvases.getCanvas("maskExtension",s,i),y=x.context;y.drawImage(f,-p,-v),y.globalCompositeOperation="destination-atop",y.fillStyle=o,y.fillRect(0,0,s,i),y.globalCompositeOperation="source-over",f=x.canvas,p=v=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const x=new Path2D;x.rect(p,v,s,i),e.clip(x),e.globalCompositeOperation="destination-atop",e.fillStyle=o,e.fillRect(p,v,s,i),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),r==="Alpha"&&a?t.filter=this.filterFactory.addAlphaFilter(a):r==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(a));const g=new Path2D;g.rect(c,u,s,i),t.clip(g),t.globalCompositeOperation="destination-in",t.drawImage(f,p,v,s,i,c,u,s,i),t.restore()}save(){this.inSMaskMode&&zu(this.ctx,this.suspendedCtx),this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){if(this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&zu(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,s,i,r,o){this.ctx.transform(e,t,s,i,r,o),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,s){let[i]=t;if(!s){i||(i=t[0]=new Path2D),this[e](i);return}if(!(i instanceof Path2D)){const r=t[0]=new Path2D;for(let o=0,a=i.length;o<a;)switch(i[o++]){case ap.moveTo:r.moveTo(i[o++],i[o++]);break;case ap.lineTo:r.lineTo(i[o++],i[o++]);break;case ap.curveTo:r.bezierCurveTo(i[o++],i[o++],i[o++],i[o++],i[o++],i[o++]);break;case ap.closePath:r.closePath();break;default:ne(`Unrecognized drawing path operator: ${i[o-1]}`);break}i=r}Y.axialAlignedBoundingBox(s,He(this.ctx),this.current.minMax),this[e](i)}closePath(){this.ctx.closePath()}stroke(e,t=!0){const s=this.ctx,i=this.current.strokeColor;if(s.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof i=="object"&&(i!=null&&i.getPattern)){const r=i.isModifyingCurrentTransform()?s.getTransform():null;if(s.save(),s.strokeStyle=i.getPattern(s,this,ei(s),Dt.STROKE),r){const o=new Path2D;o.addPath(e,s.getTransform().invertSelf().multiplySelf(r)),e=o}this.rescaleAndStroke(e,!1),s.restore()}else this.rescaleAndStroke(e,!0);t&&this.consumePath(e,this.current.getClippedPathBoundingBox(Dt.STROKE,He(this.ctx))),s.globalAlpha=this.current.fillAlpha}closeStroke(e){this.stroke(e)}fill(e,t=!0){const s=this.ctx,i=this.current.fillColor,r=this.current.patternFill;let o=!1;if(r){const c=i.isModifyingCurrentTransform()?s.getTransform():null;if(s.save(),s.fillStyle=i.getPattern(s,this,ei(s),Dt.FILL),c){const u=new Path2D;u.addPath(e,s.getTransform().invertSelf().multiplySelf(c)),e=u}o=!0}const a=this.current.getClippedPathBoundingBox();this.contentVisible&&a!==null&&(this.pendingEOFill?(s.fill(e,"evenodd"),this.pendingEOFill=!1):s.fill(e)),o&&s.restore(),t&&this.consumePath(e,a)}eoFill(e){this.pendingEOFill=!0,this.fill(e)}fillStroke(e){this.fill(e,!1),this.stroke(e,!1),this.consumePath(e)}eoFillStroke(e){this.pendingEOFill=!0,this.fillStroke(e)}closeFillStroke(e){this.fillStroke(e)}closeEOFillStroke(e){this.pendingEOFill=!0,this.fillStroke(e)}endPath(e){this.consumePath(e)}rawFillPath(e){this.ctx.fill(e)}clip(){this.pendingClip=y2}eoClip(){this.pendingClip=QA}beginText(){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(e===void 0)return;const s=new Path2D,i=t.getTransform().invertSelf();for(const{transform:r,x:o,y:a,fontSize:c,path:u}of e)s.addPath(u,new DOMMatrix(r).preMultiplySelf(i).translate(o,a).scale(c,-c));t.clip(s),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){var d;const s=this.commonObjs.get(e),i=this.current;if(!s)throw new Error(`Can't find font for ${e}`);if(i.fontMatrix=s.fontMatrix||Ev,(i.fontMatrix[0]===0||i.fontMatrix[3]===0)&&ne("Invalid font matrix for font "+e),t<0?(t=-t,i.fontDirection=-1):i.fontDirection=1,this.current.font=s,this.current.fontSize=t,s.isType3Font)return;const r=s.loadedName||"sans-serif",o=((d=s.systemFontInfo)==null?void 0:d.css)||`"${r}", ${s.fallbackName}`;let a="normal";s.black?a="900":s.bold&&(a="bold");const c=s.italic?"italic":"normal";let u=t;t<VA?u=VA:t>GA&&(u=GA),this.current.fontSizeScale=t/u,this.ctx.font=`${c} ${a} ${u}px ${o}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e){const{current:t}=this;t.textMatrix=e,t.textMatrixScale=Math.hypot(e[0],e[1]),t.x=t.lineX=0,t.y=t.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,t,s,i,r){const o=this.ctx,a=this.current,c=a.font,u=a.textRenderingMode,d=a.fontSize/a.fontSizeScale,h=u&$t.FILL_STROKE_MASK,f=!!(u&$t.ADD_TO_PATH_FLAG),p=a.patternFill&&!c.missingFile,v=a.patternStroke&&!c.missingFile;let g;if((c.disableFontFace||f||p||v)&&(g=c.getPathGenerator(this.commonObjs,e)),c.disableFontFace||p||v){o.save(),o.translate(t,s),o.scale(d,-d);let x;if((h===$t.FILL||h===$t.FILL_STROKE)&&(i?(x=o.getTransform(),o.setTransform(...i),o.fill(S(this,Ys,Kv).call(this,g,x,i))):o.fill(g)),h===$t.STROKE||h===$t.FILL_STROKE)if(r){x||(x=o.getTransform()),o.setTransform(...r);const{a:y,b:w,c:b,d:E}=x,_=Y.inverseTransform(r),k=Y.transform([y,w,b,E,0,0],_);Y.singularValueDecompose2dScale(k,Xn),o.lineWidth*=Math.max(Xn[0],Xn[1])/d,o.stroke(S(this,Ys,Kv).call(this,g,x,r))}else o.lineWidth/=d,o.stroke(g);o.restore()}else(h===$t.FILL||h===$t.FILL_STROKE)&&o.fillText(e,t,s),(h===$t.STROKE||h===$t.FILL_STROKE)&&o.strokeText(e,t,s);f&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:He(o),x:t,y:s,fontSize:d,path:g})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let s=!1;for(let i=3;i<t.length;i+=4)if(t[i]>0&&t[i]<255){s=!0;break}return le(this,"isFontSubpixelAAEnabled",s)}showText(e){const t=this.current,s=t.font;if(s.isType3Font)return this.showType3Text(e);const i=t.fontSize;if(i===0)return;const r=this.ctx,o=t.fontSizeScale,a=t.charSpacing,c=t.wordSpacing,u=t.fontDirection,d=t.textHScale*u,h=e.length,f=s.vertical,p=f?1:-1,v=s.defaultVMetrics,g=i*t.fontMatrix[0],x=t.textRenderingMode===$t.FILL&&!s.disableFontFace&&!t.patternFill;r.save(),t.textMatrix&&r.transform(...t.textMatrix),r.translate(t.x,t.y+t.textRise),u>0?r.scale(d,-1):r.scale(d,1);let y,w;if(t.patternFill){r.save();const C=t.fillColor.getPattern(r,this,ei(r),Dt.FILL);y=He(r),r.restore(),r.fillStyle=C}if(t.patternStroke){r.save();const C=t.strokeColor.getPattern(r,this,ei(r),Dt.STROKE);w=He(r),r.restore(),r.strokeStyle=C}let b=t.lineWidth;const E=t.textMatrixScale;if(E===0||b===0){const C=t.textRenderingMode&$t.FILL_STROKE_MASK;(C===$t.STROKE||C===$t.FILL_STROKE)&&(b=this.getSinglePixelWidth())}else b/=E;if(o!==1&&(r.scale(o,o),b/=o),r.lineWidth=b,s.isInvalidPDFjsFont){const C=[];let P=0;for(const L of e)C.push(L.unicode),P+=L.width;r.fillText(C.join(""),0,0),t.x+=P*g*d,r.restore(),this.compose();return}let _=0,k;for(k=0;k<h;++k){const C=e[k];if(typeof C=="number"){_+=p*C*i/1e3;continue}let P=!1;const L=(C.isSpace?c:0)+a,M=C.fontChar,D=C.accent;let K,Q,G=C.width;if(f){const j=C.vmetric||v,O=-(C.vmetric?j[1]:G*.5)*g,I=j[2]*g;G=j?-j[0]:G,K=O/o,Q=(_+I)/o}else K=_/o,Q=0;if(s.remeasure&&G>0){const j=r.measureText(M).width*1e3/i*o;if(G<j&&this.isFontSubpixelAAEnabled){const O=G/j;P=!0,r.save(),r.scale(O,1),K/=O}else G!==j&&(K+=(G-j)/2e3*i/o)}if(this.contentVisible&&(C.isInFont||s.missingFile)){if(x&&!D)r.fillText(M,K,Q);else if(this.paintChar(M,K,Q,y,w),D){const j=K+i*D.offset.x/o,O=Q-i*D.offset.y/o;this.paintChar(D.fontChar,j,O,y,w)}}const te=f?G*g-L*u:G*g+L*u;_+=te,P&&r.restore()}f?t.y-=_:t.x+=_*d,r.restore(),this.compose()}showType3Text(e){const t=this.ctx,s=this.current,i=s.font,r=s.fontSize,o=s.fontDirection,a=i.vertical?1:-1,c=s.charSpacing,u=s.wordSpacing,d=s.textHScale*o,h=s.fontMatrix||Ev,f=e.length,p=s.textRenderingMode===$t.INVISIBLE;let v,g,x,y;if(!(p||r===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),s.textMatrix&&t.transform(...s.textMatrix),t.translate(s.x,s.y+s.textRise),t.scale(d,o),v=0;v<f;++v){if(g=e[v],typeof g=="number"){y=a*g*r/1e3,this.ctx.translate(y,0),s.x+=y*d;continue}const w=(g.isSpace?u:0)+c,b=i.charProcOperatorList[g.operatorListId];b?this.contentVisible&&(this.save(),t.scale(r,r),t.transform(...h),this.executeOperatorList(b),this.restore()):ne(`Type3 character "${g.operatorListId}" is not available.`);const E=[g.width,0];Y.applyTransform(E,h),x=E[0]*r+w,t.translate(x,0),s.x+=x*d}t.restore()}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,s,i,r,o){const a=new Path2D;a.rect(s,i,r-s,o-i),this.ctx.clip(a),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){const s=this.baseTransform||He(this.ctx),i={createCanvasGraphics:r=>new ib(r,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new Xv(e,this.ctx,i,s)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e){this.ctx.strokeStyle=this.current.strokeColor=e,this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e){this.ctx.fillStyle=this.current.fillColor=e,this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let s;return this.cachedPatterns.has(e)?s=this.cachedPatterns.get(e):(s=u2(this.getObject(e)),this.cachedPatterns.set(e,s)),t&&(s.matrix=t),s}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const s=this._getPattern(e);t.fillStyle=s.getPattern(t,this,ei(t),Dt.SHADING);const i=ei(t);if(i){const{width:r,height:o}=t.canvas,a=Vl.slice();Y.axialAlignedBoundingBox([0,0,r,o],i,a);const[c,u,d,h]=a;this.ctx.fillRect(c,u,d-c,h-u)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){_e("Should not call beginInlineImage")}beginImageData(){_e("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=He(this.ctx),t)){Y.axialAlignedBoundingBox(t,this.baseTransform,this.current.minMax);const[s,i,r,o]=t,a=new Path2D;a.rect(s,i,r-s,o-i),this.ctx.clip(a),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||km("TODO: Support non-isolated groups."),e.knockout&&ne("Knockout groups not supported.");const s=He(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let i=Vl.slice();Y.axialAlignedBoundingBox(e.bbox,He(t),i);const r=[0,0,t.canvas.width,t.canvas.height];i=Y.intersect(i,r)||[0,0,0,0];const o=Math.floor(i[0]),a=Math.floor(i[1]),c=Math.max(Math.ceil(i[2])-o,1),u=Math.max(Math.ceil(i[3])-a,1);this.current.startNewPathAndClipBox([0,0,c,u]);let d="groupAt"+this.groupLevel;e.smask&&(d+="_smask_"+this.smaskCounter++%2);const h=this.cachedCanvases.getCanvas(d,c,u),f=h.context;f.translate(-o,-a),f.transform(...s);let p=new Path2D;const[v,g,x,y]=e.bbox;if(p.rect(v,g,x-v,y-g),e.matrix){const w=new Path2D;w.addPath(p,new DOMMatrix(e.matrix)),p=w}f.clip(p),e.smask?this.smaskStack.push({canvas:h.canvas,context:f,offsetX:o,offsetY:a,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(o,a),t.save()),zu(t,f),this.ctx=f,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const i=He(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...i);const r=Vl.slice();Y.axialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],i,r),this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(r)}}beginAnnotation(e,t,s,i,r){if(S(this,Ys,Yv).call(this),dp(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const o=t[2]-t[0],a=t[3]-t[1];if(r&&this.annotationCanvasMap){s=s.slice(),s[4]-=t[0],s[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=o,t[3]=a,Y.singularValueDecompose2dScale(He(this.ctx),Xn);const{viewportScale:c}=this,u=Math.ceil(o*this.outputScaleX*c),d=Math.ceil(a*this.outputScaleY*c);this.annotationCanvas=this.canvasFactory.create(u,d);const{canvas:h,context:f}=this.annotationCanvas;this.annotationCanvasMap.set(e,h),this.annotationCanvas.savedCtx=this.ctx,this.ctx=f,this.ctx.save(),this.ctx.setTransform(Xn[0],0,0,-Xn[1],0,a*Xn[1]),dp(this.ctx)}else{dp(this.ctx),this.endPath();const c=new Path2D;c.rect(t[0],t[1],o,a),this.ctx.clip(c)}}this.current=new XA(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...s),this.transform(...i)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),S(this,Ys,qv).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;e=this.getObject(e.data,e),e.count=t;const s=this.ctx,i=this._createMaskCanvas(e),r=i.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(r,i.offsetX,i.offsetY),s.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,s=0,i=0,r,o){if(!this.contentVisible)return;e=this.getObject(e.data,e);const a=this.ctx;a.save();const c=He(a);a.transform(t,s,i,r,0,0);const u=this._createMaskCanvas(e);a.setTransform(1,0,0,1,u.offsetX-c[4],u.offsetY-c[5]);for(let d=0,h=o.length;d<h;d+=2){const f=Y.transform(c,[t,s,i,r,o[d],o[d+1]]);a.drawImage(u.canvas,f[4],f[5])}a.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,s=this.current.fillColor,i=this.current.patternFill;for(const r of e){const{data:o,width:a,height:c,transform:u}=r,d=this.cachedCanvases.getCanvas("maskCanvas",a,c),h=d.context;h.save();const f=this.getObject(o,r);qA(h,f),h.globalCompositeOperation="source-in",h.fillStyle=i?s.getPattern(h,this,ei(t),Dt.FILL):s,h.fillRect(0,0,a,c),h.restore(),t.save(),t.transform(...u),t.scale(1,-1),up(t,d.canvas,0,0,a,c,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);if(!t){ne("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,s,i){if(!this.contentVisible)return;const r=this.getObject(e);if(!r){ne("Dependent image isn't ready yet");return}const o=r.width,a=r.height,c=[];for(let u=0,d=i.length;u<d;u+=2)c.push({transform:[t,0,0,s,i[u],i[u+1]],x:0,y:0,w:o,h:a});this.paintInlineImageXObjectGroup(r,c)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:s,height:i}=e,r=this.cachedCanvases.getCanvas("inlineImage",s,i),o=r.context;return o.filter=this.current.transferMaps,o.drawImage(t,0,0),o.filter="none",r.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,s=e.height,i=this.ctx;this.save();const{filter:r}=i;r!=="none"&&r!==""&&(i.filter="none"),i.scale(1/t,-1/s);let o;if(e.bitmap)o=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)o=e;else{const u=this.cachedCanvases.getCanvas("inlineImage",t,s).context;YA(u,e),o=this.applyTransferMapsToCanvas(u)}const a=this._scaleImage(o,ei(i));i.imageSmoothingEnabled=KA(He(i),e.interpolate),up(i,a.img,0,0,a.paintWidth,a.paintHeight,0,-s,t,s),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const s=this.ctx;let i;if(e.bitmap)i=e.bitmap;else{const r=e.width,o=e.height,c=this.cachedCanvases.getCanvas("inlineImage",r,o).context;YA(c,e),i=this.applyTransferMapsToCanvas(c)}for(const r of t)s.save(),s.transform(...r.transform),s.scale(1,-1),up(s,i,r.x,r.y,r.w,r.h,0,-1,1,1),s.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e,t){const s=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(t);const i=this.ctx;this.pendingClip&&(s||(this.pendingClip===QA?i.clip(e,"evenodd"):i.clip(e)),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=He(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),s=Math.hypot(e[0],e[2]),i=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(s,i)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:s,c:i,d:r}=this.ctx.getTransform();let o,a;if(s===0&&i===0){const c=Math.abs(t),u=Math.abs(r);if(c===u)if(e===0)o=a=1/c;else{const d=c*e;o=a=d<1?1/d:1}else if(e===0)o=1/c,a=1/u;else{const d=c*e,h=u*e;o=d<1?1/d:1,a=h<1?1/h:1}}else{const c=Math.abs(t*r-s*i),u=Math.hypot(t,s),d=Math.hypot(i,r);if(e===0)o=d/c,a=u/c;else{const h=e*c;o=d>h?d/h:1,a=u>h?u/h:1}}this._cachedScaleForStroking[0]=o,this._cachedScaleForStroking[1]=a}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:s,current:{lineWidth:i}}=this,[r,o]=this.getScaleForStroking();if(r===o){s.lineWidth=(i||1)*r,s.stroke(e);return}const a=s.getLineDash();t&&s.save(),s.scale(r,o),xy.a=1/r,xy.d=1/o;const c=new Path2D;if(c.addPath(e,xy),a.length>0){const u=Math.max(r,o);s.setLineDash(a.map(d=>d/u)),s.lineDashOffset/=u}s.lineWidth=i||1,s.stroke(c),t&&s.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};Ys=new WeakSet,Yv=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},qv=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},Kv=function(e,t,s){const i=new Path2D;return i.addPath(e,new DOMMatrix(s).invertSelf().multiplySelf(t)),i};let ec=ib;for(const n in Vd)ec.prototype[n]!==void 0&&(ec.prototype[Vd[n]]=ec.prototype[n]);var xh,Eh;class ps{static get workerPort(){return l(this,xh)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");m(this,xh,e)}static get workerSrc(){return l(this,Eh)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");m(this,Eh,e)}}xh=new WeakMap,Eh=new WeakMap,A(ps,xh,null),A(ps,Eh,"");var Ac,_h;class v2{constructor({parsedData:e,rawData:t}){A(this,Ac);A(this,_h);m(this,Ac,e),m(this,_h,t)}getRaw(){return l(this,_h)}get(e){return l(this,Ac).get(e)??null}[Symbol.iterator](){return l(this,Ac).entries()}}Ac=new WeakMap,_h=new WeakMap;const Tl=Symbol("INTERNAL");var Ch,kh,Th,Sc;class w2{constructor(e,{name:t,intent:s,usage:i,rbGroups:r}){A(this,Ch,!1);A(this,kh,!1);A(this,Th,!1);A(this,Sc,!0);m(this,Ch,!!(e&Gn.DISPLAY)),m(this,kh,!!(e&Gn.PRINT)),this.name=t,this.intent=s,this.usage=i,this.rbGroups=r}get visible(){if(l(this,Th))return l(this,Sc);if(!l(this,Sc))return!1;const{print:e,view:t}=this.usage;return l(this,Ch)?(t==null?void 0:t.viewState)!=="OFF":l(this,kh)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,s=!1){e!==Tl&&_e("Internal method `_setVisible` called."),m(this,Th,s),m(this,Sc,t)}}Ch=new WeakMap,kh=new WeakMap,Th=new WeakMap,Sc=new WeakMap;var eo,xe,xc,Ec,Ph,Qv;class b2{constructor(e,t=Gn.DISPLAY){A(this,Ph);A(this,eo,null);A(this,xe,new Map);A(this,xc,null);A(this,Ec,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,m(this,Ec,e.order);for(const s of e.groups)l(this,xe).set(s.id,new w2(t,s));if(e.baseState==="OFF")for(const s of l(this,xe).values())s._setVisible(Tl,!1);for(const s of e.on)l(this,xe).get(s)._setVisible(Tl,!0);for(const s of e.off)l(this,xe).get(s)._setVisible(Tl,!1);m(this,xc,this.getHash())}}isVisible(e){if(l(this,xe).size===0)return!0;if(!e)return km("Optional content group not defined."),!0;if(e.type==="OCG")return l(this,xe).has(e.id)?l(this,xe).get(e.id).visible:(ne(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return S(this,Ph,Qv).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!l(this,xe).has(t))return ne(`Optional content group not found: ${t}`),!0;if(l(this,xe).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!l(this,xe).has(t))return ne(`Optional content group not found: ${t}`),!0;if(!l(this,xe).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!l(this,xe).has(t))return ne(`Optional content group not found: ${t}`),!0;if(!l(this,xe).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!l(this,xe).has(t))return ne(`Optional content group not found: ${t}`),!0;if(l(this,xe).get(t).visible)return!1}return!0}return ne(`Unknown optional content policy ${e.policy}.`),!0}return ne(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,s=!0){var r;const i=l(this,xe).get(e);if(!i){ne(`Optional content group not found: ${e}`);return}if(s&&t&&i.rbGroups.length)for(const o of i.rbGroups)for(const a of o)a!==e&&((r=l(this,xe).get(a))==null||r._setVisible(Tl,!1,!0));i._setVisible(Tl,!!t,!0),m(this,eo,null)}setOCGState({state:e,preserveRB:t}){let s;for(const i of e){switch(i){case"ON":case"OFF":case"Toggle":s=i;continue}const r=l(this,xe).get(i);if(r)switch(s){case"ON":this.setVisibility(i,!0,t);break;case"OFF":this.setVisibility(i,!1,t);break;case"Toggle":this.setVisibility(i,!r.visible,t);break}}m(this,eo,null)}get hasInitialVisibility(){return l(this,xc)===null||this.getHash()===l(this,xc)}getOrder(){return l(this,xe).size?l(this,Ec)?l(this,Ec).slice():[...l(this,xe).keys()]:null}getGroup(e){return l(this,xe).get(e)||null}getHash(){if(l(this,eo)!==null)return l(this,eo);const e=new B1;for(const[t,s]of l(this,xe))e.update(`${t}:${s.visible}`);return m(this,eo,e.hexdigest())}[Symbol.iterator](){return l(this,xe).entries()}}eo=new WeakMap,xe=new WeakMap,xc=new WeakMap,Ec=new WeakMap,Ph=new WeakSet,Qv=function(e){const t=e.length;if(t<2)return!0;const s=e[0];for(let i=1;i<t;i++){const r=e[i];let o;if(Array.isArray(r))o=S(this,Ph,Qv).call(this,r);else if(l(this,xe).has(r))o=l(this,xe).get(r).visible;else return ne(`Optional content group not found: ${r}`),!0;switch(s){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return s==="And"};class A2{constructor(e,{disableRange:t=!1,disableStream:s=!1}){rt(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:i,initialData:r,progressiveDone:o,contentDispositionFilename:a}=e;if(this._queuedChunks=[],this._progressiveDone=o,this._contentDispositionFilename=a,(r==null?void 0:r.length)>0){const c=r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer;this._queuedChunks.push(c)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!s,this._isRangeSupported=!t,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((c,u)=>{this._onReceiveData({begin:c,chunk:u})}),e.addProgressListener((c,u)=>{this._onProgress({loaded:c,total:u})}),e.addProgressiveReadListener(c=>{this._onReceiveData({chunk:c})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const s=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(s):this._queuedChunks.push(s);else{const i=this._rangeReaders.some(function(r){return r._begin!==e?!1:(r._enqueue(s),!0)});rt(i,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var t,s,i,r;e.total===void 0?(s=(t=this._rangeReaders[0])==null?void 0:t.onProgress)==null||s.call(t,{loaded:e.loaded}):(r=(i=this._fullRequestReader)==null?void 0:i.onProgress)==null||r.call(i,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){rt(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new S2(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new x2(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeReaders.slice(0))s.cancel(e);this._pdfDataRangeTransport.abort()}}class S2{constructor(e,t,s=!1,i=null){this._stream=e,this._done=s||!1,this._filename=Pm(i)?i:null,this._queuedChunks=t||[],this._loaded=0;for(const r of this._queuedChunks)this._loaded+=r.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class x2{constructor(e,t,s){this._stream=e,this._begin=t,this._end=s,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function E2(n){let e=!0,t=s("filename\\*","i").exec(n);if(t){t=t[1];let d=a(t);return d=unescape(d),d=c(d),d=u(d),r(d)}if(t=o(n),t){const d=u(t);return r(d)}if(t=s("filename","i").exec(n),t){t=t[1];let d=a(t);return d=u(d),r(d)}function s(d,h){return new RegExp("(?:^|;)\\s*"+d+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',h)}function i(d,h){if(d){if(!/^[\x00-\xFF]+$/.test(h))return h;try{const f=new TextDecoder(d,{fatal:!0}),p=Nf(h);h=f.decode(p),e=!1}catch{}}return h}function r(d){return e&&/[\x80-\xff]/.test(d)&&(d=i("utf-8",d),e&&(d=i("iso-8859-1",d))),d}function o(d){const h=[];let f;const p=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(f=p.exec(d))!==null;){let[,g,x,y]=f;if(g=parseInt(g,10),g in h){if(g===0)break;continue}h[g]=[x,y]}const v=[];for(let g=0;g<h.length&&g in h;++g){let[x,y]=h[g];y=a(y),x&&(y=unescape(y),g===0&&(y=c(y))),v.push(y)}return v.join("")}function a(d){if(d.startsWith('"')){const h=d.slice(1).split('\\"');for(let f=0;f<h.length;++f){const p=h[f].indexOf('"');p!==-1&&(h[f]=h[f].slice(0,p),h.length=f+1),h[f]=h[f].replaceAll(/\\(.)/g,"$1")}d=h.join('"')}return d}function c(d){const h=d.indexOf("'");if(h===-1)return d;const f=d.slice(0,h),v=d.slice(h+1).replace(/^[^']*'/,"");return i(f,v)}function u(d){return!d.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(d)?d:d.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(h,f,p,v){if(p==="q"||p==="Q")return v=v.replaceAll("_"," "),v=v.replaceAll(/=([0-9a-fA-F]{2})/g,function(g,x){return String.fromCharCode(parseInt(x,16))}),i(f,v);try{v=atob(v)}catch{}return i(f,v)})}return""}function Z1(n,e){const t=new Headers;if(!n||!e||typeof e!="object")return t;for(const s in e){const i=e[s];i!==void 0&&t.append(s,i)}return t}function Lm(n){var e;return((e=URL.parse(n))==null?void 0:e.origin)??null}function e_({responseHeaders:n,isHttp:e,rangeChunkSize:t,disableRange:s}){const i={allowRangeRequests:!1,suggestedLength:void 0},r=parseInt(n.get("Content-Length"),10);return!Number.isInteger(r)||(i.suggestedLength=r,r<=2*t)||s||!e||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(i.allowRangeRequests=!0),i}function t_(n){const e=n.get("Content-Disposition");if(e){let t=E2(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(Pm(t))return t}return null}function jf(n,e){return new Gd(`Unexpected server response (${n}) while retrieving PDF "${e}".`,n,n===404||n===0&&e.startsWith("file:"))}function n_(n){return n===200||n===206}function s_(n,e,t){return{method:"GET",headers:n,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function i_(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(ne(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class _2{constructor(e){F(this,"_responseOrigin",null);this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=Z1(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return rt(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new C2(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new k2(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class C2{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const s=new Headers(e.headers),i=t.url;fetch(i,s_(s,this._withCredentials,this._abortController)).then(r=>{if(e._responseOrigin=Lm(r.url),!n_(r.status))throw jf(r.status,i);this._reader=r.body.getReader(),this._headersCapability.resolve();const o=r.headers,{allowRangeRequests:a,suggestedLength:c}=e_({responseHeaders:o,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=a,this._contentLength=c||this._contentLength,this._filename=t_(o),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Er("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:i_(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class k2{constructor(e,t,s){this._stream=e,this._reader=null,this._loaded=0;const i=e.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const r=new Headers(e.headers);r.append("Range",`bytes=${t}-${s-1}`);const o=i.url;fetch(o,s_(r,this._withCredentials,this._abortController)).then(a=>{const c=Lm(a.url);if(c!==e._responseOrigin)throw new Error(`Expected range response-origin "${c}" to match "${e._responseOrigin}".`);if(!n_(a.status))throw jf(a.status,o);this._readCapability.resolve(),this._reader=a.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:i_(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}const Ey=200,_y=206;function T2(n){const e=n.response;return typeof e!="string"?e:Nf(e).buffer}class P2{constructor({url:e,httpHeaders:t,withCredentials:s}){F(this,"_responseOrigin",null);this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=Z1(this.isHttp,t),this.withCredentials=s||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,s=this.currXhrId++,i=this.pendingRequests[s]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[r,o]of this.headers)t.setRequestHeader(r,o);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),i.expectedStatus=_y):i.expectedStatus=Ey,t.responseType="arraybuffer",rt(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,s),t.onprogress=this.onProgress.bind(this,s),i.onHeadersReceived=e.onHeadersReceived,i.onDone=e.onDone,i.onError=e.onError,i.onProgress=e.onProgress,t.send(null),s}onProgress(e,t){var i;const s=this.pendingRequests[e];s&&((i=s.onProgress)==null||i.call(s,t))}onStateChange(e,t){const s=this.pendingRequests[e];if(!s)return;const i=s.xhr;if(i.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),i.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],i.status===0&&this.isHttp){s.onError(i.status);return}const r=i.status||Ey;if(!(r===Ey&&s.expectedStatus===_y)&&r!==s.expectedStatus){s.onError(i.status);return}const a=T2(i);if(r===_y){const c=i.getResponseHeader("Content-Range"),u=/bytes (\d+)-(\d+)\/(\d+)/.exec(c);u?s.onDone({begin:parseInt(u[1],10),chunk:a}):(ne('Missing or invalid "Content-Range" header.'),s.onError(0))}else a?s.onDone({begin:0,chunk:a}):s.onError(i.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class R2{constructor(e){this._source=e,this._manager=new P2(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return rt(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new L2(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const s=new M2(this._manager,e,t);return s.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class L2{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=Lm(t.responseURL);const s=t.getAllResponseHeaders(),i=new Headers(s?s.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(a=>{const[c,...u]=a.split(": ");return[c,u.join(": ")]}):[]),{allowRangeRequests:r,suggestedLength:o}=e_({responseHeaders:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});r&&(this._isRangeSupported=!0),this._contentLength=o||this._contentLength,this._filename=t_(i),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=jf(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;(t=this.onProgress)==null||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class M2{constructor(e,t,s){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:s,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var t;const e=Lm((t=this._manager.getRequestXhr(this._requestId))==null?void 0:t.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=jf(e,this._url));for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(t=this.onProgress)==null||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const D2=/^[a-z][a-z0-9\-+.]+:/i;function N2(n){if(D2.test(n))return new URL(n);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(n))}class I2{constructor(e){this.source=e,this.url=N2(e.url),rt(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return rt(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new O2(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new F2(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class O2{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const s=process.getBuiltinModule("fs");s.promises.lstat(this._url).then(i=>{this._contentLength=i.size,this._setReadableStream(s.createReadStream(this._url)),this._headersCapability.resolve()},i=>{i.code==="ENOENT"&&(i=jf(0,this._url.href)),this._storedError=i,this._headersCapability.reject(i)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Er("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class F2{constructor(e,t,s){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const i=e.source;this._isStreamingSupported=!i.disableStream;const r=process.getBuiltinModule("fs");this._setReadableStream(r.createReadStream(this._url,{start:t,end:s-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const Bu=Symbol("INITIAL_DATA");var In,Rh,Jv;class r_{constructor(){A(this,Rh);A(this,In,Object.create(null))}get(e,t=null){if(t){const i=S(this,Rh,Jv).call(this,e);return i.promise.then(()=>t(i.data)),null}const s=l(this,In)[e];if(!s||s.data===Bu)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return s.data}has(e){const t=l(this,In)[e];return!!t&&t.data!==Bu}delete(e){const t=l(this,In)[e];return!t||t.data===Bu?!1:(delete l(this,In)[e],!0)}resolve(e,t=null){const s=S(this,Rh,Jv).call(this,e);s.data=t,s.resolve()}clear(){var e;for(const t in l(this,In)){const{data:s}=l(this,In)[t];(e=s==null?void 0:s.bitmap)==null||e.close()}m(this,In,Object.create(null))}*[Symbol.iterator](){for(const e in l(this,In)){const{data:t}=l(this,In)[e];t!==Bu&&(yield[e,t])}}}In=new WeakMap,Rh=new WeakSet,Jv=function(e){var t;return(t=l(this,In))[e]||(t[e]={...Promise.withResolvers(),data:Bu})};const j2=1e5,JA=30;var fS,to,pn,Lh,Mh,Ea,Ji,Dh,Nh,_a,_c,Cc,no,kc,Ih,Tc,Ca,Oh,Fh,Ye,Pc,ka,jh,so,Rc,Cr,o_,a_,Zv,Qn,Fp,e0,l_,c_;let Xd=(Ye=class{constructor({textContentSource:e,container:t,viewport:s}){A(this,Cr);A(this,to,Promise.withResolvers());A(this,pn,null);A(this,Lh,!1);A(this,Mh,!!((fS=globalThis.FontInspector)!=null&&fS.enabled));A(this,Ea,null);A(this,Ji,null);A(this,Dh,0);A(this,Nh,0);A(this,_a,null);A(this,_c,null);A(this,Cc,0);A(this,no,0);A(this,kc,Object.create(null));A(this,Ih,[]);A(this,Tc,null);A(this,Ca,[]);A(this,Oh,new WeakMap);A(this,Fh,null);var c;if(e instanceof ReadableStream)m(this,Tc,e);else if(typeof e=="object")m(this,Tc,new ReadableStream({start(u){u.enqueue(e),u.close()}}));else throw new Error('No "textContentSource" parameter specified.');m(this,pn,m(this,_c,t)),m(this,no,s.scale*Xs.pixelRatio),m(this,Cc,s.rotation),m(this,Ji,{div:null,properties:null,ctx:null});const{pageWidth:i,pageHeight:r,pageX:o,pageY:a}=s.rawDims;m(this,Fh,[1,0,0,-1,-o,a+r]),m(this,Nh,i),m(this,Dh,r),S(c=Ye,Qn,l_).call(c),Oo(t,s),l(this,to).promise.finally(()=>{l(Ye,Rc).delete(this),m(this,Ji,null),m(this,kc,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=Et.platform;return le(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{l(this,_a).read().then(({value:t,done:s})=>{if(s){l(this,to).resolve();return}l(this,Ea)??m(this,Ea,t.lang),Object.assign(l(this,kc),t.styles),S(this,Cr,o_).call(this,t.items),e()},l(this,to).reject)};return m(this,_a,l(this,Tc).getReader()),l(Ye,Rc).add(this),e(),l(this,to).promise}update({viewport:e,onBefore:t=null}){var r;const s=e.scale*Xs.pixelRatio,i=e.rotation;if(i!==l(this,Cc)&&(t==null||t(),m(this,Cc,i),Oo(l(this,_c),{rotation:i})),s!==l(this,no)){t==null||t(),m(this,no,s);const o={div:null,properties:null,ctx:S(r=Ye,Qn,Fp).call(r,l(this,Ea))};for(const a of l(this,Ca))o.properties=l(this,Oh).get(a),o.div=a,S(this,Cr,Zv).call(this,o)}}cancel(){var t;const e=new Er("TextLayer task cancelled.");(t=l(this,_a))==null||t.cancel(e).catch(()=>{}),m(this,_a,null),l(this,to).reject(e)}get textDivs(){return l(this,Ca)}get textContentItemsStr(){return l(this,Ih)}static cleanup(){if(!(l(this,Rc).size>0)){l(this,Pc).clear();for(const{canvas:e}of l(this,ka).values())e.remove();l(this,ka).clear()}}},to=new WeakMap,pn=new WeakMap,Lh=new WeakMap,Mh=new WeakMap,Ea=new WeakMap,Ji=new WeakMap,Dh=new WeakMap,Nh=new WeakMap,_a=new WeakMap,_c=new WeakMap,Cc=new WeakMap,no=new WeakMap,kc=new WeakMap,Ih=new WeakMap,Tc=new WeakMap,Ca=new WeakMap,Oh=new WeakMap,Fh=new WeakMap,Pc=new WeakMap,ka=new WeakMap,jh=new WeakMap,so=new WeakMap,Rc=new WeakMap,Cr=new WeakSet,o_=function(e){var i,r;if(l(this,Lh))return;(r=l(this,Ji)).ctx??(r.ctx=S(i=Ye,Qn,Fp).call(i,l(this,Ea)));const t=l(this,Ca),s=l(this,Ih);for(const o of e){if(t.length>j2){ne("Ignoring additional textDivs for performance reasons."),m(this,Lh,!0);return}if(o.str===void 0){if(o.type==="beginMarkedContentProps"||o.type==="beginMarkedContent"){const a=l(this,pn);m(this,pn,document.createElement("span")),l(this,pn).classList.add("markedContent"),o.id!==null&&l(this,pn).setAttribute("id",`${o.id}`),a.append(l(this,pn))}else o.type==="endMarkedContent"&&m(this,pn,l(this,pn).parentNode);continue}s.push(o.str),S(this,Cr,a_).call(this,o)}},a_=function(e){var g;const t=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};l(this,Ca).push(t);const i=Y.transform(l(this,Fh),e.transform);let r=Math.atan2(i[1],i[0]);const o=l(this,kc)[e.fontName];o.vertical&&(r+=Math.PI/2);let a=l(this,Mh)&&o.fontSubstitution||o.fontFamily;a=Ye.fontFamilyMap.get(a)||a;const c=Math.hypot(i[2],i[3]),u=c*S(g=Ye,Qn,c_).call(g,a,o,l(this,Ea));let d,h;r===0?(d=i[4],h=i[5]-u):(d=i[4]+u*Math.sin(r),h=i[5]-u*Math.cos(r));const f="calc(var(--total-scale-factor) *",p=t.style;l(this,pn)===l(this,_c)?(p.left=`${(100*d/l(this,Nh)).toFixed(2)}%`,p.top=`${(100*h/l(this,Dh)).toFixed(2)}%`):(p.left=`${f}${d.toFixed(2)}px)`,p.top=`${f}${h.toFixed(2)}px)`),p.fontSize=`${f}${(l(Ye,so)*c).toFixed(2)}px)`,p.fontFamily=a,s.fontSize=c,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,l(this,Mh)&&(t.dataset.fontName=o.fontSubstitutionLoadedName||e.fontName),r!==0&&(s.angle=r*(180/Math.PI));let v=!1;if(e.str.length>1)v=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const x=Math.abs(e.transform[0]),y=Math.abs(e.transform[3]);x!==y&&Math.max(x,y)/Math.min(x,y)>1.5&&(v=!0)}if(v&&(s.canvasWidth=o.vertical?e.height:e.width),l(this,Oh).set(t,s),l(this,Ji).div=t,l(this,Ji).properties=s,S(this,Cr,Zv).call(this,l(this,Ji)),s.hasText&&l(this,pn).append(t),s.hasEOL){const x=document.createElement("br");x.setAttribute("role","presentation"),l(this,pn).append(x)}},Zv=function(e){var a;const{div:t,properties:s,ctx:i}=e,{style:r}=t;let o="";if(l(Ye,so)>1&&(o=`scale(${1/l(Ye,so)})`),s.canvasWidth!==0&&s.hasText){const{fontFamily:c}=r,{canvasWidth:u,fontSize:d}=s;S(a=Ye,Qn,e0).call(a,i,d*l(this,no),c);const{width:h}=i.measureText(t.textContent);h>0&&(o=`scaleX(${u*l(this,no)/h}) ${o}`)}s.angle!==0&&(o=`rotate(${s.angle}deg) ${o}`),o.length>0&&(r.transform=o)},Qn=new WeakSet,Fp=function(e=null){let t=l(this,ka).get(e||(e=""));if(!t){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=e,document.body.append(s),t=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),l(this,ka).set(e,t),l(this,jh).set(t,{size:0,family:""})}return t},e0=function(e,t,s){const i=l(this,jh).get(e);t===i.size&&s===i.family||(e.font=`${t}px ${s}`,i.size=t,i.family=s)},l_=function(){if(l(this,so)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),m(this,so,e.getBoundingClientRect().height),e.remove()},c_=function(e,t,s){const i=l(this,Pc).get(e);if(i)return i;const r=S(this,Qn,Fp).call(this,s);r.canvas.width=r.canvas.height=JA,S(this,Qn,e0).call(this,r,JA,e);const o=r.measureText(""),a=o.fontBoundingBoxAscent,c=Math.abs(o.fontBoundingBoxDescent);r.canvas.width=r.canvas.height=0;let u=.8;return a?u=a/(a+c):(Et.platform.isFirefox&&ne("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?u=t.ascent:t.descent&&(u=1+t.descent)),l(this,Pc).set(e,u),u},A(Ye,Qn),A(Ye,Pc,new Map),A(Ye,ka,new Map),A(Ye,jh,new WeakMap),A(Ye,so,null),A(Ye,Rc,new Set),Ye);class Yd{static textContent(e){const t=[],s={items:t,styles:Object.create(null)};function i(r){var c;if(!r)return;let o=null;const a=r.name;if(a==="#text")o=r.value;else if(Yd.shouldBuildText(a))(c=r==null?void 0:r.attributes)!=null&&c.textContent?o=r.attributes.textContent:r.value&&(o=r.value);else return;if(o!==null&&t.push({str:o}),!!r.children)for(const u of r.children)i(u)}return i(e),s}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}const z2=100;function qw(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const e=new t0,{docId:t}=e,s=n.url?qL(n.url):null,i=n.data?KL(n.data):null,r=n.httpHeaders||null,o=n.withCredentials===!0,a=n.password??null,c=n.range instanceof Kw?n.range:null,u=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:2**16;let d=n.worker instanceof wu?n.worker:null;const h=n.verbosity,f=typeof n.docBaseUrl=="string"&&!Of(n.docBaseUrl)?n.docBaseUrl:null,p=lp(n.cMapUrl),v=n.cMapPacked!==!1,g=n.CMapReaderFactory||(sn?s2:BA),x=lp(n.iccUrl),y=lp(n.standardFontDataUrl),w=n.StandardFontDataFactory||(sn?i2:$A),b=lp(n.wasmUrl),E=n.WasmFactory||(sn?r2:HA),_=n.stopAtErrors!==!0,k=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,C=n.isEvalSupported!==!1,P=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!sn,L=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!sn&&(Et.platform.isFirefox||!globalThis.chrome),M=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,D=typeof n.disableFontFace=="boolean"?n.disableFontFace:sn,K=n.fontExtraProperties===!0,Q=n.enableXfa===!0,G=n.ownerDocument||globalThis.document,te=n.disableRange===!0,j=n.disableStream===!0,O=n.disableAutoFetch===!0,I=n.pdfBug===!0,$=n.CanvasFactory||(sn?n2:ZL),X=n.FilterFactory||(sn?t2:e2),re=n.enableHWA===!0,J=n.useWasm!==!1,oe=c?c.length:n.length??NaN,Pe=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!sn&&!D,We=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:!!(g===BA&&w===$A&&E===HA&&p&&y&&b&&Xu(p,document.baseURI)&&Xu(y,document.baseURI)&&Xu(b,document.baseURI)),he=null;LL(h);const fe={canvasFactory:new $({ownerDocument:G,enableHWA:re}),filterFactory:new X({docId:t,ownerDocument:G}),cMapReaderFactory:We?null:new g({baseUrl:p,isCompressed:v}),standardFontDataFactory:We?null:new w({baseUrl:y}),wasmFactory:We?null:new E({baseUrl:b})};d||(d=wu.create({verbosity:h,port:ps.workerPort}),e._worker=d);const En={docId:t,apiVersion:"5.3.31",data:i,password:a,disableAutoFetch:O,rangeChunkSize:u,length:oe,docBaseUrl:f,enableXfa:Q,evaluatorOptions:{maxImageSize:k,disableFontFace:D,ignoreErrors:_,isEvalSupported:C,isOffscreenCanvasSupported:P,isImageDecoderSupported:L,canvasMaxAreaInBytes:M,fontExtraProperties:K,useSystemFonts:Pe,useWasm:J,useWorkerFetch:We,cMapUrl:p,iccUrl:x,standardFontDataUrl:y,wasmUrl:b}},_n={ownerDocument:G,pdfBug:I,styleElement:he,loadingParams:{disableAutoFetch:O,enableXfa:Q}};return d.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const ue=d.messageHandler.sendWithPromise("GetDocRequest",En,i?[i.buffer]:null);let Cn;if(c)Cn=new A2(c,{disableRange:te,disableStream:j});else if(!i){if(!s)throw new Error("getDocument - no `url` parameter provided.");const _t=Xu(s)?_2:sn?I2:R2;Cn=new _t({url:s,length:oe,httpHeaders:r,withCredentials:o,rangeChunkSize:u,disableRange:te,disableStream:j})}return ue.then(_t=>{if(e.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const pt=new Ju(t,_t,d.port),pe=new H2(pt,e,Cn,_n,fe);e._transport=pe,pt.send("Ready",null)})}).catch(e._capability.reject),e}var qg;const Kg=class Kg{constructor(){F(this,"_capability",Promise.withResolvers());F(this,"_transport",null);F(this,"_worker",null);F(this,"docId",`d${Qt(Kg,qg)._++}`);F(this,"destroyed",!1);F(this,"onPassword",null);F(this,"onProgress",null)}get promise(){return this._capability.promise}async destroy(){var e,t,s,i;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(r){throw(s=this._worker)!=null&&s.port&&delete this._worker._pendingDestroy,r}this._transport=null,(i=this._worker)==null||i.destroy(),this._worker=null}async getData(){return this._transport.getData()}};qg=new WeakMap,A(Kg,qg,0);let t0=Kg;var Ta,zh,Bh,$h,Hh,pS;let Kw=(pS=class{constructor(e,t,s=!1,i=null){A(this,Ta,Promise.withResolvers());A(this,zh,[]);A(this,Bh,[]);A(this,$h,[]);A(this,Hh,[]);this.length=e,this.initialData=t,this.progressiveDone=s,this.contentDispositionFilename=i}addRangeListener(e){l(this,Hh).push(e)}addProgressListener(e){l(this,$h).push(e)}addProgressiveReadListener(e){l(this,Bh).push(e)}addProgressiveDoneListener(e){l(this,zh).push(e)}onDataRange(e,t){for(const s of l(this,Hh))s(e,t)}onDataProgress(e,t){l(this,Ta).promise.then(()=>{for(const s of l(this,$h))s(e,t)})}onDataProgressiveRead(e){l(this,Ta).promise.then(()=>{for(const t of l(this,Bh))t(e)})}onDataProgressiveDone(){l(this,Ta).promise.then(()=>{for(const e of l(this,zh))e()})}transportReady(){l(this,Ta).resolve()}requestDataRange(e,t){_e("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}},Ta=new WeakMap,zh=new WeakMap,Bh=new WeakMap,$h=new WeakMap,Hh=new WeakMap,pS);class B2{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return le(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var Zi,Pa,sd;class $2{constructor(e,t,s,i=!1){A(this,Pa);A(this,Zi,!1);this._pageIndex=e,this._pageInfo=t,this._transport=s,this._stats=i?new FA:null,this._pdfBug=i,this.commonObjs=s.commonObjs,this.objs=new r_,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:s=0,offsetY:i=0,dontFlip:r=!1}={}){return new If({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:s,offsetY:i,dontFlip:r})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return le(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,viewport:t,intent:s="display",annotationMode:i=Ai.ENABLE,transform:r=null,background:o=null,optionalContentConfigPromise:a=null,annotationCanvasMap:c=null,pageColors:u=null,printAnnotationStorage:d=null,isEditing:h=!1}){var E,_;(E=this._stats)==null||E.time("Overall");const f=this._transport.getRenderingIntent(s,i,d,h),{renderingIntent:p,cacheKey:v}=f;m(this,Zi,!1),a||(a=this._transport.getOptionalContentConfig(p));let g=this._intentStates.get(v);g||(g=Object.create(null),this._intentStates.set(v,g)),g.streamReaderCancelTimeout&&(clearTimeout(g.streamReaderCancelTimeout),g.streamReaderCancelTimeout=null);const x=!!(p&Gn.PRINT);g.displayReadyCapability||(g.displayReadyCapability=Promise.withResolvers(),g.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(_=this._stats)==null||_.time("Page Request"),this._pumpOperatorList(f));const y=k=>{var C;g.renderTasks.delete(w),x&&m(this,Zi,!0),S(this,Pa,sd).call(this),k?(w.capability.reject(k),this._abortOperatorList({intentState:g,reason:k instanceof Error?k:new Error(k)})):w.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(C=globalThis.Stats)!=null&&C.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},w=new n0({callback:y,params:{canvasContext:e,viewport:t,transform:r,background:o},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:c,operatorList:g.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!x,pdfBug:this._pdfBug,pageColors:u});(g.renderTasks||(g.renderTasks=new Set)).add(w);const b=w.task;return Promise.all([g.displayReadyCapability.promise,a]).then(([k,C])=>{var P;if(this.destroyed){y();return}if((P=this._stats)==null||P.time("Rendering"),!(C.renderingIntent&p))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");w.initializeGraphics({transparency:k,optionalContentConfig:C}),w.operatorListChanged()}).catch(y),b}getOperatorList({intent:e="display",annotationMode:t=Ai.ENABLE,printAnnotationStorage:s=null,isEditing:i=!1}={}){var u;function r(){a.operatorList.lastChunk&&(a.opListReadCapability.resolve(a.operatorList),a.renderTasks.delete(c))}const o=this._transport.getRenderingIntent(e,t,s,i,!0);let a=this._intentStates.get(o.cacheKey);a||(a=Object.create(null),this._intentStates.set(o.cacheKey,a));let c;return a.opListReadCapability||(c=Object.create(null),c.operatorListChanged=r,a.opListReadCapability=Promise.withResolvers(),(a.renderTasks||(a.renderTasks=new Set)).add(c),a.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(u=this._stats)==null||u.time("Page Request"),this._pumpOperatorList(o)),a.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(s=>Yd.textContent(s));const t=this.streamTextContent(e);return new Promise(function(s,i){function r(){o.read().then(function({value:c,done:u}){if(u){s(a);return}a.lang??(a.lang=c.lang),Object.assign(a.styles,c.styles),a.items.push(...c.items),r()},i)}const o=t.getReader(),a={items:[],styles:Object.create(null),lang:null};r()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const s of t.renderTasks)e.push(s.completed),s.cancel();return this.objs.clear(),m(this,Zi,!1),Promise.all(e)}cleanup(e=!1){m(this,Zi,!0);const t=S(this,Pa,sd).call(this);return e&&t&&this._stats&&(this._stats=new FA),t}_startRenderPage(e,t){var i,r;const s=this._intentStates.get(t);s&&((i=this._stats)==null||i.timeEnd("Page Request"),(r=s.displayReadyCapability)==null||r.resolve(e))}_renderPageChunk(e,t){for(let s=0,i=e.length;s<i;s++)t.operatorList.fnArray.push(e.fnArray[s]),t.operatorList.argsArray.push(e.argsArray[s]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const s of t.renderTasks)s.operatorListChanged();e.lastChunk&&S(this,Pa,sd).call(this)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:s,modifiedIds:i}){const{map:r,transfer:o}=s,c=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:r,modifiedIds:i},o).getReader(),u=this._intentStates.get(t);u.streamReader=c;const d=()=>{c.read().then(({value:h,done:f})=>{if(f){u.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(h,u),d())},h=>{if(u.streamReader=null,!this._transport.destroyed){if(u.operatorList){u.operatorList.lastChunk=!0;for(const f of u.renderTasks)f.operatorListChanged();S(this,Pa,sd).call(this)}if(u.displayReadyCapability)u.displayReadyCapability.reject(h);else if(u.opListReadCapability)u.opListReadCapability.reject(h);else throw h}})};d()}_abortOperatorList({intentState:e,reason:t,force:s=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!s){if(e.renderTasks.size>0)return;if(t instanceof Tm){let i=z2;t.extraDelay>0&&t.extraDelay<1e3&&(i+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},i);return}}if(e.streamReader.cancel(new Er(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[i,r]of this._intentStates)if(r===e){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}Zi=new WeakMap,Pa=new WeakSet,sd=function(){if(!l(this,Zi)||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),m(this,Zi,!1),!0};var io,Rs,er,Ra,Qg,La,Ma,on,jp,u_,d_,id,Lc,zp;const Oe=class Oe{constructor({name:e=null,port:t=null,verbosity:s=ML()}={}){A(this,on);A(this,io,Promise.withResolvers());A(this,Rs,null);A(this,er,null);A(this,Ra,null);if(this.name=e,this.destroyed=!1,this.verbosity=s,t){if(l(Oe,Ma).has(t))throw new Error("Cannot use more than one PDFWorker per port.");l(Oe,Ma).set(t,this),S(this,on,u_).call(this,t)}else S(this,on,d_).call(this)}get promise(){return l(this,io).promise}get port(){return l(this,er)}get messageHandler(){return l(this,Rs)}destroy(){var e,t;this.destroyed=!0,(e=l(this,Ra))==null||e.terminate(),m(this,Ra,null),l(Oe,Ma).delete(l(this,er)),m(this,er,null),(t=l(this,Rs))==null||t.destroy(),m(this,Rs,null)}static create(e){const t=l(this,Ma).get(e==null?void 0:e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new Oe(e)}static get workerSrc(){if(ps.workerSrc)return ps.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return le(this,"_setupFakeWorkerGlobal",(async()=>l(this,Lc,zp)?l(this,Lc,zp):(await import(this.workerSrc)).WorkerMessageHandler)())}};io=new WeakMap,Rs=new WeakMap,er=new WeakMap,Ra=new WeakMap,Qg=new WeakMap,La=new WeakMap,Ma=new WeakMap,on=new WeakSet,jp=function(){l(this,io).resolve(),l(this,Rs).send("configure",{verbosity:this.verbosity})},u_=function(e){m(this,er,e),m(this,Rs,new Ju("main","worker",e)),l(this,Rs).on("ready",()=>{}),S(this,on,jp).call(this)},d_=function(){if(l(Oe,La)||l(Oe,Lc,zp)){S(this,on,id).call(this);return}let{workerSrc:e}=Oe;try{Oe._isSameOrigin(window.location,e)||(e=Oe._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),s=new Ju("main","worker",t),i=()=>{r.abort(),s.destroy(),t.terminate(),this.destroyed?l(this,io).reject(new Error("Worker was destroyed")):S(this,on,id).call(this)},r=new AbortController;t.addEventListener("error",()=>{l(this,Ra)||i()},{signal:r.signal}),s.on("test",a=>{if(r.abort(),this.destroyed||!a){i();return}m(this,Rs,s),m(this,er,t),m(this,Ra,t),S(this,on,jp).call(this)}),s.on("ready",a=>{if(r.abort(),this.destroyed){i();return}try{o()}catch{S(this,on,id).call(this)}});const o=()=>{const a=new Uint8Array;s.send("test",a,[a.buffer])};o();return}catch{km("The worker has been disabled.")}S(this,on,id).call(this)},id=function(){l(Oe,La)||(ne("Setting up fake worker."),m(Oe,La,!0)),Oe._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){l(this,io).reject(new Error("Worker was destroyed"));return}const t=new JL;m(this,er,t);const s=`fake${Qt(Oe,Qg)._++}`,i=new Ju(s+"_worker",s,t);e.setup(i,t),m(this,Rs,new Ju(s,s+"_worker",t)),S(this,on,jp).call(this)}).catch(e=>{l(this,io).reject(new Error(`Setting up fake worker failed: "${e.message}".`))})},Lc=new WeakSet,zp=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},A(Oe,Lc),A(Oe,Qg,0),A(Oe,La,!1),A(Oe,Ma,new WeakMap),sn&&(m(Oe,La,!0),ps.workerSrc||(ps.workerSrc="./pdf.worker.mjs")),Oe._isSameOrigin=(e,t)=>{const s=URL.parse(e);if(!(s!=null&&s.origin)||s.origin==="null")return!1;const i=new URL(t,s);return s.origin===i.origin},Oe._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},Oe.fromPort=e=>{if($L("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return Oe.create(e)};let wu=Oe;var tr,fi,Mc,Dc,nr,Da,rd;class H2{constructor(e,t,s,i,r){A(this,Da);A(this,tr,new Map);A(this,fi,new Map);A(this,Mc,new Map);A(this,Dc,new Map);A(this,nr,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new r_,this.fontLoader=new XL({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=r.canvasFactory,this.filterFactory=r.filterFactory,this.cMapReaderFactory=r.cMapReaderFactory,this.standardFontDataFactory=r.standardFontDataFactory,this.wasmFactory=r.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=s,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return le(this,"annotationStorage",new Ww)}getRenderingIntent(e,t=Ai.ENABLE,s=null,i=!1,r=!1){let o=Gn.DISPLAY,a=Hv;switch(e){case"any":o=Gn.ANY;break;case"display":break;case"print":o=Gn.PRINT;break;default:ne(`getRenderingIntent - invalid intent: ${e}`)}const c=o&Gn.PRINT&&s instanceof H1?s:this.annotationStorage;switch(t){case Ai.DISABLE:o+=Gn.ANNOTATIONS_DISABLE;break;case Ai.ENABLE:break;case Ai.ENABLE_FORMS:o+=Gn.ANNOTATIONS_FORMS;break;case Ai.ENABLE_STORAGE:o+=Gn.ANNOTATIONS_STORAGE,a=c.serializable;break;default:ne(`getRenderingIntent - invalid annotationMode: ${t}`)}i&&(o+=Gn.IS_EDITING),r&&(o+=Gn.OPLIST);const{ids:u,hash:d}=c.modifiedIds,h=[o,a.hash,d];return{renderingIntent:o,cacheKey:h.join("_"),annotationStorageSerializable:a,modifiedIds:u}}destroy(){var s;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(s=l(this,nr))==null||s.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const i of l(this,fi).values())e.push(i._destroy());l(this,fi).clear(),l(this,Mc).clear(),l(this,Dc).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var i,r;this.commonObjs.clear(),this.fontLoader.clear(),l(this,tr).clear(),this.filterFactory.destroy(),Xd.cleanup(),(i=this._networkStream)==null||i.cancelAllRequests(new Er("Worker was terminated.")),(r=this.messageHandler)==null||r.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(s,i)=>{rt(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=r=>{this._lastProgress={loaded:r.loaded,total:r.total}},i.onPull=()=>{this._fullReader.read().then(function({value:r,done:o}){if(o){i.close();return}rt(r instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(r),1,[r])}).catch(r=>{i.error(r)})},i.onCancel=r=>{this._fullReader.cancel(r),i.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("ReaderHeadersReady",async s=>{var a;await this._fullReader.headersReady;const{isStreamingSupported:i,isRangeSupported:r,contentLength:o}=this._fullReader;return(!i||!r)&&(this._lastProgress&&((a=t.onProgress)==null||a.call(t,this._lastProgress)),this._fullReader.onProgress=c=>{var u;(u=t.onProgress)==null||u.call(t,{loaded:c.loaded,total:c.total})}),{isStreamingSupported:i,isRangeSupported:r,contentLength:o}}),e.on("GetRangeReader",(s,i)=>{rt(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const r=this._networkStream.getRangeReader(s.begin,s.end);if(!r){i.close();return}i.onPull=()=>{r.read().then(function({value:o,done:a}){if(a){i.close();return}rt(o instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{i.error(o)})},i.onCancel=o=>{r.cancel(o),i.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("GetDoc",({pdfInfo:s})=>{this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,t._capability.resolve(new B2(s,this))}),e.on("DocException",s=>{t._capability.reject(dn(s))}),e.on("PasswordRequest",s=>{m(this,nr,Promise.withResolvers());try{if(!t.onPassword)throw dn(s);const i=r=>{r instanceof Error?l(this,nr).reject(r):l(this,nr).resolve({password:r})};t.onPassword(i,s.code)}catch(i){l(this,nr).reject(i)}return l(this,nr).promise}),e.on("DataLoaded",s=>{var i;(i=t.onProgress)==null||i.call(t,{loaded:s.length,total:s.length}),this.downloadInfoCapability.resolve(s)}),e.on("StartRenderPage",s=>{if(this.destroyed)return;l(this,fi).get(s.pageIndex)._startRenderPage(s.transparency,s.cacheKey)}),e.on("commonobj",([s,i,r])=>{var o;if(this.destroyed||this.commonObjs.has(s))return null;switch(i){case"Font":if("error"in r){const d=r.error;ne(`Error during font loading: ${d}`),this.commonObjs.resolve(s,d);break}const a=this._params.pdfBug&&((o=globalThis.FontInspector)!=null&&o.enabled)?(d,h)=>globalThis.FontInspector.fontAdded(d,h):null,c=new YL(r,a);this.fontLoader.bind(c).catch(()=>e.sendWithPromise("FontFallback",{id:s})).finally(()=>{!c.fontExtraProperties&&c.data&&(c.data=null),this.commonObjs.resolve(s,c)});break;case"CopyLocalImage":const{imageRef:u}=r;rt(u,"The imageRef must be defined.");for(const d of l(this,fi).values())for(const[,h]of d.objs)if((h==null?void 0:h.ref)===u)return h.dataLen?(this.commonObjs.resolve(s,structuredClone(h)),h.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(s,r);break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),e.on("obj",([s,i,r,o])=>{var c;if(this.destroyed)return;const a=l(this,fi).get(i);if(!a.objs.has(s)){if(a._intentStates.size===0){(c=o==null?void 0:o.bitmap)==null||c.close();return}switch(r){case"Image":case"Pattern":a.objs.resolve(s,o);break;default:throw new Error(`Got unknown object type ${r}`)}}}),e.on("DocProgress",s=>{var i;this.destroyed||(i=t.onProgress)==null||i.call(t,{loaded:s.loaded,total:s.total})}),e.on("FetchBinaryData",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");const i=this[s.type];if(!i)throw new Error(`${s.type} not initialized, see the \`useWorkerFetch\` parameter.`);return i.fetch(s)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var s;this.annotationStorage.size<=0&&ne("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((s=this._fullReader)==null?void 0:s.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,s=l(this,Mc).get(t);if(s)return s;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(r=>{if(this.destroyed)throw new Error("Transport destroyed");r.refStr&&l(this,Dc).set(r.refStr,e);const o=new $2(t,r,this,this._params.pdfBug);return l(this,fi).set(t,o),o});return l(this,Mc).set(t,i),i}getPageIndex(e){return Uv(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return S(this,Da,rd).call(this,"GetFieldObjects")}hasJSActions(){return S(this,Da,rd).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return S(this,Da,rd).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return S(this,Da,rd).call(this,"GetOptionalContentConfig").then(t=>new b2(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=l(this,tr).get(e);if(t)return t;const s=this.messageHandler.sendWithPromise(e,null).then(i=>{var r,o;return{info:i[0],metadata:i[1]?new v2(i[1]):null,contentDispositionFilename:((r=this._fullReader)==null?void 0:r.filename)??null,contentLength:((o=this._fullReader)==null?void 0:o.contentLength)??null}});return l(this,tr).set(e,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of l(this,fi).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),l(this,tr).clear(),this.filterFactory.destroy(!0),Xd.cleanup()}}cachedPageNumber(e){if(!Uv(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return l(this,Dc).get(t)??null}}tr=new WeakMap,fi=new WeakMap,Mc=new WeakMap,Dc=new WeakMap,nr=new WeakMap,Da=new WeakSet,rd=function(e,t=null){const s=l(this,tr).get(e);if(s)return s;const i=this.messageHandler.sendWithPromise(e,t);return l(this,tr).set(e,i),i};var ro;class U2{constructor(e){A(this,ro,null);F(this,"onContinue",null);F(this,"onError",null);m(this,ro,e)}get promise(){return l(this,ro).capability.promise}cancel(e=0){l(this,ro).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=l(this,ro).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=l(this,ro);return e.form||e.canvas&&(t==null?void 0:t.size)>0}}ro=new WeakMap;var oo,Na;const Qo=class Qo{constructor({callback:e,params:t,objs:s,commonObjs:i,annotationCanvasMap:r,operatorList:o,pageIndex:a,canvasFactory:c,filterFactory:u,useRequestAnimationFrame:d=!1,pdfBug:h=!1,pageColors:f=null}){A(this,oo,null);this.callback=e,this.params=t,this.objs=s,this.commonObjs=i,this.annotationCanvasMap=r,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=a,this.canvasFactory=c,this.filterFactory=u,this._pdfBug=h,this.pageColors=f,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=d===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new U2(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var a,c;if(this.cancelled)return;if(this._canvas){if(l(Qo,Na).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");l(Qo,Na).add(this._canvas)}this._pdfBug&&((a=globalThis.StepperManager)!=null&&a.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:s,viewport:i,transform:r,background:o}=this.params;this.gfx=new ec(s,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:r,viewport:i,transparency:e,background:o}),this.operatorListIdx=0,this.graphicsReady=!0,(c=this.graphicsReadyCallback)==null||c.call(this)}cancel(e=null,t=0){var s,i,r;this.running=!1,this.cancelled=!0,(s=this.gfx)==null||s.endDrawing(),l(this,oo)&&(window.cancelAnimationFrame(l(this,oo)),m(this,oo,null)),l(Qo,Na).delete(this._canvas),e||(e=new Tm(`Rendering cancelled, page ${this._pageIndex+1}`,t)),this.callback(e),(r=(i=this.task).onError)==null||r.call(i,e)}operatorListChanged(){var e;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.stepper)==null||e.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?m(this,oo,window.requestAnimationFrame(()=>{m(this,oo,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),l(Qo,Na).delete(this._canvas),this.callback())))}};oo=new WeakMap,Na=new WeakMap,A(Qo,Na,new WeakSet);let n0=Qo;const h_="5.3.31",f_="47ad820d9";function ZA(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function $u(n){return Math.max(0,Math.min(255,255*n))}class eS{static CMYK_G([e,t,s,i]){return["G",1-Math.min(1,.3*e+.59*s+.11*t+i)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=$u(e),[e,e,e]}static G_HTML([e]){const t=ZA(e);return`#${t}${t}${t}`}static RGB_G([e,t,s]){return["G",.3*e+.59*t+.11*s]}static RGB_rgb(e){return e.map($u)}static RGB_HTML(e){return`#${e.map(ZA).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,s,i]){return["RGB",1-Math.min(1,e+i),1-Math.min(1,s+i),1-Math.min(1,t+i)]}static CMYK_rgb([e,t,s,i]){return[$u(1-Math.min(1,e+i)),$u(1-Math.min(1,s+i)),$u(1-Math.min(1,t+i))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,s]){const i=1-e,r=1-t,o=1-s,a=Math.min(i,r,o);return["CMYK",i,r,o,a]}}class V2{create(e,t,s=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),s||(i.setAttribute("width",`${e}px`),i.setAttribute("height",`${t}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${e} ${t}`),i}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){_e("Abstract method `_createSVG` called.")}}class qd extends V2{_createSVG(e){return document.createElementNS(Di,e)}}class Qw{static setupStorage(e,t,s,i,r){const o=i.getValue(t,{value:null});switch(s.name){case"textarea":if(o.value!==null&&(e.textContent=o.value),r==="print")break;e.addEventListener("input",a=>{i.setValue(t,{value:a.target.value})});break;case"input":if(s.attributes.type==="radio"||s.attributes.type==="checkbox"){if(o.value===s.attributes.xfaOn?e.setAttribute("checked",!0):o.value===s.attributes.xfaOff&&e.removeAttribute("checked"),r==="print")break;e.addEventListener("change",a=>{i.setValue(t,{value:a.target.checked?a.target.getAttribute("xfaOn"):a.target.getAttribute("xfaOff")})})}else{if(o.value!==null&&e.setAttribute("value",o.value),r==="print")break;e.addEventListener("input",a=>{i.setValue(t,{value:a.target.value})})}break;case"select":if(o.value!==null){e.setAttribute("value",o.value);for(const a of s.children)a.attributes.value===o.value?a.attributes.selected=!0:a.attributes.hasOwnProperty("selected")&&delete a.attributes.selected}e.addEventListener("input",a=>{const c=a.target.options,u=c.selectedIndex===-1?"":c[c.selectedIndex].value;i.setValue(t,{value:u})});break}}static setAttributes({html:e,element:t,storage:s=null,intent:i,linkService:r}){const{attributes:o}=t,a=e instanceof HTMLAnchorElement;o.type==="radio"&&(o.name=`${o.name}-${i}`);for(const[c,u]of Object.entries(o))if(u!=null)switch(c){case"class":u.length&&e.setAttribute(c,u.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",u);break;case"style":Object.assign(e.style,u);break;case"textContent":e.textContent=u;break;default:(!a||c!=="href"&&c!=="newWindow")&&e.setAttribute(c,u)}a&&r.addLinkAttributes(e,o.href,o.newWindow),s&&o.dataId&&this.setupStorage(e,o.dataId,t,s)}static render(e){var h,f;const t=e.annotationStorage,s=e.linkService,i=e.xfaHtml,r=e.intent||"display",o=document.createElement(i.name);i.attributes&&this.setAttributes({html:o,element:i,intent:r,linkService:s});const a=r!=="richText",c=e.div;if(c.append(o),e.viewport){const p=`matrix(${e.viewport.transform.join(",")})`;c.style.transform=p}a&&c.setAttribute("class","xfaLayer xfaFont");const u=[];if(i.children.length===0){if(i.value){const p=document.createTextNode(i.value);o.append(p),a&&Yd.shouldBuildText(i.name)&&u.push(p)}return{textDivs:u}}const d=[[i,-1,o]];for(;d.length>0;){const[p,v,g]=d.at(-1);if(v+1===p.children.length){d.pop();continue}const x=p.children[++d.at(-1)[1]];if(x===null)continue;const{name:y}=x;if(y==="#text"){const b=document.createTextNode(x.value);u.push(b),g.append(b);continue}const w=(h=x==null?void 0:x.attributes)!=null&&h.xmlns?document.createElementNS(x.attributes.xmlns,y):document.createElement(y);if(g.append(w),x.attributes&&this.setAttributes({html:w,element:x,storage:t,intent:r,linkService:s}),((f=x.children)==null?void 0:f.length)>0)d.push([x,-1,w]);else if(x.value){const b=document.createTextNode(x.value);a&&Yd.shouldBuildText(y)&&u.push(b),w.append(b)}}for(const p of c.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))p.setAttribute("readOnly",!0);return{textDivs:u}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const zf=1e3,G2=9,pl=new WeakSet;class tS{static create(e){switch(e.data.annotationType){case Ke.LINK:return new p_(e);case Ke.TEXT:return new W2(e);case Ke.WIDGET:switch(e.data.fieldType){case"Tx":return new X2(e);case"Btn":return e.data.radioButton?new y_(e):e.data.checkBox?new q2(e):new K2(e);case"Ch":return new Q2(e);case"Sig":return new Y2(e)}return new wl(e);case Ke.POPUP:return new i0(e);case Ke.FREETEXT:return new S_(e);case Ke.LINE:return new Z2(e);case Ke.SQUARE:return new eM(e);case Ke.CIRCLE:return new tM(e);case Ke.POLYLINE:return new x_(e);case Ke.CARET:return new sM(e);case Ke.INK:return new Jw(e);case Ke.POLYGON:return new nM(e);case Ke.HIGHLIGHT:return new E_(e);case Ke.UNDERLINE:return new iM(e);case Ke.SQUIGGLY:return new rM(e);case Ke.STRIKEOUT:return new oM(e);case Ke.STAMP:return new __(e);case Ke.FILEATTACHMENT:return new aM(e);default:return new nt(e)}}}var Ia,Nc,Ic,Uh,s0;const rb=class rb{constructor(e,{isRenderable:t=!1,ignoreBorder:s=!1,createQuadrilaterals:i=!1}={}){A(this,Uh);A(this,Ia,null);A(this,Nc,!1);A(this,Ic,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(s)),i&&this._createQuadrilaterals()}static _hasPopupData({titleObj:e,contentsObj:t,richText:s}){return!!(e!=null&&e.str||t!=null&&t.str||s!=null&&s.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return rb._hasPopupData(this.data)}updateEdited(e){var s;if(!this.container)return;l(this,Ia)||m(this,Ia,{rect:this.data.rect.slice(0)});const{rect:t}=e;t&&S(this,Uh,s0).call(this,t),(s=l(this,Ic))==null||s.popup.updateEdited(e)}resetEdited(){var e;l(this,Ia)&&(S(this,Uh,s0).call(this,l(this,Ia).rect),(e=l(this,Ic))==null||e.popup.resetEdited(),m(this,Ia,null))}_createContainer(e){const{data:t,parent:{page:s,viewport:i}}=this,r=document.createElement("section");r.setAttribute("data-annotation-id",t.id),this instanceof wl||(r.tabIndex=zf);const{style:o}=r;if(o.zIndex=this.parent.zIndex++,t.alternativeText&&(r.title=t.alternativeText),t.noRotate&&r.classList.add("norotate"),!t.rect||this instanceof i0){const{rotation:g}=t;return!t.hasOwnCanvas&&g!==0&&this.setRotation(g,r),r}const{width:a,height:c}=this;if(!e&&t.borderStyle.width>0){o.borderWidth=`${t.borderStyle.width}px`;const g=t.borderStyle.horizontalCornerRadius,x=t.borderStyle.verticalCornerRadius;if(g>0||x>0){const w=`calc(${g}px * var(--total-scale-factor)) / calc(${x}px * var(--total-scale-factor))`;o.borderRadius=w}else if(this instanceof y_){const w=`calc(${a}px * var(--total-scale-factor)) / calc(${c}px * var(--total-scale-factor))`;o.borderRadius=w}switch(t.borderStyle.style){case El.SOLID:o.borderStyle="solid";break;case El.DASHED:o.borderStyle="dashed";break;case El.BEVELED:ne("Unimplemented border style: beveled");break;case El.INSET:ne("Unimplemented border style: inset");break;case El.UNDERLINE:o.borderBottomStyle="solid";break}const y=t.borderColor||null;y?(m(this,Nc,!0),o.borderColor=Y.makeHexColor(y[0]|0,y[1]|0,y[2]|0)):o.borderWidth=0}const u=Y.normalizeRect([t.rect[0],s.view[3]-t.rect[1]+s.view[1],t.rect[2],s.view[3]-t.rect[3]+s.view[1]]),{pageWidth:d,pageHeight:h,pageX:f,pageY:p}=i.rawDims;o.left=`${100*(u[0]-f)/d}%`,o.top=`${100*(u[1]-p)/h}%`;const{rotation:v}=t;return t.hasOwnCanvas||v===0?(o.width=`${100*a/d}%`,o.height=`${100*c/h}%`):this.setRotation(v,r),r}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:s,pageHeight:i}=this.parent.viewport.rawDims;let{width:r,height:o}=this;e%180!==0&&([r,o]=[o,r]),t.style.width=`${100*r/s}%`,t.style.height=`${100*o/i}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,s,i)=>{const r=i.detail[t],o=r[0],a=r.slice(1);i.target.style[s]=eS[`${o}_HTML`](a),this.annotationStorage.setValue(this.data.id,{[s]:eS[`${o}_rgb`](a)})};return le(this,"_commonActions",{display:t=>{const{display:s}=t.detail,i=s%2===1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:s===1||s===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:s}=t.detail;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:s,noView:s})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const s=t.detail.rotation;this.setRotation(s),this.annotationStorage.setValue(this.data.id,{rotation:s})}})}_dispatchEventFromSandbox(e,t){const s=this._commonActions;for(const i of Object.keys(t.detail)){const r=e[i]||s[i];r==null||r(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const s=this._commonActions;for(const[i,r]of Object.entries(t)){const o=s[i];if(o){const a={detail:{[i]:r},target:e};o(a),delete t[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,s,i,r]=this.data.rect.map(g=>Math.fround(g));if(e.length===8){const[g,x,y,w]=e.subarray(2,6);if(i===g&&r===x&&t===y&&s===w)return}const{style:o}=this.container;let a;if(l(this,Nc)){const{borderColor:g,borderWidth:x}=o;o.borderWidth=0,a=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${g}" stroke-width="${x}">`],this.container.classList.add("hasBorder")}const c=i-t,u=r-s,{svgFactory:d}=this,h=d.createElement("svg");h.classList.add("quadrilateralsContainer"),h.setAttribute("width",0),h.setAttribute("height",0);const f=d.createElement("defs");h.append(f);const p=d.createElement("clipPath"),v=`clippath_${this.data.id}`;p.setAttribute("id",v),p.setAttribute("clipPathUnits","objectBoundingBox"),f.append(p);for(let g=2,x=e.length;g<x;g+=8){const y=e[g],w=e[g+1],b=e[g+2],E=e[g+3],_=d.createElement("rect"),k=(b-t)/c,C=(r-w)/u,P=(y-b)/c,L=(w-E)/u;_.setAttribute("x",k),_.setAttribute("y",C),_.setAttribute("width",P),_.setAttribute("height",L),p.append(_),a==null||a.push(`<rect vector-effect="non-scaling-stroke" x="${k}" y="${C}" width="${P}" height="${L}"/>`)}l(this,Nc)&&(a.push("</g></svg>')"),o.backgroundImage=a.join("")),this.container.append(h),this.container.style.clipPath=`url(#${v})`}_createPopup(){const{data:e}=this,t=m(this,Ic,new i0({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]}));this.parent.div.append(t.render())}render(){_e("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const s=[];if(this._fieldObjects){const i=this._fieldObjects[e];if(i)for(const{page:r,id:o,exportValues:a}of i){if(r===-1||o===t)continue;const c=typeof a=="string"?a:null,u=document.querySelector(`[data-element-id="${o}"]`);if(u&&!pl.has(u)){ne(`_getElementsByName - element not allowed: ${o}`);continue}s.push({id:o,exportValue:c,domElement:u})}return s}for(const i of document.getElementsByName(e)){const{exportValue:r}=i,o=i.getAttribute("data-element-id");o!==t&&pl.has(i)&&s.push({id:o,exportValue:r,domElement:i})}return s}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var s;(s=this.linkService.eventBus)==null||s.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}};Ia=new WeakMap,Nc=new WeakMap,Ic=new WeakMap,Uh=new WeakSet,s0=function(e){const{container:{style:t},data:{rect:s,rotation:i},parent:{viewport:{rawDims:{pageWidth:r,pageHeight:o,pageX:a,pageY:c}}}}=this;s==null||s.splice(0,4,...e),t.left=`${100*(e[0]-a)/r}%`,t.top=`${100*(o-e[3]+c)/o}%`,i===0?(t.width=`${100*(e[2]-e[0])/r}%`,t.height=`${100*(e[3]-e[1])/o}%`):this.setRotation(i)};let nt=rb;var Yn,Xo,g_,m_;class p_ extends nt{constructor(t,s=null){super(t,{isRenderable:!0,ignoreBorder:!!(s!=null&&s.ignoreBorder),createQuadrilaterals:!0});A(this,Yn);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:s}=this,i=document.createElement("a");i.setAttribute("data-element-id",t.id);let r=!1;return t.url?(s.addLinkAttributes(i,t.url,t.newWindow),r=!0):t.action?(this._bindNamedAction(i,t.action),r=!0):t.attachment?(S(this,Yn,g_).call(this,i,t.attachment,t.attachmentDest),r=!0):t.setOCGState?(S(this,Yn,m_).call(this,i,t.setOCGState),r=!0):t.dest?(this._bindLink(i,t.dest),r=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,t),r=!0),t.resetForm?(this._bindResetFormAction(i,t.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(i,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&this.container.append(i),this.container}_bindLink(t,s){t.href=this.linkService.getDestinationHash(s),t.onclick=()=>(s&&this.linkService.goToDestination(s),!1),(s||s==="")&&S(this,Yn,Xo).call(this)}_bindNamedAction(t,s){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(s),!1),S(this,Yn,Xo).call(this)}_bindJSAction(t,s){t.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(s.actions)){const o=i.get(r);o&&(t[o]=()=>{var a;return(a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s.id,name:r}}),!1})}t.onclick||(t.onclick=()=>!1),S(this,Yn,Xo).call(this)}_bindResetFormAction(t,s){const i=t.onclick;if(i||(t.href=this.linkService.getAnchorUrl("")),S(this,Yn,Xo).call(this),!this._fieldObjects){ne('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(t.onclick=()=>!1);return}t.onclick=()=>{var h;i==null||i();const{fields:r,refs:o,include:a}=s,c=[];if(r.length!==0||o.length!==0){const f=new Set(o);for(const p of r){const v=this._fieldObjects[p]||[];for(const{id:g}of v)f.add(g)}for(const p of Object.values(this._fieldObjects))for(const v of p)f.has(v.id)===a&&c.push(v)}else for(const f of Object.values(this._fieldObjects))c.push(...f);const u=this.annotationStorage,d=[];for(const f of c){const{id:p}=f;switch(d.push(p),f.type){case"text":{const g=f.defaultValue||"";u.setValue(p,{value:g});break}case"checkbox":case"radiobutton":{const g=f.defaultValue===f.exportValues;u.setValue(p,{value:g});break}case"combobox":case"listbox":{const g=f.defaultValue||"";u.setValue(p,{value:g});break}default:continue}const v=document.querySelector(`[data-element-id="${p}"]`);if(v){if(!pl.has(v)){ne(`_bindResetFormAction - element not allowed: ${p}`);continue}}else continue;v.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((h=this.linkService.eventBus)==null||h.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:d,name:"ResetForm"}})),!1}}}Yn=new WeakSet,Xo=function(){this.container.setAttribute("data-internal-link","")},g_=function(t,s,i=null){t.href=this.linkService.getAnchorUrl(""),s.description&&(t.title=s.description),t.onclick=()=>{var r;return(r=this.downloadManager)==null||r.openOrDownloadData(s.content,s.filename,i),!1},S(this,Yn,Xo).call(this)},m_=function(t,s){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(s),!1),S(this,Yn,Xo).call(this)};class W2 extends nt{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class wl extends nt{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Et.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,s,i,r){s.includes("mouse")?e.addEventListener(s,o=>{var a;(a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:r(o),shift:o.shiftKey,modifier:this._getKeyModifier(o)}})}):e.addEventListener(s,o=>{var a;if(s==="blur"){if(!t.focused||!o.relatedTarget)return;t.focused=!1}else if(s==="focus"){if(t.focused)return;t.focused=!0}r&&((a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:r(o)}}))})}_setEventListeners(e,t,s,i){var r,o,a;for(const[c,u]of s)(u==="Action"||(r=this.data.actions)!=null&&r[u])&&((u==="Focus"||u==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,c,u,i),u==="Focus"&&!((o=this.data.actions)!=null&&o.Blur)?this._setEventListener(e,t,"blur","Blur",null):u==="Blur"&&!((a=this.data.actions)!=null&&a.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":Y.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||G2,r=e.style;let o;const a=2,c=u=>Math.round(10*u)/10;if(this.data.multiLine){const u=Math.abs(this.data.rect[3]-this.data.rect[1]-a),d=Math.round(u/(vy*i))||1,h=u/d;o=Math.min(i,c(h/vy))}else{const u=Math.abs(this.data.rect[3]-this.data.rect[1]-a);o=Math.min(i,c(u/vy))}r.fontSize=`calc(${o}px * var(--total-scale-factor))`,r.color=Y.makeHexColor(s[0],s[1],s[2]),this.data.textAlignment!==null&&(r.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class X2 extends wl{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,s,i){const r=this.annotationStorage;for(const o of this._getElementsByName(e.name,e.id))o.domElement&&(o.domElement[t]=s),r.setValue(o.id,{[i]:s})}render(){var i,r;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const o=e.getValue(t,{value:this.data.fieldValue});let a=o.value||"";const c=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;c&&a.length>c&&(a=a.slice(0,c));let u=o.formattedValue||((i=this.data.textContent)==null?void 0:i.join(`
`))||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const d={userValue:a,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=u??a,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type=this.data.password?"password":"text",s.setAttribute("value",u??a),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),pl.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=zf,this._setRequired(s,this.data.required),c&&(s.maxLength=c),s.addEventListener("input",f=>{e.setValue(t,{value:f.target.value}),this.setPropertyOnSiblings(s,"value",f.target.value,"value"),d.formattedValue=null}),s.addEventListener("resetform",f=>{const p=this.data.defaultFieldValue??"";s.value=d.userValue=p,d.formattedValue=null});let h=f=>{const{formattedValue:p}=d;p!=null&&(f.target.value=p),f.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",p=>{var g;if(d.focused)return;const{target:v}=p;d.userValue&&(v.value=d.userValue),d.lastCommittedValue=v.value,d.commitKey=1,(g=this.data.actions)!=null&&g.Focus||(d.focused=!0)}),s.addEventListener("updatefromsandbox",p=>{this.showElementAndHideCanvas(p.target);const v={value(g){d.userValue=g.detail.value??"",e.setValue(t,{value:d.userValue.toString()}),g.target.value=d.userValue},formattedValue(g){const{formattedValue:x}=g.detail;d.formattedValue=x,x!=null&&g.target!==document.activeElement&&(g.target.value=x),e.setValue(t,{formattedValue:x})},selRange(g){g.target.setSelectionRange(...g.detail.selRange)},charLimit:g=>{var b;const{charLimit:x}=g.detail,{target:y}=g;if(x===0){y.removeAttribute("maxLength");return}y.setAttribute("maxLength",x);let w=d.userValue;!w||w.length<=x||(w=w.slice(0,x),y.value=d.userValue=w,e.setValue(t,{value:w}),(b=this.linkService.eventBus)==null||b.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:w,willCommit:!0,commitKey:1,selStart:y.selectionStart,selEnd:y.selectionEnd}}))}};this._dispatchEventFromSandbox(v,p)}),s.addEventListener("keydown",p=>{var x;d.commitKey=1;let v=-1;if(p.key==="Escape"?v=0:p.key==="Enter"&&!this.data.multiLine?v=2:p.key==="Tab"&&(d.commitKey=3),v===-1)return;const{value:g}=p.target;d.lastCommittedValue!==g&&(d.lastCommittedValue=g,d.userValue=g,(x=this.linkService.eventBus)==null||x.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:g,willCommit:!0,commitKey:v,selStart:p.target.selectionStart,selEnd:p.target.selectionEnd}}))});const f=h;h=null,s.addEventListener("blur",p=>{var g,x;if(!d.focused||!p.relatedTarget)return;(g=this.data.actions)!=null&&g.Blur||(d.focused=!1);const{value:v}=p.target;d.userValue=v,d.lastCommittedValue!==v&&((x=this.linkService.eventBus)==null||x.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:v,willCommit:!0,commitKey:d.commitKey,selStart:p.target.selectionStart,selEnd:p.target.selectionEnd}})),f(p)}),(r=this.data.actions)!=null&&r.Keystroke&&s.addEventListener("beforeinput",p=>{var _;d.lastCommittedValue=null;const{data:v,target:g}=p,{value:x,selectionStart:y,selectionEnd:w}=g;let b=y,E=w;switch(p.inputType){case"deleteWordBackward":{const k=x.substring(0,y).match(/\w*[^\w]*$/);k&&(b-=k[0].length);break}case"deleteWordForward":{const k=x.substring(y).match(/^[^\w]*\w*/);k&&(E+=k[0].length);break}case"deleteContentBackward":y===w&&(b-=1);break;case"deleteContentForward":y===w&&(E+=1);break}p.preventDefault(),(_=this.linkService.eventBus)==null||_.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:x,change:v||"",willCommit:!1,selStart:b,selEnd:E}})}),this._setEventListeners(s,d,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],p=>p.target.value)}if(h&&s.addEventListener("blur",h),this.data.comb){const p=(this.data.rect[2]-this.data.rect[0])/c;s.classList.add("comb"),s.style.letterSpacing=`calc(${p}px * var(--total-scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class Y2 extends wl{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class q2 extends wl{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,s=t.id;let i=e.getValue(s,{value:t.exportValue===t.fieldValue}).value;typeof i=="string"&&(i=i!=="Off",e.setValue(s,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const r=document.createElement("input");return pl.add(r),r.setAttribute("data-element-id",s),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="checkbox",r.name=t.fieldName,i&&r.setAttribute("checked",!0),r.setAttribute("exportValue",t.exportValue),r.tabIndex=zf,r.addEventListener("change",o=>{const{name:a,checked:c}=o.target;for(const u of this._getElementsByName(a,s)){const d=c&&u.exportValue===t.exportValue;u.domElement&&(u.domElement.checked=d),e.setValue(u.id,{value:d})}e.setValue(s,{value:c})}),r.addEventListener("resetform",o=>{const a=t.defaultFieldValue||"Off";o.target.checked=a===t.exportValue}),this.enableScripting&&this.hasJSActions&&(r.addEventListener("updatefromsandbox",o=>{const a={value(c){c.target.checked=c.detail.value!=="Off",e.setValue(s,{value:c.target.checked})}};this._dispatchEventFromSandbox(a,o)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class y_ extends wl{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,s=t.id;let i=e.getValue(s,{value:t.fieldValue===t.buttonValue}).value;if(typeof i=="string"&&(i=i!==t.buttonValue,e.setValue(s,{value:i})),i)for(const o of this._getElementsByName(t.fieldName,s))e.setValue(o.id,{value:!1});const r=document.createElement("input");if(pl.add(r),r.setAttribute("data-element-id",s),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="radio",r.name=t.fieldName,i&&r.setAttribute("checked",!0),r.tabIndex=zf,r.addEventListener("change",o=>{const{name:a,checked:c}=o.target;for(const u of this._getElementsByName(a,s))e.setValue(u.id,{value:!1});e.setValue(s,{value:c})}),r.addEventListener("resetform",o=>{const a=t.defaultFieldValue;o.target.checked=a!=null&&a===t.buttonValue}),this.enableScripting&&this.hasJSActions){const o=t.buttonValue;r.addEventListener("updatefromsandbox",a=>{const c={value:u=>{const d=o===u.detail.value;for(const h of this._getElementsByName(u.target.name)){const f=d&&h.id===s;h.domElement&&(h.domElement.checked=f),e.setValue(h.id,{value:f})}}};this._dispatchEventFromSandbox(c,a)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)}return this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class K2 extends p_{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",s=>{this._dispatchEventFromSandbox({},s)})),e}}class Q2 extends wl{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,s=e.getValue(t,{value:this.data.fieldValue}),i=document.createElement("select");pl.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=zf;let r=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",d=>{const h=this.data.defaultFieldValue;for(const f of i.options)f.selected=f.value===h});for(const d of this.data.options){const h=document.createElement("option");h.textContent=d.displayValue,h.value=d.exportValue,s.value.includes(d.exportValue)&&(h.setAttribute("selected",!0),r=!1),i.append(h)}let o=null;if(r){const d=document.createElement("option");d.value=" ",d.setAttribute("hidden",!0),d.setAttribute("selected",!0),i.prepend(d),o=()=>{d.remove(),i.removeEventListener("input",o),o=null},i.addEventListener("input",o)}const a=d=>{const h=d?"value":"textContent",{options:f,multiple:p}=i;return p?Array.prototype.filter.call(f,v=>v.selected).map(v=>v[h]):f.selectedIndex===-1?null:f[f.selectedIndex][h]};let c=a(!1);const u=d=>{const h=d.target.options;return Array.prototype.map.call(h,f=>({displayValue:f.textContent,exportValue:f.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",d=>{const h={value(f){o==null||o();const p=f.detail.value,v=new Set(Array.isArray(p)?p:[p]);for(const g of i.options)g.selected=v.has(g.value);e.setValue(t,{value:a(!0)}),c=a(!1)},multipleSelection(f){i.multiple=!0},remove(f){const p=i.options,v=f.detail.remove;p[v].selected=!1,i.remove(v),p.length>0&&Array.prototype.findIndex.call(p,x=>x.selected)===-1&&(p[0].selected=!0),e.setValue(t,{value:a(!0),items:u(f)}),c=a(!1)},clear(f){for(;i.length!==0;)i.remove(0);e.setValue(t,{value:null,items:[]}),c=a(!1)},insert(f){const{index:p,displayValue:v,exportValue:g}=f.detail.insert,x=i.children[p],y=document.createElement("option");y.textContent=v,y.value=g,x?x.before(y):i.append(y),e.setValue(t,{value:a(!0),items:u(f)}),c=a(!1)},items(f){const{items:p}=f.detail;for(;i.length!==0;)i.remove(0);for(const v of p){const{displayValue:g,exportValue:x}=v,y=document.createElement("option");y.textContent=g,y.value=x,i.append(y)}i.options.length>0&&(i.options[0].selected=!0),e.setValue(t,{value:a(!0),items:u(f)}),c=a(!1)},indices(f){const p=new Set(f.detail.indices);for(const v of f.target.options)v.selected=p.has(v.index);e.setValue(t,{value:a(!0)}),c=a(!1)},editable(f){f.target.disabled=!f.detail.editable}};this._dispatchEventFromSandbox(h,d)}),i.addEventListener("input",d=>{var p;const h=a(!0),f=a(!1);e.setValue(t,{value:h}),d.preventDefault(),(p=this.linkService.eventBus)==null||p.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:c,change:f,changeEx:h,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],d=>d.target.value)):i.addEventListener("input",function(d){e.setValue(t,{value:a(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class i0 extends nt{constructor(e){const{data:t,elements:s}=e;super(e,{isRenderable:nt._hasPopupData(t)}),this.elements=s,this.popup=null}render(){this.container.classList.add("popupAnnotation");const e=this.popup=new J2({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),t=[];for(const s of this.elements)s.popup=e,s.container.ariaHasPopup="dialog",t.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",t.map(s=>`${Vw}${s}`).join(",")),this.container}}var Oc,Jg,Zg,Fc,jc,Xe,sr,zc,Vh,Gh,Bc,ir,Ls,rr,Wh,or,Xh,Oa,Fa,Ce,Bp,r0,v_,w_,b_,A_,$p,Hp,o0;class J2{constructor({container:e,color:t,elements:s,titleObj:i,modificationDate:r,contentsObj:o,richText:a,parent:c,rect:u,parentRect:d,open:h}){A(this,Ce);A(this,Oc,S(this,Ce,b_).bind(this));A(this,Jg,S(this,Ce,o0).bind(this));A(this,Zg,S(this,Ce,Hp).bind(this));A(this,Fc,S(this,Ce,$p).bind(this));A(this,jc,null);A(this,Xe,null);A(this,sr,null);A(this,zc,null);A(this,Vh,null);A(this,Gh,null);A(this,Bc,null);A(this,ir,!1);A(this,Ls,null);A(this,rr,null);A(this,Wh,null);A(this,or,null);A(this,Xh,null);A(this,Oa,null);A(this,Fa,!1);var f;m(this,Xe,e),m(this,Xh,i),m(this,sr,o),m(this,or,a),m(this,Gh,c),m(this,jc,t),m(this,Wh,u),m(this,Bc,d),m(this,Vh,s),m(this,zc,Rm.toDateObject(r)),this.trigger=s.flatMap(p=>p.getElementsToTriggerPopup());for(const p of this.trigger)p.addEventListener("click",l(this,Fc)),p.addEventListener("mouseenter",l(this,Zg)),p.addEventListener("mouseleave",l(this,Jg)),p.classList.add("popupTriggerArea");for(const p of s)(f=p.container)==null||f.addEventListener("keydown",l(this,Oc));l(this,Xe).hidden=!0,h&&S(this,Ce,$p).call(this)}render(){if(l(this,Ls))return;const e=m(this,Ls,document.createElement("div"));if(e.className="popup",l(this,jc)){const r=e.style.outlineColor=Y.makeHexColor(...l(this,jc));e.style.backgroundColor=`color-mix(in srgb, ${r} 30%, white)`}const t=document.createElement("span");t.className="header";const s=document.createElement("h1");if(t.append(s),{dir:s.dir,str:s.textContent}=l(this,Xh),e.append(t),l(this,zc)){const r=document.createElement("span");r.classList.add("popupDate"),r.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),r.setAttribute("data-l10n-args",JSON.stringify({dateObj:l(this,zc).valueOf()})),t.append(r)}const i=l(this,Ce,Bp);if(i)Qw.render({xfaHtml:i,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const r=this._formatContents(l(this,sr));e.append(r)}l(this,Xe).append(e)}_formatContents({str:e,dir:t}){const s=document.createElement("p");s.classList.add("popupContent"),s.dir=t;const i=e.split(/(?:\r\n?|\n)/);for(let r=0,o=i.length;r<o;++r){const a=i[r];s.append(document.createTextNode(a)),r<o-1&&s.append(document.createElement("br"))}return s}updateEdited({rect:e,popupContent:t}){var s;l(this,Oa)||m(this,Oa,{contentsObj:l(this,sr),richText:l(this,or)}),e&&m(this,rr,null),t&&(m(this,or,S(this,Ce,w_).call(this,t)),m(this,sr,null)),(s=l(this,Ls))==null||s.remove(),m(this,Ls,null)}resetEdited(){var e;l(this,Oa)&&({contentsObj:Qt(this,sr)._,richText:Qt(this,or)._}=l(this,Oa),m(this,Oa,null),(e=l(this,Ls))==null||e.remove(),m(this,Ls,null),m(this,rr,null))}forceHide(){m(this,Fa,this.isVisible),l(this,Fa)&&(l(this,Xe).hidden=!0)}maybeShow(){l(this,Fa)&&(l(this,Ls)||S(this,Ce,Hp).call(this),m(this,Fa,!1),l(this,Xe).hidden=!1)}get isVisible(){return l(this,Xe).hidden===!1}}Oc=new WeakMap,Jg=new WeakMap,Zg=new WeakMap,Fc=new WeakMap,jc=new WeakMap,Xe=new WeakMap,sr=new WeakMap,zc=new WeakMap,Vh=new WeakMap,Gh=new WeakMap,Bc=new WeakMap,ir=new WeakMap,Ls=new WeakMap,rr=new WeakMap,Wh=new WeakMap,or=new WeakMap,Xh=new WeakMap,Oa=new WeakMap,Fa=new WeakMap,Ce=new WeakSet,Bp=function(){const e=l(this,or),t=l(this,sr);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&l(this,or).html||null},r0=function(){var e,t,s;return((s=(t=(e=l(this,Ce,Bp))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:s.fontSize)||0},v_=function(){var e,t,s;return((s=(t=(e=l(this,Ce,Bp))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:s.color)||null},w_=function(e){const t=[],s={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},i={style:{color:l(this,Ce,v_),fontSize:l(this,Ce,r0)?`calc(${l(this,Ce,r0)}px * var(--total-scale-factor))`:""}};for(const r of e.split(`
`))t.push({name:"span",value:r,attributes:i});return s},b_=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&l(this,ir))&&S(this,Ce,$p).call(this)},A_=function(){if(l(this,rr)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:s,pageX:i,pageY:r}}}=l(this,Gh);let o=!!l(this,Bc),a=o?l(this,Bc):l(this,Wh);for(const v of l(this,Vh))if(!a||Y.intersect(v.data.rect,a)!==null){a=v.data.rect,o=!0;break}const c=Y.normalizeRect([a[0],e[3]-a[1]+e[1],a[2],e[3]-a[3]+e[1]]),d=o?a[2]-a[0]+5:0,h=c[0]+d,f=c[1];m(this,rr,[100*(h-i)/t,100*(f-r)/s]);const{style:p}=l(this,Xe);p.left=`${l(this,rr)[0]}%`,p.top=`${l(this,rr)[1]}%`},$p=function(){m(this,ir,!l(this,ir)),l(this,ir)?(S(this,Ce,Hp).call(this),l(this,Xe).addEventListener("click",l(this,Fc)),l(this,Xe).addEventListener("keydown",l(this,Oc))):(S(this,Ce,o0).call(this),l(this,Xe).removeEventListener("click",l(this,Fc)),l(this,Xe).removeEventListener("keydown",l(this,Oc)))},Hp=function(){l(this,Ls)||this.render(),this.isVisible?l(this,ir)&&l(this,Xe).classList.add("focused"):(S(this,Ce,A_).call(this),l(this,Xe).hidden=!1,l(this,Xe).style.zIndex=parseInt(l(this,Xe).style.zIndex)+1e3)},o0=function(){l(this,Xe).classList.remove("focused"),!(l(this,ir)||!this.isVisible)&&(l(this,Xe).hidden=!0,l(this,Xe).style.zIndex=parseInt(l(this,Xe).style.zIndex)-1e3)};class S_ extends nt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=ee.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const s=document.createElement("span");s.textContent=t,e.append(s)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Yh;class Z2 extends nt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});A(this,Yh,null)}render(){this.container.classList.add("lineAnnotation");const{data:t,width:s,height:i}=this,r=this.svgFactory.create(s,i,!0),o=m(this,Yh,this.svgFactory.createElement("svg:line"));return o.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),o.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),o.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),o.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),o.setAttribute("stroke-width",t.borderStyle.width||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,Yh)}addHighlightArea(){this.container.classList.add("highlightArea")}}Yh=new WeakMap;var qh;class eM extends nt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});A(this,qh,null)}render(){this.container.classList.add("squareAnnotation");const{data:t,width:s,height:i}=this,r=this.svgFactory.create(s,i,!0),o=t.borderStyle.width,a=m(this,qh,this.svgFactory.createElement("svg:rect"));return a.setAttribute("x",o/2),a.setAttribute("y",o/2),a.setAttribute("width",s-o),a.setAttribute("height",i-o),a.setAttribute("stroke-width",o||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),r.append(a),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,qh)}addHighlightArea(){this.container.classList.add("highlightArea")}}qh=new WeakMap;var Kh;class tM extends nt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});A(this,Kh,null)}render(){this.container.classList.add("circleAnnotation");const{data:t,width:s,height:i}=this,r=this.svgFactory.create(s,i,!0),o=t.borderStyle.width,a=m(this,Kh,this.svgFactory.createElement("svg:ellipse"));return a.setAttribute("cx",s/2),a.setAttribute("cy",i/2),a.setAttribute("rx",s/2-o/2),a.setAttribute("ry",i/2-o/2),a.setAttribute("stroke-width",o||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),r.append(a),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,Kh)}addHighlightArea(){this.container.classList.add("highlightArea")}}Kh=new WeakMap;var Qh;class x_ extends nt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});A(this,Qh,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:s,borderStyle:i,popupRef:r},width:o,height:a}=this;if(!s)return this.container;const c=this.svgFactory.create(o,a,!0);let u=[];for(let h=0,f=s.length;h<f;h+=2){const p=s[h]-t[0],v=t[3]-s[h+1];u.push(`${p},${v}`)}u=u.join(" ");const d=m(this,Qh,this.svgFactory.createElement(this.svgElementName));return d.setAttribute("points",u),d.setAttribute("stroke-width",i.width||1),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),c.append(d),this.container.append(c),!r&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,Qh)}addHighlightArea(){this.container.classList.add("highlightArea")}}Qh=new WeakMap;class nM extends x_{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class sM extends nt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var Jh,ja,Zh,a0;class Jw extends nt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});A(this,Zh);A(this,Jh,null);A(this,ja,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?ee.HIGHLIGHT:ee.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:s,inkLists:i,borderStyle:r,popupRef:o}}=this,{transform:a,width:c,height:u}=S(this,Zh,a0).call(this,s,t),d=this.svgFactory.create(c,u,!0),h=m(this,Jh,this.svgFactory.createElement("svg:g"));d.append(h),h.setAttribute("stroke-width",r.width||1),h.setAttribute("stroke-linecap","round"),h.setAttribute("stroke-linejoin","round"),h.setAttribute("stroke-miterlimit",10),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),h.setAttribute("transform",a);for(let f=0,p=i.length;f<p;f++){const v=this.svgFactory.createElement(this.svgElementName);l(this,ja).push(v),v.setAttribute("points",i[f].join(",")),h.append(v)}return!o&&this.hasPopupData&&this._createPopup(),this.container.append(d),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:s,points:i,rect:r}=t,o=l(this,Jh);if(s>=0&&o.setAttribute("stroke-width",s||1),i)for(let a=0,c=l(this,ja).length;a<c;a++)l(this,ja)[a].setAttribute("points",i[a].join(","));if(r){const{transform:a,width:c,height:u}=S(this,Zh,a0).call(this,this.data.rotation,r);o.parentElement.setAttribute("viewBox",`0 0 ${c} ${u}`),o.setAttribute("transform",a)}}getElementsToTriggerPopup(){return l(this,ja)}addHighlightArea(){this.container.classList.add("highlightArea")}}Jh=new WeakMap,ja=new WeakMap,Zh=new WeakSet,a0=function(t,s){switch(t){case 90:return{transform:`rotate(90) translate(${-s[0]},${s[1]}) scale(1,-1)`,width:s[3]-s[1],height:s[2]-s[0]};case 180:return{transform:`rotate(180) translate(${-s[2]},${s[1]}) scale(1,-1)`,width:s[2]-s[0],height:s[3]-s[1]};case 270:return{transform:`rotate(270) translate(${-s[2]},${s[3]}) scale(1,-1)`,width:s[3]-s[1],height:s[2]-s[0]};default:return{transform:`translate(${-s[0]},${s[3]}) scale(1,-1)`,width:s[2]-s[0],height:s[3]-s[1]}}};class E_ extends nt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=ee.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class iM extends nt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class rM extends nt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class oM extends nt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class __ extends nt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=ee.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var ef,tf,l0;class aM extends nt{constructor(t){var i;super(t,{isRenderable:!0});A(this,tf);A(this,ef,null);const{file:s}=this.data;this.filename=s.filename,this.content=s.content,(i=this.linkService.eventBus)==null||i.dispatch("fileattachmentannotation",{source:this,...s})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:s}=this;let i;s.hasAppearance||s.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(s.name)?"paperclip":"pushpin"}.svg`,s.fillAlpha&&s.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(s.fillAlpha*100)}%);`)),i.addEventListener("dblclick",S(this,tf,l0).bind(this)),m(this,ef,i);const{isMac:r}=Et.platform;return t.addEventListener("keydown",o=>{o.key==="Enter"&&(r?o.metaKey:o.ctrlKey)&&S(this,tf,l0).call(this)}),!s.popupRef&&this.hasPopupData?this._createPopup():i.classList.add("popupTriggerArea"),t.append(i),t}getElementsToTriggerPopup(){return l(this,ef)}addHighlightArea(){this.container.classList.add("highlightArea")}}ef=new WeakMap,tf=new WeakSet,l0=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var nf,za,ao,sf,Bo,c0,u0,$c;let Zw=($c=class{constructor({div:e,accessibilityManager:t,annotationCanvasMap:s,annotationEditorUIManager:i,page:r,viewport:o,structTreeLayer:a}){A(this,Bo);A(this,nf,null);A(this,za,null);A(this,ao,new Map);A(this,sf,null);this.div=e,m(this,nf,t),m(this,za,s),m(this,sf,a||null),this.page=r,this.viewport=o,this.zIndex=0,this._annotationEditorUIManager=i}hasEditableAnnotations(){return l(this,ao).size>0}async render(e){var o;const{annotations:t}=e,s=this.div;Oo(s,this.viewport);const i=new Map,r={data:null,layer:s,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new qd,annotationStorage:e.annotationStorage||new Ww,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const a of t){if(a.noHTML)continue;const c=a.annotationType===Ke.POPUP;if(c){const h=i.get(a.id);if(!h)continue;r.elements=h}else if(a.rect[2]===a.rect[0]||a.rect[3]===a.rect[1])continue;r.data=a;const u=tS.create(r);if(!u.isRenderable)continue;if(!c&&a.popupRef){const h=i.get(a.popupRef);h?h.push(u):i.set(a.popupRef,[u])}const d=u.render();a.hidden&&(d.style.visibility="hidden"),await S(this,Bo,c0).call(this,d,a.id),u._isEditable&&(l(this,ao).set(u.data.id,u),(o=this._annotationEditorUIManager)==null||o.renderAnnotationElement(u))}S(this,Bo,u0).call(this)}async addLinkAnnotations(e,t){const s={data:null,layer:this.div,linkService:t,svgFactory:new qd,parent:this};for(const i of e){i.borderStyle||(i.borderStyle=$c._defaultBorderStyle),s.data=i;const r=tS.create(s);if(!r.isRenderable)continue;const o=r.render();await S(this,Bo,c0).call(this,o,i.id)}}update({viewport:e}){const t=this.div;this.viewport=e,Oo(t,{rotation:e.rotation}),S(this,Bo,u0).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(l(this,ao).values())}getEditableAnnotation(e){return l(this,ao).get(e)}static get _defaultBorderStyle(){return le(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:El.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}},nf=new WeakMap,za=new WeakMap,ao=new WeakMap,sf=new WeakMap,Bo=new WeakSet,c0=async function(e,t){var o,a;const s=e.firstChild||e,i=s.id=`${Vw}${t}`,r=await((o=l(this,sf))==null?void 0:o.getAriaAttributes(i));if(r)for(const[c,u]of r)s.setAttribute(c,u);this.div.append(e),(a=l(this,nf))==null||a.moveElementInDOM(this.div,e,s,!1)},u0=function(){var t;if(!l(this,za))return;const e=this.div;for(const[s,i]of l(this,za)){const r=e.querySelector(`[data-annotation-id="${s}"]`);if(!r)continue;i.className="annotationContent";const{firstChild:o}=r;o?o.nodeName==="CANVAS"?o.replaceWith(i):o.classList.contains("annotationContent")?o.after(i):o.before(i):r.append(i);const a=l(this,ao).get(s);a&&(a._hasNoCanvas?((t=this._annotationEditorUIManager)==null||t.setMissingCanvas(s,r.id,i),a._hasNoCanvas=!1):a.canvas=i)}l(this,za).clear()},$c);const hp=/\r\n?|\n/g;var Ms,On,rf,Ba,Fn,ot,C_,k_,T_,Up,wr,Vp,Gp,P_,h0,R_;const Re=class Re extends Me{constructor(t){super({...t,name:"freeTextEditor"});A(this,ot);A(this,Ms);A(this,On,"");A(this,rf,`${this.id}-editor`);A(this,Ba,null);A(this,Fn);m(this,Ms,t.color||Re._defaultColor||Me._defaultLineColor),m(this,Fn,t.fontSize||Re._defaultFontSize)}static get _keyboardManager(){const t=Re.prototype,s=o=>o.isEmpty(),i=Fo.TRANSLATE_SMALL,r=Fo.TRANSLATE_BIG;return le(this,"_keyboardManager",new Ff([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:s}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:s}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[i,0],checker:s}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[r,0],checker:s}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:s}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:s}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,i],checker:s}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,r],checker:s}]]))}static initialize(t,s){Me.initialize(t,s);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,s){switch(t){case de.FREETEXT_SIZE:Re._defaultFontSize=s;break;case de.FREETEXT_COLOR:Re._defaultColor=s;break}}updateParams(t,s){switch(t){case de.FREETEXT_SIZE:S(this,ot,C_).call(this,s);break;case de.FREETEXT_COLOR:S(this,ot,k_).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[de.FREETEXT_SIZE,Re._defaultFontSize],[de.FREETEXT_COLOR,Re._defaultColor||Me._defaultLineColor]]}get propertiesToUpdate(){return[[de.FREETEXT_SIZE,l(this,Fn)],[de.FREETEXT_COLOR,l(this,Ms)]]}_translateEmpty(t,s){this._uiManager.translateSelectedEditors(t,s,!0)}getInitialTranslation(){const t=this.parentScale;return[-Re._internalPadding*t,-(Re._internalPadding+l(this,Fn))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),m(this,Ba,new AbortController);const t=this._uiManager.combinedSignal(l(this,Ba));return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){var t;return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",l(this,rf)),this._isDraggable=!0,(t=l(this,Ba))==null||t.abort(),m(this,Ba,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var s;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(s=this._initialOptions)!=null&&s.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=l(this,On),s=m(this,On,S(this,ot,T_).call(this).trimEnd());if(t===s)return;const i=r=>{if(m(this,On,r),!r){this.remove();return}S(this,ot,Gp).call(this),this._uiManager.rebuild(this),S(this,ot,Up).call(this)};this.addCommands({cmd:()=>{i(s)},undo:()=>{i(t)},mustExec:!1}),S(this,ot,Up).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Re._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,s;(this._isCopy||this.annotationElementId)&&(t=this.x,s=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",l(this,rf)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${l(this,Fn)}px * var(--total-scale-factor))`,i.color=l(this,Ms),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[r,o]=this.parentDimensions;if(this.annotationElementId){const{position:a}=this._initialData;let[c,u]=this.getInitialTranslation();[c,u]=this.pageTranslationToScreen(c,u);const[d,h]=this.pageDimensions,[f,p]=this.pageTranslation;let v,g;switch(this.rotation){case 0:v=t+(a[0]-f)/d,g=s+this.height-(a[1]-p)/h;break;case 90:v=t+(a[0]-f)/d,g=s-(a[1]-p)/h,[c,u]=[u,-c];break;case 180:v=t-this.width+(a[0]-f)/d,g=s-(a[1]-p)/h,[c,u]=[-c,-u];break;case 270:v=t+(a[0]-f-this.height*h)/d,g=s+(a[1]-p-this.width*d)/h,[c,u]=[-u,c];break}this.setAt(v*r,g*o,c,u)}else this._moveAfterPaste(t,s);S(this,ot,Gp).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var v,g,x;const s=t.clipboardData||window.clipboardData,{types:i}=s;if(i.length===1&&i[0]==="text/plain")return;t.preventDefault();const r=S(v=Re,wr,h0).call(v,s.getData("text")||"").replaceAll(hp,`
`);if(!r)return;const o=window.getSelection();if(!o.rangeCount)return;this.editorDiv.normalize(),o.deleteFromDocument();const a=o.getRangeAt(0);if(!r.includes(`
`)){a.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),o.collapseToStart();return}const{startContainer:c,startOffset:u}=a,d=[],h=[];if(c.nodeType===Node.TEXT_NODE){const y=c.parentElement;if(h.push(c.nodeValue.slice(u).replaceAll(hp,"")),y!==this.editorDiv){let w=d;for(const b of this.editorDiv.childNodes){if(b===y){w=h;continue}w.push(S(g=Re,wr,Vp).call(g,b))}}d.push(c.nodeValue.slice(0,u).replaceAll(hp,""))}else if(c===this.editorDiv){let y=d,w=0;for(const b of this.editorDiv.childNodes)w++===u&&(y=h),y.push(S(x=Re,wr,Vp).call(x,b))}m(this,On,`${d.join(`
`)}${r}${h.join(`
`)}`),S(this,ot,Gp).call(this);const f=new Range;let p=Math.sumPrecise(d.map(y=>y.length));for(const{firstChild:y}of this.editorDiv.childNodes)if(y.nodeType===Node.TEXT_NODE){const w=y.nodeValue.length;if(p<=w){f.setStart(y,p),f.setEnd(y,p);break}p-=w}o.removeAllRanges(),o.addRange(f)}get contentDiv(){return this.editorDiv}static async deserialize(t,s,i){var a;let r=null;if(t instanceof S_){const{data:{defaultAppearanceData:{fontSize:c,fontColor:u},rect:d,rotation:h,id:f,popupRef:p},textContent:v,textPosition:g,parent:{page:{pageNumber:x}}}=t;if(!v||v.length===0)return null;r=t={annotationType:ee.FREETEXT,color:Array.from(u),fontSize:c,value:v.join(`
`),position:g,pageIndex:x-1,rect:d.slice(0),rotation:h,id:f,deleted:!1,popupRef:p}}const o=await super.deserialize(t,s,i);return m(o,Fn,t.fontSize),m(o,Ms,Y.makeHexColor(...t.color)),m(o,On,S(a=Re,wr,h0).call(a,t.value)),o.annotationElementId=t.id||null,o._initialData=r,o}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s=Re._internalPadding*this.parentScale,i=this.getRect(s,s),r=Me._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:l(this,Ms)),o={annotationType:ee.FREETEXT,color:r,fontSize:l(this,Fn),value:S(this,ot,P_).call(this),pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?(o.isCopy=!0,o):this.annotationElementId&&!S(this,ot,R_).call(this,o)?null:(o.id=this.annotationElementId,o)}renderAnnotationElement(t){const s=super.renderAnnotationElement(t);if(this.deleted)return s;const{style:i}=s;i.fontSize=`calc(${l(this,Fn)}px * var(--total-scale-factor))`,i.color=l(this,Ms),s.replaceChildren();for(const o of l(this,On).split(`
`)){const a=document.createElement("div");a.append(o?document.createTextNode(o):document.createElement("br")),s.append(a)}const r=Re._internalPadding*this.parentScale;return t.updateEdited({rect:this.getRect(r,r),popupContent:l(this,On)}),s}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};Ms=new WeakMap,On=new WeakMap,rf=new WeakMap,Ba=new WeakMap,Fn=new WeakMap,ot=new WeakSet,C_=function(t){const s=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--total-scale-factor))`,this.translate(0,-(r-l(this,Fn))*this.parentScale),m(this,Fn,r),S(this,ot,Up).call(this)},i=l(this,Fn);this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:de.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},k_=function(t){const s=r=>{m(this,Ms,this.editorDiv.style.color=r)},i=l(this,Ms);this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:de.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},T_=function(){var i;const t=[];this.editorDiv.normalize();let s=null;for(const r of this.editorDiv.childNodes)(s==null?void 0:s.nodeType)===Node.TEXT_NODE&&r.nodeName==="BR"||(t.push(S(i=Re,wr,Vp).call(i,r)),s=r);return t.join(`
`)},Up=function(){const[t,s]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:r,div:o}=this,a=o.style.display,c=o.classList.contains("hidden");o.classList.remove("hidden"),o.style.display="hidden",r.div.append(this.div),i=o.getBoundingClientRect(),o.remove(),o.style.display=a,o.classList.toggle("hidden",c)}this.rotation%180===this.parentRotation%180?(this.width=i.width/t,this.height=i.height/s):(this.width=i.height/t,this.height=i.width/s),this.fixAndSetPosition()},wr=new WeakSet,Vp=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(hp,"")},Gp=function(){if(this.editorDiv.replaceChildren(),!!l(this,On))for(const t of l(this,On).split(`
`)){const s=document.createElement("div");s.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(s)}},P_=function(){return l(this,On).replaceAll(""," ")},h0=function(t){return t.replaceAll(" ","")},R_=function(t){const{value:s,fontSize:i,color:r,pageIndex:o}=this._initialData;return this._hasBeenMoved||t.value!==s||t.fontSize!==i||t.color.some((a,c)=>a!==r[c])||t.pageIndex!==o},A(Re,wr),F(Re,"_freeTextDefaultContent",""),F(Re,"_internalPadding",0),F(Re,"_defaultColor",null),F(Re,"_defaultFontSize",10),F(Re,"_type","freetext"),F(Re,"_editorType",ee.FREETEXT);let d0=Re;class H{toSVGPath(){_e("Abstract method `toSVGPath` must be implemented.")}get box(){_e("Abstract getter `box` must be implemented.")}serialize(e,t){_e("Abstract method `serialize` must be implemented.")}static _rescale(e,t,s,i,r,o){o||(o=new Float32Array(e.length));for(let a=0,c=e.length;a<c;a+=2)o[a]=t+e[a]*i,o[a+1]=s+e[a+1]*r;return o}static _rescaleAndSwap(e,t,s,i,r,o){o||(o=new Float32Array(e.length));for(let a=0,c=e.length;a<c;a+=2)o[a]=t+e[a+1]*i,o[a+1]=s+e[a]*r;return o}static _translate(e,t,s,i){i||(i=new Float32Array(e.length));for(let r=0,o=e.length;r<o;r+=2)i[r]=t+e[r],i[r+1]=s+e[r+1];return i}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,s,i,r){switch(r){case 90:return[1-t/s,e/i];case 180:return[1-e/s,1-t/i];case 270:return[t/s,1-e/i];default:return[e/s,t/i]}}static _normalizePagePoint(e,t,s){switch(s){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,s,i,r,o){return[(e+5*s)/6,(t+5*i)/6,(5*s+r)/6,(5*i+o)/6,(s+r)/2,(i+o)/2]}}F(H,"PRECISION",1e-4);var jn,Ds,Hc,Uc,pi,ae,$a,Ha,of,af,Vc,Gc,lo,lf,em,tm,ft,od,L_,M_,D_,N_,I_,O_;const ji=class ji{constructor({x:e,y:t},s,i,r,o,a=0){A(this,ft);A(this,jn);A(this,Ds,[]);A(this,Hc);A(this,Uc);A(this,pi,[]);A(this,ae,new Float32Array(18));A(this,$a);A(this,Ha);A(this,of);A(this,af);A(this,Vc);A(this,Gc);A(this,lo,[]);m(this,jn,s),m(this,Gc,r*i),m(this,Uc,o),l(this,ae).set([NaN,NaN,NaN,NaN,e,t],6),m(this,Hc,a),m(this,af,l(ji,lf)*i),m(this,of,l(ji,tm)*i),m(this,Vc,i),l(this,lo).push(e,t)}isEmpty(){return isNaN(l(this,ae)[8])}add({x:e,y:t}){var L;m(this,$a,e),m(this,Ha,t);const[s,i,r,o]=l(this,jn);let[a,c,u,d]=l(this,ae).subarray(8,12);const h=e-u,f=t-d,p=Math.hypot(h,f);if(p<l(this,of))return!1;const v=p-l(this,af),g=v/p,x=g*h,y=g*f;let w=a,b=c;a=u,c=d,u+=x,d+=y,(L=l(this,lo))==null||L.push(e,t);const E=-y/v,_=x/v,k=E*l(this,Gc),C=_*l(this,Gc);return l(this,ae).set(l(this,ae).subarray(2,8),0),l(this,ae).set([u+k,d+C],4),l(this,ae).set(l(this,ae).subarray(14,18),12),l(this,ae).set([u-k,d-C],16),isNaN(l(this,ae)[6])?(l(this,pi).length===0&&(l(this,ae).set([a+k,c+C],2),l(this,pi).push(NaN,NaN,NaN,NaN,(a+k-s)/r,(c+C-i)/o),l(this,ae).set([a-k,c-C],14),l(this,Ds).push(NaN,NaN,NaN,NaN,(a-k-s)/r,(c-C-i)/o)),l(this,ae).set([w,b,a,c,u,d],6),!this.isEmpty()):(l(this,ae).set([w,b,a,c,u,d],6),Math.abs(Math.atan2(b-c,w-a)-Math.atan2(y,x))<Math.PI/2?([a,c,u,d]=l(this,ae).subarray(2,6),l(this,pi).push(NaN,NaN,NaN,NaN,((a+u)/2-s)/r,((c+d)/2-i)/o),[a,c,w,b]=l(this,ae).subarray(14,18),l(this,Ds).push(NaN,NaN,NaN,NaN,((w+a)/2-s)/r,((b+c)/2-i)/o),!0):([w,b,a,c,u,d]=l(this,ae).subarray(0,6),l(this,pi).push(((w+5*a)/6-s)/r,((b+5*c)/6-i)/o,((5*a+u)/6-s)/r,((5*c+d)/6-i)/o,((a+u)/2-s)/r,((c+d)/2-i)/o),[u,d,a,c,w,b]=l(this,ae).subarray(12,18),l(this,Ds).push(((w+5*a)/6-s)/r,((b+5*c)/6-i)/o,((5*a+u)/6-s)/r,((5*c+d)/6-i)/o,((a+u)/2-s)/r,((c+d)/2-i)/o),!0))}toSVGPath(){if(this.isEmpty())return"";const e=l(this,pi),t=l(this,Ds);if(isNaN(l(this,ae)[6])&&!this.isEmpty())return S(this,ft,L_).call(this);const s=[];s.push(`M${e[4]} ${e[5]}`);for(let i=6;i<e.length;i+=6)isNaN(e[i])?s.push(`L${e[i+4]} ${e[i+5]}`):s.push(`C${e[i]} ${e[i+1]} ${e[i+2]} ${e[i+3]} ${e[i+4]} ${e[i+5]}`);S(this,ft,D_).call(this,s);for(let i=t.length-6;i>=6;i-=6)isNaN(t[i])?s.push(`L${t[i+4]} ${t[i+5]}`):s.push(`C${t[i]} ${t[i+1]} ${t[i+2]} ${t[i+3]} ${t[i+4]} ${t[i+5]}`);return S(this,ft,M_).call(this,s),s.join(" ")}newFreeDrawOutline(e,t,s,i,r,o){return new F_(e,t,s,i,r,o)}getOutlines(){var h;const e=l(this,pi),t=l(this,Ds),s=l(this,ae),[i,r,o,a]=l(this,jn),c=new Float32Array((((h=l(this,lo))==null?void 0:h.length)??0)+2);for(let f=0,p=c.length-2;f<p;f+=2)c[f]=(l(this,lo)[f]-i)/o,c[f+1]=(l(this,lo)[f+1]-r)/a;if(c[c.length-2]=(l(this,$a)-i)/o,c[c.length-1]=(l(this,Ha)-r)/a,isNaN(s[6])&&!this.isEmpty())return S(this,ft,N_).call(this,c);const u=new Float32Array(l(this,pi).length+24+l(this,Ds).length);let d=e.length;for(let f=0;f<d;f+=2){if(isNaN(e[f])){u[f]=u[f+1]=NaN;continue}u[f]=e[f],u[f+1]=e[f+1]}d=S(this,ft,O_).call(this,u,d);for(let f=t.length-6;f>=6;f-=6)for(let p=0;p<6;p+=2){if(isNaN(t[f+p])){u[d]=u[d+1]=NaN,d+=2;continue}u[d]=t[f+p],u[d+1]=t[f+p+1],d+=2}return S(this,ft,I_).call(this,u,d),this.newFreeDrawOutline(u,c,l(this,jn),l(this,Vc),l(this,Hc),l(this,Uc))}};jn=new WeakMap,Ds=new WeakMap,Hc=new WeakMap,Uc=new WeakMap,pi=new WeakMap,ae=new WeakMap,$a=new WeakMap,Ha=new WeakMap,of=new WeakMap,af=new WeakMap,Vc=new WeakMap,Gc=new WeakMap,lo=new WeakMap,lf=new WeakMap,em=new WeakMap,tm=new WeakMap,ft=new WeakSet,od=function(){const e=l(this,ae).subarray(4,6),t=l(this,ae).subarray(16,18),[s,i,r,o]=l(this,jn);return[(l(this,$a)+(e[0]-t[0])/2-s)/r,(l(this,Ha)+(e[1]-t[1])/2-i)/o,(l(this,$a)+(t[0]-e[0])/2-s)/r,(l(this,Ha)+(t[1]-e[1])/2-i)/o]},L_=function(){const[e,t,s,i]=l(this,jn),[r,o,a,c]=S(this,ft,od).call(this);return`M${(l(this,ae)[2]-e)/s} ${(l(this,ae)[3]-t)/i} L${(l(this,ae)[4]-e)/s} ${(l(this,ae)[5]-t)/i} L${r} ${o} L${a} ${c} L${(l(this,ae)[16]-e)/s} ${(l(this,ae)[17]-t)/i} L${(l(this,ae)[14]-e)/s} ${(l(this,ae)[15]-t)/i} Z`},M_=function(e){const t=l(this,Ds);e.push(`L${t[4]} ${t[5]} Z`)},D_=function(e){const[t,s,i,r]=l(this,jn),o=l(this,ae).subarray(4,6),a=l(this,ae).subarray(16,18),[c,u,d,h]=S(this,ft,od).call(this);e.push(`L${(o[0]-t)/i} ${(o[1]-s)/r} L${c} ${u} L${d} ${h} L${(a[0]-t)/i} ${(a[1]-s)/r}`)},N_=function(e){const t=l(this,ae),[s,i,r,o]=l(this,jn),[a,c,u,d]=S(this,ft,od).call(this),h=new Float32Array(36);return h.set([NaN,NaN,NaN,NaN,(t[2]-s)/r,(t[3]-i)/o,NaN,NaN,NaN,NaN,(t[4]-s)/r,(t[5]-i)/o,NaN,NaN,NaN,NaN,a,c,NaN,NaN,NaN,NaN,u,d,NaN,NaN,NaN,NaN,(t[16]-s)/r,(t[17]-i)/o,NaN,NaN,NaN,NaN,(t[14]-s)/r,(t[15]-i)/o],0),this.newFreeDrawOutline(h,e,l(this,jn),l(this,Vc),l(this,Hc),l(this,Uc))},I_=function(e,t){const s=l(this,Ds);return e.set([NaN,NaN,NaN,NaN,s[4],s[5]],t),t+=6},O_=function(e,t){const s=l(this,ae).subarray(4,6),i=l(this,ae).subarray(16,18),[r,o,a,c]=l(this,jn),[u,d,h,f]=S(this,ft,od).call(this);return e.set([NaN,NaN,NaN,NaN,(s[0]-r)/a,(s[1]-o)/c,NaN,NaN,NaN,NaN,u,d,NaN,NaN,NaN,NaN,h,f,NaN,NaN,NaN,NaN,(i[0]-r)/a,(i[1]-o)/c],t),t+=24},A(ji,lf,8),A(ji,em,2),A(ji,tm,l(ji,lf)+l(ji,em));let Ig=ji;var Wc,Ua,ar,cf,zn,uf,Je,nm,j_;class F_ extends H{constructor(t,s,i,r,o,a){super();A(this,nm);A(this,Wc);A(this,Ua,new Float32Array(4));A(this,ar);A(this,cf);A(this,zn);A(this,uf);A(this,Je);m(this,Je,t),m(this,zn,s),m(this,Wc,i),m(this,uf,r),m(this,ar,o),m(this,cf,a),this.lastPoint=[NaN,NaN],S(this,nm,j_).call(this,a);const[c,u,d,h]=l(this,Ua);for(let f=0,p=t.length;f<p;f+=2)t[f]=(t[f]-c)/d,t[f+1]=(t[f+1]-u)/h;for(let f=0,p=s.length;f<p;f+=2)s[f]=(s[f]-c)/d,s[f+1]=(s[f+1]-u)/h}toSVGPath(){const t=[`M${l(this,Je)[4]} ${l(this,Je)[5]}`];for(let s=6,i=l(this,Je).length;s<i;s+=6){if(isNaN(l(this,Je)[s])){t.push(`L${l(this,Je)[s+4]} ${l(this,Je)[s+5]}`);continue}t.push(`C${l(this,Je)[s]} ${l(this,Je)[s+1]} ${l(this,Je)[s+2]} ${l(this,Je)[s+3]} ${l(this,Je)[s+4]} ${l(this,Je)[s+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,s,i,r],o){const a=i-t,c=r-s;let u,d;switch(o){case 0:u=H._rescale(l(this,Je),t,r,a,-c),d=H._rescale(l(this,zn),t,r,a,-c);break;case 90:u=H._rescaleAndSwap(l(this,Je),t,s,a,c),d=H._rescaleAndSwap(l(this,zn),t,s,a,c);break;case 180:u=H._rescale(l(this,Je),i,s,-a,c),d=H._rescale(l(this,zn),i,s,-a,c);break;case 270:u=H._rescaleAndSwap(l(this,Je),i,r,-a,-c),d=H._rescaleAndSwap(l(this,zn),i,r,-a,-c);break}return{outline:Array.from(u),points:[Array.from(d)]}}get box(){return l(this,Ua)}newOutliner(t,s,i,r,o,a=0){return new Ig(t,s,i,r,o,a)}getNewOutline(t,s){const[i,r,o,a]=l(this,Ua),[c,u,d,h]=l(this,Wc),f=o*d,p=a*h,v=i*d+c,g=r*h+u,x=this.newOutliner({x:l(this,zn)[0]*f+v,y:l(this,zn)[1]*p+g},l(this,Wc),l(this,uf),t,l(this,cf),s??l(this,ar));for(let y=2;y<l(this,zn).length;y+=2)x.add({x:l(this,zn)[y]*f+v,y:l(this,zn)[y+1]*p+g});return x.getOutlines()}}Wc=new WeakMap,Ua=new WeakMap,ar=new WeakMap,cf=new WeakMap,zn=new WeakMap,uf=new WeakMap,Je=new WeakMap,nm=new WeakSet,j_=function(t){const s=l(this,Je);let i=s[4],r=s[5];const o=[i,r,i,r];let a=i,c=r;const u=t?Math.max:Math.min;for(let h=6,f=s.length;h<f;h+=6){const p=s[h+4],v=s[h+5];if(isNaN(s[h]))Y.pointBoundingBox(p,v,o),c<v?(a=p,c=v):c===v&&(a=u(a,p));else{const g=[1/0,1/0,-1/0,-1/0];Y.bezierBoundingBox(i,r,...s.slice(h,h+6),g),Y.rectBoundingBox(...g,o),c<g[3]?(a=g[2],c=g[3]):c===g[3]&&(a=u(a,g[2]))}i=p,r=v}const d=l(this,Ua);d[0]=o[0]-l(this,ar),d[1]=o[1]-l(this,ar),d[2]=o[2]-o[0]+2*l(this,ar),d[3]=o[3]-o[1]+2*l(this,ar),this.lastPoint=[a,c]};var df,hf,co,Ns,ln,z_,Wp,B_,$_,p0;class f0{constructor(e,t=0,s=0,i=!0){A(this,ln);A(this,df);A(this,hf);A(this,co,[]);A(this,Ns,[]);const r=[1/0,1/0,-1/0,-1/0],o=10**-4;for(const{x:p,y:v,width:g,height:x}of e){const y=Math.floor((p-t)/o)*o,w=Math.ceil((p+g+t)/o)*o,b=Math.floor((v-t)/o)*o,E=Math.ceil((v+x+t)/o)*o,_=[y,b,E,!0],k=[w,b,E,!1];l(this,co).push(_,k),Y.rectBoundingBox(y,b,w,E,r)}const a=r[2]-r[0]+2*s,c=r[3]-r[1]+2*s,u=r[0]-s,d=r[1]-s,h=l(this,co).at(i?-1:-2),f=[h[0],h[2]];for(const p of l(this,co)){const[v,g,x]=p;p[0]=(v-u)/a,p[1]=(g-d)/c,p[2]=(x-d)/c}m(this,df,new Float32Array([u,d,a,c])),m(this,hf,f)}getOutlines(){l(this,co).sort((t,s)=>t[0]-s[0]||t[1]-s[1]||t[2]-s[2]);const e=[];for(const t of l(this,co))t[3]?(e.push(...S(this,ln,p0).call(this,t)),S(this,ln,B_).call(this,t)):(S(this,ln,$_).call(this,t),e.push(...S(this,ln,p0).call(this,t)));return S(this,ln,z_).call(this,e)}}df=new WeakMap,hf=new WeakMap,co=new WeakMap,Ns=new WeakMap,ln=new WeakSet,z_=function(e){const t=[],s=new Set;for(const o of e){const[a,c,u]=o;t.push([a,c,o],[a,u,o])}t.sort((o,a)=>o[1]-a[1]||o[0]-a[0]);for(let o=0,a=t.length;o<a;o+=2){const c=t[o][2],u=t[o+1][2];c.push(u),u.push(c),s.add(c),s.add(u)}const i=[];let r;for(;s.size>0;){const o=s.values().next().value;let[a,c,u,d,h]=o;s.delete(o);let f=a,p=c;for(r=[a,u],i.push(r);;){let v;if(s.has(d))v=d;else if(s.has(h))v=h;else break;s.delete(v),[a,c,u,d,h]=v,f!==a&&(r.push(f,p,a,p===c?c:u),f=a),p=p===c?u:c}r.push(f,p)}return new lM(i,l(this,df),l(this,hf))},Wp=function(e){const t=l(this,Ns);let s=0,i=t.length-1;for(;s<=i;){const r=s+i>>1,o=t[r][0];if(o===e)return r;o<e?s=r+1:i=r-1}return i+1},B_=function([,e,t]){const s=S(this,ln,Wp).call(this,e);l(this,Ns).splice(s,0,[e,t])},$_=function([,e,t]){const s=S(this,ln,Wp).call(this,e);for(let i=s;i<l(this,Ns).length;i++){const[r,o]=l(this,Ns)[i];if(r!==e)break;if(r===e&&o===t){l(this,Ns).splice(i,1);return}}for(let i=s-1;i>=0;i--){const[r,o]=l(this,Ns)[i];if(r!==e)break;if(r===e&&o===t){l(this,Ns).splice(i,1);return}}},p0=function(e){const[t,s,i]=e,r=[[t,s,i]],o=S(this,ln,Wp).call(this,i);for(let a=0;a<o;a++){const[c,u]=l(this,Ns)[a];for(let d=0,h=r.length;d<h;d++){const[,f,p]=r[d];if(!(u<=f||p<=c)){if(f>=c){if(p>u)r[d][1]=u;else{if(h===1)return[];r.splice(d,1),d--,h--}continue}r[d][2]=c,p>u&&r.push([t,u,p])}}}return r};var ff,Xc;class lM extends H{constructor(t,s,i){super();A(this,ff);A(this,Xc);m(this,Xc,t),m(this,ff,s),this.lastPoint=i}toSVGPath(){const t=[];for(const s of l(this,Xc)){let[i,r]=s;t.push(`M${i} ${r}`);for(let o=2;o<s.length;o+=2){const a=s[o],c=s[o+1];a===i?(t.push(`V${c}`),r=c):c===r&&(t.push(`H${a}`),i=a)}t.push("Z")}return t.join(" ")}serialize([t,s,i,r],o){const a=[],c=i-t,u=r-s;for(const d of l(this,Xc)){const h=new Array(d.length);for(let f=0;f<d.length;f+=2)h[f]=t+d[f]*c,h[f+1]=r-d[f+1]*u;a.push(h)}return a}get box(){return l(this,ff)}get classNamesForOutlining(){return["highlightOutline"]}}ff=new WeakMap,Xc=new WeakMap;class g0 extends Ig{newFreeDrawOutline(e,t,s,i,r,o){return new cM(e,t,s,i,r,o)}}class cM extends F_{newOutliner(e,t,s,i,r,o=0){return new g0(e,t,s,i,r,o)}}var Is,Va,Yc,ct,pf,qc,gf,mf,uo,Os,Kc,yf,Ee,m0,y0,v0,Yo,H_,Dr;const hn=class hn{constructor({editor:e=null,uiManager:t=null}){A(this,Ee);A(this,Is,null);A(this,Va,null);A(this,Yc);A(this,ct,null);A(this,pf,!1);A(this,qc,!1);A(this,gf,null);A(this,mf);A(this,uo,null);A(this,Os,null);A(this,Kc);var s;e?(m(this,qc,!1),m(this,Kc,de.HIGHLIGHT_COLOR),m(this,gf,e)):(m(this,qc,!0),m(this,Kc,de.HIGHLIGHT_DEFAULT_COLOR)),m(this,Os,(e==null?void 0:e._uiManager)||t),m(this,mf,l(this,Os)._eventBus),m(this,Yc,(e==null?void 0:e.color)||((s=l(this,Os))==null?void 0:s.highlightColors.values().next().value)||"#FFFF98"),l(hn,yf)||m(hn,yf,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return le(this,"_keyboardManager",new Ff([[["Escape","mac+Escape"],hn.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],hn.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],hn.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],hn.prototype._moveToPrevious],[["Home","mac+Home"],hn.prototype._moveToBeginning],[["End","mac+End"],hn.prototype._moveToEnd]]))}renderButton(){const e=m(this,Is,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.setAttribute("aria-haspopup",!0);const t=l(this,Os)._signal;e.addEventListener("click",S(this,Ee,Yo).bind(this),{signal:t}),e.addEventListener("keydown",S(this,Ee,v0).bind(this),{signal:t});const s=m(this,Va,document.createElement("span"));return s.className="swatch",s.setAttribute("aria-hidden",!0),s.style.backgroundColor=l(this,Yc),e.append(s),e}renderMainDropdown(){const e=m(this,ct,S(this,Ee,m0).call(this));return e.setAttribute("aria-orientation","horizontal"),e.setAttribute("aria-labelledby","highlightColorPickerLabel"),e}_colorSelectFromKeyboard(e){if(e.target===l(this,Is)){S(this,Ee,Yo).call(this,e);return}const t=e.target.getAttribute("data-color");t&&S(this,Ee,y0).call(this,t,e)}_moveToNext(e){var t,s;if(!l(this,Ee,Dr)){S(this,Ee,Yo).call(this,e);return}if(e.target===l(this,Is)){(t=l(this,ct).firstChild)==null||t.focus();return}(s=e.target.nextSibling)==null||s.focus()}_moveToPrevious(e){var t,s;if(e.target===((t=l(this,ct))==null?void 0:t.firstChild)||e.target===l(this,Is)){l(this,Ee,Dr)&&this._hideDropdownFromKeyboard();return}l(this,Ee,Dr)||S(this,Ee,Yo).call(this,e),(s=e.target.previousSibling)==null||s.focus()}_moveToBeginning(e){var t;if(!l(this,Ee,Dr)){S(this,Ee,Yo).call(this,e);return}(t=l(this,ct).firstChild)==null||t.focus()}_moveToEnd(e){var t;if(!l(this,Ee,Dr)){S(this,Ee,Yo).call(this,e);return}(t=l(this,ct).lastChild)==null||t.focus()}hideDropdown(){var e,t;(e=l(this,ct))==null||e.classList.add("hidden"),(t=l(this,uo))==null||t.abort(),m(this,uo,null)}_hideDropdownFromKeyboard(){var e;if(!l(this,qc)){if(!l(this,Ee,Dr)){(e=l(this,gf))==null||e.unselect();return}this.hideDropdown(),l(this,Is).focus({preventScroll:!0,focusVisible:l(this,pf)})}}updateColor(e){if(l(this,Va)&&(l(this,Va).style.backgroundColor=e),!l(this,ct))return;const t=l(this,Os).highlightColors.values();for(const s of l(this,ct).children)s.setAttribute("aria-selected",t.next().value===e)}destroy(){var e,t;(e=l(this,Is))==null||e.remove(),m(this,Is,null),m(this,Va,null),(t=l(this,ct))==null||t.remove(),m(this,ct,null)}};Is=new WeakMap,Va=new WeakMap,Yc=new WeakMap,ct=new WeakMap,pf=new WeakMap,qc=new WeakMap,gf=new WeakMap,mf=new WeakMap,uo=new WeakMap,Os=new WeakMap,Kc=new WeakMap,yf=new WeakMap,Ee=new WeakSet,m0=function(){const e=document.createElement("div"),t=l(this,Os)._signal;e.addEventListener("contextmenu",As,{signal:t}),e.className="dropdown",e.role="listbox",e.setAttribute("aria-multiselectable",!1),e.setAttribute("aria-orientation","vertical"),e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[s,i]of l(this,Os).highlightColors){const r=document.createElement("button");r.tabIndex="0",r.role="option",r.setAttribute("data-color",i),r.title=s,r.setAttribute("data-l10n-id",l(hn,yf)[s]);const o=document.createElement("span");r.append(o),o.className="swatch",o.style.backgroundColor=i,r.setAttribute("aria-selected",i===l(this,Yc)),r.addEventListener("click",S(this,Ee,y0).bind(this,i),{signal:t}),e.append(r)}return e.addEventListener("keydown",S(this,Ee,v0).bind(this),{signal:t}),e},y0=function(e,t){t.stopPropagation(),l(this,mf).dispatch("switchannotationeditorparams",{source:this,type:l(this,Kc),value:e})},v0=function(e){hn._keyboardManager.exec(this,e)},Yo=function(e){if(l(this,Ee,Dr)){this.hideDropdown();return}if(m(this,pf,e.detail===0),l(this,uo)||(m(this,uo,new AbortController),window.addEventListener("pointerdown",S(this,Ee,H_).bind(this),{signal:l(this,Os).combinedSignal(l(this,uo))})),l(this,ct)){l(this,ct).classList.remove("hidden");return}const t=m(this,ct,S(this,Ee,m0).call(this));l(this,Is).append(t)},H_=function(e){var t;(t=l(this,ct))!=null&&t.contains(e.target)||this.hideDropdown()},Dr=function(){return l(this,ct)&&!l(this,ct).classList.contains("hidden")},A(hn,yf,null);let Kd=hn;var Qc,vf,lr,Ga,Jc,gn,wf,bf,Wa,as,Bn,Rt,Zc,cr,Gt,eu,ls,Af,se,w0,Xp,U_,V_,G_,b0,qo,gs,Pl,W_,Yp,ad,X_,Y_,q_,K_,Q_;const ve=class ve extends Me{constructor(t){super({...t,name:"highlightEditor"});A(this,se);A(this,Qc,null);A(this,vf,0);A(this,lr);A(this,Ga,null);A(this,Jc,null);A(this,gn,null);A(this,wf,null);A(this,bf,0);A(this,Wa,null);A(this,as,null);A(this,Bn,null);A(this,Rt,!1);A(this,Zc,null);A(this,cr);A(this,Gt,null);A(this,eu,"");A(this,ls);A(this,Af,"");this.color=t.color||ve._defaultColor,m(this,ls,t.thickness||ve._defaultThickness),m(this,cr,t.opacity||ve._defaultOpacity),m(this,lr,t.boxes||null),m(this,Af,t.methodOfCreation||""),m(this,eu,t.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(m(this,Rt,!0),S(this,se,Xp).call(this,t),S(this,se,qo).call(this)):l(this,lr)&&(m(this,Qc,t.anchorNode),m(this,vf,t.anchorOffset),m(this,wf,t.focusNode),m(this,bf,t.focusOffset),S(this,se,w0).call(this),S(this,se,qo).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const t=ve.prototype;return le(this,"_keyboardManager",new Ff([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:l(this,Rt)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:l(this,ls),methodOfCreation:l(this,Af)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,s){var i;Me.initialize(t,s),ve._defaultColor||(ve._defaultColor=((i=s.highlightColors)==null?void 0:i.values().next().value)||"#fff066")}static updateDefaultParams(t,s){switch(t){case de.HIGHLIGHT_DEFAULT_COLOR:ve._defaultColor=s;break;case de.HIGHLIGHT_THICKNESS:ve._defaultThickness=s;break}}translateInPage(t,s){}get toolbarPosition(){return l(this,Zc)}updateParams(t,s){switch(t){case de.HIGHLIGHT_COLOR:S(this,se,U_).call(this,s);break;case de.HIGHLIGHT_THICKNESS:S(this,se,V_).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[de.HIGHLIGHT_DEFAULT_COLOR,ve._defaultColor],[de.HIGHLIGHT_THICKNESS,ve._defaultThickness]]}get propertiesToUpdate(){return[[de.HIGHLIGHT_COLOR,this.color||ve._defaultColor],[de.HIGHLIGHT_THICKNESS,l(this,ls)||ve._defaultThickness],[de.HIGHLIGHT_FREE,l(this,Rt)]]}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.highlightColors&&(m(this,Jc,new Kd({editor:this})),t.addColorPicker(l(this,Jc))),t):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(S(this,se,ad).call(this))}getBaseTranslation(){return[0,0]}getRect(t,s){return super.getRect(t,s,S(this,se,ad).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){S(this,se,b0).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(S(this,se,qo).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var i;let s=!1;this.parent&&!t?S(this,se,b0).call(this):t&&(S(this,se,qo).call(this,t),s=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),s&&this.select()}rotate(t){var r,o,a;const{drawLayer:s}=this.parent;let i;l(this,Rt)?(t=(t-this.rotation+360)%360,i=S(r=ve,gs,Pl).call(r,l(this,as).box,t)):i=S(o=ve,gs,Pl).call(o,[this.x,this.y,this.width,this.height],t),s.updateProperties(l(this,Bn),{bbox:i,root:{"data-main-rotation":t}}),s.updateProperties(l(this,Gt),{bbox:S(a=ve,gs,Pl).call(a,l(this,gn).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();l(this,eu)&&(t.setAttribute("aria-label",l(this,eu)),t.setAttribute("role","mark")),l(this,Rt)?t.classList.add("free"):this.div.addEventListener("keydown",S(this,se,W_).bind(this),{signal:this._uiManager._signal});const s=m(this,Wa,document.createElement("div"));t.append(s),s.setAttribute("aria-hidden","true"),s.className="internal",s.style.clipPath=l(this,Ga);const[i,r]=this.parentDimensions;return this.setDims(this.width*i,this.height*r),m1(this,l(this,Wa),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(l(this,Gt),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(l(this,Gt),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:S(this,se,Yp).call(this,!0);break;case 1:case 3:S(this,se,Yp).call(this,!1);break}}select(){var t;super.select(),l(this,Gt)&&((t=this.parent)==null||t.drawLayer.updateProperties(l(this,Gt),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),l(this,Gt)&&((t=this.parent)==null||t.drawLayer.updateProperties(l(this,Gt),{rootClass:{selected:!1}}),l(this,Rt)||S(this,se,Yp).call(this,!1))}get _mustFixPosition(){return!l(this,Rt)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(l(this,Bn),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(l(this,Gt),{rootClass:{hidden:!t}}))}static startHighlighting(t,s,{target:i,x:r,y:o}){const{x:a,y:c,width:u,height:d}=i.getBoundingClientRect(),h=new AbortController,f=t.combinedSignal(h),p=v=>{h.abort(),S(this,gs,K_).call(this,t,v)};window.addEventListener("blur",p,{signal:f}),window.addEventListener("pointerup",p,{signal:f}),window.addEventListener("pointerdown",et,{capture:!0,passive:!1,signal:f}),window.addEventListener("contextmenu",As,{signal:f}),i.addEventListener("pointermove",S(this,gs,q_).bind(this,t),{signal:f}),this._freeHighlight=new g0({x:r,y:o},[a,c,u,d],t.scale,this._defaultThickness/2,s,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,s,i){var g,x,y,w;let r=null;if(t instanceof E_){const{data:{quadPoints:b,rect:E,rotation:_,id:k,color:C,opacity:P,popupRef:L},parent:{page:{pageNumber:M}}}=t;r=t={annotationType:ee.HIGHLIGHT,color:Array.from(C),opacity:P,quadPoints:b,boxes:null,pageIndex:M-1,rect:E.slice(0),rotation:_,id:k,deleted:!1,popupRef:L}}else if(t instanceof Jw){const{data:{inkLists:b,rect:E,rotation:_,id:k,color:C,borderStyle:{rawWidth:P},popupRef:L},parent:{page:{pageNumber:M}}}=t;r=t={annotationType:ee.HIGHLIGHT,color:Array.from(C),thickness:P,inkLists:b,boxes:null,pageIndex:M-1,rect:E.slice(0),rotation:_,id:k,deleted:!1,popupRef:L}}const{color:o,quadPoints:a,inkLists:c,opacity:u}=t,d=await super.deserialize(t,s,i);d.color=Y.makeHexColor(...o),m(d,cr,u||1),c&&m(d,ls,t.thickness),d.annotationElementId=t.id||null,d._initialData=r;const[h,f]=d.pageDimensions,[p,v]=d.pageTranslation;if(a){const b=m(d,lr,[]);for(let E=0;E<a.length;E+=8)b.push({x:(a[E]-p)/h,y:1-(a[E+1]-v)/f,width:(a[E+2]-a[E])/h,height:(a[E+1]-a[E+5])/f});S(g=d,se,w0).call(g),S(x=d,se,qo).call(x),d.rotate(d.rotation)}else if(c){m(d,Rt,!0);const b=c[0],E={x:b[0]-p,y:f-(b[1]-v)},_=new g0(E,[0,0,h,f],1,l(d,ls)/2,!0,.001);for(let P=0,L=b.length;P<L;P+=2)E.x=b[P]-p,E.y=f-(b[P+1]-v),_.add(E);const{id:k,clipPathId:C}=s.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:d.color,"fill-opacity":d._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:_.toSVGPath()}},!0,!0);S(y=d,se,Xp).call(y,{highlightOutlines:_.getOutlines(),highlightId:k,clipPathId:C}),S(w=d,se,qo).call(w),d.rotate(d.parentRotation)}return d}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const s=this.getRect(0,0),i=Me._colorManager.convert(this.color),r={annotationType:ee.HIGHLIGHT,color:i,opacity:l(this,cr),thickness:l(this,ls),quadPoints:S(this,se,X_).call(this),outlines:S(this,se,Y_).call(this,s),pageIndex:this.pageIndex,rect:s,rotation:S(this,se,ad).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!S(this,se,Q_).call(this,r)?null:(r.id=this.annotationElementId,r)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};Qc=new WeakMap,vf=new WeakMap,lr=new WeakMap,Ga=new WeakMap,Jc=new WeakMap,gn=new WeakMap,wf=new WeakMap,bf=new WeakMap,Wa=new WeakMap,as=new WeakMap,Bn=new WeakMap,Rt=new WeakMap,Zc=new WeakMap,cr=new WeakMap,Gt=new WeakMap,eu=new WeakMap,ls=new WeakMap,Af=new WeakMap,se=new WeakSet,w0=function(){const t=new f0(l(this,lr),.001);m(this,as,t.getOutlines()),[this.x,this.y,this.width,this.height]=l(this,as).box;const s=new f0(l(this,lr),.0025,.001,this._uiManager.direction==="ltr");m(this,gn,s.getOutlines());const{lastPoint:i}=l(this,gn);m(this,Zc,[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height])},Xp=function({highlightOutlines:t,highlightId:s,clipPathId:i}){var h,f;if(m(this,as,t),m(this,gn,t.getNewOutline(l(this,ls)/2+1.5,.0025)),s>=0)m(this,Bn,s),m(this,Ga,i),this.parent.drawLayer.finalizeDraw(s,{bbox:t.box,path:{d:t.toSVGPath()}}),m(this,Gt,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:l(this,gn).box,path:{d:l(this,gn).toSVGPath()}},!0));else if(this.parent){const p=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(l(this,Bn),{bbox:S(h=ve,gs,Pl).call(h,l(this,as).box,(p-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(l(this,Gt),{bbox:S(f=ve,gs,Pl).call(f,l(this,gn).box,p),path:{d:l(this,gn).toSVGPath()}})}const[o,a,c,u]=t.box;switch(this.rotation){case 0:this.x=o,this.y=a,this.width=c,this.height=u;break;case 90:{const[p,v]=this.parentDimensions;this.x=a,this.y=1-o,this.width=c*v/p,this.height=u*p/v;break}case 180:this.x=1-o,this.y=1-a,this.width=c,this.height=u;break;case 270:{const[p,v]=this.parentDimensions;this.x=1-a,this.y=o,this.width=c*v/p,this.height=u*p/v;break}}const{lastPoint:d}=l(this,gn);m(this,Zc,[(d[0]-o)/c,(d[1]-a)/u])},U_=function(t){const s=(o,a)=>{var c,u;this.color=o,m(this,cr,a),(c=this.parent)==null||c.drawLayer.updateProperties(l(this,Bn),{root:{fill:o,"fill-opacity":a}}),(u=l(this,Jc))==null||u.updateColor(o)},i=this.color,r=l(this,cr);this.addCommands({cmd:s.bind(this,t,ve._defaultOpacity),undo:s.bind(this,i,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:de.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(t)},!0)},V_=function(t){const s=l(this,ls),i=r=>{m(this,ls,r),S(this,se,G_).call(this,r)};this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:de.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},G_=function(t){if(!l(this,Rt))return;S(this,se,Xp).call(this,{highlightOutlines:l(this,as).getNewOutline(t/2)}),this.fixAndSetPosition();const[s,i]=this.parentDimensions;this.setDims(this.width*s,this.height*i)},b0=function(){l(this,Bn)===null||!this.parent||(this.parent.drawLayer.remove(l(this,Bn)),m(this,Bn,null),this.parent.drawLayer.remove(l(this,Gt)),m(this,Gt,null))},qo=function(t=this.parent){l(this,Bn)===null&&({id:Qt(this,Bn)._,clipPathId:Qt(this,Ga)._}=t.drawLayer.draw({bbox:l(this,as).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":l(this,cr)},rootClass:{highlight:!0,free:l(this,Rt)},path:{d:l(this,as).toSVGPath()}},!1,!0),m(this,Gt,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:l(this,Rt)},bbox:l(this,gn).box,path:{d:l(this,gn).toSVGPath()}},l(this,Rt))),l(this,Wa)&&(l(this,Wa).style.clipPath=l(this,Ga)))},gs=new WeakSet,Pl=function([t,s,i,r],o){switch(o){case 90:return[1-s-r,t,r,i];case 180:return[1-t-i,1-s-r,i,r];case 270:return[s,1-t-i,r,i]}return[t,s,i,r]},W_=function(t){ve._keyboardManager.exec(this,t)},Yp=function(t){if(!l(this,Qc))return;const s=window.getSelection();t?s.setPosition(l(this,Qc),l(this,vf)):s.setPosition(l(this,wf),l(this,bf))},ad=function(){return l(this,Rt)?this.rotation:0},X_=function(){if(l(this,Rt))return null;const[t,s]=this.pageDimensions,[i,r]=this.pageTranslation,o=l(this,lr),a=new Float32Array(o.length*8);let c=0;for(const{x:u,y:d,width:h,height:f}of o){const p=u*t+i,v=(1-d)*s+r;a[c]=a[c+4]=p,a[c+1]=a[c+3]=v,a[c+2]=a[c+6]=p+h*t,a[c+5]=a[c+7]=v-f*s,c+=8}return a},Y_=function(t){return l(this,as).serialize(t,S(this,se,ad).call(this))},q_=function(t,s){this._freeHighlight.add(s)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},K_=function(t,s){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(s,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},Q_=function(t){const{color:s}=this._initialData;return t.color.some((i,r)=>i!==s[r])},A(ve,gs),F(ve,"_defaultColor",null),F(ve,"_defaultOpacity",1),F(ve,"_defaultThickness",12),F(ve,"_type","highlight"),F(ve,"_editorType",ee.HIGHLIGHT),F(ve,"_freeHighlightId",-1),F(ve,"_freeHighlight",null),F(ve,"_freeHighlightClipId","");let Og=ve;var Xa;class J_{constructor(){A(this,Xa,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,s]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,s)}updateSVGProperty(e,t){l(this,Xa)[e]=t}toSVGProperties(){const e=l(this,Xa);return m(this,Xa,Object.create(null)),{root:e}}reset(){m(this,Xa,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){_e("Not implemented")}}Xa=new WeakMap;var $n,tu,yt,Ya,qa,ho,fo,po,Ka,me,A0,S0,x0,ld,Z_,qp,cd,Rl;const V=class V extends Me{constructor(t){super(t);A(this,me);A(this,$n,null);A(this,tu);F(this,"_drawId",null);m(this,tu,t.mustBeCommitted||!1),this._addOutlines(t)}_addOutlines(t){t.drawOutlines&&(S(this,me,A0).call(this,t),S(this,me,ld).call(this))}static _mergeSVGProperties(t,s){const i=new Set(Object.keys(t));for(const[r,o]of Object.entries(s))i.has(r)?Object.assign(t[r],o):t[r]=o;return t}static getDefaultDrawingOptions(t){_e("Not implemented")}static get typesMap(){_e("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,s){const i=this.typesMap.get(t);i&&this._defaultDrawingOptions.updateProperty(i,s),this._currentParent&&(l(V,yt).updateProperty(i,s),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,s){const i=this.constructor.typesMap.get(t);i&&this._updateProperty(t,i,s)}static get defaultPropertiesToUpdate(){const t=[],s=this._defaultDrawingOptions;for(const[i,r]of this.typesMap)t.push([i,s[r]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:s}=this;for(const[i,r]of this.constructor.typesMap)t.push([i,s[r]]);return t}_updateProperty(t,s,i){const r=this._drawingOptions,o=r[s],a=c=>{var d;r.updateProperty(s,c);const u=l(this,$n).updateProperty(s,c);u&&S(this,me,cd).call(this,u),(d=this.parent)==null||d.drawLayer.updateProperties(this._drawId,r.toSVGProperties())};this.addCommands({cmd:a.bind(this,i),undo:a.bind(this,o),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,V._mergeSVGProperties(l(this,$n).getPathResizingSVGProperties(S(this,me,qp).call(this)),{bbox:S(this,me,Rl).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,V._mergeSVGProperties(l(this,$n).getPathResizedSVGProperties(S(this,me,qp).call(this)),{bbox:S(this,me,Rl).call(this)}))}_onTranslating(t,s){var i;(i=this.parent)==null||i.drawLayer.updateProperties(this._drawId,{bbox:S(this,me,Rl).call(this)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,V._mergeSVGProperties(l(this,$n).getPathTranslatedSVGProperties(S(this,me,qp).call(this),this.parentDimensions),{bbox:S(this,me,Rl).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,l(this,tu)&&(m(this,tu,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){S(this,me,x0).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(S(this,me,ld).call(this),S(this,me,cd).call(this,l(this,$n).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var i;let s=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),S(this,me,x0).call(this)):t&&(this._uiManager.addShouldRescale(this),S(this,me,ld).call(this,t),s=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(t),s&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,V._mergeSVGProperties({bbox:S(this,me,Rl).call(this)},l(this,$n).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&S(this,me,cd).call(this,l(this,$n).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,s;this._isCopy&&(t=this.x,s=this.y);const i=super.render();i.classList.add("draw");const r=document.createElement("div");i.append(r),r.setAttribute("aria-hidden","true"),r.className="internal";const[o,a]=this.parentDimensions;return this.setDims(this.width*o,this.height*a),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,s),i}static createDrawerInstance(t,s,i,r,o){_e("Not implemented")}static startDrawing(t,s,i,r){var x;const{target:o,offsetX:a,offsetY:c,pointerId:u,pointerType:d}=r;if(l(V,fo)&&l(V,fo)!==d)return;const{viewport:{rotation:h}}=t,{width:f,height:p}=o.getBoundingClientRect(),v=m(V,Ya,new AbortController),g=t.combinedSignal(v);if(l(V,ho)||m(V,ho,u),l(V,fo)??m(V,fo,d),window.addEventListener("pointerup",y=>{var w;l(V,ho)===y.pointerId?this._endDraw(y):(w=l(V,po))==null||w.delete(y.pointerId)},{signal:g}),window.addEventListener("pointercancel",y=>{var w;l(V,ho)===y.pointerId?this._currentParent.endDrawingSession():(w=l(V,po))==null||w.delete(y.pointerId)},{signal:g}),window.addEventListener("pointerdown",y=>{l(V,fo)===y.pointerType&&((l(V,po)||m(V,po,new Set)).add(y.pointerId),l(V,yt).isCancellable()&&(l(V,yt).removeLastElement(),l(V,yt).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:g}),window.addEventListener("contextmenu",As,{signal:g}),o.addEventListener("pointermove",this._drawMove.bind(this),{signal:g}),o.addEventListener("touchmove",y=>{y.timeStamp===l(V,Ka)&&et(y)},{signal:g}),t.toggleDrawing(),(x=s._editorUndoBar)==null||x.hide(),l(V,yt)){t.drawLayer.updateProperties(this._currentDrawId,l(V,yt).startNew(a,c,f,p,h));return}s.updateUIForDefaultProperties(this),m(V,yt,this.createDrawerInstance(a,c,f,p,h)),m(V,qa,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(l(V,qa).toSVGProperties(),l(V,yt).defaultSVGProperties),!0,!1)}static _drawMove(t){var o;if(m(V,Ka,-1),!l(V,yt))return;const{offsetX:s,offsetY:i,pointerId:r}=t;if(l(V,ho)===r){if(((o=l(V,po))==null?void 0:o.size)>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,l(V,yt).add(s,i)),m(V,Ka,t.timeStamp),et(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,m(V,yt,null),m(V,qa,null),m(V,fo,null),m(V,Ka,NaN)),l(V,Ya)&&(l(V,Ya).abort(),m(V,Ya,null),m(V,ho,NaN),m(V,po,null))}static _endDraw(t){const s=this._currentParent;if(s){if(s.toggleDrawing(!0),this._cleanup(!1),(t==null?void 0:t.target)===s.div&&s.drawLayer.updateProperties(this._currentDrawId,l(V,yt).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const i=l(V,yt),r=this._currentDrawId,o=i.getLastElement();s.addCommands({cmd:()=>{s.drawLayer.updateProperties(r,i.setLastElement(o))},undo:()=>{s.drawLayer.updateProperties(r,i.removeLastElement())},mustExec:!1,type:de.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const s=this._currentParent;if(!s)return null;if(s.toggleDrawing(!0),s.cleanUndoStack(de.DRAW_STEP),!l(V,yt).isEmpty()){const{pageDimensions:[i,r],scale:o}=s,a=s.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:l(V,yt).getOutlines(i*o,r*o,o,this._INNER_MARGIN),drawingOptions:l(V,qa),mustBeCommitted:!t});return this._cleanup(!0),a}return s.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,s,i,r,o,a){_e("Not implemented")}static async deserialize(t,s,i){var h,f;const{rawDims:{pageWidth:r,pageHeight:o,pageX:a,pageY:c}}=s.viewport,u=this.deserializeDraw(a,c,r,o,this._INNER_MARGIN,t),d=await super.deserialize(t,s,i);return d.createDrawingOptions(t),S(h=d,me,A0).call(h,{drawOutlines:u}),S(f=d,me,ld).call(f),d.onScaleChanging(),d.rotate(),d}serializeDraw(t){const[s,i]=this.pageTranslation,[r,o]=this.pageDimensions;return l(this,$n).serialize([s,i,r,o],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};$n=new WeakMap,tu=new WeakMap,yt=new WeakMap,Ya=new WeakMap,qa=new WeakMap,ho=new WeakMap,fo=new WeakMap,po=new WeakMap,Ka=new WeakMap,me=new WeakSet,A0=function({drawOutlines:t,drawId:s,drawingOptions:i}){m(this,$n,t),this._drawingOptions||(this._drawingOptions=i),s>=0?(this._drawId=s,this.parent.drawLayer.finalizeDraw(s,t.defaultProperties)):this._drawId=S(this,me,S0).call(this,t,this.parent),S(this,me,cd).call(this,t.box)},S0=function(t,s){const{id:i}=s.drawLayer.draw(V._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return i},x0=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},ld=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=S(this,me,S0).call(this,l(this,$n),t)}},Z_=function([t,s,i,r]){const{parentDimensions:[o,a],rotation:c}=this;switch(c){case 90:return[s,1-t,i*(a/o),r*(o/a)];case 180:return[1-t,1-s,i,r];case 270:return[1-s,t,i*(a/o),r*(o/a)];default:return[t,s,i,r]}},qp=function(){const{x:t,y:s,width:i,height:r,parentDimensions:[o,a],rotation:c}=this;switch(c){case 90:return[1-s,t,i*(o/a),r*(a/o)];case 180:return[1-t,1-s,i,r];case 270:return[s,1-t,i*(o/a),r*(a/o)];default:return[t,s,i,r]}},cd=function(t){if([this.x,this.y,this.width,this.height]=S(this,me,Z_).call(this,t),this.div){this.fixAndSetPosition();const[s,i]=this.parentDimensions;this.setDims(this.width*s,this.height*i)}this._onResized()},Rl=function(){const{x:t,y:s,width:i,height:r,rotation:o,parentRotation:a,parentDimensions:[c,u]}=this;switch((o*4+a)/90){case 1:return[1-s-r,t,r,i];case 2:return[1-t-i,1-s-r,i,r];case 3:return[s,1-t-i,r,i];case 4:return[t,s-i*(c/u),r*(u/c),i*(c/u)];case 5:return[1-s,t,i*(c/u),r*(u/c)];case 6:return[1-t-r*(u/c),1-s,r*(u/c),i*(c/u)];case 7:return[s-i*(c/u),1-t-r*(u/c),i*(c/u),r*(u/c)];case 8:return[t-i,s-r,i,r];case 9:return[1-s,t-i,r,i];case 10:return[1-t,1-s,i,r];case 11:return[s-r,1-t,r,i];case 12:return[t-r*(u/c),s,r*(u/c),i*(c/u)];case 13:return[1-s-i*(c/u),t-r*(u/c),i*(c/u),r*(u/c)];case 14:return[1-t,1-s-i*(c/u),r*(u/c),i*(c/u)];case 15:return[s,1-t,i*(c/u),r*(u/c)];default:return[t,s,i,r]}},F(V,"_currentDrawId",-1),F(V,"_currentParent",null),A(V,yt,null),A(V,Ya,null),A(V,qa,null),A(V,ho,NaN),A(V,fo,null),A(V,po,null),A(V,Ka,NaN),F(V,"_INNER_MARGIN",3);let Fg=V;var gi,vt,wt,Qa,nu,en,Lt,cs,Ja,Za,el,su,Kp;class uM{constructor(e,t,s,i,r,o){A(this,su);A(this,gi,new Float64Array(6));A(this,vt);A(this,wt);A(this,Qa);A(this,nu);A(this,en);A(this,Lt,"");A(this,cs,0);A(this,Ja,new Bf);A(this,Za);A(this,el);m(this,Za,s),m(this,el,i),m(this,Qa,r),m(this,nu,o),[e,t]=S(this,su,Kp).call(this,e,t);const a=m(this,vt,[NaN,NaN,NaN,NaN,e,t]);m(this,en,[e,t]),m(this,wt,[{line:a,points:l(this,en)}]),l(this,gi).set(a,0)}updateProperty(e,t){e==="stroke-width"&&m(this,nu,t)}isEmpty(){return!l(this,wt)||l(this,wt).length===0}isCancellable(){return l(this,en).length<=10}add(e,t){[e,t]=S(this,su,Kp).call(this,e,t);const[s,i,r,o]=l(this,gi).subarray(2,6),a=e-r,c=t-o;return Math.hypot(l(this,Za)*a,l(this,el)*c)<=2?null:(l(this,en).push(e,t),isNaN(s)?(l(this,gi).set([r,o,e,t],2),l(this,vt).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(l(this,gi)[0])&&l(this,vt).splice(6,6),l(this,gi).set([s,i,r,o,e,t],0),l(this,vt).push(...H.createBezierPoints(s,i,r,o,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const s=this.add(e,t);return s||(l(this,en).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,s,i,r){m(this,Za,s),m(this,el,i),m(this,Qa,r),[e,t]=S(this,su,Kp).call(this,e,t);const o=m(this,vt,[NaN,NaN,NaN,NaN,e,t]);m(this,en,[e,t]);const a=l(this,wt).at(-1);return a&&(a.line=new Float32Array(a.line),a.points=new Float32Array(a.points)),l(this,wt).push({line:o,points:l(this,en)}),l(this,gi).set(o,0),m(this,cs,0),this.toSVGPath(),null}getLastElement(){return l(this,wt).at(-1)}setLastElement(e){return l(this,wt)?(l(this,wt).push(e),m(this,vt,e.line),m(this,en,e.points),m(this,cs,0),{path:{d:this.toSVGPath()}}):l(this,Ja).setLastElement(e)}removeLastElement(){if(!l(this,wt))return l(this,Ja).removeLastElement();l(this,wt).pop(),m(this,Lt,"");for(let e=0,t=l(this,wt).length;e<t;e++){const{line:s,points:i}=l(this,wt)[e];m(this,vt,s),m(this,en,i),m(this,cs,0),this.toSVGPath()}return{path:{d:l(this,Lt)}}}toSVGPath(){const e=H.svgRound(l(this,vt)[4]),t=H.svgRound(l(this,vt)[5]);if(l(this,en).length===2)return m(this,Lt,`${l(this,Lt)} M ${e} ${t} Z`),l(this,Lt);if(l(this,en).length<=6){const i=l(this,Lt).lastIndexOf("M");m(this,Lt,`${l(this,Lt).slice(0,i)} M ${e} ${t}`),m(this,cs,6)}if(l(this,en).length===4){const i=H.svgRound(l(this,vt)[10]),r=H.svgRound(l(this,vt)[11]);return m(this,Lt,`${l(this,Lt)} L ${i} ${r}`),m(this,cs,12),l(this,Lt)}const s=[];l(this,cs)===0&&(s.push(`M ${e} ${t}`),m(this,cs,6));for(let i=l(this,cs),r=l(this,vt).length;i<r;i+=6){const[o,a,c,u,d,h]=l(this,vt).slice(i,i+6).map(H.svgRound);s.push(`C${o} ${a} ${c} ${u} ${d} ${h}`)}return m(this,Lt,l(this,Lt)+s.join(" ")),m(this,cs,l(this,vt).length),l(this,Lt)}getOutlines(e,t,s,i){const r=l(this,wt).at(-1);return r.line=new Float32Array(r.line),r.points=new Float32Array(r.points),l(this,Ja).build(l(this,wt),e,t,s,l(this,Qa),l(this,nu),i),m(this,gi,null),m(this,vt,null),m(this,wt,null),m(this,Lt,null),l(this,Ja)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}gi=new WeakMap,vt=new WeakMap,wt=new WeakMap,Qa=new WeakMap,nu=new WeakMap,en=new WeakMap,Lt=new WeakMap,cs=new WeakMap,Ja=new WeakMap,Za=new WeakMap,el=new WeakMap,su=new WeakSet,Kp=function(e,t){return H._normalizePoint(e,t,l(this,Za),l(this,el),l(this,Qa))};var tn,Sf,xf,Hn,mi,yi,iu,ru,tl,Nt,Ii,eC,tC,nC;class Bf extends H{constructor(){super(...arguments);A(this,Nt);A(this,tn);A(this,Sf,0);A(this,xf);A(this,Hn);A(this,mi);A(this,yi);A(this,iu);A(this,ru);A(this,tl)}build(t,s,i,r,o,a,c){m(this,mi,s),m(this,yi,i),m(this,iu,r),m(this,ru,o),m(this,tl,a),m(this,xf,c??0),m(this,Hn,t),S(this,Nt,tC).call(this)}get thickness(){return l(this,tl)}setLastElement(t){return l(this,Hn).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return l(this,Hn).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:s}of l(this,Hn)){if(t.push(`M${H.svgRound(s[4])} ${H.svgRound(s[5])}`),s.length===6){t.push("Z");continue}if(s.length===12&&isNaN(s[6])){t.push(`L${H.svgRound(s[10])} ${H.svgRound(s[11])}`);continue}for(let i=6,r=s.length;i<r;i+=6){const[o,a,c,u,d,h]=s.subarray(i,i+6).map(H.svgRound);t.push(`C${o} ${a} ${c} ${u} ${d} ${h}`)}}return t.join("")}serialize([t,s,i,r],o){const a=[],c=[],[u,d,h,f]=S(this,Nt,eC).call(this);let p,v,g,x,y,w,b,E,_;switch(l(this,ru)){case 0:_=H._rescale,p=t,v=s+r,g=i,x=-r,y=t+u*i,w=s+(1-d-f)*r,b=t+(u+h)*i,E=s+(1-d)*r;break;case 90:_=H._rescaleAndSwap,p=t,v=s,g=i,x=r,y=t+d*i,w=s+u*r,b=t+(d+f)*i,E=s+(u+h)*r;break;case 180:_=H._rescale,p=t+i,v=s,g=-i,x=r,y=t+(1-u-h)*i,w=s+d*r,b=t+(1-u)*i,E=s+(d+f)*r;break;case 270:_=H._rescaleAndSwap,p=t+i,v=s+r,g=-i,x=-r,y=t+(1-d-f)*i,w=s+(1-u-h)*r,b=t+(1-d)*i,E=s+(1-u)*r;break}for(const{line:k,points:C}of l(this,Hn))a.push(_(k,p,v,g,x,o?new Array(k.length):null)),c.push(_(C,p,v,g,x,o?new Array(C.length):null));return{lines:a,points:c,rect:[y,w,b,E]}}static deserialize(t,s,i,r,o,{paths:{lines:a,points:c},rotation:u,thickness:d}){const h=[];let f,p,v,g,x;switch(u){case 0:x=H._rescale,f=-t/i,p=s/r+1,v=1/i,g=-1/r;break;case 90:x=H._rescaleAndSwap,f=-s/r,p=-t/i,v=1/r,g=1/i;break;case 180:x=H._rescale,f=t/i+1,p=-s/r,v=-1/i,g=1/r;break;case 270:x=H._rescaleAndSwap,f=s/r+1,p=t/i+1,v=-1/r,g=-1/i;break}if(!a){a=[];for(const w of c){const b=w.length;if(b===2){a.push(new Float32Array([NaN,NaN,NaN,NaN,w[0],w[1]]));continue}if(b===4){a.push(new Float32Array([NaN,NaN,NaN,NaN,w[0],w[1],NaN,NaN,NaN,NaN,w[2],w[3]]));continue}const E=new Float32Array(3*(b-2));a.push(E);let[_,k,C,P]=w.subarray(0,4);E.set([NaN,NaN,NaN,NaN,_,k],0);for(let L=4;L<b;L+=2){const M=w[L],D=w[L+1];E.set(H.createBezierPoints(_,k,C,P,M,D),(L-2)*3),[_,k,C,P]=[C,P,M,D]}}}for(let w=0,b=a.length;w<b;w++)h.push({line:x(a[w].map(E=>E??NaN),f,p,v,g),points:x(c[w].map(E=>E??NaN),f,p,v,g)});const y=new this.prototype.constructor;return y.build(h,i,r,1,u,d,o),y}get box(){return l(this,tn)}updateProperty(t,s){return t==="stroke-width"?S(this,Nt,nC).call(this,s):null}updateParentDimensions([t,s],i){const[r,o]=S(this,Nt,Ii).call(this);m(this,mi,t),m(this,yi,s),m(this,iu,i);const[a,c]=S(this,Nt,Ii).call(this),u=a-r,d=c-o,h=l(this,tn);return h[0]-=u,h[1]-=d,h[2]+=2*u,h[3]+=2*d,h}updateRotation(t){return m(this,Sf,t),{path:{transform:this.rotationTransform}}}get viewBox(){return l(this,tn).map(H.svgRound).join(" ")}get defaultProperties(){const[t,s]=l(this,tn);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${H.svgRound(t)} ${H.svgRound(s)}`}}}get rotationTransform(){const[,,t,s]=l(this,tn);let i=0,r=0,o=0,a=0,c=0,u=0;switch(l(this,Sf)){case 90:r=s/t,o=-t/s,c=t;break;case 180:i=-1,a=-1,c=t,u=s;break;case 270:r=-s/t,o=t/s,u=s;break;default:return""}return`matrix(${i} ${r} ${o} ${a} ${H.svgRound(c)} ${H.svgRound(u)})`}getPathResizingSVGProperties([t,s,i,r]){const[o,a]=S(this,Nt,Ii).call(this),[c,u,d,h]=l(this,tn);if(Math.abs(d-o)<=H.PRECISION||Math.abs(h-a)<=H.PRECISION){const x=t+i/2-(c+d/2),y=s+r/2-(u+h/2);return{path:{"transform-origin":`${H.svgRound(t)} ${H.svgRound(s)}`,transform:`${this.rotationTransform} translate(${x} ${y})`}}}const f=(i-2*o)/(d-2*o),p=(r-2*a)/(h-2*a),v=d/i,g=h/r;return{path:{"transform-origin":`${H.svgRound(c)} ${H.svgRound(u)}`,transform:`${this.rotationTransform} scale(${v} ${g}) translate(${H.svgRound(o)} ${H.svgRound(a)}) scale(${f} ${p}) translate(${H.svgRound(-o)} ${H.svgRound(-a)})`}}}getPathResizedSVGProperties([t,s,i,r]){const[o,a]=S(this,Nt,Ii).call(this),c=l(this,tn),[u,d,h,f]=c;if(c[0]=t,c[1]=s,c[2]=i,c[3]=r,Math.abs(h-o)<=H.PRECISION||Math.abs(f-a)<=H.PRECISION){const y=t+i/2-(u+h/2),w=s+r/2-(d+f/2);for(const{line:b,points:E}of l(this,Hn))H._translate(b,y,w,b),H._translate(E,y,w,E);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${H.svgRound(t)} ${H.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const p=(i-2*o)/(h-2*o),v=(r-2*a)/(f-2*a),g=-p*(u+o)+t+o,x=-v*(d+a)+s+a;if(p!==1||v!==1||g!==0||x!==0)for(const{line:y,points:w}of l(this,Hn))H._rescale(y,g,x,p,v,y),H._rescale(w,g,x,p,v,w);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${H.svgRound(t)} ${H.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,s],i){const[r,o]=i,a=l(this,tn),c=t-a[0],u=s-a[1];if(l(this,mi)===r&&l(this,yi)===o)for(const{line:d,points:h}of l(this,Hn))H._translate(d,c,u,d),H._translate(h,c,u,h);else{const d=l(this,mi)/r,h=l(this,yi)/o;m(this,mi,r),m(this,yi,o);for(const{line:f,points:p}of l(this,Hn))H._rescale(f,c,u,d,h,f),H._rescale(p,c,u,d,h,p);a[2]*=d,a[3]*=h}return a[0]=t,a[1]=s,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${H.svgRound(t)} ${H.svgRound(s)}`}}}get defaultSVGProperties(){const t=l(this,tn);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${H.svgRound(t[0])} ${H.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}tn=new WeakMap,Sf=new WeakMap,xf=new WeakMap,Hn=new WeakMap,mi=new WeakMap,yi=new WeakMap,iu=new WeakMap,ru=new WeakMap,tl=new WeakMap,Nt=new WeakSet,Ii=function(t=l(this,tl)){const s=l(this,xf)+t/2*l(this,iu);return l(this,ru)%180===0?[s/l(this,mi),s/l(this,yi)]:[s/l(this,yi),s/l(this,mi)]},eC=function(){const[t,s,i,r]=l(this,tn),[o,a]=S(this,Nt,Ii).call(this,0);return[t+o,s+a,i-2*o,r-2*a]},tC=function(){const t=m(this,tn,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:r}of l(this,Hn)){if(r.length<=12){for(let c=4,u=r.length;c<u;c+=6)Y.pointBoundingBox(r[c],r[c+1],t);continue}let o=r[4],a=r[5];for(let c=6,u=r.length;c<u;c+=6){const[d,h,f,p,v,g]=r.subarray(c,c+6);Y.bezierBoundingBox(o,a,d,h,f,p,v,g,t),o=v,a=g}}const[s,i]=S(this,Nt,Ii).call(this);t[0]=Xt(t[0]-s,0,1),t[1]=Xt(t[1]-i,0,1),t[2]=Xt(t[2]+s,0,1),t[3]=Xt(t[3]+i,0,1),t[2]-=t[0],t[3]-=t[1]},nC=function(t){const[s,i]=S(this,Nt,Ii).call(this);m(this,tl,t);const[r,o]=S(this,Nt,Ii).call(this),[a,c]=[r-s,o-i],u=l(this,tn);return u[0]-=a,u[1]-=c,u[2]+=2*a,u[3]+=2*c,u};class Mm extends J_{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:Me._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??(t=this["stroke-width"]),t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new Mm(this._viewParameters);return e.updateAll(this),e}}var sm,sC;const Wl=class Wl extends Fg{constructor(t){super({...t,name:"inkEditor"});A(this,sm);this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,s){Me.initialize(t,s),this._defaultDrawingOptions=new Mm(s.viewParameters)}static getDefaultDrawingOptions(t){const s=this._defaultDrawingOptions.clone();return s.updateProperties(t),s}static get supportMultipleDrawings(){return!0}static get typesMap(){return le(this,"typesMap",new Map([[de.INK_THICKNESS,"stroke-width"],[de.INK_COLOR,"stroke"],[de.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,s,i,r,o){return new uM(t,s,i,r,o,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,s,i,r,o,a){return Bf.deserialize(t,s,i,r,o,a)}static async deserialize(t,s,i){let r=null;if(t instanceof Jw){const{data:{inkLists:a,rect:c,rotation:u,id:d,color:h,opacity:f,borderStyle:{rawWidth:p},popupRef:v},parent:{page:{pageNumber:g}}}=t;r=t={annotationType:ee.INK,color:Array.from(h),thickness:p,opacity:f,paths:{points:a},boxes:null,pageIndex:g-1,rect:c.slice(0),rotation:u,id:d,deleted:!1,popupRef:v}}const o=await super.deserialize(t,s,i);return o.annotationElementId=t.id||null,o._initialData=r,o}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:s,parent:i}=this;s.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(t,s.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:s,opacity:i}){this._drawingOptions=Wl.getDefaultDrawingOptions({stroke:Y.makeHexColor(...t),"stroke-width":s,"stroke-opacity":i})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:s,points:i,rect:r}=this.serializeDraw(t),{_drawingOptions:{stroke:o,"stroke-opacity":a,"stroke-width":c}}=this,u={annotationType:ee.INK,color:Me._colorManager.convert(o),opacity:a,thickness:c,paths:{lines:s,points:i},pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?(u.isCopy=!0,u):this.annotationElementId&&!S(this,sm,sC).call(this,u)?null:(u.id=this.annotationElementId,u)}renderAnnotationElement(t){const{points:s,rect:i}=this.serializeDraw(!1);return t.updateEdited({rect:i,thickness:this._drawingOptions["stroke-width"],points:s}),null}};sm=new WeakSet,sC=function(t){const{color:s,thickness:i,opacity:r,pageIndex:o}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||t.color.some((a,c)=>a!==s[c])||t.thickness!==i||t.opacity!==r||t.pageIndex!==o},F(Wl,"_type","ink"),F(Wl,"_editorType",ee.INK),F(Wl,"_defaultDrawingOptions",null);let E0=Wl;class _0 extends Bf{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const fp=8,Hu=3;var nl,we,C0,Fs,iC,rC,k0,Qp,oC,aC,lC,T0,P0,cC;class Si{static extractContoursFromText(e,{fontFamily:t,fontStyle:s,fontWeight:i},r,o,a,c){let u=new OffscreenCanvas(1,1),d=u.getContext("2d",{alpha:!1});const h=200,f=d.font=`${s} ${i} ${h}px ${t}`,{actualBoundingBoxLeft:p,actualBoundingBoxRight:v,actualBoundingBoxAscent:g,actualBoundingBoxDescent:x,fontBoundingBoxAscent:y,fontBoundingBoxDescent:w,width:b}=d.measureText(e),E=1.5,_=Math.ceil(Math.max(Math.abs(p)+Math.abs(v)||0,b)*E),k=Math.ceil(Math.max(Math.abs(g)+Math.abs(x)||h,Math.abs(y)+Math.abs(w)||h)*E);u=new OffscreenCanvas(_,k),d=u.getContext("2d",{alpha:!0,willReadFrequently:!0}),d.font=f,d.filter="grayscale(1)",d.fillStyle="white",d.fillRect(0,0,_,k),d.fillStyle="black",d.fillText(e,_*(E-1)/2,k*(3-E)/2);const C=S(this,we,T0).call(this,d.getImageData(0,0,_,k).data),P=S(this,we,lC).call(this,C),L=S(this,we,P0).call(this,P),M=S(this,we,k0).call(this,C,_,k,L);return this.processDrawnLines({lines:{curves:M,width:_,height:k},pageWidth:r,pageHeight:o,rotation:a,innerMargin:c,mustSmooth:!0,areContours:!0})}static process(e,t,s,i,r){const[o,a,c]=S(this,we,cC).call(this,e),[u,d]=S(this,we,aC).call(this,o,a,c,Math.hypot(a,c)*l(this,nl).sigmaSFactor,l(this,nl).sigmaR,l(this,nl).kernelSize),h=S(this,we,P0).call(this,d),f=S(this,we,k0).call(this,u,a,c,h);return this.processDrawnLines({lines:{curves:f,width:a,height:c},pageWidth:t,pageHeight:s,rotation:i,innerMargin:r,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:s,rotation:i,innerMargin:r,mustSmooth:o,areContours:a}){i%180!==0&&([t,s]=[s,t]);const{curves:c,width:u,height:d}=e,h=e.thickness??0,f=[],p=Math.min(t/u,s/d),v=p/t,g=p/s,x=[];for(const{points:w}of c){const b=o?S(this,we,oC).call(this,w):w;if(!b)continue;x.push(b);const E=b.length,_=new Float32Array(E),k=new Float32Array(3*(E===2?2:E-2));if(f.push({line:k,points:_}),E===2){_[0]=b[0]*v,_[1]=b[1]*g,k.set([NaN,NaN,NaN,NaN,_[0],_[1]],0);continue}let[C,P,L,M]=b;C*=v,P*=g,L*=v,M*=g,_.set([C,P,L,M],0),k.set([NaN,NaN,NaN,NaN,C,P],0);for(let D=4;D<E;D+=2){const K=_[D]=b[D]*v,Q=_[D+1]=b[D+1]*g;k.set(H.createBezierPoints(C,P,L,M,K,Q),(D-2)*3),[C,P,L,M]=[L,M,K,Q]}}if(f.length===0)return null;const y=a?new _0:new Bf;return y.build(f,t,s,1,i,a?0:h,r),{outline:y,newCurves:x,areContours:a,thickness:h,width:u,height:d}}static async compressSignature({outlines:e,areContours:t,thickness:s,width:i,height:r}){let o=1/0,a=-1/0,c=0;for(const b of e){c+=b.length;for(let E=2,_=b.length;E<_;E++){const k=b[E]-b[E-2];o=Math.min(o,k),a=Math.max(a,k)}}let u;o>=-128&&a<=127?u=Int8Array:o>=-32768&&a<=32767?u=Int16Array:u=Int32Array;const d=e.length,h=fp+Hu*d,f=new Uint32Array(h);let p=0;f[p++]=h*Uint32Array.BYTES_PER_ELEMENT+(c-2*d)*u.BYTES_PER_ELEMENT,f[p++]=0,f[p++]=i,f[p++]=r,f[p++]=t?0:1,f[p++]=Math.max(0,Math.floor(s??0)),f[p++]=d,f[p++]=u.BYTES_PER_ELEMENT;for(const b of e)f[p++]=b.length-2,f[p++]=b[0],f[p++]=b[1];const v=new CompressionStream("deflate-raw"),g=v.writable.getWriter();await g.ready,g.write(f);const x=u.prototype.constructor;for(const b of e){const E=new x(b.length-2);for(let _=2,k=b.length;_<k;_++)E[_-2]=b[_]-b[_-2];g.write(E)}g.close();const y=await new Response(v.readable).arrayBuffer(),w=new Uint8Array(y);return r1(w)}static async decompressSignature(e){try{const t=BL(e),{readable:s,writable:i}=new DecompressionStream("deflate-raw"),r=i.getWriter();await r.ready,r.write(t).then(async()=>{await r.ready,await r.close()}).catch(()=>{});let o=null,a=0;for await(const b of s)o||(o=new Uint8Array(new Uint32Array(b.buffer,0,4)[0])),o.set(b,a),a+=b.length;const c=new Uint32Array(o.buffer,0,o.length>>2),u=c[1];if(u!==0)throw new Error(`Invalid version: ${u}`);const d=c[2],h=c[3],f=c[4]===0,p=c[5],v=c[6],g=c[7],x=[],y=(fp+Hu*v)*Uint32Array.BYTES_PER_ELEMENT;let w;switch(g){case Int8Array.BYTES_PER_ELEMENT:w=new Int8Array(o.buffer,y);break;case Int16Array.BYTES_PER_ELEMENT:w=new Int16Array(o.buffer,y);break;case Int32Array.BYTES_PER_ELEMENT:w=new Int32Array(o.buffer,y);break}a=0;for(let b=0;b<v;b++){const E=c[Hu*b+fp],_=new Float32Array(E+2);x.push(_);for(let k=0;k<Hu-1;k++)_[k]=c[Hu*b+fp+k+1];for(let k=0;k<E;k++)_[k+2]=_[k]+w[a++]}return{areContours:f,thickness:p,outlines:x,width:d,height:h}}catch(t){return ne(`decompressSignature: ${t}`),null}}}nl=new WeakMap,we=new WeakSet,C0=function(e,t,s,i){return s-=e,i-=t,s===0?i>0?0:4:s===1?i+6:2-i},Fs=new WeakMap,iC=function(e,t,s,i,r,o,a){const c=S(this,we,C0).call(this,s,i,r,o);for(let u=0;u<8;u++){const d=(-u+c-a+16)%8,h=l(this,Fs)[2*d],f=l(this,Fs)[2*d+1];if(e[(s+h)*t+(i+f)]!==0)return d}return-1},rC=function(e,t,s,i,r,o,a){const c=S(this,we,C0).call(this,s,i,r,o);for(let u=0;u<8;u++){const d=(u+c+a+16)%8,h=l(this,Fs)[2*d],f=l(this,Fs)[2*d+1];if(e[(s+h)*t+(i+f)]!==0)return d}return-1},k0=function(e,t,s,i){const r=e.length,o=new Int32Array(r);for(let d=0;d<r;d++)o[d]=e[d]<=i?1:0;for(let d=1;d<s-1;d++)o[d*t]=o[d*t+t-1]=0;for(let d=0;d<t;d++)o[d]=o[t*s-1-d]=0;let a=1,c;const u=[];for(let d=1;d<s-1;d++){c=1;for(let h=1;h<t-1;h++){const f=d*t+h,p=o[f];if(p===0)continue;let v=d,g=h;if(p===1&&o[f-1]===0)a+=1,g-=1;else if(p>=1&&o[f+1]===0)a+=1,g+=1,p>1&&(c=p);else{p!==1&&(c=Math.abs(p));continue}const x=[h,d],y=g===h+1,w={isHole:y,points:x,id:a,parent:0};u.push(w);let b;for(const D of u)if(D.id===c){b=D;break}b?b.isHole?w.parent=y?b.parent:c:w.parent=y?c:b.parent:w.parent=y?c:0;const E=S(this,we,iC).call(this,o,t,d,h,v,g,0);if(E===-1){o[f]=-a,o[f]!==1&&(c=Math.abs(o[f]));continue}let _=l(this,Fs)[2*E],k=l(this,Fs)[2*E+1];const C=d+_,P=h+k;v=C,g=P;let L=d,M=h;for(;;){const D=S(this,we,rC).call(this,o,t,L,M,v,g,1);_=l(this,Fs)[2*D],k=l(this,Fs)[2*D+1];const K=L+_,Q=M+k;x.push(Q,K);const G=L*t+M;if(o[G+1]===0?o[G]=-a:o[G]===1&&(o[G]=a),K===d&&Q===h&&L===C&&M===P){o[f]!==1&&(c=Math.abs(o[f]));break}else v=L,g=M,L=K,M=Q}}}return u},Qp=function(e,t,s,i){if(s-t<=4){for(let C=t;C<s-2;C+=2)i.push(e[C],e[C+1]);return}const r=e[t],o=e[t+1],a=e[s-4]-r,c=e[s-3]-o,u=Math.hypot(a,c),d=a/u,h=c/u,f=d*o-h*r,p=c/a,v=1/u,g=Math.atan(p),x=Math.cos(g),y=Math.sin(g),w=v*(Math.abs(x)+Math.abs(y)),b=v*(1-w+w**2),E=Math.max(Math.atan(Math.abs(y+x)*b),Math.atan(Math.abs(y-x)*b));let _=0,k=t;for(let C=t+2;C<s-2;C+=2){const P=Math.abs(f-d*e[C+1]+h*e[C]);P>_&&(k=C,_=P)}_>(u*E)**2?(S(this,we,Qp).call(this,e,t,k+2,i),S(this,we,Qp).call(this,e,k,s,i)):i.push(r,o)},oC=function(e){const t=[],s=e.length;return S(this,we,Qp).call(this,e,0,s,t),t.push(e[s-2],e[s-1]),t.length<=4?null:t},aC=function(e,t,s,i,r,o){const a=new Float32Array(o**2),c=-2*i**2,u=o>>1;for(let g=0;g<o;g++){const x=(g-u)**2;for(let y=0;y<o;y++)a[g*o+y]=Math.exp((x+(y-u)**2)/c)}const d=new Float32Array(256),h=-2*r**2;for(let g=0;g<256;g++)d[g]=Math.exp(g**2/h);const f=e.length,p=new Uint8Array(f),v=new Uint32Array(256);for(let g=0;g<s;g++)for(let x=0;x<t;x++){const y=g*t+x,w=e[y];let b=0,E=0;for(let k=0;k<o;k++){const C=g+k-u;if(!(C<0||C>=s))for(let P=0;P<o;P++){const L=x+P-u;if(L<0||L>=t)continue;const M=e[C*t+L],D=a[k*o+P]*d[Math.abs(M-w)];b+=M*D,E+=D}}const _=p[y]=Math.round(b/E);v[_]++}return[p,v]},lC=function(e){const t=new Uint32Array(256);for(const s of e)t[s]++;return t},T0=function(e){const t=e.length,s=new Uint8ClampedArray(t>>2);let i=-1/0,r=1/0;for(let a=0,c=s.length;a<c;a++){if(e[(a<<2)+3]===0){i=s[a]=255;continue}const d=s[a]=e[a<<2];d>i&&(i=d),d<r&&(r=d)}const o=255/(i-r);for(let a=0;a<t;a++)s[a]=(s[a]-r)*o;return s},P0=function(e){let t,s=-1/0,i=-1/0;const r=e.findIndex(c=>c!==0);let o=r,a=r;for(t=r;t<256;t++){const c=e[t];c>s&&(t-o>i&&(i=t-o,a=t-1),s=c,o=t)}for(t=a-1;t>=0&&!(e[t]>e[t+1]);t--);return t},cC=function(e){const t=e,{width:s,height:i}=e,{maxDim:r}=l(this,nl);let o=s,a=i;if(s>r||i>r){let f=s,p=i,v=Math.log2(Math.max(s,i)/r);const g=Math.floor(v);v=v===g?g-1:g;for(let y=0;y<v;y++){o=Math.ceil(f/2),a=Math.ceil(p/2);const w=new OffscreenCanvas(o,a);w.getContext("2d").drawImage(e,0,0,f,p,0,0,o,a),f=o,p=a,e!==t&&e.close(),e=w.transferToImageBitmap()}const x=Math.min(r/o,r/a);o=Math.round(o*x),a=Math.round(a*x)}const u=new OffscreenCanvas(o,a).getContext("2d",{willReadFrequently:!0});u.filter="grayscale(1)",u.drawImage(e,0,0,e.width,e.height,0,0,o,a);const d=u.getImageData(0,0,o,a).data;return[S(this,we,T0).call(this,d),o,a]},A(Si,we),A(Si,nl,{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}),A(Si,Fs,new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]));class eb extends J_{constructor(){super(),super.updateProperties({fill:Me._defaultLineColor,"stroke-width":0})}clone(){const e=new eb;return e.updateAll(this),e}}class tb extends Mm{constructor(e){super(e),super.updateProperties({stroke:Me._defaultLineColor,"stroke-width":1})}clone(){const e=new tb(this._viewParameters);return e.updateAll(this),e}}var go,Un,mo,yo;const Ln=class Ln extends Fg{constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"});A(this,go,!1);A(this,Un,null);A(this,mo,null);A(this,yo,null);this._willKeepAspectRatio=!0,m(this,mo,t.signatureData||null),m(this,Un,null),this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,s){Me.initialize(t,s),this._defaultDrawingOptions=new eb,this._defaultDrawnSignatureOptions=new tb(s.viewParameters)}static getDefaultDrawingOptions(t){const s=this._defaultDrawingOptions.clone();return s.updateProperties(t),s}static get supportMultipleDrawings(){return!1}static get typesMap(){return le(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!l(this,Un)}}static computeTelemetryFinalData(t){const s=t.get("hasDescription");return{hasAltText:s.get(!0)??0,hasNoAltText:s.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,s;const{_isCopy:i}=this;if(i&&(this._isCopy=!1,t=this.x,s=this.y),super.render(),this._drawId===null)if(l(this,mo)){const{lines:r,mustSmooth:o,areContours:a,description:c,uuid:u,heightInPage:d}=l(this,mo),{rawDims:{pageWidth:h,pageHeight:f},rotation:p}=this.parent.viewport,v=Si.processDrawnLines({lines:r,pageWidth:h,pageHeight:f,rotation:p,innerMargin:Ln._INNER_MARGIN,mustSmooth:o,areContours:a});this.addSignature(v,d,c,u)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);return i&&(this._isCopy=!0,this._moveAfterPaste(t,s)),this.div}setUuid(t){m(this,yo,t),this.addEditToolbar()}getUuid(){return l(this,yo)}get description(){return l(this,Un)}set description(t){m(this,Un,t),super.addEditToolbar().then(s=>{s==null||s.updateEditSignatureButton(t)})}getSignaturePreview(){const{newCurves:t,areContours:s,thickness:i,width:r,height:o}=l(this,mo),a=Math.max(r,o),c=Si.processDrawnLines({lines:{curves:t.map(u=>({points:u})),thickness:i,width:r,height:o},pageWidth:a,pageHeight:a,rotation:0,innerMargin:0,mustSmooth:!1,areContours:s});return{areContours:s,outline:c.outline}}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.signatureManager&&l(this,Un)!==null&&(await t.addEditSignatureButton(this._uiManager.signatureManager,l(this,yo),l(this,Un)),t.show()),t):null}addSignature(t,s,i,r){const{x:o,y:a}=this,{outline:c}=m(this,mo,t);m(this,go,c instanceof _0),m(this,Un,i),this.div.setAttribute("data-l10n-args",JSON.stringify({description:i}));let u;l(this,go)?u=Ln.getDefaultDrawingOptions():(u=Ln._defaultDrawnSignatureOptions.clone(),u.updateProperties({"stroke-width":c.thickness})),this._addOutlines({drawOutlines:c,drawingOptions:u});const[d,h]=this.parentDimensions,[,f]=this.pageDimensions;let p=s/f;p=p>=1?.5:p,this.width*=p/this.height,this.width>=1&&(p*=.9/this.width,this.width=.9),this.height=p,this.setDims(d*this.width,h*this.height),this.x=o,this.y=a,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(r),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!r,hasDescription:!!i}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:s,pageHeight:i},rotation:r}=this.parent.viewport;return Si.process(t,s,i,r,Ln._INNER_MARGIN)}getFromText(t,s){const{rawDims:{pageWidth:i,pageHeight:r},rotation:o}=this.parent.viewport;return Si.extractContoursFromText(t,s,i,r,o,Ln._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:s,pageHeight:i},rotation:r}=this.parent.viewport;return Si.processDrawnLines({lines:t,pageWidth:s,pageHeight:i,rotation:r,innerMargin:Ln._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:s}){t?this._drawingOptions=Ln.getDefaultDrawingOptions():(this._drawingOptions=Ln._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":s}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:s,points:i,rect:r}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":o}}=this,a={annotationType:ee.SIGNATURE,isSignature:!0,areContours:l(this,go),color:[0,0,0],thickness:l(this,go)?0:o,pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?(a.paths={lines:s,points:i},a.uuid=l(this,yo),a.isCopy=!0):a.lines=s,l(this,Un)&&(a.accessibilityData={type:"Figure",alt:l(this,Un)}),a}static deserializeDraw(t,s,i,r,o,a){return a.areContours?_0.deserialize(t,s,i,r,o,a):Bf.deserialize(t,s,i,r,o,a)}static async deserialize(t,s,i){var o;const r=await super.deserialize(t,s,i);return m(r,go,t.areContours),m(r,Un,((o=t.accessibilityData)==null?void 0:o.alt)||""),m(r,yo,t.uuid),r}};go=new WeakMap,Un=new WeakMap,mo=new WeakMap,yo=new WeakMap,F(Ln,"_type","signature"),F(Ln,"_editorType",ee.SIGNATURE),F(Ln,"_defaultDrawingOptions",null);let R0=Ln;var Fe,bt,vo,ur,wo,ou,dr,sl,vi,Vn,au,ye,ud,dd,Jp,Zp,eg,M0,tg,uC;class L0 extends Me{constructor(t){super({...t,name:"stampEditor"});A(this,ye);A(this,Fe,null);A(this,bt,null);A(this,vo,null);A(this,ur,null);A(this,wo,null);A(this,ou,"");A(this,dr,null);A(this,sl,!1);A(this,vi,null);A(this,Vn,!1);A(this,au,!1);m(this,ur,t.bitmapUrl),m(this,wo,t.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,s){Me.initialize(t,s)}static isHandlingMimeForPasting(t){return Dg.includes(t)}static paste(t,s){s.pasteEditor({mode:ee.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const s=t.get("hasAltText");return{hasAltText:s.get(!0)??0,hasNoAltText:s.get(!1)??0}}async mlGuessAltText(t=null,s=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:o,height:a}=t||this.copyCanvas(null,null,!0).imageData,c=await i.guess({name:"altText",request:{data:r,width:o,height:a,channels:r.length/(o*a)}});if(!c)throw new Error("No response from the AI service.");if(c.error)throw new Error("Error from the AI service.");if(c.cancel)return null;if(!c.output)throw new Error("No valid response from the AI service.");const u=c.output;return await this.setGuessedAltText(u),s&&!this.hasAltTextData()&&(this.altTextData={alt:u,decorative:!1}),u}remove(){var t;l(this,bt)&&(m(this,Fe,null),this._uiManager.imageManager.deleteId(l(this,bt)),(t=l(this,dr))==null||t.remove(),m(this,dr,null),l(this,vi)&&(clearTimeout(l(this,vi)),m(this,vi,null))),super.remove()}rebuild(){if(!this.parent){l(this,bt)&&S(this,ye,Jp).call(this);return}super.rebuild(),this.div!==null&&(l(this,bt)&&l(this,dr)===null&&S(this,ye,Jp).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(l(this,vo)||l(this,Fe)||l(this,ur)||l(this,wo)||l(this,bt)||l(this,sl))}get isResizable(){return!0}render(){if(this.div)return this.div;let t,s;return this._isCopy&&(t=this.x,s=this.y),super.render(),this.div.hidden=!0,this.addAltTextButton(),l(this,sl)||(l(this,Fe)?S(this,ye,Zp).call(this):S(this,ye,Jp).call(this)),this._isCopy&&this._moveAfterPaste(t,s),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,s){const{id:i,bitmap:r}=this._uiManager.imageManager.getFromCanvas(t,s);s.remove(),i&&this._uiManager.imageManager.isValidId(i)&&(m(this,bt,i),r&&m(this,Fe,r),m(this,sl,!1),S(this,ye,Zp).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;l(this,vi)!==null&&clearTimeout(l(this,vi)),m(this,vi,setTimeout(()=>{m(this,vi,null),S(this,ye,M0).call(this)},200))}copyCanvas(t,s,i=!1){var p;t||(t=224);const{width:r,height:o}=l(this,Fe),a=new Xs;let c=l(this,Fe),u=r,d=o,h=null;if(s){if(r>s||o>s){const P=Math.min(s/r,s/o);u=Math.floor(r*P),d=Math.floor(o*P)}h=document.createElement("canvas");const v=h.width=Math.ceil(u*a.sx),g=h.height=Math.ceil(d*a.sy);l(this,Vn)||(c=S(this,ye,eg).call(this,v,g));const x=h.getContext("2d");x.filter=this._uiManager.hcmFilter;let y="white",w="#cfcfd8";this._uiManager.hcmFilter!=="none"?w="black":(p=window.matchMedia)!=null&&p.call(window,"(prefers-color-scheme: dark)").matches&&(y="#8f8f9d",w="#42414d");const b=15,E=b*a.sx,_=b*a.sy,k=new OffscreenCanvas(E*2,_*2),C=k.getContext("2d");C.fillStyle=y,C.fillRect(0,0,E*2,_*2),C.fillStyle=w,C.fillRect(0,0,E,_),C.fillRect(E,_,E,_),x.fillStyle=x.createPattern(k,"repeat"),x.fillRect(0,0,v,g),x.drawImage(c,0,0,c.width,c.height,0,0,v,g)}let f=null;if(i){let v,g;if(a.symmetric&&c.width<t&&c.height<t)v=c.width,g=c.height;else if(c=l(this,Fe),r>t||o>t){const w=Math.min(t/r,t/o);v=Math.floor(r*w),g=Math.floor(o*w),l(this,Vn)||(c=S(this,ye,eg).call(this,v,g))}const y=new OffscreenCanvas(v,g).getContext("2d",{willReadFrequently:!0});y.drawImage(c,0,0,c.width,c.height,0,0,v,g),f={width:v,height:g,data:y.getImageData(0,0,v,g).data}}return{canvas:h,width:u,height:d,imageData:f}}static async deserialize(t,s,i){var x;let r=null,o=!1;if(t instanceof __){const{data:{rect:y,rotation:w,id:b,structParent:E,popupRef:_},container:k,parent:{page:{pageNumber:C}},canvas:P}=t;let L,M;P?(delete t.canvas,{id:L,bitmap:M}=i.imageManager.getFromCanvas(k.id,P),P.remove()):(o=!0,t._hasNoCanvas=!0);const D=((x=await s._structTree.getAriaAttributes(`${Vw}${b}`))==null?void 0:x.get("aria-label"))||"";r=t={annotationType:ee.STAMP,bitmapId:L,bitmap:M,pageIndex:C-1,rect:y.slice(0),rotation:w,id:b,deleted:!1,accessibilityData:{decorative:!1,altText:D},isSvg:!1,structParent:E,popupRef:_}}const a=await super.deserialize(t,s,i),{rect:c,bitmap:u,bitmapUrl:d,bitmapId:h,isSvg:f,accessibilityData:p}=t;o?(i.addMissingCanvas(t.id,a),m(a,sl,!0)):h&&i.imageManager.isValidId(h)?(m(a,bt,h),u&&m(a,Fe,u)):m(a,ur,d),m(a,Vn,f);const[v,g]=a.pageDimensions;return a.width=(c[2]-c[0])/v,a.height=(c[3]-c[1])/g,a.annotationElementId=t.id||null,p&&(a.altTextData=p),a._initialData=r,m(a,au,!!r),a}serialize(t=!1,s=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i={annotationType:ee.STAMP,bitmapId:l(this,bt),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:l(this,Vn),structTreeParentId:this._structTreeParentId};if(t)return i.bitmapUrl=S(this,ye,tg).call(this,!0),i.accessibilityData=this.serializeAltText(!0),i.isCopy=!0,i;const{decorative:r,altText:o}=this.serializeAltText(!1);if(!r&&o&&(i.accessibilityData={type:"Figure",alt:o}),this.annotationElementId){const c=S(this,ye,uC).call(this,i);if(c.isSame)return null;c.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1}if(i.id=this.annotationElementId,s===null)return i;s.stamps||(s.stamps=new Map);const a=l(this,Vn)?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!s.stamps.has(l(this,bt)))s.stamps.set(l(this,bt),{area:a,serialized:i}),i.bitmap=S(this,ye,tg).call(this,!1);else if(l(this,Vn)){const c=s.stamps.get(l(this,bt));a>c.area&&(c.area=a,c.serialized.bitmap.close(),c.serialized.bitmap=S(this,ye,tg).call(this,!1))}return i}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}}Fe=new WeakMap,bt=new WeakMap,vo=new WeakMap,ur=new WeakMap,wo=new WeakMap,ou=new WeakMap,dr=new WeakMap,sl=new WeakMap,vi=new WeakMap,Vn=new WeakMap,au=new WeakMap,ye=new WeakSet,ud=function(t,s=!1){if(!t){this.remove();return}m(this,Fe,t.bitmap),s||(m(this,bt,t.id),m(this,Vn,t.isSvg)),t.file&&m(this,ou,t.file.name),S(this,ye,Zp).call(this)},dd=function(){if(m(this,vo,null),this._uiManager.enableWaiting(!1),!!l(this,dr)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&l(this,Fe)){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&l(this,Fe)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},Jp=function(){if(l(this,bt)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(l(this,bt)).then(i=>S(this,ye,ud).call(this,i,!0)).finally(()=>S(this,ye,dd).call(this));return}if(l(this,ur)){const i=l(this,ur);m(this,ur,null),this._uiManager.enableWaiting(!0),m(this,vo,this._uiManager.imageManager.getFromUrl(i).then(r=>S(this,ye,ud).call(this,r)).finally(()=>S(this,ye,dd).call(this)));return}if(l(this,wo)){const i=l(this,wo);m(this,wo,null),this._uiManager.enableWaiting(!0),m(this,vo,this._uiManager.imageManager.getFromFile(i).then(r=>S(this,ye,ud).call(this,r)).finally(()=>S(this,ye,dd).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=Dg.join(",");const s=this._uiManager._signal;m(this,vo,new Promise(i=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),S(this,ye,ud).call(this,r)}i()},{signal:s}),t.addEventListener("cancel",()=>{this.remove(),i()},{signal:s})}).finally(()=>S(this,ye,dd).call(this))),t.click()},Zp=function(){var h;const{div:t}=this;let{width:s,height:i}=l(this,Fe);const[r,o]=this.pageDimensions,a=.75;if(this.width)s=this.width*r,i=this.height*o;else if(s>a*r||i>a*o){const f=Math.min(a*r/s,a*o/i);s*=f,i*=f}const[c,u]=this.parentDimensions;this.setDims(s*c/r,i*u/o),this._uiManager.enableWaiting(!1);const d=m(this,dr,document.createElement("canvas"));d.setAttribute("role","img"),this.addContainer(d),this.width=s/r,this.height=i/o,(h=this._initialOptions)!=null&&h.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),S(this,ye,M0).call(this),l(this,au)||(this.parent.addUndoableEditor(this),m(this,au,!0)),this._reportTelemetry({action:"inserted_image"}),l(this,ou)&&this.div.setAttribute("aria-description",l(this,ou))},eg=function(t,s){const{width:i,height:r}=l(this,Fe);let o=i,a=r,c=l(this,Fe);for(;o>2*t||a>2*s;){const u=o,d=a;o>2*t&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2)),a>2*s&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2));const h=new OffscreenCanvas(o,a);h.getContext("2d").drawImage(c,0,0,u,d,0,0,o,a),c=h.transferToImageBitmap()}return c},M0=function(){const[t,s]=this.parentDimensions,{width:i,height:r}=this,o=new Xs,a=Math.ceil(i*t*o.sx),c=Math.ceil(r*s*o.sy),u=l(this,dr);if(!u||u.width===a&&u.height===c)return;u.width=a,u.height=c;const d=l(this,Vn)?l(this,Fe):S(this,ye,eg).call(this,a,c),h=u.getContext("2d");h.filter=this._uiManager.hcmFilter,h.drawImage(d,0,0,d.width,d.height,0,0,a,c)},tg=function(t){if(t){if(l(this,Vn)){const r=this._uiManager.imageManager.getSvgUrl(l(this,bt));if(r)return r}const s=document.createElement("canvas");return{width:s.width,height:s.height}=l(this,Fe),s.getContext("2d").drawImage(l(this,Fe),0,0),s.toDataURL()}if(l(this,Vn)){const[s,i]=this.pageDimensions,r=Math.round(this.width*s*_r.PDF_TO_CSS_UNITS),o=Math.round(this.height*i*_r.PDF_TO_CSS_UNITS),a=new OffscreenCanvas(r,o);return a.getContext("2d").drawImage(l(this,Fe),0,0,l(this,Fe).width,l(this,Fe).height,0,0,r,o),a.transferToImageBitmap()}return structuredClone(l(this,Fe))},uC=function(t){var a;const{pageIndex:s,accessibilityData:{altText:i}}=this._initialData,r=t.pageIndex===s,o=(((a=t.accessibilityData)==null?void 0:a.alt)||"")===i;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&r&&o,isSameAltText:o}},F(L0,"_type","stamp"),F(L0,"_editorType",ee.STAMP);var il,lu,wi,bo,hr,us,Ao,cu,rl,js,fr,Wt,pr,W,So,je,dC,ni,D0,N0,ng;const _s=class _s{constructor({uiManager:e,pageIndex:t,div:s,structTreeLayer:i,accessibilityManager:r,annotationLayer:o,drawLayer:a,textLayer:c,viewport:u,l10n:d}){A(this,je);A(this,il);A(this,lu,!1);A(this,wi,null);A(this,bo,null);A(this,hr,null);A(this,us,new Map);A(this,Ao,!1);A(this,cu,!1);A(this,rl,!1);A(this,js,null);A(this,fr,null);A(this,Wt,null);A(this,pr,null);A(this,W);const h=[...l(_s,So).values()];if(!_s._initialized){_s._initialized=!0;for(const f of h)f.initialize(d,e)}e.registerEditorTypes(h),m(this,W,e),this.pageIndex=t,this.div=s,m(this,il,r),m(this,wi,o),this.viewport=u,m(this,Wt,c),this.drawLayer=a,this._structTree=i,l(this,W).addLayer(this)}get isEmpty(){return l(this,us).size===0}get isInvisible(){return this.isEmpty&&l(this,W).getMode()===ee.NONE}updateToolbar(e){l(this,W).updateToolbar(e)}updateMode(e=l(this,W).getMode()){switch(S(this,je,ng).call(this),e){case ee.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case ee.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case ee.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const s of l(_s,So).values())t.toggle(`${s._type}Editing`,e===s._editorType);this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=l(this,Wt))==null?void 0:t.div)}setEditingState(e){l(this,W).setEditingState(e)}addCommands(e){l(this,W).addCommands(e)}cleanUndoStack(e){l(this,W).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=l(this,wi))==null||t.div.classList.toggle("disabled",!e)}async enable(){m(this,rl,!0),this.div.tabIndex=0,this.togglePointerEvents(!0);const e=new Set;for(const s of l(this,us).values())s.enableEditing(),s.show(!0),s.annotationElementId&&(l(this,W).removeChangedExistingAnnotation(s),e.add(s.annotationElementId));if(!l(this,wi)){m(this,rl,!1);return}const t=l(this,wi).getEditableAnnotations();for(const s of t){if(s.hide(),l(this,W).isDeletedAnnotationElement(s.data.id)||e.has(s.data.id))continue;const i=await this.deserialize(s);i&&(this.addOrRebuild(i),i.enableEditing())}m(this,rl,!1)}disable(){var i;m(this,cu,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const e=new Map,t=new Map;for(const r of l(this,us).values())if(r.disableEditing(),!!r.annotationElementId){if(r.serialize()!==null){e.set(r.annotationElementId,r);continue}else t.set(r.annotationElementId,r);(i=this.getEditableAnnotation(r.annotationElementId))==null||i.show(),r.remove()}if(l(this,wi)){const r=l(this,wi).getEditableAnnotations();for(const o of r){const{id:a}=o.data;if(l(this,W).isDeletedAnnotationElement(a))continue;let c=t.get(a);if(c){c.resetAnnotationElement(o),c.show(!1),o.show();continue}c=e.get(a),c&&(l(this,W).addChangedExistingAnnotation(c),c.renderAnnotationElement(o)&&c.show(!1)),o.show()}}S(this,je,ng).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:s}=this.div;for(const r of l(_s,So).values())s.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),m(this,cu,!1)}getEditableAnnotation(e){var t;return((t=l(this,wi))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){l(this,W).getActive()!==e&&l(this,W).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=l(this,Wt))!=null&&e.div&&!l(this,pr)){m(this,pr,new AbortController);const t=l(this,W).combinedSignal(l(this,pr));l(this,Wt).div.addEventListener("pointerdown",S(this,je,dC).bind(this),{signal:t}),l(this,Wt).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=l(this,Wt))!=null&&e.div&&l(this,pr)&&(l(this,pr).abort(),m(this,pr,null),l(this,Wt).div.classList.remove("highlighting"))}enableClick(){if(l(this,bo))return;m(this,bo,new AbortController);const e=l(this,W).combinedSignal(l(this,bo));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;(e=l(this,bo))==null||e.abort(),m(this,bo,null)}attach(e){l(this,us).set(e.id,e);const{annotationElementId:t}=e;t&&l(this,W).isDeletedAnnotationElement(t)&&l(this,W).removeDeletedAnnotationElement(e)}detach(e){var t;l(this,us).delete(e.id),(t=l(this,il))==null||t.removePointerInTextLayer(e.contentDiv),!l(this,cu)&&e.annotationElementId&&l(this,W).addDeletedAnnotationElement(e)}remove(e){this.detach(e),l(this,W).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(l(this,W).addDeletedAnnotationElement(e.annotationElementId),Me.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),l(this,W).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!l(this,rl)),l(this,W).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var s;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!l(this,hr)&&(e._focusEventsAllowed=!1,m(this,hr,setTimeout(()=>{m(this,hr,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:l(this,W)._signal}),t.focus())},0))),e._structTreeParentId=(s=l(this,il))==null?void 0:s.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),s=()=>{e.remove()};this.addCommands({cmd:t,undo:s,mustExec:!1})}getNextId(){return l(this,W).getId()}combinedSignal(e){return l(this,W).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=l(this,je,ni))==null?void 0:e.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await l(this,W).updateMode(e.mode);const{offsetX:s,offsetY:i}=S(this,je,N0).call(this),r=this.getNextId(),o=S(this,je,D0).call(this,{parent:this,id:r,x:s,y:i,uiManager:l(this,W),isCentered:!0,...t});o&&this.add(o)}async deserialize(e){var t;return await((t=l(_s,So).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,l(this,W)))||null}createAndAddNewEditor(e,t,s={}){const i=this.getNextId(),r=S(this,je,D0).call(this,{parent:this,id:i,x:e.offsetX,y:e.offsetY,uiManager:l(this,W),isCentered:t,...s});return r&&this.add(r),r}addNewEditor(e={}){this.createAndAddNewEditor(S(this,je,N0).call(this),!0,e)}setSelected(e){l(this,W).setSelected(e)}toggleSelected(e){l(this,W).toggleSelected(e)}unselect(e){l(this,W).unselect(e)}pointerup(e){var i;const{isMac:t}=Et.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!l(this,Ao)||(m(this,Ao,!1),(i=l(this,je,ni))!=null&&i.isDrawer&&l(this,je,ni).supportMultipleDrawings))return;if(!l(this,lu)){m(this,lu,!0);return}const s=l(this,W).getMode();if(s===ee.STAMP||s===ee.SIGNATURE){l(this,W).unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){var i;if(l(this,W).getMode()===ee.HIGHLIGHT&&this.enableTextSelection(),l(this,Ao)){m(this,Ao,!1);return}const{isMac:t}=Et.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(m(this,Ao,!0),(i=l(this,je,ni))!=null&&i.isDrawer){this.startDrawingSession(e);return}const s=l(this,W).getActive();m(this,lu,!s||s.isEmpty())}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),l(this,js)){l(this,je,ni).startDrawing(this,l(this,W),!1,e);return}l(this,W).setCurrentDrawingSession(this),m(this,js,new AbortController);const t=l(this,W).combinedSignal(l(this,js));this.div.addEventListener("blur",({relatedTarget:s})=>{s&&!this.div.contains(s)&&(m(this,fr,null),this.commitOrRemove())},{signal:t}),l(this,je,ni).startDrawing(this,l(this,W),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&m(this,fr,t);return}l(this,fr)&&setTimeout(()=>{var t;(t=l(this,fr))==null||t.focus(),m(this,fr,null)},0)}endDrawingSession(e=!1){return l(this,js)?(l(this,W).setCurrentDrawingSession(null),l(this,js).abort(),m(this,js,null),m(this,fr,null),l(this,je,ni).endDrawing(e)):null}findNewParent(e,t,s){const i=l(this,W).findParent(t,s);return i===null||i===this?!1:(i.changeParent(e),!0)}commitOrRemove(){return l(this,js)?(this.endDrawingSession(),!0):!1}onScaleChanging(){l(this,js)&&l(this,je,ni).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=l(this,W).getActive())==null?void 0:e.parent)===this&&(l(this,W).commitOrRemove(),l(this,W).setActiveEditor(null)),l(this,hr)&&(clearTimeout(l(this,hr)),m(this,hr,null));for(const s of l(this,us).values())(t=l(this,il))==null||t.removePointerInTextLayer(s.contentDiv),s.setParent(null),s.isAttachedToDOM=!1,s.div.remove();this.div=null,l(this,us).clear(),l(this,W).removeLayer(this)}render({viewport:e}){this.viewport=e,Oo(this.div,e);for(const t of l(this,W).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){l(this,W).commitOrRemove(),S(this,je,ng).call(this);const t=this.viewport.rotation,s=e.rotation;if(this.viewport=e,Oo(this.div,{rotation:s}),t!==s)for(const i of l(this,us).values())i.rotate(s)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return l(this,W).viewParameters.realScale}};il=new WeakMap,lu=new WeakMap,wi=new WeakMap,bo=new WeakMap,hr=new WeakMap,us=new WeakMap,Ao=new WeakMap,cu=new WeakMap,rl=new WeakMap,js=new WeakMap,fr=new WeakMap,Wt=new WeakMap,pr=new WeakMap,W=new WeakMap,So=new WeakMap,je=new WeakSet,dC=function(e){l(this,W).unselectAll();const{target:t}=e;if(t===l(this,Wt).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&l(this,Wt).div.contains(t)){const{isMac:s}=Et.platform;if(e.button!==0||e.ctrlKey&&s)return;l(this,W).showAllEditors("highlight",!0,!0),l(this,Wt).div.classList.add("free"),this.toggleDrawing(),Og.startHighlighting(this,l(this,W).direction==="ltr",{target:l(this,Wt).div,x:e.x,y:e.y}),l(this,Wt).div.addEventListener("pointerup",()=>{l(this,Wt).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:l(this,W)._signal}),e.preventDefault()}},ni=function(){return l(_s,So).get(l(this,W).getMode())},D0=function(e){const t=l(this,je,ni);return t?new t.prototype.constructor(e):null},N0=function(){const{x:e,y:t,width:s,height:i}=this.div.getBoundingClientRect(),r=Math.max(0,e),o=Math.max(0,t),a=Math.min(window.innerWidth,e+s),c=Math.min(window.innerHeight,t+i),u=(r+a)/2-e,d=(o+c)/2-t,[h,f]=this.viewport.rotation%180===0?[u,d]:[d,u];return{offsetX:h,offsetY:f}},ng=function(){for(const e of l(this,us).values())e.isEmpty()&&e.remove()},F(_s,"_initialized",!1),A(_s,So,new Map([d0,E0,L0,Og,R0].map(e=>[e._editorType,e])));let jg=_s;var zs,nn,ol,Ef,im,hC,Ci,I0,fC,O0;const at=class at{constructor({pageIndex:e}){A(this,Ci);A(this,zs,null);A(this,nn,new Map);A(this,ol,new Map);this.pageIndex=e}setParent(e){if(!l(this,zs)){m(this,zs,e);return}if(l(this,zs)!==e){if(l(this,nn).size>0)for(const t of l(this,nn).values())t.remove(),e.append(t);m(this,zs,e)}}static get _svgFactory(){return le(this,"_svgFactory",new qd)}draw(e,t=!1,s=!1){const i=Qt(at,Ef)._++,r=S(this,Ci,I0).call(this),o=at._svgFactory.createElement("defs");r.append(o);const a=at._svgFactory.createElement("path");o.append(a);const c=`path_p${this.pageIndex}_${i}`;a.setAttribute("id",c),a.setAttribute("vector-effect","non-scaling-stroke"),t&&l(this,ol).set(i,a);const u=s?S(this,Ci,fC).call(this,o,c):null,d=at._svgFactory.createElement("use");return r.append(d),d.setAttribute("href",`#${c}`),this.updateProperties(r,e),l(this,nn).set(i,r),{id:i,clipPathId:`url(#${u})`}}drawOutline(e,t){const s=Qt(at,Ef)._++,i=S(this,Ci,I0).call(this),r=at._svgFactory.createElement("defs");i.append(r);const o=at._svgFactory.createElement("path");r.append(o);const a=`path_p${this.pageIndex}_${s}`;o.setAttribute("id",a),o.setAttribute("vector-effect","non-scaling-stroke");let c;if(t){const h=at._svgFactory.createElement("mask");r.append(h),c=`mask_p${this.pageIndex}_${s}`,h.setAttribute("id",c),h.setAttribute("maskUnits","objectBoundingBox");const f=at._svgFactory.createElement("rect");h.append(f),f.setAttribute("width","1"),f.setAttribute("height","1"),f.setAttribute("fill","white");const p=at._svgFactory.createElement("use");h.append(p),p.setAttribute("href",`#${a}`),p.setAttribute("stroke","none"),p.setAttribute("fill","black"),p.setAttribute("fill-rule","nonzero"),p.classList.add("mask")}const u=at._svgFactory.createElement("use");i.append(u),u.setAttribute("href",`#${a}`),c&&u.setAttribute("mask",`url(#${c})`);const d=u.cloneNode();return i.append(d),u.classList.add("mainOutline"),d.classList.add("secondaryOutline"),this.updateProperties(i,e),l(this,nn).set(s,i),s}finalizeDraw(e,t){l(this,ol).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var c;if(!t)return;const{root:s,bbox:i,rootClass:r,path:o}=t,a=typeof e=="number"?l(this,nn).get(e):e;if(a){if(s&&S(this,Ci,O0).call(this,a,s),i&&S(c=at,im,hC).call(c,a,i),r){const{classList:u}=a;for(const[d,h]of Object.entries(r))u.toggle(d,h)}if(o){const d=a.firstChild.firstChild;S(this,Ci,O0).call(this,d,o)}}}updateParent(e,t){if(t===this)return;const s=l(this,nn).get(e);s&&(l(t,zs).append(s),l(this,nn).delete(e),l(t,nn).set(e,s))}remove(e){l(this,ol).delete(e),l(this,zs)!==null&&(l(this,nn).get(e).remove(),l(this,nn).delete(e))}destroy(){m(this,zs,null);for(const e of l(this,nn).values())e.remove();l(this,nn).clear(),l(this,ol).clear()}};zs=new WeakMap,nn=new WeakMap,ol=new WeakMap,Ef=new WeakMap,im=new WeakSet,hC=function(e,[t,s,i,r]){const{style:o}=e;o.top=`${100*s}%`,o.left=`${100*t}%`,o.width=`${100*i}%`,o.height=`${100*r}%`},Ci=new WeakSet,I0=function(){const e=at._svgFactory.create(1,1,!0);return l(this,zs).append(e),e.setAttribute("aria-hidden",!0),e},fC=function(e,t){const s=at._svgFactory.createElement("clipPath");e.append(s);const i=`clip_${t}`;s.setAttribute("id",i),s.setAttribute("clipPathUnits","objectBoundingBox");const r=at._svgFactory.createElement("use");return s.append(r),r.setAttribute("href",`#${t}`),r.classList.add("clip"),i},O0=function(e,t){for(const[s,i]of Object.entries(t))i===null?e.removeAttribute(s):e.setAttribute(s,i)},A(at,im),A(at,Ef,0);let zg=at;globalThis._pdfjsTestingUtils={HighlightOutliner:f0};globalThis.pdfjsLib={AbortException:Er,AnnotationEditorLayer:jg,AnnotationEditorParamsType:de,AnnotationEditorType:ee,AnnotationEditorUIManager:Fo,AnnotationLayer:Zw,AnnotationMode:Ai,AnnotationType:Ke,build:f_,ColorPicker:Kd,createValidAbsoluteUrl:$w,DOMSVGFactory:qd,DrawLayer:zg,FeatureTest:Et,fetchData:Cu,getDocument:qw,getFilenameFromUrl:o1,getPdfFilenameFromUrl:a1,getUuid:Uw,getXfaPageViewport:l1,GlobalWorkerOptions:ps,ImageKind:Ed,InvalidPDFException:Mg,isDataScheme:Of,isPdfFile:Pm,isValidExplicitDest:U1,MathClamp:Xt,noContextMenu:As,normalizeUnicode:i1,OPS:Vd,OutputScale:Xs,PasswordResponses:n1,PDFDataRangeTransport:Kw,PDFDateString:Rm,PDFWorker:wu,PermissionFlag:t1,PixelsPerInch:_r,RenderingCancelledException:Tm,ResponseException:Gd,setLayerDimensions:Oo,shadow:le,SignatureExtractor:Si,stopEvent:et,SupportedImageMimeTypes:Dg,TextLayer:Xd,TouchManager:Wd,updateUrlHash:Hw,Util:Y,VerbosityLevel:Df,version:h_,XfaLayer:Qw};const dM=Object.freeze(Object.defineProperty({__proto__:null,AbortException:Er,AnnotationEditorLayer:jg,AnnotationEditorParamsType:de,AnnotationEditorType:ee,AnnotationEditorUIManager:Fo,AnnotationLayer:Zw,AnnotationMode:Ai,AnnotationType:Ke,ColorPicker:Kd,DOMSVGFactory:qd,DrawLayer:zg,FeatureTest:Et,GlobalWorkerOptions:ps,ImageKind:Ed,InvalidPDFException:Mg,MathClamp:Xt,OPS:Vd,OutputScale:Xs,PDFDataRangeTransport:Kw,PDFDateString:Rm,PDFWorker:wu,PasswordResponses:n1,PermissionFlag:t1,PixelsPerInch:_r,RenderingCancelledException:Tm,ResponseException:Gd,SignatureExtractor:Si,SupportedImageMimeTypes:Dg,TextLayer:Xd,TouchManager:Wd,Util:Y,VerbosityLevel:Df,XfaLayer:Qw,build:f_,createValidAbsoluteUrl:$w,fetchData:Cu,getDocument:qw,getFilenameFromUrl:o1,getPdfFilenameFromUrl:a1,getUuid:Uw,getXfaPageViewport:l1,isDataScheme:Of,isPdfFile:Pm,isValidExplicitDest:U1,noContextMenu:As,normalizeUnicode:i1,setLayerDimensions:Oo,shadow:le,stopEvent:et,updateUrlHash:Hw,version:h_},Symbol.toStringTag,{value:"Module"})),hM=["onCopy","onCut","onPaste"],fM=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],pM=["onFocus","onBlur"],gM=["onInput","onInvalid","onReset","onSubmit"],mM=["onLoad","onError"],yM=["onKeyDown","onKeyPress","onKeyUp"],vM=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],wM=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],bM=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],AM=["onSelect"],SM=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],xM=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],EM=["onScroll"],_M=["onWheel"],CM=["onAnimationStart","onAnimationEnd","onAnimationIteration"],kM=["onTransitionEnd"],TM=["onToggle"],PM=["onChange"],RM=[...hM,...fM,...pM,...gM,...mM,...yM,...vM,...wM,...bM,...AM,...SM,...xM,...EM,..._M,...CM,...kM,...PM,...TM];function pC(n,e){const t={};for(const s of RM){const i=n[s];i&&(e?t[s]=r=>i(r,e(s)):t[s]=i)}return t}function $f(n){let e=!1;return{promise:new Promise((s,i)=>{n.then(r=>!e&&s(r)).catch(r=>!e&&i(r))}),cancel(){e=!0}}}var LM="Invariant failed";function Te(n,e){if(!n)throw new Error(LM)}var MM=function(){},DM=MM;const qt=z0(DM);var nS=Object.prototype.hasOwnProperty;function sS(n,e,t){for(t of n.keys())if(tc(t,e))return t}function tc(n,e){var t,s,i;if(n===e)return!0;if(n&&e&&(t=n.constructor)===e.constructor){if(t===Date)return n.getTime()===e.getTime();if(t===RegExp)return n.toString()===e.toString();if(t===Array){if((s=n.length)===e.length)for(;s--&&tc(n[s],e[s]););return s===-1}if(t===Set){if(n.size!==e.size)return!1;for(s of n)if(i=s,i&&typeof i=="object"&&(i=sS(e,i),!i)||!e.has(i))return!1;return!0}if(t===Map){if(n.size!==e.size)return!1;for(s of n)if(i=s[0],i&&typeof i=="object"&&(i=sS(e,i),!i)||!tc(s[1],e.get(i)))return!1;return!0}if(t===ArrayBuffer)n=new Uint8Array(n),e=new Uint8Array(e);else if(t===DataView){if((s=n.byteLength)===e.byteLength)for(;s--&&n.getInt8(s)===e.getInt8(s););return s===-1}if(ArrayBuffer.isView(n)){if((s=n.byteLength)===e.byteLength)for(;s--&&n[s]===e[s];);return s===-1}if(!t||typeof n=="object"){s=0;for(t in n)if(nS.call(n,t)&&++s&&!nS.call(e,t)||!(t in e)||!tc(n[t],e[t]))return!1;return Object.keys(e).length===s}}return n!==n&&e!==e}const gC=R.createContext(null);function nc({children:n,type:e}){return T.jsx("div",{className:`react-pdf__message react-pdf__message--${e}`,children:n})}const NM="noopener noreferrer nofollow";class IM{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(e){this.pdfDocument=e}setViewer(e){this.pdfViewer=e}setExternalLinkRel(e){this.externalLinkRel=e}setExternalLinkTarget(e){this.externalLinkTarget=e}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return Te(this.pdfViewer),this.pdfViewer.currentPageNumber||0}set page(e){Te(this.pdfViewer),this.pdfViewer.currentPageNumber=e}get rotation(){return 0}set rotation(e){}goToDestination(e){return new Promise(t=>{Te(this.pdfDocument),Te(e),typeof e=="string"?this.pdfDocument.getDestination(e).then(t):Array.isArray(e)?t(e):e.then(t)}).then(t=>{Te(Array.isArray(t));const s=t[0];new Promise(i=>{Te(this.pdfDocument),s instanceof Object?this.pdfDocument.getPageIndex(s).then(r=>{i(r)}).catch(()=>{Te(!1)}):typeof s=="number"?i(s):Te(!1)}).then(i=>{const r=i+1;Te(this.pdfViewer),Te(r>=1&&r<=this.pagesCount),this.pdfViewer.scrollPageIntoView({dest:t,pageIndex:i,pageNumber:r})})})}navigateTo(e){this.goToDestination(e)}goToPage(e){const t=e-1;Te(this.pdfViewer),Te(e>=1&&e<=this.pagesCount),this.pdfViewer.scrollPageIntoView({pageIndex:t,pageNumber:e})}addLinkAttributes(e,t,s){e.href=t,e.rel=this.externalLinkRel||NM,e.target=s?"_blank":this.externalLinkTarget||""}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}setHash(){}executeNamedAction(){}cachePageRef(){}isPageVisible(){return!0}isPageCached(){return!0}executeSetOCGState(){}}const iS={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},Dm=typeof window<"u",mC=Dm&&window.location.protocol==="file:";function OM(n){return typeof n<"u"}function Vo(n){return OM(n)&&n!==null}function FM(n){return typeof n=="string"}function jM(n){return n instanceof ArrayBuffer}function zM(n){return Te(Dm),n instanceof Blob}function F0(n){return FM(n)&&/^data:/.test(n)}function rS(n){Te(F0(n));const[e="",t=""]=n.split(",");return e.split(";").indexOf("base64")!==-1?atob(t):unescape(t)}function BM(){return Dm&&window.devicePixelRatio||1}const yC="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function oS(){qt(!mC,`Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ${yC}`)}function $M(){qt(!mC,`Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ${yC}`)}function gl(n){n!=null&&n.cancel&&n.cancel()}function j0(n,e){return Object.defineProperty(n,"width",{get(){return this.view[2]*e},configurable:!0}),Object.defineProperty(n,"height",{get(){return this.view[3]*e},configurable:!0}),Object.defineProperty(n,"originalWidth",{get(){return this.view[2]},configurable:!0}),Object.defineProperty(n,"originalHeight",{get(){return this.view[3]},configurable:!0}),n}function HM(n){return n.name==="RenderingCancelledException"}function UM(n){return new Promise((e,t)=>{const s=new FileReader;s.onload=()=>{if(!s.result)return t(new Error("Error while reading a file."));e(s.result)},s.onerror=i=>{if(!i.target)return t(new Error("Error while reading a file."));const{error:r}=i.target;if(!r)return t(new Error("Error while reading a file."));switch(r.code){case r.NOT_FOUND_ERR:return t(new Error("Error while reading a file: File not found."));case r.SECURITY_ERR:return t(new Error("Error while reading a file: Security error."));case r.ABORT_ERR:return t(new Error("Error while reading a file: Aborted."));default:return t(new Error("Error while reading a file."))}},s.readAsArrayBuffer(n)})}function VM(n,e){switch(e.type){case"RESOLVE":return{value:e.value,error:void 0};case"REJECT":return{value:!1,error:e.error};case"RESET":return{value:void 0,error:void 0};default:return n}}function bu(){return R.useReducer(VM,{value:void 0,error:void 0})}var aS=function(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(n);i<s.length;i++)e.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(n,s[i])&&(t[s[i]]=n[s[i]]);return t};const{PDFDataRangeTransport:GM}=dM,WM=(n,e)=>{switch(e){case iS.NEED_PASSWORD:{const t=prompt("Enter the password to open this PDF file.");n(t);break}case iS.INCORRECT_PASSWORD:{const t=prompt("Invalid password. Please try again.");n(t);break}}};function lS(n){return typeof n=="object"&&n!==null&&("data"in n||"range"in n||"url"in n)}const XM=R.forwardRef(function(e,t){var{children:s,className:i,error:r="Failed to load PDF file.",externalLinkRel:o,externalLinkTarget:a,file:c,inputRef:u,imageResourcesPath:d,loading:h="Loading PDF",noData:f="No PDF file specified.",onItemClick:p,onLoadError:v,onLoadProgress:g,onLoadSuccess:x,onPassword:y=WM,onSourceError:w,onSourceSuccess:b,options:E,renderMode:_,rotate:k,scale:C}=e,P=aS(e,["children","className","error","externalLinkRel","externalLinkTarget","file","inputRef","imageResourcesPath","loading","noData","onItemClick","onLoadError","onLoadProgress","onLoadSuccess","onPassword","onSourceError","onSourceSuccess","options","renderMode","rotate","scale"]);const[L,M]=bu(),{value:D,error:K}=L,[Q,G]=bu(),{value:te,error:j}=Q,O=R.useRef(new IM),I=R.useRef([]),$=R.useRef(void 0),X=R.useRef(void 0);c&&c!==$.current&&lS(c)&&(qt(!tc(c,$.current),`File prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "file" prop.`),$.current=c),E&&E!==X.current&&(qt(!tc(E,X.current),`Options prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "options" prop.`),X.current=E);const re=R.useRef({scrollPageIntoView:pe=>{const{dest:Be,pageNumber:Se,pageIndex:Ss=Se-1}=pe;if(p){p({dest:Be,pageIndex:Ss,pageNumber:Se});return}const Ti=I.current[Ss];if(Ti){Ti.scrollIntoView();return}qt(!1,`An internal link leading to page ${Se} was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>.`)}});R.useImperativeHandle(t,()=>({linkService:O,pages:I,viewer:re}),[]);function J(){b&&b()}function oe(){K&&(qt(!1,K.toString()),w&&w(K))}function Pe(){M({type:"RESET"})}R.useEffect(Pe,[c,M]);const We=R.useCallback(async()=>{if(!c)return null;if(typeof c=="string")return F0(c)?{data:rS(c)}:(oS(),{url:c});if(c instanceof GM)return{range:c};if(jM(c))return{data:c};if(Dm&&zM(c))return{data:await UM(c)};if(Te(typeof c=="object"),Te(lS(c)),"url"in c&&typeof c.url=="string"){if(F0(c.url)){const{url:pe}=c,Be=aS(c,["url"]),Se=rS(pe);return Object.assign({data:Se},Be)}oS()}return c},[c]);R.useEffect(()=>{const pe=$f(We());return pe.promise.then(Be=>{M({type:"RESOLVE",value:Be})}).catch(Be=>{M({type:"REJECT",error:Be})}),()=>{gl(pe)}},[We,M]),R.useEffect(()=>{if(!(typeof D>"u")){if(D===!1){oe();return}J()}},[D]);function he(){te&&(x&&x(te),I.current=new Array(te.numPages),O.current.setDocument(te))}function fe(){j&&(qt(!1,j.toString()),v&&v(j))}R.useEffect(function(){G({type:"RESET"})},[G,D]),R.useEffect(function(){if(!D)return;const Be=E?Object.assign(Object.assign({},D),E):D,Se=qw(Be);g&&(Se.onProgress=g),y&&(Se.onPassword=y);const Ss=Se,Ti=Ss.promise.then(Pi=>{G({type:"RESOLVE",value:Pi})}).catch(Pi=>{Ss.destroyed||G({type:"REJECT",error:Pi})});return()=>{Ti.finally(()=>Ss.destroy())}},[E,G,D]),R.useEffect(()=>{if(!(typeof te>"u")){if(te===!1){fe();return}he()}},[te]),R.useEffect(function(){O.current.setViewer(re.current),O.current.setExternalLinkRel(o),O.current.setExternalLinkTarget(a)},[o,a]);const En=R.useCallback((pe,Be)=>{I.current[pe]=Be},[]),_n=R.useCallback(pe=>{delete I.current[pe]},[]),ue=R.useMemo(()=>({imageResourcesPath:d,linkService:O.current,onItemClick:p,pdf:te,registerPage:En,renderMode:_,rotate:k,scale:C,unregisterPage:_n}),[d,p,te,En,_,k,C,_n]),Cn=R.useMemo(()=>pC(P,()=>te),[P,te]);function _t(){return T.jsx(gC.Provider,{value:ue,children:s})}function pt(){return c?te==null?T.jsx(nc,{type:"loading",children:typeof h=="function"?h():h}):te===!1?T.jsx(nc,{type:"error",children:typeof r=="function"?r():r}):_t():T.jsx(nc,{type:"no-data",children:typeof f=="function"?f():f})}return T.jsx("div",Object.assign({className:_i("react-pdf__Document",i),ref:u},Cn,{children:pt()}))});function vC(){return R.useContext(gC)}function wC(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=n.filter(Boolean);if(t.length<=1){var s=t[0];return s||null}return function(r){for(var o=0,a=t;o<a.length;o++){var c=a[o];typeof c=="function"?c(r):c&&(c.current=r)}}}const bC=R.createContext(null),AC={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},YM=/^H(\d+)$/;function qM(n){return n in AC}function Nm(n){return"children"in n}function SC(n){return Nm(n)?n.children.length===1&&0 in n.children&&"id"in n.children[0]:!1}function KM(n){const e={};if(Nm(n)){const{role:t}=n,s=t.match(YM);if(s)e.role="heading",e["aria-level"]=Number(s[1]);else if(qM(t)){const i=AC[t];i&&(e.role=i)}}return e}function xC(n){const e={};if(Nm(n)){if(n.alt!==void 0&&(e["aria-label"]=n.alt),n.lang!==void 0&&(e.lang=n.lang),SC(n)){const[t]=n.children;if(t){const s=xC(t);return Object.assign(Object.assign({},e),s)}}}else"id"in n&&(e["aria-owns"]=n.id);return e}function QM(n){return n?Object.assign(Object.assign({},KM(n)),xC(n)):null}function EC({className:n,node:e}){const t=R.useMemo(()=>QM(e),[e]),s=R.useMemo(()=>!Nm(e)||SC(e)?null:e.children.map((i,r)=>T.jsx(EC,{node:i},r)),[e]);return T.jsx("span",Object.assign({className:n},t,{children:s}))}function Im(){return R.useContext(bC)}function JM(){const n=Im();Te(n);const{onGetStructTreeError:e,onGetStructTreeSuccess:t}=n,[s,i]=bu(),{value:r,error:o}=s,{customTextRenderer:a,page:c}=n;function u(){r&&t&&t(r)}function d(){o&&(qt(!1,o.toString()),e&&e(o))}return R.useEffect(function(){i({type:"RESET"})},[i,c]),R.useEffect(function(){if(a||!c)return;const f=$f(c.getStructTree()),p=f;return f.promise.then(v=>{i({type:"RESOLVE",value:v})}).catch(v=>{i({type:"REJECT",error:v})}),()=>gl(p)},[a,c,i]),R.useEffect(()=>{if(r!==void 0){if(r===!1){d();return}u()}},[r]),r?T.jsx(EC,{className:"react-pdf__Page__structTree structTree",node:r}):null}const cS=Ai;function ZM(n){const e=Im();Te(e);const t=Object.assign(Object.assign({},e),n),{_className:s,canvasBackground:i,devicePixelRatio:r=BM(),onRenderError:o,onRenderSuccess:a,page:c,renderForms:u,renderTextLayer:d,rotate:h,scale:f}=t,{canvasRef:p}=n;Te(c);const v=R.useRef(null);function g(){c&&a&&a(j0(c,f))}function x(E){HM(E)||(qt(!1,E.toString()),o&&o(E))}const y=R.useMemo(()=>c.getViewport({scale:f*r,rotation:h}),[r,c,h,f]),w=R.useMemo(()=>c.getViewport({scale:f,rotation:h}),[c,h,f]);R.useEffect(function(){if(!c)return;c.cleanup();const{current:_}=v;if(!_)return;_.width=y.width,_.height=y.height,_.style.width=`${Math.floor(w.width)}px`,_.style.height=`${Math.floor(w.height)}px`,_.style.visibility="hidden";const k={annotationMode:u?cS.ENABLE_FORMS:cS.ENABLE,canvasContext:_.getContext("2d",{alpha:!1}),viewport:y};i&&(k.background=i);const C=c.render(k),P=C;return C.promise.then(()=>{_.style.visibility="",g()}).catch(x),()=>gl(P)},[i,c,u,y,w]);const b=R.useCallback(()=>{const{current:E}=v;E&&(E.width=0,E.height=0)},[]);return R.useEffect(()=>b,[b]),T.jsx("canvas",{className:`${s}__canvas`,dir:"ltr",ref:wC(p,v),style:{display:"block",userSelect:"none"},children:d?T.jsx(JM,{}):null})}function eD(n){return"str"in n}function tD(){const n=Im();Te(n);const{customTextRenderer:e,onGetTextError:t,onGetTextSuccess:s,onRenderTextLayerError:i,onRenderTextLayerSuccess:r,page:o,pageIndex:a,pageNumber:c,rotate:u,scale:d}=n;Te(o);const[h,f]=bu(),{value:p,error:v}=h,g=R.useRef(null);qt(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer");function x(){p&&s&&s(p)}function y(){v&&(qt(!1,v.toString()),t&&t(v))}R.useEffect(function(){f({type:"RESET"})},[o,f]),R.useEffect(function(){if(!o)return;const P=$f(o.getTextContent()),L=P;return P.promise.then(M=>{f({type:"RESOLVE",value:M})}).catch(M=>{f({type:"REJECT",error:M})}),()=>gl(L)},[o,f]),R.useEffect(()=>{if(p!==void 0){if(p===!1){y();return}x()}},[p]);const w=R.useCallback(()=>{r&&r()},[r]),b=R.useCallback(C=>{qt(!1,C.toString()),i&&i(C)},[i]);function E(){const C=g.current;C&&C.classList.add("selecting")}function _(){const C=g.current;C&&C.classList.remove("selecting")}const k=R.useMemo(()=>o.getViewport({scale:d,rotation:u}),[o,u,d]);return R.useLayoutEffect(function(){if(!o||!p)return;const{current:P}=g;if(!P)return;P.innerHTML="";const L=o.streamTextContent({includeMarkedContent:!0}),M={container:P,textContentSource:L,viewport:k},D=new Xd(M),K=D;return D.render().then(()=>{const Q=document.createElement("div");Q.className="endOfContent",P.append(Q);const G=P.querySelectorAll('[role="presentation"]');if(e){let te=0;p.items.forEach((j,O)=>{if(!eD(j))return;const I=G[te];if(!I)return;const $=e(Object.assign({pageIndex:a,pageNumber:c,itemIndex:O},j));I.innerHTML=$,te+=j.str&&j.hasEOL?2:1})}w()}).catch(b),()=>gl(K)},[e,b,w,o,a,c,p,k]),T.jsx("div",{className:_i("react-pdf__Page__textContent","textLayer"),onMouseUp:_,onMouseDown:E,ref:g})}function nD(){const n=vC(),e=Im();Te(e);const t=Object.assign(Object.assign({},n),e),{imageResourcesPath:s,linkService:i,onGetAnnotationsError:r,onGetAnnotationsSuccess:o,onRenderAnnotationLayerError:a,onRenderAnnotationLayerSuccess:c,page:u,pdf:d,renderForms:h,rotate:f,scale:p=1}=t;Te(d),Te(u),Te(i);const[v,g]=bu(),{value:x,error:y}=v,w=R.useRef(null);qt(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations");function b(){x&&o&&o(x)}function E(){y&&(qt(!1,y.toString()),r&&r(y))}R.useEffect(function(){g({type:"RESET"})},[g,u]),R.useEffect(function(){if(!u)return;const L=$f(u.getAnnotations()),M=L;return L.promise.then(D=>{g({type:"RESOLVE",value:D})}).catch(D=>{g({type:"REJECT",error:D})}),()=>{gl(M)}},[g,u]),R.useEffect(()=>{if(x!==void 0){if(x===!1){E();return}b()}},[x]);function _(){c&&c()}function k(P){qt(!1,`${P}`),a&&a(P)}const C=R.useMemo(()=>u.getViewport({scale:p,rotation:f}),[u,f,p]);return R.useEffect(function(){if(!d||!u||!i||!x)return;const{current:L}=w;if(!L)return;const M=C.clone({dontFlip:!0}),D={accessibilityManager:null,annotationCanvasMap:null,annotationEditorUIManager:null,div:L,l10n:null,page:u,structTreeLayer:null,viewport:M},K={annotations:x,annotationStorage:d.annotationStorage,div:L,imageResourcesPath:s,linkService:i,page:u,renderForms:h,viewport:M};L.innerHTML="";try{new Zw(D).render(K),_()}catch(Q){k(Q)}return()=>{}},[x,s,i,u,d,h,C]),T.jsx("div",{className:_i("react-pdf__Page__annotations","annotationLayer"),ref:w})}var sD=function(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(n);i<s.length;i++)e.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(n,s[i])&&(t[s[i]]=n[s[i]]);return t};const uS=1;function iD(n){const e=vC(),t=Object.assign(Object.assign({},e),n),{_className:s="react-pdf__Page",_enableRegisterUnregisterPage:i=!0,canvasBackground:r,canvasRef:o,children:a,className:c,customRenderer:u,customTextRenderer:d,devicePixelRatio:h,error:f="Failed to load the page.",height:p,inputRef:v,loading:g="Loading page",noData:x="No page specified.",onGetAnnotationsError:y,onGetAnnotationsSuccess:w,onGetStructTreeError:b,onGetStructTreeSuccess:E,onGetTextError:_,onGetTextSuccess:k,onLoadError:C,onLoadSuccess:P,onRenderAnnotationLayerError:L,onRenderAnnotationLayerSuccess:M,onRenderError:D,onRenderSuccess:K,onRenderTextLayerError:Q,onRenderTextLayerSuccess:G,pageIndex:te,pageNumber:j,pdf:O,registerPage:I,renderAnnotationLayer:$=!0,renderForms:X=!1,renderMode:re="canvas",renderTextLayer:J=!0,rotate:oe,scale:Pe=uS,unregisterPage:We,width:he}=t,fe=sD(t,["_className","_enableRegisterUnregisterPage","canvasBackground","canvasRef","children","className","customRenderer","customTextRenderer","devicePixelRatio","error","height","inputRef","loading","noData","onGetAnnotationsError","onGetAnnotationsSuccess","onGetStructTreeError","onGetStructTreeSuccess","onGetTextError","onGetTextSuccess","onLoadError","onLoadSuccess","onRenderAnnotationLayerError","onRenderAnnotationLayerSuccess","onRenderError","onRenderSuccess","onRenderTextLayerError","onRenderTextLayerSuccess","pageIndex","pageNumber","pdf","registerPage","renderAnnotationLayer","renderForms","renderMode","renderTextLayer","rotate","scale","unregisterPage","width"]),[En,_n]=bu(),{value:ue,error:Cn}=En,_t=R.useRef(null);Te(O);const pt=Vo(j)?j-1:te??null,pe=j??(Vo(te)?te+1:null),Be=oe??(ue?ue.rotate:null),Se=R.useMemo(()=>{if(!ue)return null;let kn=1;const xs=Pe??uS;if(he||p){const Ks=ue.getViewport({scale:1,rotation:Be});he?kn=he/Ks.width:p&&(kn=p/Ks.height)}return xs*kn},[p,ue,Be,Pe,he]);R.useEffect(function(){return()=>{Vo(pt)&&i&&We&&We(pt)}},[i,O,pt,We]);function Ss(){if(P){if(!ue||!Se)return;P(j0(ue,Se))}if(i&&I){if(!Vo(pt)||!_t.current)return;I(pt,_t.current)}}function Ti(){Cn&&(qt(!1,Cn.toString()),C&&C(Cn))}R.useEffect(function(){_n({type:"RESET"})},[_n,O,pt]),R.useEffect(function(){if(!O||!pe)return;const xs=$f(O.getPage(pe)),Ks=xs;return xs.promise.then(Al=>{_n({type:"RESOLVE",value:Al})}).catch(Al=>{_n({type:"REJECT",error:Al})}),()=>gl(Ks)},[_n,O,pe]),R.useEffect(()=>{if(ue!==void 0){if(ue===!1){Ti();return}Ss()}},[ue,Se]);const Pi=R.useMemo(()=>ue&&Vo(pt)&&pe&&Vo(Be)&&Vo(Se)?{_className:s,canvasBackground:r,customTextRenderer:d,devicePixelRatio:h,onGetAnnotationsError:y,onGetAnnotationsSuccess:w,onGetStructTreeError:b,onGetStructTreeSuccess:E,onGetTextError:_,onGetTextSuccess:k,onRenderAnnotationLayerError:L,onRenderAnnotationLayerSuccess:M,onRenderError:D,onRenderSuccess:K,onRenderTextLayerError:Q,onRenderTextLayerSuccess:G,page:ue,pageIndex:pt,pageNumber:pe,renderForms:X,renderTextLayer:J,rotate:Be,scale:Se}:null,[s,r,d,h,y,w,b,E,_,k,L,M,D,K,Q,G,ue,pt,pe,X,J,Be,Se]),qs=R.useMemo(()=>pC(fe,()=>ue&&(Se?j0(ue,Se):void 0)),[fe,ue,Se]),Ri=`${pt}@${Se}/${Be}`;function bl(){switch(re){case"custom":return Te(u),T.jsx(u,{},`${Ri}_custom`);case"none":return null;case"canvas":default:return T.jsx(ZM,{canvasRef:o},`${Ri}_canvas`)}}function Hf(){return J?T.jsx(tD,{},`${Ri}_text`):null}function Uf(){return $?T.jsx(nD,{},`${Ri}_annotations`):null}function Om(){return T.jsxs(bC.Provider,{value:Pi,children:[bl(),Hf(),Uf(),a]})}function Fm(){return pe?O===null||ue===void 0||ue===null?T.jsx(nc,{type:"loading",children:typeof g=="function"?g():g}):O===!1||ue===!1?T.jsx(nc,{type:"error",children:typeof f=="function"?f():f}):Om():T.jsx(nc,{type:"no-data",children:typeof x=="function"?x():x})}return T.jsx("div",Object.assign({className:_i(s,c),"data-page-number":pe,ref:wC(v,_t),style:{"--scale-round-x":"1px","--scale-round-y":"1px","--scale-factor":"1","--user-unit":`${Se}`,"--total-scale-factor":"calc(var(--scale-factor) * var(--user-unit))",backgroundColor:r||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"}},qs,{children:Fm()}))}$M();ps.workerSrc="pdf.worker.mjs";const rD=({assetId:n,pdfUrl:e,initialParsedData:t,onSave:s,onConfirm:i,onAnalyze:r,onClose:o})=>{const[a,c]=R.useState(null),[u,d]=R.useState(1),[h,f]=R.useState(t),[p,v]=R.useState(!1);function g({numPages:C}){c(C),d(1)}const x=()=>d(C=>Math.max(C-1,1)),y=()=>d(C=>Math.min(C+1,a||1)),w=(C,P)=>{f(L=>({...L,[C]:P})),v(!0)},b=()=>{s(n,h),v(!1)},E=()=>{p&&!window.confirm("You have unsaved changes. Re-analysing will discard your edits. Do you want to continue?")||r(n)},_=()=>{i(n,h),v(!1),o()},k=()=>{p&&!window.confirm("You have unsaved changes. Close without saving?")||o()};return T.jsxs("div",{className:"flex flex-1 w-full h-full",children:[T.jsxs("div",{className:"w-1/2 h-full border-r border-gray-200 flex flex-col bg-gray-50",children:[T.jsx("div",{className:"flex-grow overflow-y-auto",children:T.jsx(XM,{file:e,onLoadSuccess:g,loading:T.jsx("p",{className:"p-4 text-center",children:"Loading PDF..."}),error:T.jsx("p",{className:"p-4 text-center text-red-500",children:"Failed to load PDF. Please check the file URL and ensure the backend is running."}),children:T.jsx(iD,{pageNumber:u})})}),a&&T.jsxs("div",{className:"flex items-center justify-center p-2 border-t bg-white shadow-sm",children:[T.jsx("button",{onClick:x,disabled:u<=1,className:"px-3 py-1 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Prev"}),T.jsxs("p",{className:"text-sm text-gray-700 mx-4",children:["Page ",u," of ",a]}),T.jsx("button",{onClick:y,disabled:u>=a,className:"px-3 py-1 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]}),T.jsxs("div",{className:"w-1/2 h-full flex flex-col overflow-y-auto bg-white",children:[T.jsxs("div",{className:"p-4 flex justify-between items-center border-b",children:[T.jsx("h2",{className:"text-lg font-semibold",children:"Review & Confirm"}),T.jsx("button",{onClick:k,className:"p-2 rounded-full hover:bg-gray-200","aria-label":"Close",children:""})]}),T.jsx("div",{className:"p-4 flex-grow space-y-4",children:Object.entries(h).map(([C,P])=>T.jsxs("div",{children:[T.jsx("label",{className:"block text-sm font-medium text-gray-700 capitalize",children:C.replace(/_/g," ")}),typeof P=="object"&&P!==null?T.jsx("textarea",{value:JSON.stringify(P,null,2),onChange:L=>{try{const M=JSON.parse(L.target.value);w(C,M)}catch{w(C,L.target.value)}},rows:4,className:"mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm font-mono"}):T.jsx("input",{type:"text",value:String(P??""),onChange:L=>w(C,L.target.value),className:"mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]},C))}),T.jsxs("div",{className:"p-4 border-t bg-gray-50 flex justify-end space-x-3",children:[T.jsx("button",{onClick:b,className:"px-4 py-2 text-sm font-medium text-white bg-green-600 border border-transparent rounded-md shadow-sm hover:bg-green-700 focus:outline-none",children:"Save"}),T.jsx("button",{onClick:_,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700 focus:outline-none",children:"Confirm & Close"}),T.jsx("button",{onClick:E,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700 focus:outline-none",children:"Re-Analyze"})]})]})]})},oD=()=>{const n=q(g=>g.activeDatasheet),e=q(g=>g.setActiveDatasheet),{addUpload:t,updateUpload:s,setRoute:i,addStatusMessage:r}=q(),{setNodeRef:o}=ZE({id:"component-canvas-area"}),a=R.useRef(null),c=R.useCallback(async g=>{const x=`temp-${Date.now()}`;t({id:x,name:g.name,size:g.size,mime:g.type,progress:0,assetType:"component",parsed_at:null,parsing_status:null,parsing_error:null,is_human_verified:!1});try{const y=await ME(g,b=>s(x,{progress:b}));s(y.id,{...y,parsing_status:"processing"}),i("components"),kg(y.id).catch(b=>{s(y.id,{parsing_status:"failed",parsing_error:b.message})});const w=setInterval(async()=>{try{const b=await vu(y.id);if(b.parsing_status==="success"){clearInterval(w),s(y.id,{parsing_status:"success",parsing_error:null});const E=`${Ze}/files/${b.id}/file`;e({id:b.id,url:E,payload:b.parsed_payload})}else b.parsing_status==="failed"&&(clearInterval(w),s(y.id,{parsing_status:"failed",parsing_error:b.parsing_error}))}catch(b){clearInterval(w),s(y.id,{parsing_status:"failed",parsing_error:b.message||"Failed to fetch status"})}},2e3)}catch(y){console.error(y),s(x,{parsing_status:"failed",parsing_error:"Upload or parse failed"})}},[t,s,e,i]),u=R.useCallback(g=>{if(g.preventDefault(),g.dataTransfer.files&&g.dataTransfer.files[0]){const x=g.dataTransfer.files[0];x.type==="application/pdf"&&c(x)}},[c]),d=g=>g.preventDefault(),h=(g,x)=>{SA(g,x,!1).then(y=>{const w=`${Ze}/files/${y.id}/file`;e({id:y.id,url:w,payload:y.parsed_payload}),r("Changes saved","success")}).catch(y=>{console.error("Failed to save datasheet",y),r("Failed to save datasheet","error")})},f=(g,x)=>{SA(g,x,!0).then(y=>{const w=`${Ze}/files/${y.id}/file`;e({id:y.id,url:w,payload:y.parsed_payload}),r("Datasheet confirmed","success")}).catch(y=>{console.error("Failed to confirm datasheet",y),r("Failed to confirm datasheet","error")})},p=g=>{a.current||(r("Re-analyzing datasheet...","info"),kg(g).catch(x=>{console.error("Re-Analyze failed",x),r("Re-Analyze failed","error"),a.current&&(clearInterval(a.current),a.current=null)}),a.current=setInterval(async()=>{try{const x=await vu(g);if(x.parsing_status==="success"){clearInterval(a.current),a.current=null,s(g,{parsing_status:"success",parsing_error:null});const y=`${Ze}/files/${x.id}/file`;e({id:x.id,url:y,payload:x.parsed_payload}),r("Datasheet parsed successfully","success")}else x.parsing_status==="failed"&&(clearInterval(a.current),a.current=null,s(g,{parsing_status:"failed",parsing_error:x.parsing_error}),r("Datasheet parsing failed","error"))}catch(x){clearInterval(a.current),a.current=null,s(g,{parsing_status:"failed",parsing_error:x.message||"Failed to fetch status"}),r("Datasheet parsing failed","error")}},2e3))},v=()=>e(null);return T.jsx("div",{ref:o,className:"w-full h-full flex flex-col",onDrop:u,onDragOver:d,children:n?T.jsx(rD,{assetId:n.id,pdfUrl:n.url,initialParsedData:n.payload,onSave:h,onConfirm:f,onAnalyze:p,onClose:v}):T.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-400 border-2 border-dashed rounded-lg pointer-events-none",children:T.jsx("p",{children:"Drop a component from the library or a PDF from your computer to begin."})})})},aD=()=>{const n=q(o=>o.useRuleBased),e=q(o=>o.useTableExtraction),t=q(o=>o.useAiExtraction),s=q(o=>o.useOcrFallback),i=q(o=>o.setExtractionSetting),r=(o,a,c)=>T.jsxs("div",{className:"flex items-center justify-between py-2",children:[T.jsx("span",{className:"text-sm font-medium text-gray-700",children:a}),T.jsx("label",{className:"inline-flex items-center cursor-pointer",children:T.jsx("input",{type:"checkbox",className:"form-checkbox h-4 w-4 text-blue-600",checked:c,onChange:u=>i(o,u.target.checked)})})]});return T.jsxs("div",{className:"flex flex-col h-full p-4 overflow-auto bg-gray-50 text-black",children:[T.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Settings"}),T.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Configure how datasheets are parsed. These options control the backend extraction pipeline. You can enable or disable rule-based parsing, table extraction, AI extraction and OCR fallback. Changes take effect immediately for future parses."}),r("useRuleBased","Use rule-based parsing",n),r("useTableExtraction","Use table extraction",e),r("useAiExtraction","Use AI extraction",t),r("useOcrFallback","Use OCR fallback",s)]})},lD=()=>{const n=q(e=>e.route);return q(e=>e.activeDatasheet),T.jsxs("main",{className:"grid-in-main flex flex-col bg-gray-50 text-black h-full w-full p-2 overflow-hidden",children:[n==="projects"&&T.jsx(PL,{}),n==="components"&&T.jsx(oD,{}),n==="settings"&&T.jsx(aD,{})]})},cD=({u:n})=>{const e=q(d=>d.setActiveDatasheet),t=q(d=>d.setRoute),s=q(d=>d.updateUpload),{attributes:i,listeners:r,setNodeRef:o,isDragging:a}=JE({id:`file-asset-${n.id}`,data:{type:"file-asset",asset:n}}),c=()=>n.parsing_status==="processing"?T.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"}):n.parsing_status==="failed"?T.jsx("span",{title:n.parsing_error||"An unknown error occurred.",className:"text-red-500",children:""}):n.parsing_status==="success"?T.jsx("span",{className:"text-green-500",children:""}):null,u=async()=>{try{s(n.id,{parsing_status:"processing"}),await kg(n.id);const d=setInterval(async()=>{try{const h=await vu(n.id);if(h.parsing_status==="success"){clearInterval(d),s(n.id,{parsing_status:"success",parsing_error:null});const f=`${Ze}/files/${h.id}/file`;e({id:h.id,url:f,payload:h.parsed_payload}),t("components")}else h.parsing_status==="failed"&&(clearInterval(d),s(n.id,{parsing_status:"failed",parsing_error:h.parsing_error}))}catch(h){clearInterval(d),s(n.id,{parsing_status:"failed",parsing_error:h.message||"Failed to fetch status"})}},2e3)}catch(d){console.error(d),s(n.id,{parsing_status:"failed",parsing_error:d.message||"Failed to parse datasheet"})}};return T.jsxs("div",{ref:o,...r,...i,onClick:async()=>{if(n.parsing_status==="success"){const d=await vu(n.id),h=`${Ze}/files/${d.id}/file`;e({id:d.id,url:h,payload:d.parsed_payload}),t("components")}},className:_i("border rounded p-2 text-sm transition bg-white shadow-sm",a&&"opacity-50"),children:[T.jsxs("div",{className:"flex justify-between items-center gap-2",children:[T.jsx("div",{className:"font-medium truncate flex-1",children:n.name}),(!n.parsing_status||n.parsing_status==="failed")&&T.jsx("button",{onClick:d=>{d.stopPropagation(),u()},className:"text-xs text-blue-600 hover:underline",title:"Parse datasheet",children:"Parse"})]}),T.jsx("div",{className:"h-1 bg-gray-200 rounded mt-1",children:T.jsx("div",{className:_i("h-1 rounded bg-emerald-500 transition-all",n.progress>100?"w-full":void 0),style:{width:`${Math.min(n.progress,100)}%`}})}),T.jsx("div",{className:"text-xs text-right text-gray-500 flex items-center gap-1 mt-1",children:n.progress>100?T.jsx(c,{}):`${n.progress}%`})]})},uD=()=>{const n=q(e=>e.uploads.filter(t=>t.progress>100));return n.length?T.jsxs("div",{className:"p-2 space-y-2",children:[T.jsx("div",{className:"text-sm font-medium text-gray-500 px-2",children:"Component Library"}),n.map(e=>T.jsx(cD,{u:e},e.id))]}):null},dD=[{name:"projects",label:"Projects",icon:jP},{name:"components",label:"Components",icon:HP},{name:"settings",label:"Settings",icon:IE}],hD=({isCollapsed:n})=>{const e=q(s=>s.route),t=q(s=>s.setRoute);return T.jsx("div",{className:"grid-in-sidebar flex flex-col bg-white text-black border-r border-gray-200",children:T.jsxs("nav",{className:"flex-1 py-4 px-2 mt-2","aria-label":"Sidebar navigation",children:[T.jsx("ul",{className:"space-y-1",children:dD.map(s=>T.jsx("li",{children:T.jsxs("button",{onClick:()=>t(s.name),className:`flex w-full items-center gap-3 p-3 rounded-r-lg transition-colors ${n?"justify-center":""} ${e===s.name?"bg-blue-100 text-blue-600":"hover:bg-blue-50"}`,"aria-current":e===s.name?"page":void 0,title:n?s.label:void 0,children:[T.jsx(s.icon,{className:"h-5 w-5"}),!n&&T.jsx("span",{children:s.label})]})},s.name))}),!n&&T.jsx(uD,{})]})})},fD=({isCollapsed:n})=>T.jsx("div",{className:`grid-in-sidebar-header flex items-center p-4 h-16 border-b border-r border-gray-200 ${n?"justify-center":"justify-start"}`,children:T.jsxs("a",{href:"/",className:"flex items-center gap-2",children:[T.jsx("span",{className:"text-2xl",children:""}),!n&&T.jsx("h1",{className:"text-xl font-bold",children:"OriginFlow"})]})}),pD=({isCollapsed:n})=>T.jsx("div",{className:"grid-in-sidebar-footer p-2 border-t border-r border-gray-200 bg-white flex items-center",children:T.jsxs("a",{href:"#",className:"flex items-center gap-3 px-4 py-2 text-sm font-medium rounded-md hover:bg-gray-100",children:[T.jsx(VP,{size:20}),!n&&T.jsx("span",{children:"Help & Support"})]})}),gD={info:"text-blue-600",success:"text-green-600",error:"text-red-600"},mD=()=>{const n=q(s=>s.statusMessages),e=n[n.length-1],t=e!=null&&e.icon?gD[e.icon]??"text-gray-600":"text-gray-600";return T.jsx("footer",{role:"status","aria-live":"polite",className:`grid-in-status flex items-center px-4 py-2 bg-white text-black border-t border-gray-200 text-sm ${t}`,children:(e==null?void 0:e.message)??"Ready"})},yD=()=>{const n=q(e=>e.analyzeAndExecute);return T.jsxs("section",{className:"grid-in-toolbar h-12 flex items-center justify-between px-6 border-b bg-white shadow-sm",role:"region","aria-label":"Sub Navigation",children:[T.jsxs("div",{className:"flex items-center gap-3",children:[T.jsx("button",{onClick:()=>n("validate my design"),className:"px-3 py-1 text-sm rounded bg-blue-600 text-white hover:bg-blue-700",children:"Analyze"}),T.jsx("button",{className:"px-3 py-1 text-sm rounded bg-gray-100 hover:bg-gray-200",children:"Filter"}),T.jsx("button",{className:"px-3 py-1 text-sm rounded bg-gray-100 hover:bg-gray-200",children:"Export"})]}),T.jsx("div",{className:"text-xs text-gray-500 italic",children:"Sub-nav active"})]})},vD=({message:n})=>{const e=n.author==="User";return T.jsx("div",{className:_i("w-full flex",e?"justify-end":"justify-start"),children:T.jsx("div",{className:_i("max-w-[80%] rounded-2xl px-4 py-2 text-sm whitespace-pre-wrap",{"bg-blue-600 text-white":e,"bg-gray-200 text-gray-800":!e}),children:n.text})})},wD=()=>{const n=q(t=>t.messages),e=q(t=>t.isAiProcessing);return T.jsx("div",{className:"grid-in-chat-history flex flex-col h-full bg-white overflow-y-auto min-h-0",style:{borderLeft:"1px solid #e5e7eb"},children:T.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[n.map((t,s)=>T.jsx(vD,{message:t},s)),e&&T.jsx("div",{className:"w-full flex justify-start mt-2","aria-live":"polite","aria-label":"AI processing indicator",children:T.jsxs("div",{className:"flex items-center space-x-2 bg-gray-200 text-gray-800 px-4 py-2 rounded-2xl text-sm",children:[T.jsx(NE,{className:"animate-spin h-4 w-4"}),T.jsx("span",{children:"Echo is thinking"})]})})]})})};function bD(n){return`${n}_${crypto.randomUUID()}`}const AD=()=>{const n=R.useRef(null),{addUpload:e,updateUpload:t,addMessage:s,addStatusMessage:i,uploads:r}=q(),o=()=>{var c;return(c=n.current)==null?void 0:c.click()},a=async c=>{var h;const u=(h=c.target.files)==null?void 0:h[0];if(!u)return;const d=bD("upload");e({id:d,name:u.name,size:u.size,mime:u.type,progress:0,assetType:"component",parsed_at:null,parsing_status:null,parsing_error:null,is_human_verified:!1}),i(`Uploading ${u.name}`,"info");try{const f=await ME(u,p=>t(d,{progress:p}));t(d,{...f,id:f.id,progress:101,parsing_status:null,parsing_error:null}),s({author:"User",text:`Uploaded ${u.name}`}),i("Upload complete","success")}catch(f){console.error("Upload failed",f),t(d,{progress:-1}),s({author:"User",text:` Upload failed for ${u.name}`}),i("Upload failed","error")}};return T.jsxs(T.Fragment,{children:[T.jsx("input",{type:"file",ref:n,onChange:a,className:"hidden"}),T.jsxs("button",{onClick:o,className:"relative p-2 text-gray-500 hover:text-blue-600 transition-colors","aria-label":"Upload file",children:[T.jsx(QP,{size:20}),r.some(c=>c.progress>=0&&c.progress<100)&&T.jsx(NE,{size:14,className:"absolute top-0 right-0 text-blue-600 animate-spin"}),(()=>{const c=r.filter(u=>u.progress>=0&&u.progress<100).length;return c>0?T.jsx("span",{className:"absolute -top-1 -right-1 bg-red-600 text-white rounded-full text-xs w-4 h-4 flex items-center justify-center",children:c}):null})()]})]})},SD=()=>{const n=q(h=>h.chatDraft),e=q(h=>h.setChatDraft),t=q(h=>h.analyzeAndExecute),s=q(h=>h.clearChatDraft),i=q(h=>h.voiceMode),r=q(h=>h.startListening),o=q(h=>h.stopListening),a=q(h=>h.voiceTranscript),c=q(h=>h.isAiProcessing),u=i==="listening",d=i==="speaking";return T.jsx("div",{className:"grid-in-chat-input p-3 bg-white border-t border-white",style:{borderLeft:"1px solid #e5e7eb"},children:T.jsxs("div",{className:"relative",children:[T.jsx("textarea",{value:u?a:n,onChange:h=>e(h.target.value),onKeyDown:h=>{h.key==="Enter"&&!h.shiftKey&&(h.preventDefault(),n.trim()&&(t(n),s()))},placeholder:u?"Listening...":d?"Echo is speaking...":"Ask Echo to do something...",className:"w-full h-full p-2 border border-gray-300 rounded bg-white text-black placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none pr-20",rows:2,readOnly:u||d}),T.jsxs("div",{className:"absolute right-2 bottom-2 flex gap-2",children:[T.jsx(AD,{}),T.jsx("button",{onClick:()=>{u?o():r()},className:`p-2 rounded-md ${u?"bg-red-600 text-white":"bg-gray-100"}`,"aria-label":"Record voice command",disabled:c||d,children:d?T.jsx(BP,{className:"h-5 w-5 animate-pulse"}):T.jsx(XP,{className:"h-5 w-5"})}),T.jsx("button",{onClick:()=>{n.trim()&&(t(n),s())},disabled:c||u||d,className:"p-2 bg-blue-600 rounded-md hover:bg-blue-700 disabled:opacity-50 text-white","aria-label":"Send message",children:T.jsx(ZP,{className:"h-5 w-5"})})]})]})})},xD=()=>{const{voiceOutputEnabled:n,toggleVoiceOutput:e,isContinuousConversation:t,toggleContinuousConversation:s}=q();return T.jsxs("div",{className:"p-4 border-t border-gray-200",children:[T.jsxs("div",{className:"flex justify-between items-center gap-4",children:[T.jsxs("div",{className:"flex items-center space-x-2",children:[T.jsx("input",{id:"voice-output",type:"checkbox",className:"form-checkbox",checked:n,onChange:e}),T.jsx("label",{htmlFor:"voice-output",className:"text-sm font-medium",children:"Voice Output"})]}),T.jsxs("div",{className:"flex items-center space-x-2",children:[T.jsx("input",{id:"continuous-conversation",type:"checkbox",className:"form-checkbox",checked:t,onChange:s}),T.jsx("label",{htmlFor:"continuous-conversation",className:"text-sm font-medium",children:"Continuous Conversation"})]})]}),T.jsx("p",{className:"mt-4 text-xs text-gray-500",children:"OriginFlow is a prototype. Responses may be inaccurate."})]})},ED=()=>{const n=q(s=>s.voiceMode),e=q(s=>s.stopListening),t=q(s=>s.updateVoiceTranscript);return R.useEffect(()=>{const s=window.SpeechRecognition||window.webkitSpeechRecognition;if(!s){console.warn("SpeechRecognition API not supported in this browser.");return}const i=new s;if(i.continuous=!0,i.interimResults=!0,i.lang="en-US",i.onresult=r=>{let o="",a="";for(let c=r.resultIndex;c<r.results.length;++c){const u=r.results[c][0].transcript;r.results[c].isFinal?o+=u:a+=u}if(a&&t(a),o){const c=o.trim().toLowerCase();if(c==="stop listening"||c==="stop"){e();return}e(c)}},i.onerror=()=>{n==="listening"&&e()},n==="listening")try{i.start()}catch{}else i.stop();return()=>{i.stop()}},[n,e,t]),null},_D=()=>{const n=q(a=>a.messages),e=q(a=>a.voiceOutputEnabled),t=q(a=>a.isContinuousConversation),s=q(a=>a.startListening),i=q(a=>a.stopListening),r=q(a=>a.setVoiceMode),o=R.useRef(null);return R.useEffect(()=>{if(!e||n.length===0)return;const a=n[n.length-1];if(a.author!=="AI"||o.current===a.id)return;const c=window.speechSynthesis;if(!c)return;i(),r("speaking");const u=a.summary||a.text,d=new SpeechSynthesisUtterance(u);d.onend=()=>{t?s():r("idle")},c.speak(d),o.current=a.id},[n,e,t,s,i,r]),null},CD=()=>{const[n,e]=R.useState(!1),t=q(i=>i.isSubNavVisible),s=q(i=>i.toggleSubNav);return T.jsxs(T.Fragment,{children:[T.jsx(ED,{}),T.jsx(_D,{}),T.jsxs("div",{className:"grid h-screen w-screen min-h-0 transition-all duration-300 ease-in-out",style:{gridTemplateColumns:`${n?"64px":"250px"} 1fr 350px`,gridTemplateRows:`64px ${t?"48px":"0px"} 1fr auto 48px`,gridTemplateAreas:`
          "sidebar-header header      chat-history"
          "sidebar        toolbar     chat-history"
          "sidebar        main        chat-history"
          "sidebar        main        chat-input"
          "sidebar-footer status      chat-footer"
        `},children:[T.jsx(fD,{isCollapsed:n}),T.jsx(tR,{toggleSidebar:()=>e(!n),toggleToolbar:s}),t&&T.jsx(yD,{}),T.jsx(hD,{isCollapsed:n}),T.jsx("div",{className:"grid-in-main relative min-h-0 overflow-auto bg-gray-50",children:T.jsx(lD,{})}),T.jsx(wD,{}),T.jsx(SD,{}),T.jsx(xD,{}),T.jsx(pD,{isCollapsed:n}),T.jsx(mD,{})]})]})},kD=({items:n,onClose:e})=>T.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center",children:T.jsxs("div",{className:"bg-white p-4 rounded",children:[T.jsx("h2",{className:"font-bold mb-2",children:"Bill of Materials"}),T.jsx("ul",{className:"list-disc pl-6 max-h-60 overflow-auto",children:n.map(t=>T.jsx("li",{children:t},t))}),T.jsx("button",{className:"mt-4 btn",onClick:e,children:"Close"})]})}),TD=()=>{const{bomItems:n,setBom:e,loadUploads:t,addComponent:s,updateComponentPosition:i,updateUpload:r,setActiveDatasheet:o,setRoute:a,addStatusMessage:c}=q(),u=mR(gR(Bw)),d=h=>{var g,x,y;const{active:f,over:p,delta:v}=h;if(p){if(p.id==="canvas-area"&&((g=f.data.current)==null?void 0:g.type)==="file-asset"){const w=f.data.current.asset;s({name:w.name,type:w.mime,standard_code:w.id});return}if(p.id==="component-canvas-area"&&((x=f.data.current)==null?void 0:x.type)==="file-asset"){const w=f.data.current.asset;if(w.parsing_status==="success"){a("components"),(async()=>{try{const E=await vu(w.id),_=`${Ze}/files/${E.id}/file`;o({id:E.id,url:_,payload:E.parsed_payload})}catch(E){console.error("Failed to load parsed datasheet:",E),r(w.id,{parsing_status:"failed",parsing_error:E.message||"Failed to fetch status"}),c("Failed to load datasheet","error")}})();return}r(w.id,{parsing_status:"processing"}),a("components"),c("Parsing datasheet...","info"),kg(w.id).catch(E=>{r(w.id,{parsing_status:"failed",parsing_error:E.message}),c("Datasheet parsing failed","error")});const b=setInterval(async()=>{try{const E=await vu(w.id);if(E.parsing_status==="success"){clearInterval(b),r(w.id,{parsing_status:"success",parsing_error:null});const _=`${Ze}/files/${E.id}/file`;o({id:E.id,url:_,payload:E.parsed_payload}),c("Datasheet parsed successfully","success")}else E.parsing_status==="failed"&&(clearInterval(b),r(w.id,{parsing_status:"failed",parsing_error:E.parsing_error}),c("Datasheet parsing failed","error"))}catch(E){clearInterval(b),r(w.id,{parsing_status:"failed",parsing_error:E.message||"Failed to fetch status"}),c("Datasheet parsing failed","error")}},2e3);return}((y=f.data.current)==null?void 0:y.type)==="canvas-card"&&i(f.id,{x:v.x,y:v.y})}};return R.useEffect(()=>{t()},[t]),T.jsx(vL,{sensors:u,onDragEnd:d,children:T.jsxs("div",{className:"App h-full",children:[T.jsx(CD,{}),n&&T.jsx(kD,{items:n,onClose:()=>e(null)})]})})},PD="/assets/pdf.worker.min-CsnNCGNt.mjs";ps.workerSrc=PD;const dS=document.getElementById("root"),hS=dS?Cy.createRoot(dS):null;hS&&hS.render(T.jsx(yn.StrictMode,{children:T.jsx(TD,{})}));
